ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pwm.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.SWI_EXTI_Config,"ax",%progbits
  18              		.align	1
  19              		.global	SWI_EXTI_Config
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	SWI_EXTI_Config:
  26              	.LFB333:
  27              		.file 1 "Src/pwm.c"
   1:Src/pwm.c     **** #include "PWM.h"
   2:Src/pwm.c     **** #include "global.h"
   3:Src/pwm.c     **** // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½ï¿½ï¿½ï¿½Ð¶ï¿½ï¿½ï¿½ï¿½ï¿½ EXTI_Line3
   4:Src/pwm.c     **** 
   5:Src/pwm.c     **** TIM_HandleTypeDef htim1;
   6:Src/pwm.c     **** volatile  s32 sample_invered = 0;
   7:Src/pwm.c     **** 
   8:Src/pwm.c     **** 
   9:Src/pwm.c     **** 
  10:Src/pwm.c     **** void HAL_TIM_MspPostInit(TIM_HandleTypeDef* htim);
  11:Src/pwm.c     **** 
  12:Src/pwm.c     **** void SWI_EXTI_Config(void)
  13:Src/pwm.c     **** {
  28              		.loc 1 13 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
  14:Src/pwm.c     **** //	EXTI_HandleTypeDef  EXTI_Handle;
  15:Src/pwm.c     **** //	EXTI_ConfigTypeDef   EXTI_Config;
  16:Src/pwm.c     **** //	
  17:Src/pwm.c     **** //	
  18:Src/pwm.c     **** //	
  19:Src/pwm.c     **** //	EXTI_Handle.Line = EXTI_LINE_3;
  20:Src/pwm.c     **** //	
  21:Src/pwm.c     **** //	EXTI_Config.GPIOSel= EXTI_GPIOA;
  22:Src/pwm.c     **** //	EXTI_Config.Line =EXTI_LINE_3;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 2


  23:Src/pwm.c     **** //	EXTI_Config.Mode = EXTI_MODE_INTERRUPT;
  24:Src/pwm.c     **** //	EXTI_Config.Trigger = EXTI_TRIGGER_RISING_FALLING;
  25:Src/pwm.c     **** //	
  26:Src/pwm.c     **** 	EXTI->PR1 |= 0x0008;		// ï¿½ï¿½ï¿½ï¿½ï¿½Ö¾
  37              		.loc 1 26 0
  38 0002 0B4B     		ldr	r3, .L2
  39 0004 5A69     		ldr	r2, [r3, #20]
  40 0006 42F00802 		orr	r2, r2, #8
  41 000a 5A61     		str	r2, [r3, #20]
  27:Src/pwm.c     **** 	EXTI->IMR1 |=  0x08;
  42              		.loc 1 27 0
  43 000c 1A68     		ldr	r2, [r3]
  44 000e 42F00802 		orr	r2, r2, #8
  45 0012 1A60     		str	r2, [r3]
  28:Src/pwm.c     **** 	EXTI->EMR1 |=  0x08;
  46              		.loc 1 28 0
  47 0014 5A68     		ldr	r2, [r3, #4]
  48 0016 42F00802 		orr	r2, r2, #8
  49 001a 5A60     		str	r2, [r3, #4]
  29:Src/pwm.c     **** //	
  30:Src/pwm.c     **** //	HAL_EXTI_SetConfigLine(&EXTI_Handle, &EXTI_Config);
  31:Src/pwm.c     **** 	
  32:Src/pwm.c     **** 	
  33:Src/pwm.c     **** 	HAL_NVIC_SetPriority(EXTI3_IRQn, 1, 1);
  50              		.loc 1 33 0
  51 001c 0122     		movs	r2, #1
  52 001e 0920     		movs	r0, #9
  53 0020 1146     		mov	r1, r2
  54 0022 FFF7FEFF 		bl	HAL_NVIC_SetPriority
  55              	.LVL0:
  34:Src/pwm.c     ****   HAL_NVIC_EnableIRQ(EXTI3_IRQn);
  56              		.loc 1 34 0
  57 0026 0920     		movs	r0, #9
  35:Src/pwm.c     **** }
  58              		.loc 1 35 0
  59 0028 BDE80840 		pop	{r3, lr}
  60              	.LCFI1:
  61              		.cfi_restore 14
  62              		.cfi_restore 3
  63              		.cfi_def_cfa_offset 0
  34:Src/pwm.c     ****   HAL_NVIC_EnableIRQ(EXTI3_IRQn);
  64              		.loc 1 34 0
  65 002c FFF7FEBF 		b	HAL_NVIC_EnableIRQ
  66              	.LVL1:
  67              	.L3:
  68              		.align	2
  69              	.L2:
  70 0030 00040140 		.word	1073808384
  71              		.cfi_endproc
  72              	.LFE333:
  74              		.section	.text.MX_TIM1_Init,"ax",%progbits
  75              		.align	1
  76              		.global	MX_TIM1_Init
  77              		.syntax unified
  78              		.thumb
  79              		.thumb_func
  80              		.fpu fpv4-sp-d16
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 3


  82              	MX_TIM1_Init:
  83              	.LFB334:
  36:Src/pwm.c     **** 
  37:Src/pwm.c     **** 
  38:Src/pwm.c     **** /**
  39:Src/pwm.c     ****   * @brief TIM1 Initialization Function
  40:Src/pwm.c     ****   * @param None
  41:Src/pwm.c     ****   * @retval None
  42:Src/pwm.c     ****   */
  43:Src/pwm.c     ****  void MX_TIM1_Init(void)
  44:Src/pwm.c     **** {
  84              		.loc 1 44 0
  85              		.cfi_startproc
  86              		@ args = 0, pretend = 0, frame = 112
  87              		@ frame_needed = 0, uses_anonymous_args = 0
  88 0000 30B5     		push	{r4, r5, lr}
  89              	.LCFI2:
  90              		.cfi_def_cfa_offset 12
  91              		.cfi_offset 4, -12
  92              		.cfi_offset 5, -8
  93              		.cfi_offset 14, -4
  45:Src/pwm.c     **** 
  46:Src/pwm.c     ****   /* USER CODE BEGIN TIM1_Init 0 */
  47:Src/pwm.c     **** 
  48:Src/pwm.c     ****   /* USER CODE END TIM1_Init 0 */
  49:Src/pwm.c     **** 
  50:Src/pwm.c     ****   TIM_ClockConfigTypeDef sClockSourceConfig = {0};
  94              		.loc 1 50 0
  95 0002 1022     		movs	r2, #16
  44:Src/pwm.c     **** 
  96              		.loc 1 44 0
  97 0004 9DB0     		sub	sp, sp, #116
  98              	.LCFI3:
  99              		.cfi_def_cfa_offset 128
  51:Src/pwm.c     ****   TIM_MasterConfigTypeDef sMasterConfig = {0};
 100              		.loc 1 51 0
 101 0006 0025     		movs	r5, #0
  50:Src/pwm.c     ****   TIM_MasterConfigTypeDef sMasterConfig = {0};
 102              		.loc 1 50 0
 103 0008 0021     		movs	r1, #0
 104 000a 0DEB0200 		add	r0, sp, r2
 105 000e FFF7FEFF 		bl	memset
 106              	.LVL2:
  52:Src/pwm.c     ****   TIM_OC_InitTypeDef sConfigOC = {0};
 107              		.loc 1 52 0
 108 0012 1C22     		movs	r2, #28
 109 0014 2946     		mov	r1, r5
 110 0016 08A8     		add	r0, sp, #32
  51:Src/pwm.c     ****   TIM_MasterConfigTypeDef sMasterConfig = {0};
 111              		.loc 1 51 0
 112 0018 CDE90155 		strd	r5, r5, [sp, #4]
 113 001c 0395     		str	r5, [sp, #12]
 114              		.loc 1 52 0
 115 001e FFF7FEFF 		bl	memset
 116              	.LVL3:
  53:Src/pwm.c     ****   TIM_BreakDeadTimeConfigTypeDef sBreakDeadTimeConfig = {0};
 117              		.loc 1 53 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 4


 118 0022 3422     		movs	r2, #52
 119 0024 2946     		mov	r1, r5
 120 0026 0FA8     		add	r0, sp, #60
 121 0028 FFF7FEFF 		bl	memset
 122              	.LVL4:
  54:Src/pwm.c     **** 
  55:Src/pwm.c     ****   /* USER CODE BEGIN TIM1_Init 1 */
  56:Src/pwm.c     **** 
  57:Src/pwm.c     ****   /* USER CODE END TIM1_Init 1 */
  58:Src/pwm.c     ****   htim1.Instance = TIM1;
 123              		.loc 1 58 0
 124 002c 5B4C     		ldr	r4, .L45
 125 002e 5C4B     		ldr	r3, .L45+4
  59:Src/pwm.c     ****   htim1.Init.Prescaler = 0;
  60:Src/pwm.c     ****   htim1.Init.CounterMode = TIM_COUNTERMODE_CENTERALIGNED1;
  61:Src/pwm.c     ****   htim1.Init.Period = REAL_CCR;
 126              		.loc 1 61 0
 127 0030 4FF0200C 		mov	ip, #32
  59:Src/pwm.c     ****   htim1.Init.Prescaler = 0;
 128              		.loc 1 59 0
 129 0034 C4E90035 		strd	r3, r5, [r4]
 130              		.loc 1 61 0
 131 0038 4FF45263 		mov	r3, #3360
 132 003c C4E902C3 		strd	ip, r3, [r4, #8]
  62:Src/pwm.c     ****   htim1.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  63:Src/pwm.c     ****   htim1.Init.RepetitionCounter = 0;
  64:Src/pwm.c     ****   htim1.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_ENABLE;
  65:Src/pwm.c     **** 	
  66:Src/pwm.c     **** 	
  67:Src/pwm.c     ****   if (HAL_TIM_Base_Init(&htim1) != HAL_OK)
 133              		.loc 1 67 0
 134 0040 2046     		mov	r0, r4
  64:Src/pwm.c     **** 	
 135              		.loc 1 64 0
 136 0042 8023     		movs	r3, #128
  63:Src/pwm.c     ****   htim1.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_ENABLE;
 137              		.loc 1 63 0
 138 0044 C4E90455 		strd	r5, r5, [r4, #16]
  64:Src/pwm.c     **** 	
 139              		.loc 1 64 0
 140 0048 A361     		str	r3, [r4, #24]
 141              		.loc 1 67 0
 142 004a FFF7FEFF 		bl	HAL_TIM_Base_Init
 143              	.LVL5:
 144 004e 08B1     		cbz	r0, .L5
 145              	.LBB4:
  68:Src/pwm.c     ****   {
  69:Src/pwm.c     ****     Error_Handler();
 146              		.loc 1 69 0
 147 0050 FFF7FEFF 		bl	Error_Handler
 148              	.LVL6:
 149              	.L5:
 150              	.LBE4:
  70:Src/pwm.c     ****   }
  71:Src/pwm.c     ****   sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
 151              		.loc 1 71 0
 152 0054 4FF48053 		mov	r3, #4096
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 5


  72:Src/pwm.c     ****   if (HAL_TIM_ConfigClockSource(&htim1, &sClockSourceConfig) != HAL_OK)
 153              		.loc 1 72 0
 154 0058 04A9     		add	r1, sp, #16
 155 005a 5048     		ldr	r0, .L45
  71:Src/pwm.c     ****   if (HAL_TIM_ConfigClockSource(&htim1, &sClockSourceConfig) != HAL_OK)
 156              		.loc 1 71 0
 157 005c 0493     		str	r3, [sp, #16]
 158              		.loc 1 72 0
 159 005e FFF7FEFF 		bl	HAL_TIM_ConfigClockSource
 160              	.LVL7:
 161 0062 08B1     		cbz	r0, .L6
 162              	.LBB5:
  73:Src/pwm.c     ****   {
  74:Src/pwm.c     ****     Error_Handler();
 163              		.loc 1 74 0
 164 0064 FFF7FEFF 		bl	Error_Handler
 165              	.LVL8:
 166              	.L6:
 167              	.LBE5:
  75:Src/pwm.c     ****   }
  76:Src/pwm.c     ****   if (HAL_TIM_PWM_Init(&htim1) != HAL_OK)
 168              		.loc 1 76 0
 169 0068 4C48     		ldr	r0, .L45
 170 006a FFF7FEFF 		bl	HAL_TIM_PWM_Init
 171              	.LVL9:
 172 006e 08B1     		cbz	r0, .L7
 173              	.LBB6:
  77:Src/pwm.c     ****   {
  78:Src/pwm.c     ****     Error_Handler();
 174              		.loc 1 78 0
 175 0070 FFF7FEFF 		bl	Error_Handler
 176              	.LVL10:
 177              	.L7:
 178              	.LBE6:
  79:Src/pwm.c     ****   }
  80:Src/pwm.c     ****   if (HAL_TIM_OC_Init(&htim1) != HAL_OK)
 179              		.loc 1 80 0
 180 0074 4948     		ldr	r0, .L45
 181 0076 FFF7FEFF 		bl	HAL_TIM_OC_Init
 182              	.LVL11:
 183 007a 08B1     		cbz	r0, .L8
 184              	.LBB7:
  81:Src/pwm.c     ****   {
  82:Src/pwm.c     ****     Error_Handler();
 185              		.loc 1 82 0
 186 007c FFF7FEFF 		bl	Error_Handler
 187              	.LVL12:
 188              	.L8:
 189              	.LBE7:
  83:Src/pwm.c     ****   }
  84:Src/pwm.c     ****   sMasterConfig.MasterOutputTrigger = TIM_TRGO_OC4REF;//TIM_TRGO_OC4REF;
  85:Src/pwm.c     ****   sMasterConfig.MasterOutputTrigger2 = TIM_TRGO2_RESET;
 190              		.loc 1 85 0
 191 0080 7020     		movs	r0, #112
 192 0082 0023     		movs	r3, #0
 193 0084 CDE90103 		strd	r0, r3, [sp, #4]
  86:Src/pwm.c     ****   sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 6


  87:Src/pwm.c     ****   if (HAL_TIMEx_MasterConfigSynchronization(&htim1, &sMasterConfig) != HAL_OK)
 194              		.loc 1 87 0
 195 0088 01A9     		add	r1, sp, #4
 196 008a 4448     		ldr	r0, .L45
  86:Src/pwm.c     ****   sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
 197              		.loc 1 86 0
 198 008c 0393     		str	r3, [sp, #12]
 199              		.loc 1 87 0
 200 008e FFF7FEFF 		bl	HAL_TIMEx_MasterConfigSynchronization
 201              	.LVL13:
 202 0092 08B1     		cbz	r0, .L9
 203              	.LBB8:
  88:Src/pwm.c     ****   {
  89:Src/pwm.c     ****     Error_Handler();
 204              		.loc 1 89 0
 205 0094 FFF7FEFF 		bl	Error_Handler
 206              	.LVL14:
 207              	.L9:
 208              	.LBE8:
  90:Src/pwm.c     ****   }
  91:Src/pwm.c     ****   sConfigOC.OCMode = TIM_OCMODE_PWM1;
 209              		.loc 1 91 0
 210 0098 6023     		movs	r3, #96
  92:Src/pwm.c     ****   sConfigOC.Pulse = (TIM1->ARR)>>1;
 211              		.loc 1 92 0
 212 009a 414D     		ldr	r5, .L45+4
  91:Src/pwm.c     ****   sConfigOC.Pulse = (TIM1->ARR)>>1;
 213              		.loc 1 91 0
 214 009c 0893     		str	r3, [sp, #32]
 215              		.loc 1 92 0
 216 009e EB6A     		ldr	r3, [r5, #44]
  93:Src/pwm.c     ****   sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
  94:Src/pwm.c     ****   sConfigOC.OCNPolarity = TIM_OCNPOLARITY_HIGH;
  95:Src/pwm.c     ****   sConfigOC.OCFastMode = TIM_OCFAST_ENABLE;
  96:Src/pwm.c     ****   sConfigOC.OCIdleState = TIM_OCIDLESTATE_RESET;
  97:Src/pwm.c     ****   sConfigOC.OCNIdleState = TIM_OCNIDLESTATE_RESET;
  98:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_1) != HAL_OK)
 217              		.loc 1 98 0
 218 00a0 3E48     		ldr	r0, .L45
  92:Src/pwm.c     ****   sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
 219              		.loc 1 92 0
 220 00a2 5B08     		lsrs	r3, r3, #1
  93:Src/pwm.c     ****   sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
 221              		.loc 1 93 0
 222 00a4 0022     		movs	r2, #0
  92:Src/pwm.c     ****   sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
 223              		.loc 1 92 0
 224 00a6 0993     		str	r3, [sp, #36]
 225              		.loc 1 98 0
 226 00a8 08A9     		add	r1, sp, #32
  95:Src/pwm.c     ****   sConfigOC.OCIdleState = TIM_OCIDLESTATE_RESET;
 227              		.loc 1 95 0
 228 00aa 0423     		movs	r3, #4
  94:Src/pwm.c     ****   sConfigOC.OCFastMode = TIM_OCFAST_ENABLE;
 229              		.loc 1 94 0
 230 00ac CDE90A22 		strd	r2, r2, [sp, #40]
  96:Src/pwm.c     ****   sConfigOC.OCNIdleState = TIM_OCNIDLESTATE_RESET;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 7


 231              		.loc 1 96 0
 232 00b0 CDE90C32 		strd	r3, r2, [sp, #48]
  97:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_1) != HAL_OK)
 233              		.loc 1 97 0
 234 00b4 0E92     		str	r2, [sp, #56]
 235              		.loc 1 98 0
 236 00b6 FFF7FEFF 		bl	HAL_TIM_PWM_ConfigChannel
 237              	.LVL15:
 238 00ba 08B1     		cbz	r0, .L10
 239              	.LBB9:
  99:Src/pwm.c     ****   {
 100:Src/pwm.c     ****     Error_Handler();
 240              		.loc 1 100 0
 241 00bc FFF7FEFF 		bl	Error_Handler
 242              	.LVL16:
 243              	.L10:
 244              	.LBE9:
 101:Src/pwm.c     ****   }
 102:Src/pwm.c     **** 	sConfigOC.Pulse = (TIM1->ARR)>>2;
 245              		.loc 1 102 0
 246 00c0 EB6A     		ldr	r3, [r5, #44]
 103:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_2) != HAL_OK)
 247              		.loc 1 103 0
 248 00c2 3648     		ldr	r0, .L45
 102:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_2) != HAL_OK)
 249              		.loc 1 102 0
 250 00c4 9B08     		lsrs	r3, r3, #2
 251              		.loc 1 103 0
 252 00c6 0422     		movs	r2, #4
 253 00c8 08A9     		add	r1, sp, #32
 102:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_2) != HAL_OK)
 254              		.loc 1 102 0
 255 00ca 0993     		str	r3, [sp, #36]
 256              		.loc 1 103 0
 257 00cc FFF7FEFF 		bl	HAL_TIM_PWM_ConfigChannel
 258              	.LVL17:
 259 00d0 08B1     		cbz	r0, .L11
 260              	.LBB10:
 104:Src/pwm.c     ****   {
 105:Src/pwm.c     ****     Error_Handler();
 261              		.loc 1 105 0
 262 00d2 FFF7FEFF 		bl	Error_Handler
 263              	.LVL18:
 264              	.L11:
 265              	.LBE10:
 106:Src/pwm.c     ****   }
 107:Src/pwm.c     **** 	sConfigOC.Pulse = (TIM1->ARR)>>1;
 266              		.loc 1 107 0
 267 00d6 324B     		ldr	r3, .L45+4
 108:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
 268              		.loc 1 108 0
 269 00d8 3048     		ldr	r0, .L45
 107:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
 270              		.loc 1 107 0
 271 00da DB6A     		ldr	r3, [r3, #44]
 272              		.loc 1 108 0
 273 00dc 0822     		movs	r2, #8
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 8


 107:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
 274              		.loc 1 107 0
 275 00de 5B08     		lsrs	r3, r3, #1
 276              		.loc 1 108 0
 277 00e0 08A9     		add	r1, sp, #32
 107:Src/pwm.c     ****   if (HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
 278              		.loc 1 107 0
 279 00e2 0993     		str	r3, [sp, #36]
 280              		.loc 1 108 0
 281 00e4 FFF7FEFF 		bl	HAL_TIM_PWM_ConfigChannel
 282              	.LVL19:
 283 00e8 08B1     		cbz	r0, .L12
 284              	.LBB11:
 109:Src/pwm.c     ****   {
 110:Src/pwm.c     ****     Error_Handler();
 285              		.loc 1 110 0
 286 00ea FFF7FEFF 		bl	Error_Handler
 287              	.LVL20:
 288              	.L12:
 289              	.LBE11:
 111:Src/pwm.c     ****   }
 112:Src/pwm.c     ****   sConfigOC.OCMode = TIM_OCMODE_PWM2;
 113:Src/pwm.c     **** 	sConfigOC.Pulse = REAL_CCR-1;
 290              		.loc 1 113 0
 291 00ee 7021     		movs	r1, #112
 292 00f0 40F61F53 		movw	r3, #3359
 293 00f4 CDE90813 		strd	r1, r3, [sp, #32]
 114:Src/pwm.c     ****   if (HAL_TIM_OC_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_4) != HAL_OK)
 294              		.loc 1 114 0
 295 00f8 0C22     		movs	r2, #12
 296 00fa 08A9     		add	r1, sp, #32
 297 00fc 2748     		ldr	r0, .L45
 298 00fe FFF7FEFF 		bl	HAL_TIM_OC_ConfigChannel
 299              	.LVL21:
 300 0102 08B1     		cbz	r0, .L13
 301              	.LBB12:
 115:Src/pwm.c     ****   {
 116:Src/pwm.c     ****     Error_Handler();
 302              		.loc 1 116 0
 303 0104 FFF7FEFF 		bl	Error_Handler
 304              	.LVL22:
 305              	.L13:
 306              	.LBE12:
 117:Src/pwm.c     ****   }
 118:Src/pwm.c     ****   sBreakDeadTimeConfig.OffStateRunMode = TIM_OSSR_ENABLE;
 119:Src/pwm.c     ****   sBreakDeadTimeConfig.OffStateIDLEMode = TIM_OSSI_DISABLE;
 307              		.loc 1 119 0
 308 0108 0023     		movs	r3, #0
 309 010a 4FF40062 		mov	r2, #2048
 310 010e CDE90F23 		strd	r2, r3, [sp, #60]
 120:Src/pwm.c     ****   sBreakDeadTimeConfig.LockLevel = TIM_LOCKLEVEL_OFF;
 121:Src/pwm.c     ****   sBreakDeadTimeConfig.DeadTime = 20;
 311              		.loc 1 121 0
 312 0112 1422     		movs	r2, #20
 122:Src/pwm.c     ****   sBreakDeadTimeConfig.BreakState = TIM_BREAK_DISABLE;
 313              		.loc 1 122 0
 314 0114 CDE91223 		strd	r2, r3, [sp, #72]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 9


 123:Src/pwm.c     ****   sBreakDeadTimeConfig.BreakPolarity = TIM_BREAKPOLARITY_HIGH;
 315              		.loc 1 123 0
 316 0118 4FF40052 		mov	r2, #8192
 124:Src/pwm.c     ****   sBreakDeadTimeConfig.BreakFilter = 0;
 317              		.loc 1 124 0
 318 011c CDE91423 		strd	r2, r3, [sp, #80]
 125:Src/pwm.c     ****   sBreakDeadTimeConfig.BreakAFMode = TIM_BREAK_AFMODE_INPUT;
 126:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2State = TIM_BREAK2_DISABLE;
 127:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2Polarity = TIM_BREAK2POLARITY_HIGH;
 128:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2Filter = 0;
 129:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2AFMode = TIM_BREAK_AFMODE_INPUT;
 130:Src/pwm.c     ****   sBreakDeadTimeConfig.AutomaticOutput = TIM_AUTOMATICOUTPUT_DISABLE;
 131:Src/pwm.c     **** 	
 132:Src/pwm.c     ****   if (HAL_TIMEx_ConfigBreakDeadTime(&htim1, &sBreakDeadTimeConfig) != HAL_OK)
 319              		.loc 1 132 0
 320 0120 0FA9     		add	r1, sp, #60
 127:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2Filter = 0;
 321              		.loc 1 127 0
 322 0122 4FF00072 		mov	r2, #33554432
 323              		.loc 1 132 0
 324 0126 1D48     		ldr	r0, .L45
 120:Src/pwm.c     ****   sBreakDeadTimeConfig.DeadTime = 20;
 325              		.loc 1 120 0
 326 0128 1193     		str	r3, [sp, #68]
 126:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2Polarity = TIM_BREAK2POLARITY_HIGH;
 327              		.loc 1 126 0
 328 012a CDE91633 		strd	r3, r3, [sp, #88]
 128:Src/pwm.c     ****   sBreakDeadTimeConfig.Break2AFMode = TIM_BREAK_AFMODE_INPUT;
 329              		.loc 1 128 0
 330 012e CDE91823 		strd	r2, r3, [sp, #96]
 130:Src/pwm.c     **** 	
 331              		.loc 1 130 0
 332 0132 CDE91A33 		strd	r3, r3, [sp, #104]
 333              		.loc 1 132 0
 334 0136 FFF7FEFF 		bl	HAL_TIMEx_ConfigBreakDeadTime
 335              	.LVL23:
 336 013a 08B1     		cbz	r0, .L14
 337              	.LBB13:
 133:Src/pwm.c     ****   {
 134:Src/pwm.c     ****     Error_Handler();
 338              		.loc 1 134 0
 339 013c FFF7FEFF 		bl	Error_Handler
 340              	.LVL24:
 341              	.L14:
 342              	.LBE13:
 135:Src/pwm.c     ****   }
 136:Src/pwm.c     ****   /* USER CODE BEGIN TIM1_Init 2 */
 137:Src/pwm.c     **** 
 138:Src/pwm.c     ****   /* USER CODE END TIM1_Init 2 */
 139:Src/pwm.c     ****   HAL_TIM_MspPostInit(&htim1);
 343              		.loc 1 139 0
 344 0140 1648     		ldr	r0, .L45
 345 0142 FFF7FEFF 		bl	HAL_TIM_MspPostInit
 346              	.LVL25:
 140:Src/pwm.c     **** 	
 141:Src/pwm.c     **** 	
 142:Src/pwm.c     **** //	HAL_TIMEx_OCN_Start(&htim1,TIM_CHANNEL_1);
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 10


 143:Src/pwm.c     **** //	HAL_TIMEx_OCN_Start(&htim1,TIM_CHANNEL_2);
 144:Src/pwm.c     **** //	HAL_TIMEx_OCN_Start(&htim1,TIM_CHANNEL_3);
 145:Src/pwm.c     **** //	HAL_TIMEx_OCN_Start(&htim1,TIM_CHANNEL_4);
 146:Src/pwm.c     **** 	
 147:Src/pwm.c     **** 	
 148:Src/pwm.c     **** 	HAL_TIM_PWM_Start(&htim1,TIM_CHANNEL_1);
 347              		.loc 1 148 0
 348 0146 0021     		movs	r1, #0
 349 0148 1448     		ldr	r0, .L45
 350 014a FFF7FEFF 		bl	HAL_TIM_PWM_Start
 351              	.LVL26:
 149:Src/pwm.c     **** 	HAL_TIM_PWM_Start(&htim1,TIM_CHANNEL_2);
 352              		.loc 1 149 0
 353 014e 0421     		movs	r1, #4
 354 0150 1248     		ldr	r0, .L45
 355 0152 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 356              	.LVL27:
 150:Src/pwm.c     **** 	HAL_TIM_PWM_Start(&htim1,TIM_CHANNEL_3);
 357              		.loc 1 150 0
 358 0156 0821     		movs	r1, #8
 359 0158 1048     		ldr	r0, .L45
 360 015a FFF7FEFF 		bl	HAL_TIM_PWM_Start
 361              	.LVL28:
 151:Src/pwm.c     **** 	HAL_TIM_PWM_Start(&htim1,TIM_CHANNEL_4);
 362              		.loc 1 151 0
 363 015e 0C21     		movs	r1, #12
 364 0160 0E48     		ldr	r0, .L45
 365 0162 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 366              	.LVL29:
 152:Src/pwm.c     **** 	
 153:Src/pwm.c     **** 	HAL_TIMEx_PWMN_Start(&htim1,TIM_CHANNEL_1);
 367              		.loc 1 153 0
 368 0166 0021     		movs	r1, #0
 369 0168 0C48     		ldr	r0, .L45
 370 016a FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 371              	.LVL30:
 154:Src/pwm.c     **** 	HAL_TIMEx_PWMN_Start(&htim1,TIM_CHANNEL_2);
 372              		.loc 1 154 0
 373 016e 0421     		movs	r1, #4
 374 0170 0A48     		ldr	r0, .L45
 375 0172 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 376              	.LVL31:
 155:Src/pwm.c     **** 	HAL_TIMEx_PWMN_Start(&htim1,TIM_CHANNEL_3);
 377              		.loc 1 155 0
 378 0176 0821     		movs	r1, #8
 379 0178 0848     		ldr	r0, .L45
 380 017a FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 381              	.LVL32:
 156:Src/pwm.c     **** 	HAL_TIMEx_PWMN_Start(&htim1,TIM_CHANNEL_4);
 382              		.loc 1 156 0
 383 017e 0C21     		movs	r1, #12
 384 0180 0648     		ldr	r0, .L45
 385 0182 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 386              	.LVL33:
 157:Src/pwm.c     **** 	
 158:Src/pwm.c     **** 	__HAL_TIM_ENABLE(&htim1);
 387              		.loc 1 158 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 11


 388 0186 2268     		ldr	r2, [r4]
 159:Src/pwm.c     **** 	
 160:Src/pwm.c     **** 	HAL_ADCEx_InjectedStart_IT(&hadc1);
 389              		.loc 1 160 0
 390 0188 0648     		ldr	r0, .L45+8
 158:Src/pwm.c     **** 	
 391              		.loc 1 158 0
 392 018a 1368     		ldr	r3, [r2]
 393 018c 43F00103 		orr	r3, r3, #1
 394 0190 1360     		str	r3, [r2]
 395              		.loc 1 160 0
 396 0192 FFF7FEFF 		bl	HAL_ADCEx_InjectedStart_IT
 397              	.LVL34:
 161:Src/pwm.c     **** }
 398              		.loc 1 161 0
 399 0196 1DB0     		add	sp, sp, #116
 400              	.LCFI4:
 401              		.cfi_def_cfa_offset 12
 402              		@ sp needed
 403 0198 30BD     		pop	{r4, r5, pc}
 404              	.L46:
 405 019a 00BF     		.align	2
 406              	.L45:
 407 019c 00000000 		.word	htim1
 408 01a0 002C0140 		.word	1073818624
 409 01a4 00000000 		.word	hadc1
 410              		.cfi_endproc
 411              	.LFE334:
 413              		.section	.text.PWM_Init,"ax",%progbits
 414              		.align	1
 415              		.global	PWM_Init
 416              		.syntax unified
 417              		.thumb
 418              		.thumb_func
 419              		.fpu fpv4-sp-d16
 421              	PWM_Init:
 422              	.LFB335:
 162:Src/pwm.c     **** 
 163:Src/pwm.c     **** 
 164:Src/pwm.c     **** 
 165:Src/pwm.c     **** 
 166:Src/pwm.c     **** 
 167:Src/pwm.c     **** void PWM_Init(void)
 168:Src/pwm.c     **** {
 423              		.loc 1 168 0
 424              		.cfi_startproc
 425              		@ args = 0, pretend = 0, frame = 0
 426              		@ frame_needed = 0, uses_anonymous_args = 0
 427 0000 08B5     		push	{r3, lr}
 428              	.LCFI5:
 429              		.cfi_def_cfa_offset 8
 430              		.cfi_offset 3, -8
 431              		.cfi_offset 14, -4
 169:Src/pwm.c     **** 	
 170:Src/pwm.c     **** 	SWI_EXTI_Config();                                       //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ð¶Ï£ï¿½Ö´ï¿½ï¿½Î»ï
 432              		.loc 1 170 0
 433 0002 FFF7FEFF 		bl	SWI_EXTI_Config
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 12


 434              	.LVL35:
 171:Src/pwm.c     **** 	MX_TIM1_Init();
 172:Src/pwm.c     **** }
 435              		.loc 1 172 0
 436 0006 BDE80840 		pop	{r3, lr}
 437              	.LCFI6:
 438              		.cfi_restore 14
 439              		.cfi_restore 3
 440              		.cfi_def_cfa_offset 0
 171:Src/pwm.c     **** 	MX_TIM1_Init();
 441              		.loc 1 171 0
 442 000a FFF7FEBF 		b	MX_TIM1_Init
 443              	.LVL36:
 444              		.cfi_endproc
 445              	.LFE335:
 447              		.section	.text.PWM_Disable,"ax",%progbits
 448              		.align	1
 449              		.global	PWM_Disable
 450              		.syntax unified
 451              		.thumb
 452              		.thumb_func
 453              		.fpu fpv4-sp-d16
 455              	PWM_Disable:
 456              	.LFB337:
 173:Src/pwm.c     **** void PWM_Enable(void)
 174:Src/pwm.c     **** {
 175:Src/pwm.c     **** 	MP6540_ON();
 176:Src/pwm.c     ****   g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 177:Src/pwm.c     ****   g_bEnableHB = 1;
 178:Src/pwm.c     ****   TIM1->BDTR|=(TIM_BDTR_MOE);
 179:Src/pwm.c     ****   PWM_OutPut_Open(TIM1,g_ElectricAngle,0);
 180:Src/pwm.c     **** }
 181:Src/pwm.c     **** void PWM_Disable(void)
 182:Src/pwm.c     **** {
 457              		.loc 1 182 0
 458              		.cfi_startproc
 459              		@ args = 0, pretend = 0, frame = 0
 460              		@ frame_needed = 0, uses_anonymous_args = 0
 461              		@ link register save eliminated.
 183:Src/pwm.c     **** 	MP6540_OFF();
 462              		.loc 1 183 0
 463 0000 0B4A     		ldr	r2, .L49
 464 0002 5369     		ldr	r3, [r2, #20]
 465 0004 23F48053 		bic	r3, r3, #4096
 466 0008 5361     		str	r3, [r2, #20]
 184:Src/pwm.c     ****   g_CmdMap[TAG_MOTOR_ENABLE] = 0;
 467              		.loc 1 184 0
 468 000a 0A4B     		ldr	r3, .L49+4
 469 000c 0022     		movs	r2, #0
 470 000e A3F80222 		strh	r2, [r3, #514]	@ movhi
 185:Src/pwm.c     ****   g_bEnableHB = 0;
 471              		.loc 1 185 0
 472 0012 094B     		ldr	r3, .L49+8
 473 0014 1A80     		strh	r2, [r3]	@ movhi
 186:Src/pwm.c     **** 	
 187:Src/pwm.c     **** 		TIM1->CCR3 = 0;
 474              		.loc 1 187 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 13


 475 0016 094B     		ldr	r3, .L49+12
 476 0018 DA63     		str	r2, [r3, #60]
 188:Src/pwm.c     ****   TIM1->CCR2 = 0;
 477              		.loc 1 188 0
 478 001a 9A63     		str	r2, [r3, #56]
 189:Src/pwm.c     ****   TIM1->CCR1 = 0;
 479              		.loc 1 189 0
 480 001c 5A63     		str	r2, [r3, #52]
 190:Src/pwm.c     ****   TIM1->CCER = (u16)5000;
 481              		.loc 1 190 0
 482 001e 41F28832 		movw	r2, #5000
 483 0022 1A62     		str	r2, [r3, #32]
 191:Src/pwm.c     ****   TIM1->BDTR &= ~(TIM_BDTR_MOE);
 484              		.loc 1 191 0
 485 0024 5A6C     		ldr	r2, [r3, #68]
 486 0026 22F40042 		bic	r2, r2, #32768
 487 002a 5A64     		str	r2, [r3, #68]
 192:Src/pwm.c     **** }
 488              		.loc 1 192 0
 489 002c 7047     		bx	lr
 490              	.L50:
 491 002e 00BF     		.align	2
 492              	.L49:
 493 0030 00040048 		.word	1207960576
 494 0034 00000000 		.word	g_CmdMap
 495 0038 00000000 		.word	g_bEnableHB
 496 003c 002C0140 		.word	1073818624
 497              		.cfi_endproc
 498              	.LFE337:
 500              		.section	.text.Calculate_CCR,"ax",%progbits
 501              		.align	1
 502              		.global	Calculate_CCR
 503              		.syntax unified
 504              		.thumb
 505              		.thumb_func
 506              		.fpu fpv4-sp-d16
 508              	Calculate_CCR:
 509              	.LFB338:
 193:Src/pwm.c     **** 
 194:Src/pwm.c     **** 
 195:Src/pwm.c     **** 
 196:Src/pwm.c     **** 
 197:Src/pwm.c     **** 
 198:Src/pwm.c     **** 
 199:Src/pwm.c     **** 
 200:Src/pwm.c     **** 
 201:Src/pwm.c     **** 
 202:Src/pwm.c     **** 
 203:Src/pwm.c     **** 
 204:Src/pwm.c     **** 	int hall_value = 1;
 205:Src/pwm.c     **** 	int cnt = 0;
 206:Src/pwm.c     **** 
 207:Src/pwm.c     **** volatile int hall_a;
 208:Src/pwm.c     **** volatile int hall_b;
 209:Src/pwm.c     **** volatile int hall_c;
 210:Src/pwm.c     **** volatile  int hall_ture_value = 5;
 211:Src/pwm.c     **** volatile  int last_hall_ture_value = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 14


 212:Src/pwm.c     **** volatile  int tmp_hall_ture_value =0;
 213:Src/pwm.c     **** /**********
 214:Src/pwm.c     **** * hall_ture_value
 215:Src/pwm.c     **** * hall_ture_value = 5     B 
 216:Src/pwm.c     **** * hall_ture_value = 1     C 
 217:Src/pwm.c     ****  hall_ture_value = 3     C 
 218:Src/pwm.c     ****  hall_ture_value = 2     A 
 219:Src/pwm.c     ****  hall_ture_value = 6     A 
 220:Src/pwm.c     ****  hall_ture_value = 4     B 
 221:Src/pwm.c     **** 
 222:Src/pwm.c     **** *********/
 223:Src/pwm.c     **** volatile int G_hall_ture_value=0;
 224:Src/pwm.c     **** void Calculate_CCR(TIM_TypeDef* TIMx, s32 angle, s32 targetCCR)	  // Ä¿ï¿½ï¿½CCR 0~MAX_CCRï¿½ï¿½Ó¦0
 225:Src/pwm.c     **** {
 510              		.loc 1 225 0
 511              		.cfi_startproc
 512              		@ args = 0, pretend = 0, frame = 0
 513              		@ frame_needed = 0, uses_anonymous_args = 0
 514              	.LVL37:
 515 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 516              	.LCFI7:
 517              		.cfi_def_cfa_offset 24
 518              		.cfi_offset 4, -24
 519              		.cfi_offset 5, -20
 520              		.cfi_offset 6, -16
 521              		.cfi_offset 7, -12
 522              		.cfi_offset 8, -8
 523              		.cfi_offset 14, -4
 226:Src/pwm.c     **** 	static int p_cnt = 0;
 227:Src/pwm.c     **** 
 228:Src/pwm.c     ****   s32 t0, tk, tk_1;
 229:Src/pwm.c     ****   s32 CCR1 = 0;
 230:Src/pwm.c     ****   s32 CCR2 = 0;
 231:Src/pwm.c     ****   s32 CCR3 = 0;
 232:Src/pwm.c     **** 	
 233:Src/pwm.c     **** 	
 234:Src/pwm.c     **** 
 235:Src/pwm.c     **** 	
 236:Src/pwm.c     **** 	
 237:Src/pwm.c     ****   angle = angle<0?0:(angle<EN_360?angle:(EN_360-1));
 524              		.loc 1 237 0
 525 0004 0D1E     		subs	r5, r1, #0
 225:Src/pwm.c     **** 	static int p_cnt = 0;
 526              		.loc 1 225 0
 527 0006 0646     		mov	r6, r0
 528 0008 744B     		ldr	r3, .L69
 529              		.loc 1 237 0
 530 000a C0F2DE80 		blt	.L63
 531              		.loc 1 237 0 is_stmt 0 discriminator 1
 532 000e 7449     		ldr	r1, .L69+4
 533              	.LVL38:
 534 0010 B1F90010 		ldrsh	r1, [r1]
 535 0014 A942     		cmp	r1, r5
 536 0016 00F3D980 		bgt	.L52
 238:Src/pwm.c     ****   targetCCR = targetCCR>MAX_CCR?MAX_CCR:(targetCCR<0?0:targetCCR);
 537              		.loc 1 238 0 is_stmt 1 discriminator 3
 538 001a B2F53D6F 		cmp	r2, #3024
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 15


 237:Src/pwm.c     ****   targetCCR = targetCCR>MAX_CCR?MAX_CCR:(targetCCR<0?0:targetCCR);
 539              		.loc 1 237 0 discriminator 3
 540 001e 01F1FF35 		add	r5, r1, #-1
 541              	.LVL39:
 542              		.loc 1 238 0 discriminator 3
 543 0022 28DC     		bgt	.L64
 544              	.L61:
 545              		.loc 1 238 0 is_stmt 0 discriminator 1
 546 0024 22EAE274 		bic	r4, r2, r2, asr #31
 547              	.L53:
 548              	.LVL40:
 239:Src/pwm.c     **** 	
 240:Src/pwm.c     **** 	
 241:Src/pwm.c     ****   if (angle >= 0 && angle < EN_60)
 549              		.loc 1 241 0 is_stmt 1 discriminator 4
 550 0028 002D     		cmp	r5, #0
 551 002a 27DB     		blt	.L54
 552              	.LVL41:
 553              	.L62:
 554              		.loc 1 241 0 is_stmt 0 discriminator 1
 555 002c B3F90000 		ldrsh	r0, [r3]
 556              	.LVL42:
 557 0030 A842     		cmp	r0, r5
 558 0032 23DD     		ble	.L54
 242:Src/pwm.c     ****   {
 243:Src/pwm.c     **** //    tk = ( Math_Sin_EN360(EN_60-angle) * targetCCR ) >> 15;
 244:Src/pwm.c     **** //    tk_1 = ( Math_Sin_EN360(angle) * targetCCR ) >> 15;
 245:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 559              		.loc 1 245 0 is_stmt 1
 560 0034 ADB2     		uxth	r5, r5
 561              	.LVL43:
 562 0036 401B     		subs	r0, r0, r5
 563 0038 80B2     		uxth	r0, r0
 564 003a FFF7FEFF 		bl	Math_Sin_EN360
 565              	.LVL44:
 566 003e 2146     		mov	r1, r4
 567 0040 FFF7FEFF 		bl	Q15_MUL
 568              	.LVL45:
 569 0044 8046     		mov	r8, r0
 570              	.LVL46:
 246:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 571              		.loc 1 246 0
 572 0046 2846     		mov	r0, r5
 573              	.LVL47:
 574 0048 FFF7FEFF 		bl	Math_Sin_EN360
 575              	.LVL48:
 576 004c 2146     		mov	r1, r4
 577 004e FFF7FEFF 		bl	Q15_MUL
 578              	.LVL49:
 247:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 579              		.loc 1 247 0
 580 0052 C8F53D63 		rsb	r3, r8, #3024
 581 0056 1B1A     		subs	r3, r3, r0
 248:Src/pwm.c     ****     CCR3 = t0>>1;
 582              		.loc 1 248 0
 583 0058 5B10     		asrs	r3, r3, #1
 584              	.LVL50:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 16


 249:Src/pwm.c     ****     CCR2 = CCR3 + tk_1;
 585              		.loc 1 249 0
 586 005a C118     		adds	r1, r0, r3
 587              	.LVL51:
 250:Src/pwm.c     ****     CCR1 = CCR2 + tk;
 251:Src/pwm.c     **** 		g_Sector_test = 1;
 588              		.loc 1 251 0
 589 005c 6148     		ldr	r0, .L69+8
 590              	.LVL52:
 250:Src/pwm.c     ****     CCR1 = CCR2 + tk;
 591              		.loc 1 250 0
 592 005e 08EB0102 		add	r2, r8, r1
 593              	.LVL53:
 594              		.loc 1 251 0
 595 0062 0124     		movs	r4, #1
 596              	.LVL54:
 597              	.L68:
 252:Src/pwm.c     ****   }
 253:Src/pwm.c     ****   else if (angle >= EN_60 && angle < EN_120)
 254:Src/pwm.c     ****   {
 255:Src/pwm.c     ****     angle -= EN_60;
 256:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 257:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 258:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 259:Src/pwm.c     ****     CCR3 = t0>>1;
 260:Src/pwm.c     ****     CCR1 = CCR3 + tk;
 261:Src/pwm.c     ****     CCR2 = CCR1 + tk_1;
 262:Src/pwm.c     **** 		g_Sector_test = 2;
 263:Src/pwm.c     ****   }
 264:Src/pwm.c     ****   else if (angle >= EN_120 && angle < EN_180)
 265:Src/pwm.c     ****   {
 266:Src/pwm.c     ****     angle -= EN_120;
 267:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 268:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 269:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 270:Src/pwm.c     ****     CCR1 = t0>>1;
 271:Src/pwm.c     ****     CCR3 = CCR1 + tk_1;
 272:Src/pwm.c     ****     CCR2 = CCR3 + tk;
 273:Src/pwm.c     **** 		g_Sector_test = 3;
 274:Src/pwm.c     ****   }
 275:Src/pwm.c     ****   else if (angle >= EN_180 && angle < EN_240)
 276:Src/pwm.c     ****   {
 277:Src/pwm.c     ****     angle -= EN_180;
 278:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 279:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 280:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 281:Src/pwm.c     ****     CCR1 = t0>>1;
 282:Src/pwm.c     ****     CCR2 = CCR1 + tk;
 283:Src/pwm.c     ****     CCR3 = CCR2 + tk_1;
 284:Src/pwm.c     **** 		g_Sector_test = 4;
 285:Src/pwm.c     ****   }
 286:Src/pwm.c     ****   else if (angle >= EN_240 && angle < EN_300)
 287:Src/pwm.c     ****   {
 288:Src/pwm.c     ****     angle -= EN_240;
 289:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 290:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 291:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 17


 292:Src/pwm.c     ****     CCR2 = t0>>1;
 293:Src/pwm.c     ****     CCR1 = CCR2 + tk_1;
 294:Src/pwm.c     ****     CCR3 = CCR1 + tk;
 295:Src/pwm.c     **** 		g_Sector_test = 5;
 296:Src/pwm.c     **** 
 297:Src/pwm.c     ****   }
 298:Src/pwm.c     ****   else if (angle >= EN_300 && angle < EN_360)
 299:Src/pwm.c     ****   {
 300:Src/pwm.c     ****     angle -= EN_300;
 301:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 302:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 303:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 304:Src/pwm.c     ****     CCR2 = t0>>1;
 305:Src/pwm.c     ****     CCR3 = CCR2 + tk;
 306:Src/pwm.c     ****     CCR1 = CCR3 + tk_1;
 307:Src/pwm.c     **** 		g_Sector_test = 6;
 598              		.loc 1 307 0
 599 0064 0480     		strh	r4, [r0]	@ movhi
 600              	.LVL55:
 601              	.L55:
 308:Src/pwm.c     ****   }
 309:Src/pwm.c     ****   TIMx->CCR3 = CCR3;
 602              		.loc 1 309 0
 603 0066 F363     		str	r3, [r6, #60]
 310:Src/pwm.c     ****   TIMx->CCR2 = CCR2;
 311:Src/pwm.c     ****   TIMx->CCR1 = CCR1;
 312:Src/pwm.c     ****   //TIMx->CCER = (u16)0x5555;
 313:Src/pwm.c     **** 	TIMx->CCER = (u16)PWM_OUTPUT_REG;
 604              		.loc 1 313 0
 605 0068 45F25553 		movw	r3, #21845
 606              	.LVL56:
 310:Src/pwm.c     ****   TIMx->CCR2 = CCR2;
 607              		.loc 1 310 0
 608 006c B163     		str	r1, [r6, #56]
 609              	.LVL57:
 311:Src/pwm.c     ****   //TIMx->CCER = (u16)0x5555;
 610              		.loc 1 311 0
 611 006e 7263     		str	r2, [r6, #52]
 612              		.loc 1 313 0
 613 0070 3362     		str	r3, [r6, #32]
 314:Src/pwm.c     **** 	
 315:Src/pwm.c     **** 	
 316:Src/pwm.c     **** }
 614              		.loc 1 316 0
 615 0072 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 616              	.LVL58:
 617              	.L64:
 238:Src/pwm.c     **** 	
 618              		.loc 1 238 0
 619 0076 4FF43D64 		mov	r4, #3024
 620 007a D5E7     		b	.L53
 621              	.LVL59:
 622              	.L54:
 253:Src/pwm.c     ****   {
 623              		.loc 1 253 0
 624 007c B3F90000 		ldrsh	r0, [r3]
 625 0080 594B     		ldr	r3, .L69+12
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 18


 626 0082 A842     		cmp	r0, r5
 627 0084 B3F900C0 		ldrsh	ip, [r3]
 628 0088 1ADC     		bgt	.L56
 253:Src/pwm.c     ****   {
 629              		.loc 1 253 0 is_stmt 0 discriminator 1
 630 008a AC45     		cmp	ip, r5
 631 008c 18DD     		ble	.L56
 632              	.LVL60:
 255:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 633              		.loc 1 255 0 is_stmt 1
 634 008e 2D1A     		subs	r5, r5, r0
 635              	.LVL61:
 256:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 636              		.loc 1 256 0
 637 0090 ADB2     		uxth	r5, r5
 638              	.LVL62:
 639 0092 401B     		subs	r0, r0, r5
 640 0094 80B2     		uxth	r0, r0
 641 0096 FFF7FEFF 		bl	Math_Sin_EN360
 642              	.LVL63:
 643 009a 2146     		mov	r1, r4
 644 009c FFF7FEFF 		bl	Q15_MUL
 645              	.LVL64:
 646 00a0 0746     		mov	r7, r0
 647              	.LVL65:
 257:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 648              		.loc 1 257 0
 649 00a2 2846     		mov	r0, r5
 650              	.LVL66:
 651 00a4 FFF7FEFF 		bl	Math_Sin_EN360
 652              	.LVL67:
 653 00a8 2146     		mov	r1, r4
 654 00aa FFF7FEFF 		bl	Q15_MUL
 655              	.LVL68:
 258:Src/pwm.c     ****     CCR3 = t0>>1;
 656              		.loc 1 258 0
 657 00ae C7F53D63 		rsb	r3, r7, #3024
 658 00b2 1B1A     		subs	r3, r3, r0
 259:Src/pwm.c     ****     CCR1 = CCR3 + tk;
 659              		.loc 1 259 0
 660 00b4 5B10     		asrs	r3, r3, #1
 661              	.LVL69:
 260:Src/pwm.c     ****     CCR2 = CCR1 + tk_1;
 662              		.loc 1 260 0
 663 00b6 FA18     		adds	r2, r7, r3
 664              	.LVL70:
 261:Src/pwm.c     **** 		g_Sector_test = 2;
 665              		.loc 1 261 0
 666 00b8 8118     		adds	r1, r0, r2
 667              	.LVL71:
 262:Src/pwm.c     ****   }
 668              		.loc 1 262 0
 669 00ba 0224     		movs	r4, #2
 670              	.LVL72:
 671 00bc 4948     		ldr	r0, .L69+8
 672              	.LVL73:
 673 00be D1E7     		b	.L68
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 19


 674              	.LVL74:
 675              	.L56:
 676 00c0 4A4B     		ldr	r3, .L69+16
 264:Src/pwm.c     ****   {
 677              		.loc 1 264 0
 678 00c2 AC45     		cmp	ip, r5
 679 00c4 B3F90070 		ldrsh	r7, [r3]
 680 00c8 1BDC     		bgt	.L57
 264:Src/pwm.c     ****   {
 681              		.loc 1 264 0 is_stmt 0 discriminator 1
 682 00ca AF42     		cmp	r7, r5
 683 00cc 19DD     		ble	.L57
 684              	.LVL75:
 266:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 685              		.loc 1 266 0 is_stmt 1
 686 00ce A5EB0C05 		sub	r5, r5, ip
 687              	.LVL76:
 267:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 688              		.loc 1 267 0
 689 00d2 ADB2     		uxth	r5, r5
 690              	.LVL77:
 691 00d4 401B     		subs	r0, r0, r5
 692 00d6 80B2     		uxth	r0, r0
 693 00d8 FFF7FEFF 		bl	Math_Sin_EN360
 694              	.LVL78:
 695 00dc 2146     		mov	r1, r4
 696 00de FFF7FEFF 		bl	Q15_MUL
 697              	.LVL79:
 698 00e2 0746     		mov	r7, r0
 699              	.LVL80:
 268:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 700              		.loc 1 268 0
 701 00e4 2846     		mov	r0, r5
 702              	.LVL81:
 703 00e6 FFF7FEFF 		bl	Math_Sin_EN360
 704              	.LVL82:
 705 00ea 2146     		mov	r1, r4
 706 00ec FFF7FEFF 		bl	Q15_MUL
 707              	.LVL83:
 269:Src/pwm.c     ****     CCR1 = t0>>1;
 708              		.loc 1 269 0
 709 00f0 C7F53D62 		rsb	r2, r7, #3024
 710 00f4 121A     		subs	r2, r2, r0
 270:Src/pwm.c     ****     CCR3 = CCR1 + tk_1;
 711              		.loc 1 270 0
 712 00f6 5210     		asrs	r2, r2, #1
 713              	.LVL84:
 271:Src/pwm.c     ****     CCR2 = CCR3 + tk;
 714              		.loc 1 271 0
 715 00f8 8318     		adds	r3, r0, r2
 716              	.LVL85:
 272:Src/pwm.c     **** 		g_Sector_test = 3;
 717              		.loc 1 272 0
 718 00fa F918     		adds	r1, r7, r3
 719              	.LVL86:
 273:Src/pwm.c     ****   }
 720              		.loc 1 273 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 20


 721 00fc 3948     		ldr	r0, .L69+8
 722              	.LVL87:
 723 00fe 0324     		movs	r4, #3
 724              	.LVL88:
 725 0100 B0E7     		b	.L68
 726              	.LVL89:
 727              	.L57:
 728 0102 3B4B     		ldr	r3, .L69+20
 275:Src/pwm.c     ****   {
 729              		.loc 1 275 0
 730 0104 AF42     		cmp	r7, r5
 731 0106 B3F90020 		ldrsh	r2, [r3]
 732 010a 1ADC     		bgt	.L58
 275:Src/pwm.c     ****   {
 733              		.loc 1 275 0 is_stmt 0 discriminator 1
 734 010c AA42     		cmp	r2, r5
 735 010e 18DD     		ble	.L58
 736              	.LVL90:
 277:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 737              		.loc 1 277 0 is_stmt 1
 738 0110 EF1B     		subs	r7, r5, r7
 739              	.LVL91:
 278:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 740              		.loc 1 278 0
 741 0112 BFB2     		uxth	r7, r7
 742              	.LVL92:
 743 0114 C01B     		subs	r0, r0, r7
 744 0116 80B2     		uxth	r0, r0
 745 0118 FFF7FEFF 		bl	Math_Sin_EN360
 746              	.LVL93:
 747 011c 2146     		mov	r1, r4
 748 011e FFF7FEFF 		bl	Q15_MUL
 749              	.LVL94:
 750 0122 0546     		mov	r5, r0
 751              	.LVL95:
 279:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 752              		.loc 1 279 0
 753 0124 3846     		mov	r0, r7
 754              	.LVL96:
 755 0126 FFF7FEFF 		bl	Math_Sin_EN360
 756              	.LVL97:
 757 012a 2146     		mov	r1, r4
 758 012c FFF7FEFF 		bl	Q15_MUL
 759              	.LVL98:
 280:Src/pwm.c     ****     CCR1 = t0>>1;
 760              		.loc 1 280 0
 761 0130 C5F53D62 		rsb	r2, r5, #3024
 762 0134 121A     		subs	r2, r2, r0
 281:Src/pwm.c     ****     CCR2 = CCR1 + tk;
 763              		.loc 1 281 0
 764 0136 5210     		asrs	r2, r2, #1
 765              	.LVL99:
 282:Src/pwm.c     ****     CCR3 = CCR2 + tk_1;
 766              		.loc 1 282 0
 767 0138 A918     		adds	r1, r5, r2
 768              	.LVL100:
 283:Src/pwm.c     **** 		g_Sector_test = 4;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 21


 769              		.loc 1 283 0
 770 013a 4318     		adds	r3, r0, r1
 771              	.LVL101:
 284:Src/pwm.c     ****   }
 772              		.loc 1 284 0
 773 013c 0424     		movs	r4, #4
 774              	.LVL102:
 775 013e 2948     		ldr	r0, .L69+8
 776              	.LVL103:
 777 0140 90E7     		b	.L68
 778              	.LVL104:
 779              	.L58:
 780 0142 2C4B     		ldr	r3, .L69+24
 286:Src/pwm.c     ****   {
 781              		.loc 1 286 0
 782 0144 AA42     		cmp	r2, r5
 783 0146 B3F90030 		ldrsh	r3, [r3]
 784 014a 1ADC     		bgt	.L59
 286:Src/pwm.c     ****   {
 785              		.loc 1 286 0 is_stmt 0 discriminator 1
 786 014c AB42     		cmp	r3, r5
 787 014e 1ADD     		ble	.L60
 788              	.LVL105:
 288:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 789              		.loc 1 288 0 is_stmt 1
 790 0150 AD1A     		subs	r5, r5, r2
 791              	.LVL106:
 289:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 792              		.loc 1 289 0
 793 0152 ADB2     		uxth	r5, r5
 794              	.LVL107:
 795 0154 401B     		subs	r0, r0, r5
 796 0156 80B2     		uxth	r0, r0
 797 0158 FFF7FEFF 		bl	Math_Sin_EN360
 798              	.LVL108:
 799 015c 2146     		mov	r1, r4
 800 015e FFF7FEFF 		bl	Q15_MUL
 801              	.LVL109:
 802 0162 0746     		mov	r7, r0
 803              	.LVL110:
 290:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 804              		.loc 1 290 0
 805 0164 2846     		mov	r0, r5
 806              	.LVL111:
 807 0166 FFF7FEFF 		bl	Math_Sin_EN360
 808              	.LVL112:
 809 016a 2146     		mov	r1, r4
 810 016c FFF7FEFF 		bl	Q15_MUL
 811              	.LVL113:
 291:Src/pwm.c     ****     CCR2 = t0>>1;
 812              		.loc 1 291 0
 813 0170 C7F53D61 		rsb	r1, r7, #3024
 814 0174 091A     		subs	r1, r1, r0
 292:Src/pwm.c     ****     CCR1 = CCR2 + tk_1;
 815              		.loc 1 292 0
 816 0176 4910     		asrs	r1, r1, #1
 817              	.LVL114:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 22


 293:Src/pwm.c     ****     CCR3 = CCR1 + tk;
 818              		.loc 1 293 0
 819 0178 4218     		adds	r2, r0, r1
 820              	.LVL115:
 294:Src/pwm.c     **** 		g_Sector_test = 5;
 821              		.loc 1 294 0
 822 017a BB18     		adds	r3, r7, r2
 823              	.LVL116:
 295:Src/pwm.c     **** 
 824              		.loc 1 295 0
 825 017c 1948     		ldr	r0, .L69+8
 826              	.LVL117:
 827 017e 0524     		movs	r4, #5
 828              	.LVL118:
 829 0180 70E7     		b	.L68
 830              	.LVL119:
 831              	.L59:
 298:Src/pwm.c     ****   {
 832              		.loc 1 298 0
 833 0182 AB42     		cmp	r3, r5
 834 0184 1DDC     		bgt	.L66
 835              	.L60:
 298:Src/pwm.c     ****   {
 836              		.loc 1 298 0 is_stmt 0 discriminator 1
 837 0186 164A     		ldr	r2, .L69+4
 838 0188 B2F90020 		ldrsh	r2, [r2]
 839 018c AA42     		cmp	r2, r5
 840 018e 18DD     		ble	.L66
 841              	.LVL120:
 300:Src/pwm.c     ****     tk = Q15_MUL(Math_Sin_EN360(EN_60-angle),targetCCR);
 842              		.loc 1 300 0 is_stmt 1
 843 0190 EB1A     		subs	r3, r5, r3
 844              	.LVL121:
 301:Src/pwm.c     ****     tk_1 = Q15_MUL(Math_Sin_EN360(angle),targetCCR);
 845              		.loc 1 301 0
 846 0192 9DB2     		uxth	r5, r3
 847 0194 401B     		subs	r0, r0, r5
 848 0196 80B2     		uxth	r0, r0
 849 0198 FFF7FEFF 		bl	Math_Sin_EN360
 850              	.LVL122:
 851 019c 2146     		mov	r1, r4
 852 019e FFF7FEFF 		bl	Q15_MUL
 853              	.LVL123:
 854 01a2 0746     		mov	r7, r0
 855              	.LVL124:
 302:Src/pwm.c     ****     t0 = MAX_CCR - tk - tk_1;
 856              		.loc 1 302 0
 857 01a4 2846     		mov	r0, r5
 858              	.LVL125:
 859 01a6 FFF7FEFF 		bl	Math_Sin_EN360
 860              	.LVL126:
 861 01aa 2146     		mov	r1, r4
 862 01ac FFF7FEFF 		bl	Q15_MUL
 863              	.LVL127:
 303:Src/pwm.c     ****     CCR2 = t0>>1;
 864              		.loc 1 303 0
 865 01b0 C7F53D61 		rsb	r1, r7, #3024
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 23


 866 01b4 091A     		subs	r1, r1, r0
 304:Src/pwm.c     ****     CCR3 = CCR2 + tk;
 867              		.loc 1 304 0
 868 01b6 4910     		asrs	r1, r1, #1
 869              	.LVL128:
 305:Src/pwm.c     ****     CCR1 = CCR3 + tk_1;
 870              		.loc 1 305 0
 871 01b8 7B18     		adds	r3, r7, r1
 872              	.LVL129:
 306:Src/pwm.c     **** 		g_Sector_test = 6;
 873              		.loc 1 306 0
 874 01ba C218     		adds	r2, r0, r3
 875              	.LVL130:
 307:Src/pwm.c     ****   }
 876              		.loc 1 307 0
 877 01bc 0624     		movs	r4, #6
 878              	.LVL131:
 879 01be 0948     		ldr	r0, .L69+8
 880              	.LVL132:
 881 01c0 50E7     		b	.L68
 882              	.LVL133:
 883              	.L66:
 231:Src/pwm.c     **** 	
 884              		.loc 1 231 0
 885 01c2 0023     		movs	r3, #0
 230:Src/pwm.c     ****   s32 CCR3 = 0;
 886              		.loc 1 230 0
 887 01c4 1946     		mov	r1, r3
 229:Src/pwm.c     ****   s32 CCR2 = 0;
 888              		.loc 1 229 0
 889 01c6 1A46     		mov	r2, r3
 890 01c8 4DE7     		b	.L55
 891              	.LVL134:
 892              	.L63:
 237:Src/pwm.c     ****   targetCCR = targetCCR>MAX_CCR?MAX_CCR:(targetCCR<0?0:targetCCR);
 893              		.loc 1 237 0
 894 01ca 0025     		movs	r5, #0
 895              	.LVL135:
 896              	.L52:
 238:Src/pwm.c     **** 	
 897              		.loc 1 238 0
 898 01cc B2F53D6F 		cmp	r2, #3024
 899 01d0 7FF728AF 		ble	.L61
 900 01d4 4FF43D64 		mov	r4, #3024
 901 01d8 28E7     		b	.L62
 902              	.L70:
 903 01da 00BF     		.align	2
 904              	.L69:
 905 01dc 00000000 		.word	EN_60
 906 01e0 00000000 		.word	EN_360
 907 01e4 00000000 		.word	g_Sector_test
 908 01e8 00000000 		.word	EN_120
 909 01ec 00000000 		.word	EN_180
 910 01f0 00000000 		.word	EN_240
 911 01f4 00000000 		.word	EN_300
 912              		.cfi_endproc
 913              	.LFE338:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 24


 915              		.section	.text.PWM_OutPut_Open,"ax",%progbits
 916              		.align	1
 917              		.global	PWM_OutPut_Open
 918              		.syntax unified
 919              		.thumb
 920              		.thumb_func
 921              		.fpu fpv4-sp-d16
 923              	PWM_OutPut_Open:
 924              	.LFB339:
 317:Src/pwm.c     **** 
 318:Src/pwm.c     **** 
 319:Src/pwm.c     **** 
 320:Src/pwm.c     **** volatile int g_high_fre_pulse =1;
 321:Src/pwm.c     **** 
 322:Src/pwm.c     **** void PWM_OutPut_Open(TIM_TypeDef* TIMx, s32 ElectricAngle, s32 TimerCCR)
 323:Src/pwm.c     **** {
 925              		.loc 1 323 0
 926              		.cfi_startproc
 927              		@ args = 0, pretend = 0, frame = 0
 928              		@ frame_needed = 0, uses_anonymous_args = 0
 929              		@ link register save eliminated.
 930              	.LVL136:
 931              	.LBB14:
 932              	.LBB15:
 933              		.file 2 "Inc/stm32_math.h"
   1:Inc/stm32_math.h **** #ifndef __STM32_MATH_H__
   2:Inc/stm32_math.h **** #define __STM32_MATH_H__
   3:Inc/stm32_math.h **** 
   4:Inc/stm32_math.h **** typedef struct
   5:Inc/stm32_math.h **** {
   6:Inc/stm32_math.h **** 	int Fiter_in;
   7:Inc/stm32_math.h **** 	int Fiter_K;
   8:Inc/stm32_math.h **** 	int Fiter_Out;	
   9:Inc/stm32_math.h **** } Fiter;
  10:Inc/stm32_math.h **** 
  11:Inc/stm32_math.h **** int Q15_MUL(int Data_A,int Data_B);		//Q15ï¿½Ë·ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½Q15,ï¿½ï¿½ï¿½Q15
  12:Inc/stm32_math.h **** int Q16_MUL(int Data_A,int Data_B);		//Q16ï¿½Ë·ï¿½ï¿½ï¿½ï¿½ï¿½  ï¿½ï¿½ï¿½ï¿½Q16,ï¿½ï¿½ï¿½Q16
  13:Inc/stm32_math.h **** int Q16_Int(long int Data_A);				  //Q16×ªï¿½ï¿½ï¿½ï¿½
  14:Inc/stm32_math.h **** long int Int_Q16(int Data_A);				  //ï¿½ï¿½ï¿½ï¿½×ªQ16
  15:Inc/stm32_math.h **** 
  16:Inc/stm32_math.h **** unsigned int Low_Fiter(Fiter *Ptr);
  17:Inc/stm32_math.h **** unsigned int ASM_MUL(unsigned int a,unsigned int b);
  18:Inc/stm32_math.h **** unsigned int MUL_DIV(unsigned int Data,unsigned int Q_Data,unsigned int X_Data);	//Data*Q_Data/X_Da
  19:Inc/stm32_math.h **** unsigned int Uint32_DIV(unsigned int Data_A,unsigned int Data_B);
  20:Inc/stm32_math.h **** unsigned int SQRT_INT(unsigned int Data); //ï¿½ï¿½ï¿½ã¿ªï¿½ï¿½
  21:Inc/stm32_math.h **** static inline int LIMIT_INT(int data_in,int max,int min)
  22:Inc/stm32_math.h **** {
  23:Inc/stm32_math.h ****     int rst;
  24:Inc/stm32_math.h ****     rst = (data_in >= max) ? max : data_in;
 934              		.loc 2 24 0
 935 0000 1346     		mov	r3, r2
 936 0002 B2F53D6F 		cmp	r2, #3024
 937              	.LBE15:
 938              	.LBE14:
 939              		.loc 1 323 0
 940 0006 10B4     		push	{r4}
 941              	.LCFI8:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 25


 942              		.cfi_def_cfa_offset 4
 943              		.cfi_offset 4, -4
 944              		.loc 1 323 0
 945 0008 1446     		mov	r4, r2
 946              	.LBB17:
 947              	.LBB16:
  25:Inc/stm32_math.h ****     rst = (rst <= min) ? min : rst;
 948              		.loc 2 25 0
 949 000a 0E4A     		ldr	r2, .L75
 950              	.LVL137:
  24:Inc/stm32_math.h ****     rst = (rst <= min) ? min : rst;
 951              		.loc 2 24 0
 952 000c A8BF     		it	ge
 953 000e 4FF43D63 		movge	r3, #3024
 954              	.LVL138:
 955              		.loc 2 25 0
 956 0012 9A42     		cmp	r2, r3
 957 0014 B8BF     		it	lt
 958 0016 1A46     		movlt	r2, r3
 959              	.LVL139:
 960              	.LBE16:
 961              	.LBE17:
 324:Src/pwm.c     ****   s32 angle = 0;
 325:Src/pwm.c     **** 	
 326:Src/pwm.c     **** 
 327:Src/pwm.c     **** 	
 328:Src/pwm.c     **** //		TimerCCR += g_high_fre_pulse*500; 
 329:Src/pwm.c     **** //	g_high_fre_pulse = 0 - g_high_fre_pulse;
 330:Src/pwm.c     **** 	
 331:Src/pwm.c     ****   //TimerCCR = TimerCCR>MAX_CCR?MAX_CCR:(TimerCCR<-MAX_CCR?-MAX_CCR:TimerCCR);
 332:Src/pwm.c     ****   TimerCCR = LIMIT_INT(TimerCCR, MAX_CCR,-MAX_CCR);
 333:Src/pwm.c     ****   if (TimerCCR >= 0)
 962              		.loc 1 333 0
 963 0018 002C     		cmp	r4, #0
 334:Src/pwm.c     ****   {
 335:Src/pwm.c     ****     angle = ElectricAngle;
 336:Src/pwm.c     ****   }
 337:Src/pwm.c     ****   else
 338:Src/pwm.c     ****   {
 339:Src/pwm.c     ****     TimerCCR = -TimerCCR;
 340:Src/pwm.c     ****     angle = ElectricAngle + EN_180;
 964              		.loc 1 340 0
 965 001a BEBF     		ittt	lt
 966 001c 0A4B     		ldrlt	r3, .L75+4
 967 001e B3F90030 		ldrshlt	r3, [r3]
 968 0022 C918     		addlt	r1, r1, r3
 969              	.LVL140:
 341:Src/pwm.c     ****   }
 342:Src/pwm.c     ****   if (angle >= EN_360)
 970              		.loc 1 342 0
 971 0024 094B     		ldr	r3, .L75+8
 972 0026 B3F90030 		ldrsh	r3, [r3]
 339:Src/pwm.c     ****     angle = ElectricAngle + EN_180;
 973              		.loc 1 339 0
 974 002a B8BF     		it	lt
 975 002c 5242     		rsblt	r2, r2, #0
 976              	.LVL141:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 26


 977              		.loc 1 342 0
 978 002e 8B42     		cmp	r3, r1
 979 0030 04DC     		bgt	.L73
 343:Src/pwm.c     ****     angle -= EN_360;
 980              		.loc 1 343 0
 981 0032 C91A     		subs	r1, r1, r3
 982              	.LVL142:
 983              	.L74:
 344:Src/pwm.c     ****   else if (angle < 0)
 345:Src/pwm.c     ****     angle += EN_360;
 346:Src/pwm.c     ****   Calculate_CCR(TIMx, angle, TimerCCR);
 347:Src/pwm.c     **** }
 984              		.loc 1 347 0
 985 0034 5DF8044B 		ldr	r4, [sp], #4
 986              	.LCFI9:
 987              		.cfi_remember_state
 988              		.cfi_restore 4
 989              		.cfi_def_cfa_offset 0
 346:Src/pwm.c     **** }
 990              		.loc 1 346 0
 991 0038 FFF7FEBF 		b	Calculate_CCR
 992              	.LVL143:
 993              	.L73:
 994              	.LCFI10:
 995              		.cfi_restore_state
 344:Src/pwm.c     ****   else if (angle < 0)
 996              		.loc 1 344 0
 997 003c 0029     		cmp	r1, #0
 345:Src/pwm.c     ****   Calculate_CCR(TIMx, angle, TimerCCR);
 998              		.loc 1 345 0
 999 003e B8BF     		it	lt
 1000 0040 C918     		addlt	r1, r1, r3
 1001              	.LVL144:
 1002 0042 F7E7     		b	.L74
 1003              	.L76:
 1004              		.align	2
 1005              	.L75:
 1006 0044 30F4FFFF 		.word	-3024
 1007 0048 00000000 		.word	EN_180
 1008 004c 00000000 		.word	EN_360
 1009              		.cfi_endproc
 1010              	.LFE339:
 1012              		.section	.text.PWM_Enable,"ax",%progbits
 1013              		.align	1
 1014              		.global	PWM_Enable
 1015              		.syntax unified
 1016              		.thumb
 1017              		.thumb_func
 1018              		.fpu fpv4-sp-d16
 1020              	PWM_Enable:
 1021              	.LFB336:
 174:Src/pwm.c     **** 	MP6540_ON();
 1022              		.loc 1 174 0
 1023              		.cfi_startproc
 1024              		@ args = 0, pretend = 0, frame = 0
 1025              		@ frame_needed = 0, uses_anonymous_args = 0
 1026              		@ link register save eliminated.
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 27


 175:Src/pwm.c     ****   g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 1027              		.loc 1 175 0
 1028 0000 0A4A     		ldr	r2, .L78
 178:Src/pwm.c     ****   PWM_OutPut_Open(TIM1,g_ElectricAngle,0);
 1029              		.loc 1 178 0
 1030 0002 0B48     		ldr	r0, .L78+4
 175:Src/pwm.c     ****   g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 1031              		.loc 1 175 0
 1032 0004 5369     		ldr	r3, [r2, #20]
 1033 0006 43F48053 		orr	r3, r3, #4096
 1034 000a 5361     		str	r3, [r2, #20]
 176:Src/pwm.c     ****   g_bEnableHB = 1;
 1035              		.loc 1 176 0
 1036 000c 094A     		ldr	r2, .L78+8
 1037 000e 0123     		movs	r3, #1
 1038 0010 A2F80232 		strh	r3, [r2, #514]	@ movhi
 177:Src/pwm.c     ****   TIM1->BDTR|=(TIM_BDTR_MOE);
 1039              		.loc 1 177 0
 1040 0014 084A     		ldr	r2, .L78+12
 1041 0016 1380     		strh	r3, [r2]	@ movhi
 178:Src/pwm.c     ****   PWM_OutPut_Open(TIM1,g_ElectricAngle,0);
 1042              		.loc 1 178 0
 1043 0018 436C     		ldr	r3, [r0, #68]
 1044 001a 43F40043 		orr	r3, r3, #32768
 1045 001e 4364     		str	r3, [r0, #68]
 179:Src/pwm.c     **** }
 1046              		.loc 1 179 0
 1047 0020 064B     		ldr	r3, .L78+16
 1048 0022 0022     		movs	r2, #0
 1049 0024 1968     		ldr	r1, [r3]
 1050 0026 FFF7FEBF 		b	PWM_OutPut_Open
 1051              	.LVL145:
 1052              	.L79:
 1053 002a 00BF     		.align	2
 1054              	.L78:
 1055 002c 00040048 		.word	1207960576
 1056 0030 002C0140 		.word	1073818624
 1057 0034 00000000 		.word	g_CmdMap
 1058 0038 00000000 		.word	g_bEnableHB
 1059 003c 00000000 		.word	g_ElectricAngle
 1060              		.cfi_endproc
 1061              	.LFE336:
 1063              		.global	g_high_fre_pulse
 1064              		.global	G_hall_ture_value
 1065              		.global	tmp_hall_ture_value
 1066              		.global	last_hall_ture_value
 1067              		.global	hall_ture_value
 1068              		.comm	hall_c,4,4
 1069              		.comm	hall_b,4,4
 1070              		.comm	hall_a,4,4
 1071              		.global	cnt
 1072              		.global	hall_value
 1073              		.global	sample_invered
 1074              		.comm	htim1,76,4
 1075              		.section	.bss.G_hall_ture_value,"aw",%nobits
 1076              		.align	2
 1079              	G_hall_ture_value:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 28


 1080 0000 00000000 		.space	4
 1081              		.section	.bss.cnt,"aw",%nobits
 1082              		.align	2
 1085              	cnt:
 1086 0000 00000000 		.space	4
 1087              		.section	.bss.last_hall_ture_value,"aw",%nobits
 1088              		.align	2
 1091              	last_hall_ture_value:
 1092 0000 00000000 		.space	4
 1093              		.section	.bss.sample_invered,"aw",%nobits
 1094              		.align	2
 1097              	sample_invered:
 1098 0000 00000000 		.space	4
 1099              		.section	.bss.tmp_hall_ture_value,"aw",%nobits
 1100              		.align	2
 1103              	tmp_hall_ture_value:
 1104 0000 00000000 		.space	4
 1105              		.section	.data.g_high_fre_pulse,"aw",%progbits
 1106              		.align	2
 1109              	g_high_fre_pulse:
 1110 0000 01000000 		.word	1
 1111              		.section	.data.hall_ture_value,"aw",%progbits
 1112              		.align	2
 1115              	hall_ture_value:
 1116 0000 05000000 		.word	5
 1117              		.section	.data.hall_value,"aw",%progbits
 1118              		.align	2
 1121              	hall_value:
 1122 0000 01000000 		.word	1
 1123              		.text
 1124              	.Letext0:
 1125              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 1126              		.file 4 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 1127              		.file 5 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1128              		.file 6 "Drivers/CMSIS/Include/core_cm4.h"
 1129              		.file 7 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/system_stm32g4xx.h"
 1130              		.file 8 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 1131              		.file 9 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g4xx.h"
 1132              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 1133              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 1134              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc.h"
 1135              		.file 13 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_flash.h"
 1136              		.file 14 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 1137              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim.h"
 1138              		.file 16 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 1139              		.file 17 "Inc/PWM.h"
 1140              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1141              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1142              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 1143              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1144              		.file 22 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1145              		.file 23 "Inc/uart.h"
 1146              		.file 24 "Inc/spi_MEncoder.h"
 1147              		.file 25 "Inc/adc.h"
 1148              		.file 26 "Inc/stm32_math_sin.h"
 1149              		.file 27 "Inc/pid.h"
 1150              		.file 28 "Inc/profile_joint.h"
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 29


 1151              		.file 29 "Inc/icmu.h"
 1152              		.file 30 "Inc/performance_test.h"
 1153              		.file 31 "Inc/global.h"
 1154              		.file 32 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim_ex.h"
 1155              		.file 33 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc_ex.h"
 1156              		.file 34 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_cortex.h"
 1157              		.file 35 "<built-in>"
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 30


DEFINED SYMBOLS
                            *ABS*:00000000 pwm.c
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:18     .text.SWI_EXTI_Config:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:25     .text.SWI_EXTI_Config:00000000 SWI_EXTI_Config
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:70     .text.SWI_EXTI_Config:00000030 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:75     .text.MX_TIM1_Init:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:82     .text.MX_TIM1_Init:00000000 MX_TIM1_Init
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:407    .text.MX_TIM1_Init:0000019c $d
                            *COM*:0000004c htim1
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:414    .text.PWM_Init:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:421    .text.PWM_Init:00000000 PWM_Init
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:448    .text.PWM_Disable:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:455    .text.PWM_Disable:00000000 PWM_Disable
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:493    .text.PWM_Disable:00000030 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:501    .text.Calculate_CCR:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:508    .text.Calculate_CCR:00000000 Calculate_CCR
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:905    .text.Calculate_CCR:000001dc $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:916    .text.PWM_OutPut_Open:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:923    .text.PWM_OutPut_Open:00000000 PWM_OutPut_Open
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1006   .text.PWM_OutPut_Open:00000044 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1013   .text.PWM_Enable:00000000 $t
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1020   .text.PWM_Enable:00000000 PWM_Enable
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1055   .text.PWM_Enable:0000002c $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1109   .data.g_high_fre_pulse:00000000 g_high_fre_pulse
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1079   .bss.G_hall_ture_value:00000000 G_hall_ture_value
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1103   .bss.tmp_hall_ture_value:00000000 tmp_hall_ture_value
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1091   .bss.last_hall_ture_value:00000000 last_hall_ture_value
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1115   .data.hall_ture_value:00000000 hall_ture_value
                            *COM*:00000004 hall_c
                            *COM*:00000004 hall_b
                            *COM*:00000004 hall_a
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1085   .bss.cnt:00000000 cnt
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1121   .data.hall_value:00000000 hall_value
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1097   .bss.sample_invered:00000000 sample_invered
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1076   .bss.G_hall_ture_value:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1082   .bss.cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1088   .bss.last_hall_ture_value:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1094   .bss.sample_invered:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1100   .bss.tmp_hall_ture_value:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1106   .data.g_high_fre_pulse:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1112   .data.hall_ture_value:00000000 $d
C:\Users\82057\AppData\Local\Temp\cceBErjc.s:1118   .data.hall_value:00000000 $d

UNDEFINED SYMBOLS
HAL_NVIC_SetPriority
HAL_NVIC_EnableIRQ
memset
HAL_TIM_Base_Init
Error_Handler
HAL_TIM_ConfigClockSource
HAL_TIM_PWM_Init
HAL_TIM_OC_Init
HAL_TIMEx_MasterConfigSynchronization
HAL_TIM_PWM_ConfigChannel
HAL_TIM_OC_ConfigChannel
HAL_TIMEx_ConfigBreakDeadTime
HAL_TIM_MspPostInit
ARM GAS  C:\Users\82057\AppData\Local\Temp\cceBErjc.s 			page 31


HAL_TIM_PWM_Start
HAL_TIMEx_PWMN_Start
HAL_ADCEx_InjectedStart_IT
hadc1
g_CmdMap
g_bEnableHB
Math_Sin_EN360
Q15_MUL
EN_60
EN_360
g_Sector_test
EN_120
EN_180
EN_240
EN_300
g_ElectricAngle
