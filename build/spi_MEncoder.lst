ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"spi_MEncoder.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.HAL_SPI_MspInit,"ax",%progbits
  18              		.align	1
  19              		.global	HAL_SPI_MspInit
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	HAL_SPI_MspInit:
  26              	.LFB333:
  27              		.file 1 "Src/spi_MEncoder.c"
   1:Src/spi_MEncoder.c **** #include "global.h"
   2:Src/spi_MEncoder.c **** #include "spi_MEncoder.h"
   3:Src/spi_MEncoder.c **** #include "icmu.h"
   4:Src/spi_MEncoder.c **** #include"sensorless.h"
   5:Src/spi_MEncoder.c **** 
   6:Src/spi_MEncoder.c **** u16 EncoderAB_PulseWidth_Array[16] = {0};//�������������
   7:Src/spi_MEncoder.c **** s32 g_MEncode = 0;
   8:Src/spi_MEncoder.c **** volatile s32 g_Encode_AbsPos = 0;
   9:Src/spi_MEncoder.c **** volatile s32 g_Encode_AbsPos_Last = 0;
  10:Src/spi_MEncoder.c **** volatile s32 g_Encode_Inc = 0;
  11:Src/spi_MEncoder.c **** volatile s32 Num_Turns = 0;
  12:Src/spi_MEncoder.c **** volatile s32 g_Encode_offset = 0;
  13:Src/spi_MEncoder.c **** volatile s32 g_Encode_offset_EN = 0;
  14:Src/spi_MEncoder.c **** volatile s32 tim3_cnt = 0;
  15:Src/spi_MEncoder.c **** volatile s32 tim4_cnt = 0;
  16:Src/spi_MEncoder.c **** 
  17:Src/spi_MEncoder.c **** TIM_HandleTypeDef htim2;
  18:Src/spi_MEncoder.c **** 
  19:Src/spi_MEncoder.c **** float sincos_sample_s_ = 0.0f;
  20:Src/spi_MEncoder.c **** float sincos_sample_c_ = 0.0f;
  21:Src/spi_MEncoder.c **** 
  22:Src/spi_MEncoder.c **** extern DMA_HandleTypeDef hdma_spi1_rx;
  23:Src/spi_MEncoder.c **** 
  24:Src/spi_MEncoder.c **** extern DMA_HandleTypeDef hdma_spi1_tx;
  25:Src/spi_MEncoder.c **** 
  26:Src/spi_MEncoder.c **** 
  27:Src/spi_MEncoder.c **** /**
  28:Src/spi_MEncoder.c ****   * @brief SPI3 Initialization Function
  29:Src/spi_MEncoder.c ****   * @param None
  30:Src/spi_MEncoder.c ****   * @retval None
  31:Src/spi_MEncoder.c ****   */
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 2


  32:Src/spi_MEncoder.c **** SPI_HandleTypeDef hspi3;
  33:Src/spi_MEncoder.c **** 
  34:Src/spi_MEncoder.c **** 
  35:Src/spi_MEncoder.c **** /**
  36:Src/spi_MEncoder.c **** * @brief SPI MSP Initialization
  37:Src/spi_MEncoder.c **** * This function configures the hardware resources used in this example
  38:Src/spi_MEncoder.c **** * @param hspi: SPI handle pointer
  39:Src/spi_MEncoder.c **** * @retval None
  40:Src/spi_MEncoder.c **** */
  41:Src/spi_MEncoder.c **** void HAL_SPI_MspInit(SPI_HandleTypeDef* hspi)
  42:Src/spi_MEncoder.c **** {
  28              		.loc 1 42 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 48
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              	.LVL0:
  33 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 24
  36              		.cfi_offset 4, -24
  37              		.cfi_offset 5, -20
  38              		.cfi_offset 6, -16
  39              		.cfi_offset 7, -12
  40              		.cfi_offset 8, -8
  41              		.cfi_offset 14, -4
  42 0004 0546     		mov	r5, r0
  43 0006 8CB0     		sub	sp, sp, #48
  44              	.LCFI1:
  45              		.cfi_def_cfa_offset 72
  43:Src/spi_MEncoder.c ****   GPIO_InitTypeDef GPIO_InitStruct = {0};
  46              		.loc 1 43 0
  47 0008 1422     		movs	r2, #20
  48 000a 0021     		movs	r1, #0
  49 000c 07A8     		add	r0, sp, #28
  50              	.LVL1:
  51 000e FFF7FEFF 		bl	memset
  52              	.LVL2:
  44:Src/spi_MEncoder.c ****   if(hspi->Instance==SPI3)
  53              		.loc 1 44 0
  54 0012 2B68     		ldr	r3, [r5]
  55 0014 534A     		ldr	r2, .L12
  56 0016 9342     		cmp	r3, r2
  57 0018 59D1     		bne	.L2
  58              	.LBB2:
  45:Src/spi_MEncoder.c ****   {
  46:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_MspInit 0 */
  47:Src/spi_MEncoder.c **** 
  48:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_MspInit 0 */
  49:Src/spi_MEncoder.c ****     /* Peripheral clock enable */
  50:Src/spi_MEncoder.c ****     __HAL_RCC_SPI3_CLK_ENABLE();
  59              		.loc 1 50 0
  60 001a 534B     		ldr	r3, .L12+4
  61 001c 9A6D     		ldr	r2, [r3, #88]
  62 001e 42F40042 		orr	r2, r2, #32768
  63 0022 9A65     		str	r2, [r3, #88]
  64 0024 9A6D     		ldr	r2, [r3, #88]
  65 0026 02F40042 		and	r2, r2, #32768
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 3


  66 002a 0192     		str	r2, [sp, #4]
  67 002c 019A     		ldr	r2, [sp, #4]
  68              	.LBE2:
  69              	.LBB3:
  51:Src/spi_MEncoder.c **** 
  52:Src/spi_MEncoder.c ****     __HAL_RCC_GPIOA_CLK_ENABLE();
  70              		.loc 1 52 0
  71 002e DA6C     		ldr	r2, [r3, #76]
  72 0030 42F00102 		orr	r2, r2, #1
  73 0034 DA64     		str	r2, [r3, #76]
  74 0036 DA6C     		ldr	r2, [r3, #76]
  75 0038 02F00102 		and	r2, r2, #1
  76 003c 0292     		str	r2, [sp, #8]
  77 003e 029A     		ldr	r2, [sp, #8]
  78              	.LBE3:
  79              	.LBB4:
  53:Src/spi_MEncoder.c ****     __HAL_RCC_GPIOC_CLK_ENABLE();
  80              		.loc 1 53 0
  81 0040 DA6C     		ldr	r2, [r3, #76]
  82 0042 42F00402 		orr	r2, r2, #4
  83 0046 DA64     		str	r2, [r3, #76]
  84 0048 DA6C     		ldr	r2, [r3, #76]
  85 004a 02F00402 		and	r2, r2, #4
  86 004e 0392     		str	r2, [sp, #12]
  87 0050 039A     		ldr	r2, [sp, #12]
  88              	.LBE4:
  89              	.LBB5:
  54:Src/spi_MEncoder.c ****     __HAL_RCC_GPIOB_CLK_ENABLE();
  90              		.loc 1 54 0
  91 0052 DA6C     		ldr	r2, [r3, #76]
  92 0054 42F00202 		orr	r2, r2, #2
  93 0058 DA64     		str	r2, [r3, #76]
  94 005a DB6C     		ldr	r3, [r3, #76]
  95 005c 03F00203 		and	r3, r3, #2
  96 0060 0493     		str	r3, [sp, #16]
  97              	.LBE5:
  55:Src/spi_MEncoder.c ****     /**SPI3 GPIO Configuration
  56:Src/spi_MEncoder.c ****     PA15     ------> SPI3_NSS
  57:Src/spi_MEncoder.c ****     PC10     ------> SPI3_SCK
  58:Src/spi_MEncoder.c ****     PC11     ------> SPI3_MISO
  59:Src/spi_MEncoder.c ****     PB5     ------> SPI3_MOSI
  60:Src/spi_MEncoder.c ****     */
  61:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pin = GPIO_PIN_15;
  62:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  63:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
  64:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  65:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
  98              		.loc 1 65 0
  99 0062 0325     		movs	r5, #3
 100              	.LVL3:
 101 0064 0624     		movs	r4, #6
  62:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
 102              		.loc 1 62 0
 103 0066 0127     		movs	r7, #1
 104              	.LBB6:
  54:Src/spi_MEncoder.c ****     __HAL_RCC_GPIOB_CLK_ENABLE();
 105              		.loc 1 54 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 4


 106 0068 049B     		ldr	r3, [sp, #16]
 107              	.LBE6:
  63:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 108              		.loc 1 63 0
 109 006a 0997     		str	r7, [sp, #36]
  62:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
 110              		.loc 1 62 0
 111 006c 4FF40043 		mov	r3, #32768
  66:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 112              		.loc 1 66 0
 113 0070 07A9     		add	r1, sp, #28
 114 0072 4FF09040 		mov	r0, #1207959552
  67:Src/spi_MEncoder.c **** 
  68:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pin = GPIO_PIN_10;
  69:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 115              		.loc 1 69 0
 116 0076 0226     		movs	r6, #2
  62:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
 117              		.loc 1 62 0
 118 0078 CDE90737 		strd	r3, r7, [sp, #28]
  70:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 119              		.loc 1 70 0
 120 007c 4FF00008 		mov	r8, #0
  65:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 121              		.loc 1 65 0
 122 0080 CDE90A54 		strd	r5, r4, [sp, #40]
  66:Src/spi_MEncoder.c **** 
 123              		.loc 1 66 0
 124 0084 FFF7FEFF 		bl	HAL_GPIO_Init
 125              	.LVL4:
  69:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 126              		.loc 1 69 0
 127 0088 4FF48063 		mov	r3, #1024
  71:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  72:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
  73:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);
 128              		.loc 1 73 0
 129 008c 07A9     		add	r1, sp, #28
 130 008e 3748     		ldr	r0, .L12+8
  72:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);
 131              		.loc 1 72 0
 132 0090 0B94     		str	r4, [sp, #44]
  69:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 133              		.loc 1 69 0
 134 0092 CDE90736 		strd	r3, r6, [sp, #28]
  71:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 135              		.loc 1 71 0
 136 0096 CDE90985 		strd	r8, r5, [sp, #36]
 137              		.loc 1 73 0
 138 009a FFF7FEFF 		bl	HAL_GPIO_Init
 139              	.LVL5:
  74:Src/spi_MEncoder.c **** 
  75:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pin = GPIO_PIN_11;
 140              		.loc 1 75 0
 141 009e 4FF40063 		mov	r3, #2048
  76:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  77:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 5


  78:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  79:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
  80:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);
 142              		.loc 1 80 0
 143 00a2 07A9     		add	r1, sp, #28
 144 00a4 3148     		ldr	r0, .L12+8
  79:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);
 145              		.loc 1 79 0
 146 00a6 0B94     		str	r4, [sp, #44]
  76:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 147              		.loc 1 76 0
 148 00a8 CDE90736 		strd	r3, r6, [sp, #28]
  78:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
 149              		.loc 1 78 0
 150 00ac CDE90975 		strd	r7, r5, [sp, #36]
 151              		.loc 1 80 0
 152 00b0 FFF7FEFF 		bl	HAL_GPIO_Init
 153              	.LVL6:
  81:Src/spi_MEncoder.c **** 
  82:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pin = GPIO_PIN_5;
 154              		.loc 1 82 0
 155 00b4 2023     		movs	r3, #32
  83:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  84:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
  85:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
  86:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
  87:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 156              		.loc 1 87 0
 157 00b6 07A9     		add	r1, sp, #28
 158 00b8 2D48     		ldr	r0, .L12+12
  86:Src/spi_MEncoder.c ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 159              		.loc 1 86 0
 160 00ba 0B94     		str	r4, [sp, #44]
  83:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 161              		.loc 1 83 0
 162 00bc CDE90736 		strd	r3, r6, [sp, #28]
  85:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF6_SPI3;
 163              		.loc 1 85 0
 164 00c0 CDE90985 		strd	r8, r5, [sp, #36]
 165              		.loc 1 87 0
 166 00c4 FFF7FEFF 		bl	HAL_GPIO_Init
 167              	.LVL7:
 168              	.L1:
  88:Src/spi_MEncoder.c **** 
  89:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_MspInit 1 */
  90:Src/spi_MEncoder.c **** 
  91:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_MspInit 1 */
  92:Src/spi_MEncoder.c ****   }
  93:Src/spi_MEncoder.c **** 	
  94:Src/spi_MEncoder.c **** 	else  if(hspi->Instance==SPI1)
  95:Src/spi_MEncoder.c ****   {
  96:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI1_MspInit 0 */
  97:Src/spi_MEncoder.c **** 
  98:Src/spi_MEncoder.c ****   /* USER CODE END SPI1_MspInit 0 */
  99:Src/spi_MEncoder.c ****     /* Peripheral clock enable */
 100:Src/spi_MEncoder.c ****     __HAL_RCC_SPI1_CLK_ENABLE();
 101:Src/spi_MEncoder.c **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 6


 102:Src/spi_MEncoder.c ****     __HAL_RCC_GPIOA_CLK_ENABLE();
 103:Src/spi_MEncoder.c ****     /**SPI1 GPIO Configuration
 104:Src/spi_MEncoder.c ****     PA4     ------> SPI1_NSS
 105:Src/spi_MEncoder.c ****     PA5     ------> SPI1_SCK
 106:Src/spi_MEncoder.c ****     PA6     ------> SPI1_MISO
 107:Src/spi_MEncoder.c ****     PA7     ------> SPI1_MOSI
 108:Src/spi_MEncoder.c ****     */
 109:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pin = GPIO_PIN_5|GPIO_PIN_6|GPIO_PIN_7;
 110:Src/spi_MEncoder.c ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 111:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 112:Src/spi_MEncoder.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
 113:Src/spi_MEncoder.c ****     GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;
 114:Src/spi_MEncoder.c ****   //  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 115:Src/spi_MEncoder.c **** 
 116:Src/spi_MEncoder.c ****     /* SPI1 DMA Init */
 117:Src/spi_MEncoder.c ****     /* SPI1_RX Init */
 118:Src/spi_MEncoder.c ****     hdma_spi1_rx.Instance = DMA1_Channel4;
 119:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Request = DMA_REQUEST_SPI1_RX;
 120:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;
 121:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.PeriphInc = DMA_PINC_DISABLE;
 122:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.MemInc = DMA_MINC_ENABLE;
 123:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
 124:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
 125:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Mode = DMA_CIRCULAR;
 126:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Priority = DMA_PRIORITY_LOW;
 127:Src/spi_MEncoder.c ****     if (HAL_DMA_Init(&hdma_spi1_rx) != HAL_OK)
 128:Src/spi_MEncoder.c ****     {
 129:Src/spi_MEncoder.c ****       Error_Handler();
 130:Src/spi_MEncoder.c ****     }
 131:Src/spi_MEncoder.c **** 
 132:Src/spi_MEncoder.c ****     __HAL_LINKDMA(hspi,hdmarx,hdma_spi1_rx);
 133:Src/spi_MEncoder.c **** 
 134:Src/spi_MEncoder.c ****     /* SPI1_TX Init */
 135:Src/spi_MEncoder.c ****     hdma_spi1_tx.Instance = DMA1_Channel3;
 136:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Request = DMA_REQUEST_SPI1_TX;
 137:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;
 138:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.PeriphInc = DMA_PINC_DISABLE;
 139:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.MemInc = DMA_MINC_ENABLE;
 140:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
 141:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
 142:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Mode = DMA_NORMAL;
 143:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Priority = DMA_PRIORITY_LOW;
 144:Src/spi_MEncoder.c ****     if (HAL_DMA_Init(&hdma_spi1_tx) != HAL_OK)
 145:Src/spi_MEncoder.c ****     {
 146:Src/spi_MEncoder.c ****       Error_Handler();
 147:Src/spi_MEncoder.c ****     }
 148:Src/spi_MEncoder.c **** 
 149:Src/spi_MEncoder.c ****     __HAL_LINKDMA(hspi,hdmatx,hdma_spi1_tx);
 150:Src/spi_MEncoder.c **** 
 151:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI1_MspInit 1 */
 152:Src/spi_MEncoder.c **** //		__HAL_DMA_ENABLE(&hdma_spi1_rx);
 153:Src/spi_MEncoder.c **** //		__HAL_DMA_ENABLE(&hdma_spi1_tx);
 154:Src/spi_MEncoder.c **** //		
 155:Src/spi_MEncoder.c **** //		__HAL_DMA_ENABLE_IT(&hdma_spi1_rx, DMA_IT_TC );
 156:Src/spi_MEncoder.c **** //		__HAL_DMA_ENABLE_IT(&hdma_spi1_tx, DMA_IT_TC );
 157:Src/spi_MEncoder.c **** //		
 158:Src/spi_MEncoder.c **** 		
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 7


 159:Src/spi_MEncoder.c **** //		HAL_DMA_Start_IT(&hdma_spi1_rx,(uint32_t)(&(SPI1->DR)), (uint32_t)(&spi1_reg_buf[0]) ,4);
 160:Src/spi_MEncoder.c **** 
 161:Src/spi_MEncoder.c **** 		
 162:Src/spi_MEncoder.c ****   /* USER CODE END SPI1_MspInit 1 */
 163:Src/spi_MEncoder.c ****   }
 164:Src/spi_MEncoder.c **** 
 165:Src/spi_MEncoder.c **** }
 169              		.loc 1 165 0
 170 00c8 0CB0     		add	sp, sp, #48
 171              	.LCFI2:
 172              		.cfi_remember_state
 173              		.cfi_def_cfa_offset 24
 174              		@ sp needed
 175 00ca BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 176              	.LVL8:
 177              	.L2:
 178              	.LCFI3:
 179              		.cfi_restore_state
  94:Src/spi_MEncoder.c ****   {
 180              		.loc 1 94 0
 181 00ce 294A     		ldr	r2, .L12+16
 182 00d0 9342     		cmp	r3, r2
 183 00d2 F9D1     		bne	.L1
 184              	.LBB7:
 100:Src/spi_MEncoder.c **** 
 185              		.loc 1 100 0
 186 00d4 244B     		ldr	r3, .L12+4
 187              	.LBE7:
 118:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Request = DMA_REQUEST_SPI1_RX;
 188              		.loc 1 118 0
 189 00d6 284C     		ldr	r4, .L12+20
 190              	.LBB8:
 100:Src/spi_MEncoder.c **** 
 191              		.loc 1 100 0
 192 00d8 1A6E     		ldr	r2, [r3, #96]
 193              	.LBE8:
 119:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;
 194              		.loc 1 119 0
 195 00da 284E     		ldr	r6, .L12+24
 196              	.LBB9:
 100:Src/spi_MEncoder.c **** 
 197              		.loc 1 100 0
 198 00dc 42F48052 		orr	r2, r2, #4096
 199 00e0 1A66     		str	r2, [r3, #96]
 200 00e2 1A6E     		ldr	r2, [r3, #96]
 201 00e4 02F48052 		and	r2, r2, #4096
 202 00e8 0592     		str	r2, [sp, #20]
 203 00ea 059A     		ldr	r2, [sp, #20]
 204              	.LBE9:
 205              	.LBB10:
 102:Src/spi_MEncoder.c ****     /**SPI1 GPIO Configuration
 206              		.loc 1 102 0
 207 00ec DA6C     		ldr	r2, [r3, #76]
 208 00ee 42F00102 		orr	r2, r2, #1
 209 00f2 DA64     		str	r2, [r3, #76]
 210 00f4 DB6C     		ldr	r3, [r3, #76]
 211 00f6 03F00103 		and	r3, r3, #1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 8


 212 00fa 0693     		str	r3, [sp, #24]
 213              	.LBE10:
 110:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 214              		.loc 1 110 0
 215 00fc E020     		movs	r0, #224
 216              	.LBB11:
 102:Src/spi_MEncoder.c ****     /**SPI1 GPIO Configuration
 217              		.loc 1 102 0
 218 00fe 069B     		ldr	r3, [sp, #24]
 219              	.LBE11:
 110:Src/spi_MEncoder.c ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 220              		.loc 1 110 0
 221 0100 0223     		movs	r3, #2
 222 0102 CDE90703 		strd	r0, r3, [sp, #28]
 113:Src/spi_MEncoder.c ****   //  HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 223              		.loc 1 113 0
 224 0106 0523     		movs	r3, #5
 225 0108 0B93     		str	r3, [sp, #44]
 119:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;
 226              		.loc 1 119 0
 227 010a 0A23     		movs	r3, #10
 122:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
 228              		.loc 1 122 0
 229 010c 8022     		movs	r2, #128
 119:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;
 230              		.loc 1 119 0
 231 010e C4E90063 		strd	r6, r3, [r4]
 120:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.PeriphInc = DMA_PINC_DISABLE;
 232              		.loc 1 120 0
 233 0112 0023     		movs	r3, #0
 123:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
 234              		.loc 1 123 0
 235 0114 C4E90423 		strd	r2, r3, [r4, #16]
 127:Src/spi_MEncoder.c ****     {
 236              		.loc 1 127 0
 237 0118 2046     		mov	r0, r4
 125:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Priority = DMA_PRIORITY_LOW;
 238              		.loc 1 125 0
 239 011a 2022     		movs	r2, #32
 121:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.MemInc = DMA_MINC_ENABLE;
 240              		.loc 1 121 0
 241 011c C4E90233 		strd	r3, r3, [r4, #8]
 124:Src/spi_MEncoder.c ****     hdma_spi1_rx.Init.Mode = DMA_CIRCULAR;
 242              		.loc 1 124 0
 243 0120 A361     		str	r3, [r4, #24]
 126:Src/spi_MEncoder.c ****     if (HAL_DMA_Init(&hdma_spi1_rx) != HAL_OK)
 244              		.loc 1 126 0
 245 0122 C4E90723 		strd	r2, r3, [r4, #28]
 127:Src/spi_MEncoder.c ****     {
 246              		.loc 1 127 0
 247 0126 FFF7FEFF 		bl	HAL_DMA_Init
 248              	.LVL9:
 249 012a 08B1     		cbz	r0, .L4
 250              	.LBB12:
 129:Src/spi_MEncoder.c ****     }
 251              		.loc 1 129 0
 252 012c FFF7FEFF 		bl	Error_Handler
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 9


 253              	.LVL10:
 254              	.L4:
 255              	.LBE12:
 136:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;
 256              		.loc 1 136 0
 257 0130 134A     		ldr	r2, .L12+28
 132:Src/spi_MEncoder.c **** 
 258              		.loc 1 132 0
 259 0132 AC65     		str	r4, [r5, #88]
 260 0134 A562     		str	r5, [r4, #40]
 135:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Request = DMA_REQUEST_SPI1_TX;
 261              		.loc 1 135 0
 262 0136 134C     		ldr	r4, .L12+32
 136:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;
 263              		.loc 1 136 0
 264 0138 0B23     		movs	r3, #11
 265 013a C4E90023 		strd	r2, r3, [r4]
 138:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.MemInc = DMA_MINC_ENABLE;
 266              		.loc 1 138 0
 267 013e 1021     		movs	r1, #16
 268 0140 0023     		movs	r3, #0
 139:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;
 269              		.loc 1 139 0
 270 0142 8022     		movs	r2, #128
 144:Src/spi_MEncoder.c ****     {
 271              		.loc 1 144 0
 272 0144 2046     		mov	r0, r4
 138:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.MemInc = DMA_MINC_ENABLE;
 273              		.loc 1 138 0
 274 0146 C4E90213 		strd	r1, r3, [r4, #8]
 140:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;
 275              		.loc 1 140 0
 276 014a C4E90423 		strd	r2, r3, [r4, #16]
 142:Src/spi_MEncoder.c ****     hdma_spi1_tx.Init.Priority = DMA_PRIORITY_LOW;
 277              		.loc 1 142 0
 278 014e C4E90633 		strd	r3, r3, [r4, #24]
 143:Src/spi_MEncoder.c ****     if (HAL_DMA_Init(&hdma_spi1_tx) != HAL_OK)
 279              		.loc 1 143 0
 280 0152 2362     		str	r3, [r4, #32]
 144:Src/spi_MEncoder.c ****     {
 281              		.loc 1 144 0
 282 0154 FFF7FEFF 		bl	HAL_DMA_Init
 283              	.LVL11:
 284 0158 08B1     		cbz	r0, .L5
 285              	.LBB13:
 146:Src/spi_MEncoder.c ****     }
 286              		.loc 1 146 0
 287 015a FFF7FEFF 		bl	Error_Handler
 288              	.LVL12:
 289              	.L5:
 290              	.LBE13:
 149:Src/spi_MEncoder.c **** 
 291              		.loc 1 149 0
 292 015e 6C65     		str	r4, [r5, #84]
 293 0160 A562     		str	r5, [r4, #40]
 294              		.loc 1 165 0
 295 0162 B1E7     		b	.L1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 10


 296              	.L13:
 297              		.align	2
 298              	.L12:
 299 0164 003C0040 		.word	1073757184
 300 0168 00100240 		.word	1073876992
 301 016c 00080048 		.word	1207961600
 302 0170 00040048 		.word	1207960576
 303 0174 00300140 		.word	1073819648
 304 0178 00000000 		.word	hdma_spi1_rx
 305 017c 44000240 		.word	1073872964
 306 0180 30000240 		.word	1073872944
 307 0184 00000000 		.word	hdma_spi1_tx
 308              		.cfi_endproc
 309              	.LFE333:
 311              		.section	.text.HAL_SPI_MspDeInit,"ax",%progbits
 312              		.align	1
 313              		.global	HAL_SPI_MspDeInit
 314              		.syntax unified
 315              		.thumb
 316              		.thumb_func
 317              		.fpu fpv4-sp-d16
 319              	HAL_SPI_MspDeInit:
 320              	.LFB334:
 166:Src/spi_MEncoder.c **** 
 167:Src/spi_MEncoder.c **** /**
 168:Src/spi_MEncoder.c **** * @brief SPI MSP De-Initialization
 169:Src/spi_MEncoder.c **** * This function freeze the hardware resources used in this example
 170:Src/spi_MEncoder.c **** * @param hspi: SPI handle pointer
 171:Src/spi_MEncoder.c **** * @retval None
 172:Src/spi_MEncoder.c **** */
 173:Src/spi_MEncoder.c **** void HAL_SPI_MspDeInit(SPI_HandleTypeDef* hspi)
 174:Src/spi_MEncoder.c **** {
 321              		.loc 1 174 0
 322              		.cfi_startproc
 323              		@ args = 0, pretend = 0, frame = 0
 324              		@ frame_needed = 0, uses_anonymous_args = 0
 325              	.LVL13:
 326 0000 08B5     		push	{r3, lr}
 327              	.LCFI4:
 328              		.cfi_def_cfa_offset 8
 329              		.cfi_offset 3, -8
 330              		.cfi_offset 14, -4
 175:Src/spi_MEncoder.c ****   if(hspi->Instance==SPI3)
 331              		.loc 1 175 0
 332 0002 0268     		ldr	r2, [r0]
 333 0004 0C4B     		ldr	r3, .L16
 334 0006 9A42     		cmp	r2, r3
 335 0008 15D1     		bne	.L14
 176:Src/spi_MEncoder.c ****   {
 177:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_MspDeInit 0 */
 178:Src/spi_MEncoder.c **** 
 179:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_MspDeInit 0 */
 180:Src/spi_MEncoder.c ****     /* Peripheral clock disable */
 181:Src/spi_MEncoder.c ****     __HAL_RCC_SPI3_CLK_DISABLE();
 336              		.loc 1 181 0
 337 000a 0C4A     		ldr	r2, .L16+4
 338 000c 936D     		ldr	r3, [r2, #88]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 11


 339 000e 23F40043 		bic	r3, r3, #32768
 340 0012 9365     		str	r3, [r2, #88]
 182:Src/spi_MEncoder.c **** 
 183:Src/spi_MEncoder.c ****     /**SPI3 GPIO Configuration
 184:Src/spi_MEncoder.c ****     PA15     ------> SPI3_NSS
 185:Src/spi_MEncoder.c ****     PC10     ------> SPI3_SCK
 186:Src/spi_MEncoder.c ****     PC11     ------> SPI3_MISO
 187:Src/spi_MEncoder.c ****     PB5     ------> SPI3_MOSI
 188:Src/spi_MEncoder.c ****     */
 189:Src/spi_MEncoder.c ****     HAL_GPIO_DeInit(GPIOA, GPIO_PIN_15);
 341              		.loc 1 189 0
 342 0014 4FF40041 		mov	r1, #32768
 343 0018 4FF09040 		mov	r0, #1207959552
 344              	.LVL14:
 345 001c FFF7FEFF 		bl	HAL_GPIO_DeInit
 346              	.LVL15:
 190:Src/spi_MEncoder.c **** 
 191:Src/spi_MEncoder.c ****     HAL_GPIO_DeInit(GPIOC, GPIO_PIN_10|GPIO_PIN_11);
 347              		.loc 1 191 0
 348 0020 4FF44061 		mov	r1, #3072
 349 0024 0648     		ldr	r0, .L16+8
 350 0026 FFF7FEFF 		bl	HAL_GPIO_DeInit
 351              	.LVL16:
 192:Src/spi_MEncoder.c **** 
 193:Src/spi_MEncoder.c ****     HAL_GPIO_DeInit(GPIOB, GPIO_PIN_5);
 352              		.loc 1 193 0
 353 002a 2021     		movs	r1, #32
 354 002c 0548     		ldr	r0, .L16+12
 194:Src/spi_MEncoder.c **** 
 195:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_MspDeInit 1 */
 196:Src/spi_MEncoder.c **** 
 197:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_MspDeInit 1 */
 198:Src/spi_MEncoder.c ****   }
 199:Src/spi_MEncoder.c **** 
 200:Src/spi_MEncoder.c **** }
 355              		.loc 1 200 0
 356 002e BDE80840 		pop	{r3, lr}
 357              	.LCFI5:
 358              		.cfi_remember_state
 359              		.cfi_restore 14
 360              		.cfi_restore 3
 361              		.cfi_def_cfa_offset 0
 193:Src/spi_MEncoder.c **** 
 362              		.loc 1 193 0
 363 0032 FFF7FEBF 		b	HAL_GPIO_DeInit
 364              	.LVL17:
 365              	.L14:
 366              	.LCFI6:
 367              		.cfi_restore_state
 368              		.loc 1 200 0
 369 0036 08BD     		pop	{r3, pc}
 370              	.L17:
 371              		.align	2
 372              	.L16:
 373 0038 003C0040 		.word	1073757184
 374 003c 00100240 		.word	1073876992
 375 0040 00080048 		.word	1207961600
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 12


 376 0044 00040048 		.word	1207960576
 377              		.cfi_endproc
 378              	.LFE334:
 380              		.section	.text.MX_SPI3_Init,"ax",%progbits
 381              		.align	1
 382              		.global	MX_SPI3_Init
 383              		.syntax unified
 384              		.thumb
 385              		.thumb_func
 386              		.fpu fpv4-sp-d16
 388              	MX_SPI3_Init:
 389              	.LFB335:
 201:Src/spi_MEncoder.c **** 
 202:Src/spi_MEncoder.c **** 
 203:Src/spi_MEncoder.c **** 
 204:Src/spi_MEncoder.c **** void MX_SPI3_Init(void)
 205:Src/spi_MEncoder.c **** {
 390              		.loc 1 205 0
 391              		.cfi_startproc
 392              		@ args = 0, pretend = 0, frame = 0
 393              		@ frame_needed = 0, uses_anonymous_args = 0
 394 0000 10B5     		push	{r4, lr}
 395              	.LCFI7:
 396              		.cfi_def_cfa_offset 8
 397              		.cfi_offset 4, -8
 398              		.cfi_offset 14, -4
 206:Src/spi_MEncoder.c **** 
 207:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_Init 0 */
 208:Src/spi_MEncoder.c **** 
 209:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_Init 0 */
 210:Src/spi_MEncoder.c **** 
 211:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_Init 1 */
 212:Src/spi_MEncoder.c **** 
 213:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_Init 1 */
 214:Src/spi_MEncoder.c ****   /* SPI3 parameter configuration*/
 215:Src/spi_MEncoder.c ****   hspi3.Instance = SPI3;
 216:Src/spi_MEncoder.c ****   hspi3.Init.Mode = SPI_MODE_MASTER;
 399              		.loc 1 216 0
 400 0002 134A     		ldr	r2, .L23
 215:Src/spi_MEncoder.c ****   hspi3.Init.Mode = SPI_MODE_MASTER;
 401              		.loc 1 215 0
 402 0004 134C     		ldr	r4, .L23+4
 403              		.loc 1 216 0
 404 0006 4FF48273 		mov	r3, #260
 405 000a C4E90023 		strd	r2, r3, [r4]
 217:Src/spi_MEncoder.c ****   hspi3.Init.Direction = SPI_DIRECTION_2LINES;
 218:Src/spi_MEncoder.c ****   hspi3.Init.DataSize = SPI_DATASIZE_16BIT;
 406              		.loc 1 218 0
 407 000e 0023     		movs	r3, #0
 408 0010 4FF47062 		mov	r2, #3840
 409 0014 C4E90232 		strd	r3, r2, [r4, #8]
 219:Src/spi_MEncoder.c ****   hspi3.Init.CLKPolarity = SPI_POLARITY_HIGH;
 220:Src/spi_MEncoder.c ****   hspi3.Init.CLKPhase = SPI_PHASE_2EDGE;
 410              		.loc 1 220 0
 411 0018 0221     		movs	r1, #2
 412 001a 0122     		movs	r2, #1
 221:Src/spi_MEncoder.c ****   hspi3.Init.NSS = SPI_NSS_SOFT;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 13


 222:Src/spi_MEncoder.c ****   hspi3.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_64;
 413              		.loc 1 222 0
 414 001c 4FF40070 		mov	r0, #512
 220:Src/spi_MEncoder.c ****   hspi3.Init.NSS = SPI_NSS_SOFT;
 415              		.loc 1 220 0
 416 0020 C4E90412 		strd	r1, r2, [r4, #16]
 417              		.loc 1 222 0
 418 0024 2822     		movs	r2, #40
 419 0026 C4E90602 		strd	r0, r2, [r4, #24]
 223:Src/spi_MEncoder.c ****   hspi3.Init.FirstBit = SPI_FIRSTBIT_MSB;
 224:Src/spi_MEncoder.c ****   hspi3.Init.TIMode = SPI_TIMODE_DISABLE;
 225:Src/spi_MEncoder.c ****   hspi3.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
 226:Src/spi_MEncoder.c ****   hspi3.Init.CRCPolynomial = 7;
 420              		.loc 1 226 0
 421 002a 0722     		movs	r2, #7
 227:Src/spi_MEncoder.c ****   hspi3.Init.CRCLength = SPI_CRC_LENGTH_DATASIZE;
 228:Src/spi_MEncoder.c ****   hspi3.Init.NSSPMode = SPI_NSS_PULSE_DISABLE;
 229:Src/spi_MEncoder.c ****   if (HAL_SPI_Init(&hspi3) != HAL_OK)
 422              		.loc 1 229 0
 423 002c 2046     		mov	r0, r4
 224:Src/spi_MEncoder.c ****   hspi3.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
 424              		.loc 1 224 0
 425 002e C4E90833 		strd	r3, r3, [r4, #32]
 225:Src/spi_MEncoder.c ****   hspi3.Init.CRCPolynomial = 7;
 426              		.loc 1 225 0
 427 0032 A362     		str	r3, [r4, #40]
 227:Src/spi_MEncoder.c ****   hspi3.Init.CRCLength = SPI_CRC_LENGTH_DATASIZE;
 428              		.loc 1 227 0
 429 0034 C4E90B23 		strd	r2, r3, [r4, #44]
 228:Src/spi_MEncoder.c ****   if (HAL_SPI_Init(&hspi3) != HAL_OK)
 430              		.loc 1 228 0
 431 0038 6363     		str	r3, [r4, #52]
 432              		.loc 1 229 0
 433 003a FFF7FEFF 		bl	HAL_SPI_Init
 434              	.LVL18:
 435 003e 08B1     		cbz	r0, .L19
 436              	.LBB14:
 230:Src/spi_MEncoder.c ****   {
 231:Src/spi_MEncoder.c ****     Error_Handler();
 437              		.loc 1 231 0
 438 0040 FFF7FEFF 		bl	Error_Handler
 439              	.LVL19:
 440              	.L19:
 441              	.LBE14:
 232:Src/spi_MEncoder.c ****   }
 233:Src/spi_MEncoder.c ****   /* USER CODE BEGIN SPI3_Init 2 */
 234:Src/spi_MEncoder.c **** 
 235:Src/spi_MEncoder.c ****   /* USER CODE END SPI3_Init 2 */
 236:Src/spi_MEncoder.c **** 
 237:Src/spi_MEncoder.c **** 	__HAL_SPI_ENABLE(&hspi3);
 442              		.loc 1 237 0
 443 0044 2268     		ldr	r2, [r4]
 444 0046 1368     		ldr	r3, [r2]
 445 0048 43F04003 		orr	r3, r3, #64
 446 004c 1360     		str	r3, [r2]
 238:Src/spi_MEncoder.c **** }
 447              		.loc 1 238 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 14


 448 004e 10BD     		pop	{r4, pc}
 449              	.L24:
 450              		.align	2
 451              	.L23:
 452 0050 003C0040 		.word	1073757184
 453 0054 00000000 		.word	hspi3
 454              		.cfi_endproc
 455              	.LFE335:
 457              		.section	.text.MX_TIM2_Init,"ax",%progbits
 458              		.align	1
 459              		.global	MX_TIM2_Init
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 463              		.fpu fpv4-sp-d16
 465              	MX_TIM2_Init:
 466              	.LFB336:
 239:Src/spi_MEncoder.c **** 
 240:Src/spi_MEncoder.c **** 
 241:Src/spi_MEncoder.c **** 
 242:Src/spi_MEncoder.c **** 
 243:Src/spi_MEncoder.c **** 
 244:Src/spi_MEncoder.c **** 
 245:Src/spi_MEncoder.c **** /**
 246:Src/spi_MEncoder.c ****   * @brief TIM2 Initialization Function
 247:Src/spi_MEncoder.c ****   * @param None
 248:Src/spi_MEncoder.c ****   * @retval None
 249:Src/spi_MEncoder.c ****   */
 250:Src/spi_MEncoder.c **** void MX_TIM2_Init(void)
 251:Src/spi_MEncoder.c **** {
 467              		.loc 1 251 0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 48
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471 0000 30B5     		push	{r4, r5, lr}
 472              	.LCFI8:
 473              		.cfi_def_cfa_offset 12
 474              		.cfi_offset 4, -12
 475              		.cfi_offset 5, -8
 476              		.cfi_offset 14, -4
 252:Src/spi_MEncoder.c **** 
 253:Src/spi_MEncoder.c ****   /* USER CODE BEGIN TIM2_Init 0 */
 254:Src/spi_MEncoder.c **** 
 255:Src/spi_MEncoder.c ****   /* USER CODE END TIM2_Init 0 */
 256:Src/spi_MEncoder.c **** 
 257:Src/spi_MEncoder.c ****   TIM_ClockConfigTypeDef sClockSourceConfig = {0};
 477              		.loc 1 257 0
 478 0002 1022     		movs	r2, #16
 251:Src/spi_MEncoder.c **** 
 479              		.loc 1 251 0
 480 0004 8DB0     		sub	sp, sp, #52
 481              	.LCFI9:
 482              		.cfi_def_cfa_offset 64
 258:Src/spi_MEncoder.c ****   TIM_MasterConfigTypeDef sMasterConfig = {0};
 483              		.loc 1 258 0
 484 0006 0025     		movs	r5, #0
 257:Src/spi_MEncoder.c ****   TIM_MasterConfigTypeDef sMasterConfig = {0};
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 15


 485              		.loc 1 257 0
 486 0008 0021     		movs	r1, #0
 487 000a 0DEB0200 		add	r0, sp, r2
 488 000e FFF7FEFF 		bl	memset
 489              	.LVL20:
 259:Src/spi_MEncoder.c ****   TIM_IC_InitTypeDef sConfigIC = {0};
 260:Src/spi_MEncoder.c **** 
 261:Src/spi_MEncoder.c ****   /* USER CODE BEGIN TIM2_Init 1 */
 262:Src/spi_MEncoder.c **** 
 263:Src/spi_MEncoder.c ****   /* USER CODE END TIM2_Init 1 */
 264:Src/spi_MEncoder.c ****   htim2.Instance = TIM2;
 490              		.loc 1 264 0
 491 0012 344C     		ldr	r4, .L58
 258:Src/spi_MEncoder.c ****   TIM_IC_InitTypeDef sConfigIC = {0};
 492              		.loc 1 258 0
 493 0014 0395     		str	r5, [sp, #12]
 259:Src/spi_MEncoder.c ****   TIM_IC_InitTypeDef sConfigIC = {0};
 494              		.loc 1 259 0
 495 0016 1022     		movs	r2, #16
 496 0018 2946     		mov	r1, r5
 497 001a 08A8     		add	r0, sp, #32
 258:Src/spi_MEncoder.c ****   TIM_IC_InitTypeDef sConfigIC = {0};
 498              		.loc 1 258 0
 499 001c CDE90155 		strd	r5, r5, [sp, #4]
 259:Src/spi_MEncoder.c ****   TIM_IC_InitTypeDef sConfigIC = {0};
 500              		.loc 1 259 0
 501 0020 FFF7FEFF 		bl	memset
 502              	.LVL21:
 265:Src/spi_MEncoder.c ****   htim2.Init.Prescaler = 167;
 503              		.loc 1 265 0
 504 0024 A723     		movs	r3, #167
 505 0026 4FF08042 		mov	r2, #1073741824
 506 002a C4E90023 		strd	r2, r3, [r4]
 266:Src/spi_MEncoder.c ****   htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
 267:Src/spi_MEncoder.c ****   htim2.Init.Period =0xffff;
 268:Src/spi_MEncoder.c ****   htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
 269:Src/spi_MEncoder.c ****   htim2.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
 270:Src/spi_MEncoder.c ****   if (HAL_TIM_Base_Init(&htim2) != HAL_OK)
 507              		.loc 1 270 0
 508 002e 2046     		mov	r0, r4
 267:Src/spi_MEncoder.c ****   htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
 509              		.loc 1 267 0
 510 0030 4FF6FF73 		movw	r3, #65535
 266:Src/spi_MEncoder.c ****   htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
 511              		.loc 1 266 0
 512 0034 A560     		str	r5, [r4, #8]
 268:Src/spi_MEncoder.c ****   htim2.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
 513              		.loc 1 268 0
 514 0036 C4E90335 		strd	r3, r5, [r4, #12]
 269:Src/spi_MEncoder.c ****   if (HAL_TIM_Base_Init(&htim2) != HAL_OK)
 515              		.loc 1 269 0
 516 003a A561     		str	r5, [r4, #24]
 517              		.loc 1 270 0
 518 003c FFF7FEFF 		bl	HAL_TIM_Base_Init
 519              	.LVL22:
 520 0040 08B1     		cbz	r0, .L26
 521              	.LBB15:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 16


 271:Src/spi_MEncoder.c ****   {
 272:Src/spi_MEncoder.c ****     Error_Handler();
 522              		.loc 1 272 0
 523 0042 FFF7FEFF 		bl	Error_Handler
 524              	.LVL23:
 525              	.L26:
 526              	.LBE15:
 273:Src/spi_MEncoder.c ****   }
 274:Src/spi_MEncoder.c ****   sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
 527              		.loc 1 274 0
 528 0046 4FF48053 		mov	r3, #4096
 275:Src/spi_MEncoder.c ****   if (HAL_TIM_ConfigClockSource(&htim2, &sClockSourceConfig) != HAL_OK)
 529              		.loc 1 275 0
 530 004a 04A9     		add	r1, sp, #16
 531 004c 2548     		ldr	r0, .L58
 274:Src/spi_MEncoder.c ****   if (HAL_TIM_ConfigClockSource(&htim2, &sClockSourceConfig) != HAL_OK)
 532              		.loc 1 274 0
 533 004e 0493     		str	r3, [sp, #16]
 534              		.loc 1 275 0
 535 0050 FFF7FEFF 		bl	HAL_TIM_ConfigClockSource
 536              	.LVL24:
 537 0054 08B1     		cbz	r0, .L27
 538              	.LBB16:
 276:Src/spi_MEncoder.c ****   {
 277:Src/spi_MEncoder.c ****     Error_Handler();
 539              		.loc 1 277 0
 540 0056 FFF7FEFF 		bl	Error_Handler
 541              	.LVL25:
 542              	.L27:
 543              	.LBE16:
 278:Src/spi_MEncoder.c ****   }
 279:Src/spi_MEncoder.c ****   if (HAL_TIM_IC_Init(&htim2) != HAL_OK)
 544              		.loc 1 279 0
 545 005a 2248     		ldr	r0, .L58
 546 005c FFF7FEFF 		bl	HAL_TIM_IC_Init
 547              	.LVL26:
 548 0060 08B1     		cbz	r0, .L28
 549              	.LBB17:
 280:Src/spi_MEncoder.c ****   {
 281:Src/spi_MEncoder.c ****     Error_Handler();
 550              		.loc 1 281 0
 551 0062 FFF7FEFF 		bl	Error_Handler
 552              	.LVL27:
 553              	.L28:
 554              	.LBE17:
 282:Src/spi_MEncoder.c ****   }
 283:Src/spi_MEncoder.c ****   sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
 555              		.loc 1 283 0
 556 0066 0023     		movs	r3, #0
 284:Src/spi_MEncoder.c ****   sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
 285:Src/spi_MEncoder.c ****   if (HAL_TIMEx_MasterConfigSynchronization(&htim2, &sMasterConfig) != HAL_OK)
 557              		.loc 1 285 0
 558 0068 01A9     		add	r1, sp, #4
 559 006a 1E48     		ldr	r0, .L58
 283:Src/spi_MEncoder.c ****   sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
 560              		.loc 1 283 0
 561 006c 0193     		str	r3, [sp, #4]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 17


 284:Src/spi_MEncoder.c ****   sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
 562              		.loc 1 284 0
 563 006e 0393     		str	r3, [sp, #12]
 564              		.loc 1 285 0
 565 0070 FFF7FEFF 		bl	HAL_TIMEx_MasterConfigSynchronization
 566              	.LVL28:
 567 0074 08B1     		cbz	r0, .L29
 568              	.LBB18:
 286:Src/spi_MEncoder.c ****   {
 287:Src/spi_MEncoder.c ****     Error_Handler();
 569              		.loc 1 287 0
 570 0076 FFF7FEFF 		bl	Error_Handler
 571              	.LVL29:
 572              	.L29:
 573              	.LBE18:
 288:Src/spi_MEncoder.c ****   }
 289:Src/spi_MEncoder.c ****   sConfigIC.ICPolarity = TIM_INPUTCHANNELPOLARITY_BOTHEDGE;
 290:Src/spi_MEncoder.c ****   sConfigIC.ICSelection = TIM_ICSELECTION_TRC;
 574              		.loc 1 290 0
 575 007a 0A21     		movs	r1, #10
 576 007c 0322     		movs	r2, #3
 291:Src/spi_MEncoder.c ****   sConfigIC.ICPrescaler = TIM_ICPSC_DIV1;
 292:Src/spi_MEncoder.c ****   sConfigIC.ICFilter = 15;
 577              		.loc 1 292 0
 578 007e 0025     		movs	r5, #0
 579 0080 0F23     		movs	r3, #15
 293:Src/spi_MEncoder.c **** 	
 294:Src/spi_MEncoder.c **** 	TIM_TI1_SetConfig(htim2.Instance, sConfigIC.ICPolarity, TIM_ICSELECTION_TRC, sConfigIC.ICFilter);
 580              		.loc 1 294 0
 581 0082 2068     		ldr	r0, [r4]
 290:Src/spi_MEncoder.c ****   sConfigIC.ICPrescaler = TIM_ICPSC_DIV1;
 582              		.loc 1 290 0
 583 0084 CDE90812 		strd	r1, r2, [sp, #32]
 292:Src/spi_MEncoder.c **** 	
 584              		.loc 1 292 0
 585 0088 CDE90A53 		strd	r5, r3, [sp, #40]
 586              		.loc 1 294 0
 587 008c FFF7FEFF 		bl	TIM_TI1_SetConfig
 588              	.LVL30:
 295:Src/spi_MEncoder.c ****   if (HAL_TIM_IC_ConfigChannel(&htim2, &sConfigIC, TIM_CHANNEL_1) != HAL_OK)
 589              		.loc 1 295 0
 590 0090 2A46     		mov	r2, r5
 591 0092 08A9     		add	r1, sp, #32
 592 0094 1348     		ldr	r0, .L58
 593 0096 FFF7FEFF 		bl	HAL_TIM_IC_ConfigChannel
 594              	.LVL31:
 595 009a 08B1     		cbz	r0, .L30
 596              	.LBB19:
 296:Src/spi_MEncoder.c ****   {
 297:Src/spi_MEncoder.c ****     Error_Handler();
 597              		.loc 1 297 0
 598 009c FFF7FEFF 		bl	Error_Handler
 599              	.LVL32:
 600              	.L30:
 601              	.LBE19:
 298:Src/spi_MEncoder.c ****   }
 299:Src/spi_MEncoder.c ****   if (HAL_TIM_IC_ConfigChannel(&htim2, &sConfigIC, TIM_CHANNEL_2) != HAL_OK)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 18


 602              		.loc 1 299 0
 603 00a0 0422     		movs	r2, #4
 604 00a2 08A9     		add	r1, sp, #32
 605 00a4 0F48     		ldr	r0, .L58
 606 00a6 FFF7FEFF 		bl	HAL_TIM_IC_ConfigChannel
 607              	.LVL33:
 608 00aa 08B1     		cbz	r0, .L31
 609              	.LBB20:
 300:Src/spi_MEncoder.c ****   {
 301:Src/spi_MEncoder.c ****     Error_Handler();
 610              		.loc 1 301 0
 611 00ac FFF7FEFF 		bl	Error_Handler
 612              	.LVL34:
 613              	.L31:
 614              	.LBE20:
 302:Src/spi_MEncoder.c ****   }
 303:Src/spi_MEncoder.c ****   if (HAL_TIM_IC_ConfigChannel(&htim2, &sConfigIC, TIM_CHANNEL_3) != HAL_OK)
 615              		.loc 1 303 0
 616 00b0 0822     		movs	r2, #8
 617 00b2 08A9     		add	r1, sp, #32
 618 00b4 0B48     		ldr	r0, .L58
 619 00b6 FFF7FEFF 		bl	HAL_TIM_IC_ConfigChannel
 620              	.LVL35:
 621 00ba 08B1     		cbz	r0, .L32
 622              	.LBB21:
 304:Src/spi_MEncoder.c ****   {
 305:Src/spi_MEncoder.c ****     Error_Handler();
 623              		.loc 1 305 0
 624 00bc FFF7FEFF 		bl	Error_Handler
 625              	.LVL36:
 626              	.L32:
 627              	.LBE21:
 306:Src/spi_MEncoder.c ****   }
 307:Src/spi_MEncoder.c **** 	
 308:Src/spi_MEncoder.c ****   if (HAL_TIM_ConfigTI1Input(&htim2, TIM_TI1SELECTION_XORCOMBINATION) != HAL_OK)
 628              		.loc 1 308 0
 629 00c0 8021     		movs	r1, #128
 630 00c2 0848     		ldr	r0, .L58
 631 00c4 FFF7FEFF 		bl	HAL_TIM_ConfigTI1Input
 632              	.LVL37:
 633 00c8 08B1     		cbz	r0, .L33
 634              	.LBB22:
 309:Src/spi_MEncoder.c ****   {
 310:Src/spi_MEncoder.c ****     Error_Handler();
 635              		.loc 1 310 0
 636 00ca FFF7FEFF 		bl	Error_Handler
 637              	.LVL38:
 638              	.L33:
 639              	.LBE22:
 311:Src/spi_MEncoder.c ****   }
 312:Src/spi_MEncoder.c **** 	
 313:Src/spi_MEncoder.c **** 	htim2.Instance->SMCR |= TIM_TS_TI1F_ED; // select "ti1f_ed" input trigger 
 640              		.loc 1 313 0
 641 00ce 2068     		ldr	r0, [r4]
 642 00d0 8368     		ldr	r3, [r0, #8]
 643 00d2 43F04003 		orr	r3, r3, #64
 644 00d6 8360     		str	r3, [r0, #8]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 19


 314:Src/spi_MEncoder.c **** 	TIM_CCxChannelCmd(htim2.Instance, TIM_CHANNEL_1, TIM_CCx_ENABLE);
 645              		.loc 1 314 0
 646 00d8 0122     		movs	r2, #1
 647 00da 0021     		movs	r1, #0
 648 00dc FFF7FEFF 		bl	TIM_CCxChannelCmd
 649              	.LVL39:
 315:Src/spi_MEncoder.c ****   
 316:Src/spi_MEncoder.c ****   /* USER CODE BEGIN TIM2_Init 2 */
 317:Src/spi_MEncoder.c **** 
 318:Src/spi_MEncoder.c ****   /* USER CODE END TIM2_Init 2 */
 319:Src/spi_MEncoder.c **** 
 320:Src/spi_MEncoder.c **** }
 650              		.loc 1 320 0
 651 00e0 0DB0     		add	sp, sp, #52
 652              	.LCFI10:
 653              		.cfi_def_cfa_offset 12
 654              		@ sp needed
 655 00e2 30BD     		pop	{r4, r5, pc}
 656              	.L59:
 657              		.align	2
 658              	.L58:
 659 00e4 00000000 		.word	htim2
 660              		.cfi_endproc
 661              	.LFE336:
 663              		.section	.text.hall_Configuration,"ax",%progbits
 664              		.align	1
 665              		.global	hall_Configuration
 666              		.syntax unified
 667              		.thumb
 668              		.thumb_func
 669              		.fpu fpv4-sp-d16
 671              	hall_Configuration:
 672              	.LFB337:
 321:Src/spi_MEncoder.c **** 
 322:Src/spi_MEncoder.c **** 
 323:Src/spi_MEncoder.c **** void hall_Configuration(void)
 324:Src/spi_MEncoder.c **** {
 673              		.loc 1 324 0
 674              		.cfi_startproc
 675              		@ args = 0, pretend = 0, frame = 0
 676              		@ frame_needed = 0, uses_anonymous_args = 0
 677 0000 08B5     		push	{r3, lr}
 678              	.LCFI11:
 679              		.cfi_def_cfa_offset 8
 680              		.cfi_offset 3, -8
 681              		.cfi_offset 14, -4
 325:Src/spi_MEncoder.c **** 	
 326:Src/spi_MEncoder.c **** 	MX_TIM2_Init();
 682              		.loc 1 326 0
 683 0002 FFF7FEFF 		bl	MX_TIM2_Init
 684              	.LVL40:
 327:Src/spi_MEncoder.c **** 	TIM2->CR1 |= TIM_AUTORELOAD_PRELOAD_ENABLE;
 685              		.loc 1 327 0
 686 0006 4FF08042 		mov	r2, #1073741824
 687 000a 1368     		ldr	r3, [r2]
 688 000c 43F08003 		orr	r3, r3, #128
 689 0010 1360     		str	r3, [r2]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 20


 328:Src/spi_MEncoder.c **** 
 329:Src/spi_MEncoder.c **** 	 __HAL_TIM_ENABLE(&htim2);
 690              		.loc 1 329 0
 691 0012 034B     		ldr	r3, .L61
 692 0014 1A68     		ldr	r2, [r3]
 693 0016 1368     		ldr	r3, [r2]
 694 0018 43F00103 		orr	r3, r3, #1
 695 001c 1360     		str	r3, [r2]
 330:Src/spi_MEncoder.c **** }
 696              		.loc 1 330 0
 697 001e 08BD     		pop	{r3, pc}
 698              	.L62:
 699              		.align	2
 700              	.L61:
 701 0020 00000000 		.word	htim2
 702              		.cfi_endproc
 703              	.LFE337:
 705              		.section	.text.MTPro,"ax",%progbits
 706              		.align	1
 707              		.global	MTPro
 708              		.syntax unified
 709              		.thumb
 710              		.thumb_func
 711              		.fpu fpv4-sp-d16
 713              	MTPro:
 714              	.LFB338:
 331:Src/spi_MEncoder.c **** 
 332:Src/spi_MEncoder.c **** 
 333:Src/spi_MEncoder.c **** 
 334:Src/spi_MEncoder.c **** volatile s32 Encoder_Current = 0;							// ��ǰ����������ֵ
 335:Src/spi_MEncoder.c **** volatile s32 Encoder_Last = 0;   							// ��ǰ����������ֵ
 336:Src/spi_MEncoder.c **** volatile s32 Encoder_Inc = 0;   							// ����������ֵ�仯��
 337:Src/spi_MEncoder.c **** volatile s32 s_SpeedTimeAdd1 = 0;   					// ����������ֵ�仯��
 338:Src/spi_MEncoder.c **** volatile s32 s_ForecastTimeAdd1 = 0;   				// ����������ֵ�仯��
 339:Src/spi_MEncoder.c **** volatile s32 speed_def[2] = {64,0};
 340:Src/spi_MEncoder.c **** volatile s32 speed_TCal = 0;									//T����õ��ٶ�
 341:Src/spi_MEncoder.c **** volatile s32 speed_MCal = 0;									//M������ٶ�
 342:Src/spi_MEncoder.c **** volatile s32 s_IntNum1 = 0; 									// 	��ֵ(����)����
 343:Src/spi_MEncoder.c **** volatile s32 s_ForecastCnt1 = 1;							//	Ԥ�����
 344:Src/spi_MEncoder.c **** volatile s32 g_CurrentSpeed = 0;
 345:Src/spi_MEncoder.c **** 
 346:Src/spi_MEncoder.c **** volatile s32 start_speed_sample = 0;
 347:Src/spi_MEncoder.c **** 
 348:Src/spi_MEncoder.c **** extern  volatile int speed1,speed2,speed3;
 349:Src/spi_MEncoder.c **** extern  volatile  int pid_hall_ture_value1;
 350:Src/spi_MEncoder.c **** extern  volatile  int pid_last_hall_ture_value1;
 351:Src/spi_MEncoder.c **** 
 352:Src/spi_MEncoder.c **** extern volatile int hall_speed_sample_timeout_cnt; //���㵽30ms
 353:Src/spi_MEncoder.c **** extern volatile int  hall_speed_sample_cnt;
 354:Src/spi_MEncoder.c **** extern volatile int hall_speed_sample_timeout;
 355:Src/spi_MEncoder.c **** extern volatile int hall_cnt;
 356:Src/spi_MEncoder.c **** 
 357:Src/spi_MEncoder.c **** extern volatile int hall_now_time;
 358:Src/spi_MEncoder.c **** extern volatile int hall_previous_1_time;
 359:Src/spi_MEncoder.c **** extern volatile int hall_previous_2_time;
 360:Src/spi_MEncoder.c **** extern volatile int hall_previous_3_time ;
 361:Src/spi_MEncoder.c **** extern volatile int64_t Vel_PPS_raw1 ;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 21


 362:Src/spi_MEncoder.c **** void MTPro(void) //10KHz ִ��
 363:Src/spi_MEncoder.c **** {
 715              		.loc 1 363 0
 716              		.cfi_startproc
 717              		@ args = 0, pretend = 0, frame = 0
 718              		@ frame_needed = 0, uses_anonymous_args = 0
 719              		@ link register save eliminated.
 720              	.LVL41:
 364:Src/spi_MEncoder.c **** 	
 365:Src/spi_MEncoder.c **** 	int64_t s_SpeedTimeAdd11=0;
 366:Src/spi_MEncoder.c **** 
 367:Src/spi_MEncoder.c **** 	
 368:Src/spi_MEncoder.c **** 	int speed;
 369:Src/spi_MEncoder.c **** 
 370:Src/spi_MEncoder.c **** 		#if 0 
 371:Src/spi_MEncoder.c **** 		
 372:Src/spi_MEncoder.c **** 		//	g_CmdMap[CMD_SPDREG_REF_PU] = (s16)((((int64_t)Vel_PPS_raw1)<<22)/((int64_t)*g_pVel_ref_base_P
 373:Src/spi_MEncoder.c **** 		speed = (s16)((((int64_t)Vel_PPS_raw1)<<22)/((int64_t)*g_pVel_ref_base_PPS));
 374:Src/spi_MEncoder.c **** 
 375:Src/spi_MEncoder.c **** 
 376:Src/spi_MEncoder.c **** 		g_CmdMap[CMD_SPD_ACT_PU] =speed; 
 377:Src/spi_MEncoder.c **** 		
 378:Src/spi_MEncoder.c **** 		#endif
 379:Src/spi_MEncoder.c **** 
 380:Src/spi_MEncoder.c **** 			
 381:Src/spi_MEncoder.c **** }
 721              		.loc 1 381 0
 722 0000 7047     		bx	lr
 723              		.cfi_endproc
 724              	.LFE338:
 726              		.section	.text.Pll_phase,"ax",%progbits
 727              		.align	1
 728              		.global	Pll_phase
 729              		.syntax unified
 730              		.thumb
 731              		.thumb_func
 732              		.fpu fpv4-sp-d16
 734              	Pll_phase:
 735              	.LFB339:
 382:Src/spi_MEncoder.c **** 
 383:Src/spi_MEncoder.c **** float pll_estimated_phase = 0;
 384:Src/spi_MEncoder.c **** float  pll_estimated_spd = 0;
 385:Src/spi_MEncoder.c **** 
 386:Src/spi_MEncoder.c **** float  pll_pid_integ = 0;
 387:Src/spi_MEncoder.c **** float pll_pid_out = 0;
 388:Src/spi_MEncoder.c **** 
 389:Src/spi_MEncoder.c **** volatile int estimated_SPD_filterd = 0;
 390:Src/spi_MEncoder.c **** int g_measured_phase = 0;
 391:Src/spi_MEncoder.c **** #define  FILTER_SIZE   24
 392:Src/spi_MEncoder.c **** int temp_spd_index  = 0;
 393:Src/spi_MEncoder.c **** int temp_spd[FILTER_SIZE] ={0};
 394:Src/spi_MEncoder.c **** int temp_spd_filed[FILTER_SIZE] ={0};
 395:Src/spi_MEncoder.c **** 
 396:Src/spi_MEncoder.c **** int pll_pid_integ_int = 0;
 397:Src/spi_MEncoder.c **** int estimated_phase_integ_int = 0;
 398:Src/spi_MEncoder.c **** float estimated_phase_integ_int_1 = 0;
 399:Src/spi_MEncoder.c **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 22


 400:Src/spi_MEncoder.c **** void Pll_phase(s16 measured_phase, float *estimated_phase, float *estimated_spd )
 401:Src/spi_MEncoder.c **** {
 736              		.loc 1 401 0
 737              		.cfi_startproc
 738              		@ args = 0, pretend = 0, frame = 0
 739              		@ frame_needed = 0, uses_anonymous_args = 0
 740              	.LVL42:
 741 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 742              	.LCFI12:
 743              		.cfi_def_cfa_offset 20
 744              		.cfi_offset 4, -20
 745              		.cfi_offset 5, -16
 746              		.cfi_offset 6, -12
 747              		.cfi_offset 7, -8
 748              		.cfi_offset 14, -4
 402:Src/spi_MEncoder.c **** 	float phase_erro;
 403:Src/spi_MEncoder.c **** 	int estimated_spd_1 = 0;
 404:Src/spi_MEncoder.c **** 	
 405:Src/spi_MEncoder.c **** 	
 406:Src/spi_MEncoder.c **** 	static int cnt  =0;
 407:Src/spi_MEncoder.c **** 	cnt++;
 749              		.loc 1 407 0
 750 0002 634C     		ldr	r4, .L84
 751 0004 2368     		ldr	r3, [r4]
 752 0006 0133     		adds	r3, r3, #1
 408:Src/spi_MEncoder.c **** 	if(cnt ==4)
 753              		.loc 1 408 0
 754 0008 042B     		cmp	r3, #4
 755 000a 01D0     		beq	.L65
 407:Src/spi_MEncoder.c **** 	if(cnt ==4)
 756              		.loc 1 407 0
 757 000c 2360     		str	r3, [r4]
 758              	.LVL43:
 759              	.L64:
 409:Src/spi_MEncoder.c **** 	{
 410:Src/spi_MEncoder.c **** 		cnt = 0;
 411:Src/spi_MEncoder.c **** 		
 412:Src/spi_MEncoder.c **** 	if( measured_phase > 16384 )
 413:Src/spi_MEncoder.c **** 	{
 414:Src/spi_MEncoder.c **** 		measured_phase = measured_phase - 32768;
 415:Src/spi_MEncoder.c **** 	}
 416:Src/spi_MEncoder.c **** 		if( measured_phase < -16384 )
 417:Src/spi_MEncoder.c **** 	{
 418:Src/spi_MEncoder.c **** 		measured_phase = measured_phase + 32768;
 419:Src/spi_MEncoder.c **** 	}
 420:Src/spi_MEncoder.c **** 
 421:Src/spi_MEncoder.c **** 	
 422:Src/spi_MEncoder.c **** 
 423:Src/spi_MEncoder.c **** 	
 424:Src/spi_MEncoder.c **** 	phase_erro = measured_phase - *estimated_phase;
 425:Src/spi_MEncoder.c **** 	
 426:Src/spi_MEncoder.c **** 	if( phase_erro > 16384 )
 427:Src/spi_MEncoder.c **** 	{
 428:Src/spi_MEncoder.c **** 		phase_erro = phase_erro - 32768;
 429:Src/spi_MEncoder.c **** 	}	
 430:Src/spi_MEncoder.c **** 	if( phase_erro < -16384 )
 431:Src/spi_MEncoder.c **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 23


 432:Src/spi_MEncoder.c **** 		phase_erro = phase_erro + 32768;
 433:Src/spi_MEncoder.c **** 	}	
 434:Src/spi_MEncoder.c **** 	pll_pid_integ_int = pll_pid_integ_int + phase_erro;
 435:Src/spi_MEncoder.c **** 	
 436:Src/spi_MEncoder.c **** 	
 437:Src/spi_MEncoder.c **** //	pll_pid_integ = pll_pid_integ + phase_erro *0.0001;
 438:Src/spi_MEncoder.c **** 	pll_pid_integ = pll_pid_integ_int /10000;
 439:Src/spi_MEncoder.c **** 	
 440:Src/spi_MEncoder.c **** 	*estimated_spd =  ( 2000*phase_erro + 100000*pll_pid_integ);
 441:Src/spi_MEncoder.c **** 	
 442:Src/spi_MEncoder.c **** 	estimated_phase_integ_int = estimated_phase_integ_int + *estimated_spd ;
 443:Src/spi_MEncoder.c **** 	
 444:Src/spi_MEncoder.c **** 		if( estimated_phase_integ_int > 163840000 )
 445:Src/spi_MEncoder.c **** 	{
 446:Src/spi_MEncoder.c **** 		estimated_phase_integ_int =estimated_phase_integ_int - 327680000;
 447:Src/spi_MEncoder.c **** 	}
 448:Src/spi_MEncoder.c **** 		if( estimated_phase_integ_int < -163840000 )
 449:Src/spi_MEncoder.c **** 	{
 450:Src/spi_MEncoder.c **** 		estimated_phase_integ_int = estimated_phase_integ_int + 327680000;
 451:Src/spi_MEncoder.c **** 	}
 452:Src/spi_MEncoder.c **** 
 453:Src/spi_MEncoder.c **** 	
 454:Src/spi_MEncoder.c **** 	*estimated_phase = estimated_phase_integ_int /10000;
 455:Src/spi_MEncoder.c **** //	*estimated_phase  = *estimated_phase  + *estimated_spd * 0.0001;
 456:Src/spi_MEncoder.c **** //	*estimated_phase = estimated_phase_integ_int *0.0001;
 457:Src/spi_MEncoder.c **** 
 458:Src/spi_MEncoder.c **** //	if( estimated_phase_integ_int_1 > 16384 )
 459:Src/spi_MEncoder.c **** //	{
 460:Src/spi_MEncoder.c **** //		estimated_phase_integ_int_1 =estimated_phase_integ_int_1 - 32768;
 461:Src/spi_MEncoder.c **** //	}
 462:Src/spi_MEncoder.c **** //		if( estimated_phase_integ_int_1 < -16384 )
 463:Src/spi_MEncoder.c **** //	{
 464:Src/spi_MEncoder.c **** //		estimated_phase_integ_int_1 = estimated_phase_integ_int_1 + 32768;
 465:Src/spi_MEncoder.c **** //	}
 466:Src/spi_MEncoder.c **** 
 467:Src/spi_MEncoder.c **** 	
 468:Src/spi_MEncoder.c **** 	if( (int)*estimated_phase > 16384 )
 469:Src/spi_MEncoder.c **** 	{
 470:Src/spi_MEncoder.c **** 		*estimated_phase = *estimated_phase - 32768;
 471:Src/spi_MEncoder.c **** 	}
 472:Src/spi_MEncoder.c **** 		if( (int)*estimated_phase < -16384 )
 473:Src/spi_MEncoder.c **** 	{
 474:Src/spi_MEncoder.c **** 		*estimated_phase = *estimated_phase + 32768;
 475:Src/spi_MEncoder.c **** 	}
 476:Src/spi_MEncoder.c **** 	
 477:Src/spi_MEncoder.c **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1)
 478:Src/spi_MEncoder.c **** 	{
 479:Src/spi_MEncoder.c **** 		if(temp_spd_index < FILTER_SIZE)
 480:Src/spi_MEncoder.c **** 		{
 481:Src/spi_MEncoder.c **** 			temp_spd_filed[temp_spd_index] = estimated_SPD_filterd;
 482:Src/spi_MEncoder.c **** 			temp_spd[temp_spd_index++] = (int)*estimated_spd;
 483:Src/spi_MEncoder.c **** 		}
 484:Src/spi_MEncoder.c **** 		else
 485:Src/spi_MEncoder.c **** 			temp_spd_index = 0;
 486:Src/spi_MEncoder.c **** 			
 487:Src/spi_MEncoder.c **** 	}
 488:Src/spi_MEncoder.c **** 	else
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 24


 489:Src/spi_MEncoder.c **** 	{
 490:Src/spi_MEncoder.c **** 		temp_spd_index = 0;
 491:Src/spi_MEncoder.c **** 	}
 492:Src/spi_MEncoder.c **** 	
 493:Src/spi_MEncoder.c **** 	g_measured_phase = measured_phase;
 494:Src/spi_MEncoder.c **** 	
 495:Src/spi_MEncoder.c **** ///	estimated_spd_1 = ( (int)*estimated_spd ) / 2000;
 496:Src/spi_MEncoder.c **** 	estimated_spd_1 = ( (int)*estimated_spd )* 30 /23000;
 497:Src/spi_MEncoder.c **** 	estimated_SPD_filterd = ( (56*estimated_SPD_filterd) + ( 200*(int)(estimated_spd_1)) )>>8; ;
 498:Src/spi_MEncoder.c **** 	
 499:Src/spi_MEncoder.c **** 
 500:Src/spi_MEncoder.c **** //	estimated_SPD_filterd =(s16)((((int64_t)estimated_SPD_filterd)<<10)/((int64_t)*g_pVel_ref_base_P
 501:Src/spi_MEncoder.c **** //	g_CmdMap[CMD_SPD_ACT_PU] =  ( estimated_SPD_filterd /100) *100 ;
 502:Src/spi_MEncoder.c **** 	g_CmdMap[CMD_SPD_ACT_PU] =  estimated_SPD_filterd  ;
 503:Src/spi_MEncoder.c **** 
 504:Src/spi_MEncoder.c **** //	
 505:Src/spi_MEncoder.c **** }
 506:Src/spi_MEncoder.c **** }
 760              		.loc 1 506 0
 761 000e F0BD     		pop	{r4, r5, r6, r7, pc}
 762              	.LVL44:
 763              	.L65:
 410:Src/spi_MEncoder.c **** 		
 764              		.loc 1 410 0
 765 0010 0023     		movs	r3, #0
 766 0012 2360     		str	r3, [r4]
 412:Src/spi_MEncoder.c **** 	{
 767              		.loc 1 412 0
 768 0014 83B2     		uxth	r3, r0
 769 0016 03F58044 		add	r4, r3, #16384
 770 001a A4B2     		uxth	r4, r4
 771 001c B4F5004F 		cmp	r4, #32768
 414:Src/spi_MEncoder.c **** 	}
 772              		.loc 1 414 0
 773 0020 84BF     		itt	hi
 774 0022 A3F50040 		subhi	r0, r3, #32768
 775              	.LVL45:
 776 0026 00B2     		sxthhi	r0, r0
 777              	.LVL46:
 424:Src/spi_MEncoder.c **** 	
 778              		.loc 1 424 0
 779 0028 07EE100A 		vmov	s14, r0	@ int
 780 002c D1ED007A 		vldr.32	s15, [r1]
 434:Src/spi_MEncoder.c **** 	
 781              		.loc 1 434 0
 782 0030 584C     		ldr	r4, .L84+4
 440:Src/spi_MEncoder.c **** 	
 783              		.loc 1 440 0
 784 0032 DFED596A 		vldr.32	s13, .L84+8
 444:Src/spi_MEncoder.c **** 	{
 785              		.loc 1 444 0
 786 0036 594D     		ldr	r5, .L84+12
 424:Src/spi_MEncoder.c **** 	
 787              		.loc 1 424 0
 788 0038 B8EEC77A 		vcvt.f32.s32	s14, s14
 789 003c 37EE677A 		vsub.f32	s14, s14, s15
 790              	.LVL47:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 25


 426:Src/spi_MEncoder.c **** 	{
 791              		.loc 1 426 0
 792 0040 DFED577A 		vldr.32	s15, .L84+16
 793 0044 B4EEE77A 		vcmpe.f32	s14, s15
 794 0048 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 428:Src/spi_MEncoder.c **** 	}	
 795              		.loc 1 428 0
 796 004c C4BF     		itt	gt
 797 004e DFED557A 		vldrgt.32	s15, .L84+20
 798 0052 37EE677A 		vsubgt.f32	s14, s14, s15
 799              	.LVL48:
 430:Src/spi_MEncoder.c **** 	{
 800              		.loc 1 430 0
 801 0056 DFED547A 		vldr.32	s15, .L84+24
 802 005a B4EEE77A 		vcmpe.f32	s14, s15
 803 005e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 432:Src/spi_MEncoder.c **** 	}	
 804              		.loc 1 432 0
 805 0062 44BF     		itt	mi
 806 0064 DFED4F7A 		vldrmi.32	s15, .L84+20
 807 0068 37EE277A 		vaddmi.f32	s14, s14, s15
 808              	.LVL49:
 434:Src/spi_MEncoder.c **** 	
 809              		.loc 1 434 0
 810 006c D4ED007A 		vldr.32	s15, [r4]	@ int
 811 0070 F8EEE77A 		vcvt.f32.s32	s15, s15
 812 0074 77EE877A 		vadd.f32	s15, s15, s14
 813 0078 FDEEE77A 		vcvt.s32.f32	s15, s15
 814 007c 17EE903A 		vmov	r3, s15	@ int
 815 0080 C4ED007A 		vstr.32	s15, [r4]	@ int
 438:Src/spi_MEncoder.c **** 	
 816              		.loc 1 438 0
 817 0084 42F21074 		movw	r4, #10000
 818 0088 93FBF4F3 		sdiv	r3, r3, r4
 819 008c 07EE903A 		vmov	s15, r3	@ int
 820 0090 464B     		ldr	r3, .L84+28
 442:Src/spi_MEncoder.c **** 	
 821              		.loc 1 442 0
 822 0092 474C     		ldr	r4, .L84+32
 438:Src/spi_MEncoder.c **** 	
 823              		.loc 1 438 0
 824 0094 F8EEE77A 		vcvt.f32.s32	s15, s15
 825 0098 C3ED007A 		vstr.32	s15, [r3]
 440:Src/spi_MEncoder.c **** 	
 826              		.loc 1 440 0
 827 009c 67EEA67A 		vmul.f32	s15, s15, s13
 828 00a0 DFED446A 		vldr.32	s13, .L84+36
 829 00a4 E7EE267A 		vfma.f32	s15, s14, s13
 442:Src/spi_MEncoder.c **** 	
 830              		.loc 1 442 0
 831 00a8 94ED007A 		vldr.32	s14, [r4]	@ int
 832              	.LVL50:
 440:Src/spi_MEncoder.c **** 	
 833              		.loc 1 440 0
 834 00ac C2ED007A 		vstr.32	s15, [r2]
 442:Src/spi_MEncoder.c **** 	
 835              		.loc 1 442 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 26


 836 00b0 B8EEC77A 		vcvt.f32.s32	s14, s14
 837 00b4 77EE277A 		vadd.f32	s15, s14, s15
 838 00b8 FDEEE77A 		vcvt.s32.f32	s15, s15
 839 00bc 17EE903A 		vmov	r3, s15	@ int
 444:Src/spi_MEncoder.c **** 	{
 840              		.loc 1 444 0
 841 00c0 AB42     		cmp	r3, r5
 446:Src/spi_MEncoder.c **** 	}
 842              		.loc 1 446 0
 843 00c2 C4BF     		itt	gt
 844 00c4 03F16C43 		addgt	r3, r3, #-335544320
 845 00c8 03F5F003 		addgt	r3, r3, #7864320
 846 00cc 2360     		str	r3, [r4]
 448:Src/spi_MEncoder.c **** 	{
 847              		.loc 1 448 0
 848 00ce 2368     		ldr	r3, [r4]
 849 00d0 394D     		ldr	r5, .L84+40
 850 00d2 AB42     		cmp	r3, r5
 450:Src/spi_MEncoder.c **** 	}
 851              		.loc 1 450 0
 852 00d4 BEBF     		ittt	lt
 853 00d6 03F19C53 		addlt	r3, r3, #327155712
 854 00da 03F50023 		addlt	r3, r3, #524288
 855 00de 2360     		strlt	r3, [r4]
 454:Src/spi_MEncoder.c **** //	*estimated_phase  = *estimated_phase  + *estimated_spd * 0.0001;
 856              		.loc 1 454 0
 857 00e0 2368     		ldr	r3, [r4]
 858 00e2 364D     		ldr	r5, .L84+44
 859 00e4 42F21074 		movw	r4, #10000
 860 00e8 93FBF4F3 		sdiv	r3, r3, r4
 861 00ec 07EE903A 		vmov	s15, r3	@ int
 862 00f0 F8EEE77A 		vcvt.f32.s32	s15, s15
 468:Src/spi_MEncoder.c **** 	{
 863              		.loc 1 468 0
 864 00f4 BDEEE77A 		vcvt.s32.f32	s14, s15
 865 00f8 17EE103A 		vmov	r3, s14	@ int
 866 00fc B3F5804F 		cmp	r3, #16384
 470:Src/spi_MEncoder.c **** 	}
 867              		.loc 1 470 0
 868 0100 C4BF     		itt	gt
 869 0102 9FED287A 		vldrgt.32	s14, .L84+20
 870 0106 77EEC77A 		vsubgt.f32	s15, s15, s14
 871 010a C1ED007A 		vstr.32	s15, [r1]
 472:Src/spi_MEncoder.c **** 	{
 872              		.loc 1 472 0
 873 010e D1ED007A 		vldr.32	s15, [r1]
 874 0112 BDEEE77A 		vcvt.s32.f32	s14, s15
 875 0116 17EE103A 		vmov	r3, s14	@ int
 876 011a 13F5804F 		cmn	r3, #16384
 474:Src/spi_MEncoder.c **** 	}
 877              		.loc 1 474 0
 878 011e BEBF     		ittt	lt
 879 0120 9FED207A 		vldrlt.32	s14, .L84+20
 880 0124 77EE877A 		vaddlt.f32	s15, s15, s14
 881 0128 C1ED007A 		vstrlt.32	s15, [r1]
 477:Src/spi_MEncoder.c **** 	{
 882              		.loc 1 477 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 27


 883 012c 2449     		ldr	r1, .L84+48
 884              	.LVL51:
 885 012e D2ED007A 		vldr.32	s15, [r2]
 886 0132 B1F80242 		ldrh	r4, [r1, #514]
 887 0136 FDEEE77A 		vcvt.s32.f32	s15, s15
 888 013a 24B2     		sxth	r4, r4
 889 013c 012C     		cmp	r4, #1
 890 013e 17EE903A 		vmov	r3, s15	@ int
 891 0142 204C     		ldr	r4, .L84+52
 892 0144 20D1     		bne	.L78
 479:Src/spi_MEncoder.c **** 		{
 893              		.loc 1 479 0
 894 0146 2A68     		ldr	r2, [r5]
 895              	.LVL52:
 896 0148 172A     		cmp	r2, #23
 897 014a 1DDC     		bgt	.L78
 481:Src/spi_MEncoder.c **** 			temp_spd[temp_spd_index++] = (int)*estimated_spd;
 898              		.loc 1 481 0
 899 014c 1E4E     		ldr	r6, .L84+56
 900 014e 2768     		ldr	r7, [r4]
 901 0150 46F82270 		str	r7, [r6, r2, lsl #2]
 482:Src/spi_MEncoder.c **** 		}
 902              		.loc 1 482 0
 903 0154 561C     		adds	r6, r2, #1
 904 0156 2E60     		str	r6, [r5]
 905 0158 1C4D     		ldr	r5, .L84+60
 906 015a 45F82230 		str	r3, [r5, r2, lsl #2]
 907              	.L79:
 493:Src/spi_MEncoder.c **** 	
 908              		.loc 1 493 0
 909 015e 1C4A     		ldr	r2, .L84+64
 910 0160 1060     		str	r0, [r2]
 911              	.LVL53:
 497:Src/spi_MEncoder.c **** 	
 912              		.loc 1 497 0
 913 0162 2068     		ldr	r0, [r4]
 914              	.LVL54:
 496:Src/spi_MEncoder.c **** 	estimated_SPD_filterd = ( (56*estimated_SPD_filterd) + ( 200*(int)(estimated_spd_1)) )>>8; ;
 915              		.loc 1 496 0
 916 0164 1E22     		movs	r2, #30
 917 0166 5343     		muls	r3, r2, r3
 918              	.LVL55:
 919 0168 45F6D812 		movw	r2, #23000
 920 016c 93FBF2F3 		sdiv	r3, r3, r2
 921              	.LVL56:
 497:Src/spi_MEncoder.c **** 	
 922              		.loc 1 497 0
 923 0170 3822     		movs	r2, #56
 924 0172 4243     		muls	r2, r0, r2
 925 0174 C820     		movs	r0, #200
 926 0176 00FB0323 		mla	r3, r0, r3, r2
 927              	.LVL57:
 928 017a 1B12     		asrs	r3, r3, #8
 929 017c 2360     		str	r3, [r4]
 502:Src/spi_MEncoder.c **** 
 930              		.loc 1 502 0
 931 017e 2368     		ldr	r3, [r4]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 28


 932 0180 1BB2     		sxth	r3, r3
 933 0182 A1F85030 		strh	r3, [r1, #80]	@ movhi
 934              		.loc 1 506 0
 935 0186 42E7     		b	.L64
 936              	.LVL58:
 937              	.L78:
 485:Src/spi_MEncoder.c **** 			
 938              		.loc 1 485 0
 939 0188 0022     		movs	r2, #0
 940 018a 2A60     		str	r2, [r5]
 941 018c E7E7     		b	.L79
 942              	.L85:
 943 018e 00BF     		.align	2
 944              	.L84:
 945 0190 00000000 		.word	.LANCHOR0
 946 0194 00000000 		.word	.LANCHOR1
 947 0198 0050C347 		.word	1203982336
 948 019c 0000C409 		.word	163840000
 949 01a0 00008046 		.word	1182793728
 950 01a4 00000047 		.word	1191182336
 951 01a8 000080C6 		.word	-964689920
 952 01ac 00000000 		.word	.LANCHOR2
 953 01b0 00000000 		.word	.LANCHOR3
 954 01b4 0000FA44 		.word	1157234688
 955 01b8 00003CF6 		.word	-163840000
 956 01bc 00000000 		.word	.LANCHOR4
 957 01c0 00000000 		.word	g_CmdMap
 958 01c4 00000000 		.word	.LANCHOR5
 959 01c8 00000000 		.word	.LANCHOR6
 960 01cc 00000000 		.word	.LANCHOR7
 961 01d0 00000000 		.word	.LANCHOR8
 962              		.cfi_endproc
 963              	.LFE339:
 965              		.section	.text.GetElectricAngle,"ax",%progbits
 966              		.align	1
 967              		.global	GetElectricAngle
 968              		.syntax unified
 969              		.thumb
 970              		.thumb_func
 971              		.fpu fpv4-sp-d16
 973              	GetElectricAngle:
 974              	.LFB340:
 507:Src/spi_MEncoder.c **** 
 508:Src/spi_MEncoder.c **** 
 509:Src/spi_MEncoder.c **** 
 510:Src/spi_MEncoder.c **** int g_ElectricAngle_15bit_Last = 0;
 511:Src/spi_MEncoder.c **** int s_Encoder_Inc = 0;
 512:Src/spi_MEncoder.c **** 
 513:Src/spi_MEncoder.c **** int g_ElectricAngle_add = 0;
 514:Src/spi_MEncoder.c **** void GetElectricAngle(void)//50us ִ������
 515:Src/spi_MEncoder.c **** {		
 975              		.loc 1 515 0
 976              		.cfi_startproc
 977              		@ args = 0, pretend = 0, frame = 0
 978              		@ frame_needed = 0, uses_anonymous_args = 0
 979              	.LVL59:
 516:Src/spi_MEncoder.c **** 		static s32 count1 = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 29


 517:Src/spi_MEncoder.c **** 		s32 inc__MechanicsAngle_15bit = 0;
 518:Src/spi_MEncoder.c **** 		g_MechanicsAngle_15bit = (32768.f*(*motor_.phase_)/(2*M_PI));
 980              		.loc 1 518 0
 981 0000 3F4B     		ldr	r3, .L100
 982 0002 DFED407A 		vldr.32	s15, .L100+4
 983 0006 1B6F     		ldr	r3, [r3, #112]
 984 0008 DFED3F6A 		vldr.32	s13, .L100+8
 985 000c 93ED007A 		vldr.32	s14, [r3]
 986 0010 3E49     		ldr	r1, .L100+12
 519:Src/spi_MEncoder.c **** 		if(SPI3->DR == 0xFFFF)
 987              		.loc 1 519 0
 988 0012 3F4B     		ldr	r3, .L100+16
 518:Src/spi_MEncoder.c **** 		if(SPI3->DR == 0xFFFF)
 989              		.loc 1 518 0
 990 0014 27EE277A 		vmul.f32	s14, s14, s15
 515:Src/spi_MEncoder.c **** 		static s32 count1 = 0;
 991              		.loc 1 515 0
 992 0018 30B5     		push	{r4, r5, lr}
 993              	.LCFI13:
 994              		.cfi_def_cfa_offset 12
 995              		.cfi_offset 4, -12
 996              		.cfi_offset 5, -8
 997              		.cfi_offset 14, -4
 518:Src/spi_MEncoder.c **** 		if(SPI3->DR == 0xFFFF)
 998              		.loc 1 518 0
 999 001a C7EE267A 		vdiv.f32	s15, s14, s13
 1000 001e 3D4C     		ldr	r4, .L100+20
 1001 0020 FDEEE77A 		vcvt.s32.f32	s15, s15
 1002 0024 C1ED007A 		vstr.32	s15, [r1]	@ int
 1003              		.loc 1 519 0
 1004 0028 DA68     		ldr	r2, [r3, #12]
 1005 002a 4FF6FF73 		movw	r3, #65535
 1006 002e 9A42     		cmp	r2, r3
 518:Src/spi_MEncoder.c **** 		if(SPI3->DR == 0xFFFF)
 1007              		.loc 1 518 0
 1008 0030 17EE900A 		vmov	r0, s15	@ int
 1009 0034 384A     		ldr	r2, .L100+24
 1010              		.loc 1 519 0
 1011 0036 52D1     		bne	.L87
 520:Src/spi_MEncoder.c **** 		{
 521:Src/spi_MEncoder.c **** 			if(count1<50000)
 1012              		.loc 1 521 0
 1013 0038 1368     		ldr	r3, [r2]
 1014 003a 4CF24F35 		movw	r5, #49999
 1015 003e AB42     		cmp	r3, r5
 1016 0040 02DC     		bgt	.L88
 522:Src/spi_MEncoder.c **** 			{
 523:Src/spi_MEncoder.c **** 				count1++;
 1017              		.loc 1 523 0
 1018 0042 0133     		adds	r3, r3, #1
 1019              	.L98:
 524:Src/spi_MEncoder.c **** 			}
 525:Src/spi_MEncoder.c **** 			else
 526:Src/spi_MEncoder.c **** 			{
 527:Src/spi_MEncoder.c **** 				g_CmdMap[CMD_ERROR] |= ERROR_MASK_ENCODER_FAULT;
 528:Src/spi_MEncoder.c **** 			}
 529:Src/spi_MEncoder.c **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 30


 530:Src/spi_MEncoder.c **** 		else
 531:Src/spi_MEncoder.c **** 		{
 532:Src/spi_MEncoder.c **** 			count1 = 0;
 1020              		.loc 1 532 0
 1021 0044 1360     		str	r3, [r2]
 1022 0046 06E0     		b	.L89
 1023              	.L88:
 527:Src/spi_MEncoder.c **** 			}
 1024              		.loc 1 527 0
 1025 0048 B4F85430 		ldrh	r3, [r4, #84]
 1026 004c 1BB2     		sxth	r3, r3
 1027 004e 43F04003 		orr	r3, r3, #64
 1028 0052 A4F85430 		strh	r3, [r4, #84]	@ movhi
 1029              	.L89:
 533:Src/spi_MEncoder.c **** 		}
 534:Src/spi_MEncoder.c **** //		g_MechanicsAngle_15bit += g_CmdMap[CMD_SPD_ACT_PU]*500/16384;
 535:Src/spi_MEncoder.c **** //		g_MechanicsAngle_15bit &= 0x7fff;
 536:Src/spi_MEncoder.c **** //		
 537:Src/spi_MEncoder.c **** 		g_MechanicsAngle_15bit_last = g_MechanicsAngle_15bit;
 1030              		.loc 1 537 0
 1031 0056 314A     		ldr	r2, .L100+28
 1032 0058 0B68     		ldr	r3, [r1]
 1033 005a 1360     		str	r3, [r2]
 538:Src/spi_MEncoder.c **** 		inc__MechanicsAngle_15bit = g_MechanicsAngle_15bit - g_MechanicsAngle_15bit_last;
 1034              		.loc 1 538 0
 1035 005c 0B68     		ldr	r3, [r1]
 1036 005e 1268     		ldr	r2, [r2]
 1037 0060 9B1A     		subs	r3, r3, r2
 1038              	.LVL60:
 539:Src/spi_MEncoder.c **** 		if(inc__MechanicsAngle_15bit > 16384)
 1039              		.loc 1 539 0
 1040 0062 B3F5804F 		cmp	r3, #16384
 1041 0066 3CDD     		ble	.L90
 540:Src/spi_MEncoder.c **** 		{
 541:Src/spi_MEncoder.c **** 				inc__MechanicsAngle_15bit =  32768 - inc__MechanicsAngle_15bit;
 1042              		.loc 1 541 0
 1043 0068 C3F50043 		rsb	r3, r3, #32768
 1044              	.LVL61:
 1045              	.L91:
 542:Src/spi_MEncoder.c **** 		}
 543:Src/spi_MEncoder.c **** 		else if(inc__MechanicsAngle_15bit < -16384)
 544:Src/spi_MEncoder.c **** 		{
 545:Src/spi_MEncoder.c **** 				inc__MechanicsAngle_15bit =  32768 + inc__MechanicsAngle_15bit;
 546:Src/spi_MEncoder.c **** 		}
 547:Src/spi_MEncoder.c **** 		if(inc__MechanicsAngle_15bit > 8192)//�������쳣
 1046              		.loc 1 547 0
 1047 006c B3F5005F 		cmp	r3, #8192
 548:Src/spi_MEncoder.c **** 		{
 549:Src/spi_MEncoder.c **** 			g_CmdMap[CMD_ERROR] |= ERROR_MASK_ENCODER_FAULT;
 1048              		.loc 1 549 0
 1049 0070 C1BF     		itttt	gt
 1050 0072 B4F85430 		ldrhgt	r3, [r4, #84]
 1051              	.LVL62:
 1052 0076 1BB2     		sxthgt	r3, r3
 1053 0078 43F04003 		orrgt	r3, r3, #64
 1054 007c A4F85430 		strhgt	r3, [r4, #84]	@ movhi
 550:Src/spi_MEncoder.c **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 31


 551:Src/spi_MEncoder.c **** 		g_ElectricAngle_15bit_Raw = g_MechanicsAngle_15bit% EN_360;
 1055              		.loc 1 551 0
 1056 0080 274B     		ldr	r3, .L100+32
 1057 0082 0D68     		ldr	r5, [r1]
 1058 0084 B3F90020 		ldrsh	r2, [r3]
 1059 0088 95FBF2F3 		sdiv	r3, r5, r2
 1060 008c 02FB1353 		mls	r3, r2, r3, r5
 1061 0090 244D     		ldr	r5, .L100+36
 1062 0092 2B60     		str	r3, [r5]
 552:Src/spi_MEncoder.c **** 		g_ElectricAngle_act = (g_MechanicsAngle_15bit )% EN_360;
 1063              		.loc 1 552 0
 1064 0094 0968     		ldr	r1, [r1]
 1065 0096 91FBF2F3 		sdiv	r3, r1, r2
 1066 009a 02FB1313 		mls	r3, r2, r3, r1
 1067 009e 2249     		ldr	r1, .L100+40
 1068 00a0 0B60     		str	r3, [r1]
 553:Src/spi_MEncoder.c **** 		if(g_CmdMap[SYS_MOT_TEST] == 0)
 1069              		.loc 1 553 0
 1070 00a2 B4F81A52 		ldrh	r5, [r4, #538]
 1071 00a6 214B     		ldr	r3, .L100+44
 1072 00a8 2DB2     		sxth	r5, r5
 1073 00aa 05BB     		cbnz	r5, .L93
 554:Src/spi_MEncoder.c **** 		{										
 555:Src/spi_MEncoder.c **** 			g_ElectricAngle = g_ElectricAngle_act;
 1074              		.loc 1 555 0
 1075 00ac 0868     		ldr	r0, [r1]
 1076              	.L99:
 556:Src/spi_MEncoder.c **** 		}
 557:Src/spi_MEncoder.c **** 		else if(g_CmdMap[SYS_MOT_TEST] == 5)
 558:Src/spi_MEncoder.c **** 		{
 559:Src/spi_MEncoder.c **** 			g_ElectricAngle = (s16)(32768.f*(*motor_.phase_)/(2*M_PI));
 560:Src/spi_MEncoder.c **** 		}
 561:Src/spi_MEncoder.c **** 		else
 562:Src/spi_MEncoder.c **** 		{
 563:Src/spi_MEncoder.c **** 			g_ElectricAngle = g_ElectricAngle_sim;
 1077              		.loc 1 563 0
 1078 00ae 1860     		str	r0, [r3]
 564:Src/spi_MEncoder.c **** 		}
 565:Src/spi_MEncoder.c **** 	  if(g_ElectricAngle>=EN_360)
 1079              		.loc 1 565 0
 1080 00b0 1868     		ldr	r0, [r3]
 566:Src/spi_MEncoder.c **** 		{
 567:Src/spi_MEncoder.c **** 			g_ElectricAngle=g_ElectricAngle - EN_360;			
 568:Src/spi_MEncoder.c **** 		}
 569:Src/spi_MEncoder.c **** 		if(g_ElectricAngle<=EN_0)
 1081              		.loc 1 569 0
 1082 00b2 1F4C     		ldr	r4, .L100+48
 565:Src/spi_MEncoder.c **** 		{
 1083              		.loc 1 565 0
 1084 00b4 8242     		cmp	r2, r0
 567:Src/spi_MEncoder.c **** 		}
 1085              		.loc 1 567 0
 1086 00b6 D8BF     		it	le
 1087 00b8 1868     		ldrle	r0, [r3]
 1088              		.loc 1 569 0
 1089 00ba B4F90040 		ldrsh	r4, [r4]
 567:Src/spi_MEncoder.c **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 32


 1090              		.loc 1 567 0
 1091 00be DCBF     		itt	le
 1092 00c0 801A     		suble	r0, r0, r2
 1093 00c2 1860     		strle	r0, [r3]
 1094              		.loc 1 569 0
 1095 00c4 1868     		ldr	r0, [r3]
 1096 00c6 8442     		cmp	r4, r0
 570:Src/spi_MEncoder.c **** 		{
 571:Src/spi_MEncoder.c **** 			g_ElectricAngle=EN_360 + g_ElectricAngle;
 1097              		.loc 1 571 0
 1098 00c8 A2BF     		ittt	ge
 1099 00ca 1868     		ldrge	r0, [r3]
 1100 00cc 8018     		addge	r0, r0, r2
 1101 00ce 1860     		strge	r0, [r3]
 572:Src/spi_MEncoder.c **** 		}
 573:Src/spi_MEncoder.c **** 		g_ElectricAngle_15bit = (g_ElectricAngle_act<<15)/EN_360;// ��Ƕ�_32768
 1102              		.loc 1 573 0
 1103 00d0 0B68     		ldr	r3, [r1]
 1104 00d2 DB03     		lsls	r3, r3, #15
 1105 00d4 93FBF2F2 		sdiv	r2, r3, r2
 1106 00d8 164B     		ldr	r3, .L100+52
 1107 00da 1A60     		str	r2, [r3]
 574:Src/spi_MEncoder.c **** 		
 575:Src/spi_MEncoder.c **** 		
 576:Src/spi_MEncoder.c **** 		
 577:Src/spi_MEncoder.c **** 		
 578:Src/spi_MEncoder.c **** 		
 579:Src/spi_MEncoder.c **** //	s_cnt++;
 580:Src/spi_MEncoder.c **** 		
 581:Src/spi_MEncoder.c **** //	if(s_cnt == 4)
 582:Src/spi_MEncoder.c **** //	{
 583:Src/spi_MEncoder.c **** //		s_cnt = 0;
 584:Src/spi_MEncoder.c **** //		s_Encoder_Inc = (g_ElectricAngle_15bit - g_ElectricAngle_15bit_Last); 
 585:Src/spi_MEncoder.c **** //		g_ElectricAngle_15bit_Last = g_ElectricAngle_15bit;
 586:Src/spi_MEncoder.c **** //		
 587:Src/spi_MEncoder.c **** //		if (s_Encoder_Inc > 16384)    // ����ֵ��Խ���߽߱紦��
 588:Src/spi_MEncoder.c **** //			s_Encoder_Inc -= 32768;
 589:Src/spi_MEncoder.c **** //		else if (s_Encoder_Inc < -16384)
 590:Src/spi_MEncoder.c **** //			s_Encoder_Inc += 32768;  
 591:Src/spi_MEncoder.c **** //		
 592:Src/spi_MEncoder.c **** //	//	speed_based_encoder = s_Encoder_Inc * 60*  1000000  /180   / 23000; 
 593:Src/spi_MEncoder.c **** //	}
 594:Src/spi_MEncoder.c **** //		
 595:Src/spi_MEncoder.c **** }
 1108              		.loc 1 595 0
 1109 00dc 30BD     		pop	{r4, r5, pc}
 1110              	.LVL63:
 1111              	.L87:
 532:Src/spi_MEncoder.c **** 		}
 1112              		.loc 1 532 0
 1113 00de 0023     		movs	r3, #0
 1114 00e0 B0E7     		b	.L98
 1115              	.LVL64:
 1116              	.L90:
 543:Src/spi_MEncoder.c **** 		{
 1117              		.loc 1 543 0
 1118 00e2 13F5804F 		cmn	r3, #16384
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 33


 545:Src/spi_MEncoder.c **** 		}
 1119              		.loc 1 545 0
 1120 00e6 B8BF     		it	lt
 1121 00e8 03F50043 		addlt	r3, r3, #32768
 1122              	.LVL65:
 1123 00ec BEE7     		b	.L91
 1124              	.LVL66:
 1125              	.L93:
 557:Src/spi_MEncoder.c **** 		{
 1126              		.loc 1 557 0
 1127 00ee B4F81A42 		ldrh	r4, [r4, #538]
 1128 00f2 24B2     		sxth	r4, r4
 1129 00f4 052C     		cmp	r4, #5
 563:Src/spi_MEncoder.c **** 		}
 1130              		.loc 1 563 0
 1131 00f6 16BF     		itet	ne
 1132 00f8 0F48     		ldrne	r0, .L100+56
 559:Src/spi_MEncoder.c **** 		}
 1133              		.loc 1 559 0
 1134 00fa 00B2     		sxtheq	r0, r0
 563:Src/spi_MEncoder.c **** 		}
 1135              		.loc 1 563 0
 1136 00fc 0068     		ldrne	r0, [r0]
 1137 00fe D6E7     		b	.L99
 1138              	.L101:
 1139              		.align	2
 1140              	.L100:
 1141 0100 00000000 		.word	motor_
 1142 0104 00000047 		.word	1191182336
 1143 0108 DB0FC940 		.word	1086918619
 1144 010c 00000000 		.word	g_MechanicsAngle_15bit
 1145 0110 003C0040 		.word	1073757184
 1146 0114 00000000 		.word	g_CmdMap
 1147 0118 00000000 		.word	.LANCHOR9
 1148 011c 00000000 		.word	g_MechanicsAngle_15bit_last
 1149 0120 00000000 		.word	EN_360
 1150 0124 00000000 		.word	g_ElectricAngle_15bit_Raw
 1151 0128 00000000 		.word	g_ElectricAngle_act
 1152 012c 00000000 		.word	g_ElectricAngle
 1153 0130 00000000 		.word	EN_0
 1154 0134 00000000 		.word	g_ElectricAngle_15bit
 1155 0138 00000000 		.word	g_ElectricAngle_sim
 1156              		.cfi_endproc
 1157              	.LFE340:
 1159              		.section	.text.sim_ElectricAngle,"ax",%progbits
 1160              		.align	1
 1161              		.global	sim_ElectricAngle
 1162              		.syntax unified
 1163              		.thumb
 1164              		.thumb_func
 1165              		.fpu fpv4-sp-d16
 1167              	sim_ElectricAngle:
 1168              	.LFB341:
 596:Src/spi_MEncoder.c **** void sim_ElectricAngle(void)
 597:Src/spi_MEncoder.c **** {
 1169              		.loc 1 597 0
 1170              		.cfi_startproc
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 34


 1171              		@ args = 0, pretend = 0, frame = 0
 1172              		@ frame_needed = 0, uses_anonymous_args = 0
 598:Src/spi_MEncoder.c **** 		static s16 sys_mot_test_last = 0;
 599:Src/spi_MEncoder.c **** 		static s32 cnt_temp = 0;
 600:Src/spi_MEncoder.c **** 		if(sys_mot_test_last != g_CmdMap[SYS_MOT_TEST])
 1173              		.loc 1 600 0
 1174 0000 624B     		ldr	r3, .L119
 1175 0002 6349     		ldr	r1, .L119+4
 1176 0004 B3F81A22 		ldrh	r2, [r3, #538]
 1177 0008 0888     		ldrh	r0, [r1]
 1178 000a 9042     		cmp	r0, r2
 597:Src/spi_MEncoder.c **** 		static s16 sys_mot_test_last = 0;
 1179              		.loc 1 597 0
 1180 000c 30B5     		push	{r4, r5, lr}
 1181              	.LCFI14:
 1182              		.cfi_def_cfa_offset 12
 1183              		.cfi_offset 4, -12
 1184              		.cfi_offset 5, -8
 1185              		.cfi_offset 14, -4
 1186              		.loc 1 600 0
 1187 000e 4DD0     		beq	.L104
 601:Src/spi_MEncoder.c **** 		{
 602:Src/spi_MEncoder.c **** 			if(g_CmdMap[SYS_MOT_TEST] == 1)
 1188              		.loc 1 602 0
 1189 0010 B3F81A22 		ldrh	r2, [r3, #538]
 603:Src/spi_MEncoder.c **** 			{
 604:Src/spi_MEncoder.c **** 			}
 605:Src/spi_MEncoder.c **** 			if(g_CmdMap[SYS_MOT_TEST] == 2)
 1190              		.loc 1 605 0
 1191 0014 B3F81A22 		ldrh	r2, [r3, #538]
 1192 0018 12B2     		sxth	r2, r2
 1193 001a 022A     		cmp	r2, #2
 1194 001c 20D1     		bne	.L105
 606:Src/spi_MEncoder.c **** 			{
 607:Src/spi_MEncoder.c **** 				cnt_temp = EN_60*2000/EN_360;
 1195              		.loc 1 607 0
 1196 001e 5D4A     		ldr	r2, .L119+8
 1197 0020 5D48     		ldr	r0, .L119+12
 1198 0022 B2F90020 		ldrsh	r2, [r2]
 1199 0026 5D4D     		ldr	r5, .L119+16
 1200 0028 B0F90040 		ldrsh	r4, [r0]
 1201 002c 4FF4FA60 		mov	r0, #2000
 1202 0030 12FB00F0 		smulbb	r0, r2, r0
 1203 0034 90FBF4F0 		sdiv	r0, r0, r4
 1204 0038 2860     		str	r0, [r5]
 608:Src/spi_MEncoder.c **** 				g_ElectricAngle_sim = EN_60;
 1205              		.loc 1 608 0
 1206 003a 5948     		ldr	r0, .L119+20
 1207 003c 0260     		str	r2, [r0]
 609:Src/spi_MEncoder.c **** 				g_Encode_offset_EN = EN_0;
 1208              		.loc 1 609 0
 1209 003e 594A     		ldr	r2, .L119+24
 1210 0040 B2F90000 		ldrsh	r0, [r2]
 1211 0044 584A     		ldr	r2, .L119+28
 1212 0046 1060     		str	r0, [r2]
 610:Src/spi_MEncoder.c **** 				g_Encode_offset = g_Encode_offset_EN*360/EN_360;
 1213              		.loc 1 610 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 35


 1214 0048 1068     		ldr	r0, [r2]
 1215 004a 4FF4B472 		mov	r2, #360
 1216 004e 4243     		muls	r2, r0, r2
 1217 0050 5648     		ldr	r0, .L119+32
 1218 0052 92FBF4F2 		sdiv	r2, r2, r4
 1219 0056 0260     		str	r2, [r0]
 611:Src/spi_MEncoder.c **** 				g_CmdMap[MOT_EANGLE_OFFSET] = g_Encode_offset;
 1220              		.loc 1 611 0
 1221 0058 0268     		ldr	r2, [r0]
 1222 005a 12B2     		sxth	r2, r2
 1223 005c A3F84C22 		strh	r2, [r3, #588]	@ movhi
 1224              	.L105:
 612:Src/spi_MEncoder.c **** 			}
 613:Src/spi_MEncoder.c **** 			if(g_CmdMap[SYS_MOT_TEST] == 3)
 1225              		.loc 1 613 0
 1226 0060 B3F81A22 		ldrh	r2, [r3, #538]
 1227 0064 12B2     		sxth	r2, r2
 1228 0066 032A     		cmp	r2, #3
 1229 0068 20D1     		bne	.L104
 614:Src/spi_MEncoder.c **** 			{
 615:Src/spi_MEncoder.c **** 				cnt_temp = EN_300*2000/EN_360;
 1230              		.loc 1 615 0
 1231 006a 514A     		ldr	r2, .L119+36
 1232 006c 4A48     		ldr	r0, .L119+12
 1233 006e B2F90020 		ldrsh	r2, [r2]
 1234 0072 4A4D     		ldr	r5, .L119+16
 1235 0074 B0F90040 		ldrsh	r4, [r0]
 1236 0078 4FF4FA60 		mov	r0, #2000
 1237 007c 12FB00F0 		smulbb	r0, r2, r0
 1238 0080 90FBF4F0 		sdiv	r0, r0, r4
 1239 0084 2860     		str	r0, [r5]
 616:Src/spi_MEncoder.c **** 				g_ElectricAngle_sim = EN_300;
 1240              		.loc 1 616 0
 1241 0086 4648     		ldr	r0, .L119+20
 1242 0088 0260     		str	r2, [r0]
 617:Src/spi_MEncoder.c **** 				g_Encode_offset_EN = EN_0;
 1243              		.loc 1 617 0
 1244 008a 464A     		ldr	r2, .L119+24
 1245 008c B2F90000 		ldrsh	r0, [r2]
 1246 0090 454A     		ldr	r2, .L119+28
 1247 0092 1060     		str	r0, [r2]
 618:Src/spi_MEncoder.c **** 				g_Encode_offset = g_Encode_offset_EN*360/EN_360;
 1248              		.loc 1 618 0
 1249 0094 1068     		ldr	r0, [r2]
 1250 0096 4FF4B472 		mov	r2, #360
 1251 009a 4243     		muls	r2, r0, r2
 1252 009c 4348     		ldr	r0, .L119+32
 1253 009e 92FBF4F2 		sdiv	r2, r2, r4
 1254 00a2 0260     		str	r2, [r0]
 619:Src/spi_MEncoder.c **** 				g_CmdMap[MOT_EANGLE_OFFSET] = g_Encode_offset;
 1255              		.loc 1 619 0
 1256 00a4 0268     		ldr	r2, [r0]
 1257 00a6 12B2     		sxth	r2, r2
 1258 00a8 A3F84C22 		strh	r2, [r3, #588]	@ movhi
 1259              	.L104:
 620:Src/spi_MEncoder.c **** 			}
 621:Src/spi_MEncoder.c **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 36


 622:Src/spi_MEncoder.c **** 		if(g_CmdMap[SYS_MOT_TEST] == 1)//ģ�������ת��Ƕ�
 1260              		.loc 1 622 0
 1261 00ac B3F81A22 		ldrh	r2, [r3, #538]
 1262 00b0 12B2     		sxth	r2, r2
 1263 00b2 012A     		cmp	r2, #1
 1264 00b4 14D1     		bne	.L107
 623:Src/spi_MEncoder.c **** 		{
 624:Src/spi_MEncoder.c **** 					cnt_temp = cnt_temp + 1;//1;
 1265              		.loc 1 624 0
 1266 00b6 3948     		ldr	r0, .L119+16
 1267 00b8 0268     		ldr	r2, [r0]
 1268 00ba 0132     		adds	r2, r2, #1
 1269 00bc 0260     		str	r2, [r0]
 625:Src/spi_MEncoder.c **** 					g_ElectricAngle_sim = cnt_temp*EN_360/10000;//2s һȦ����ת�ٶ�
 1270              		.loc 1 625 0
 1271 00be 3648     		ldr	r0, .L119+12
 1272 00c0 B0F90000 		ldrsh	r0, [r0]
 1273 00c4 42F21074 		movw	r4, #10000
 1274 00c8 4243     		muls	r2, r0, r2
 1275 00ca 92FBF4F2 		sdiv	r2, r2, r4
 1276 00ce 344C     		ldr	r4, .L119+20
 1277 00d0 2260     		str	r2, [r4]
 626:Src/spi_MEncoder.c **** 					if(g_ElectricAngle_sim>EN_360)
 1278              		.loc 1 626 0
 1279 00d2 2268     		ldr	r2, [r4]
 1280 00d4 9042     		cmp	r0, r2
 1281              	.L116:
 1282 00d6 13DA     		bge	.L109
 627:Src/spi_MEncoder.c **** 					{
 628:Src/spi_MEncoder.c **** 						cnt_temp = 0;
 1283              		.loc 1 628 0
 1284 00d8 304A     		ldr	r2, .L119+16
 1285 00da 0020     		movs	r0, #0
 1286              	.L118:
 629:Src/spi_MEncoder.c **** 					}				
 630:Src/spi_MEncoder.c **** 					
 631:Src/spi_MEncoder.c **** 		}
 632:Src/spi_MEncoder.c **** 		else if(g_CmdMap[SYS_MOT_TEST] == 2)//���Ե�Ƕȣ���������ת(g_ElectricA
 633:Src/spi_MEncoder.c **** 		{
 634:Src/spi_MEncoder.c **** 					if(g_ElectricAngle_sim < EN_30)
 635:Src/spi_MEncoder.c **** 					{
 636:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim  = EN_0;
 637:Src/spi_MEncoder.c **** 						
 638:Src/spi_MEncoder.c **** 					}
 639:Src/spi_MEncoder.c **** 					else
 640:Src/spi_MEncoder.c **** 					{
 641:Src/spi_MEncoder.c **** 						cnt_temp = cnt_temp + 1;
 642:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim = cnt_temp*EN_360/2000;//2s һȦ����ת�ٶ�
 643:Src/spi_MEncoder.c **** 						if(g_ElectricAngle_sim>EN_360)
 644:Src/spi_MEncoder.c **** 						{
 645:Src/spi_MEncoder.c **** 							cnt_temp = 0;
 646:Src/spi_MEncoder.c **** 						}
 647:Src/spi_MEncoder.c **** 					}									
 648:Src/spi_MEncoder.c **** 		}
 649:Src/spi_MEncoder.c **** 		else if(g_CmdMap[SYS_MOT_TEST] == 3)//���Ե�Ƕȣ���������ת(g_ElectricA
 650:Src/spi_MEncoder.c **** 		{
 651:Src/spi_MEncoder.c **** 					if(g_ElectricAngle_sim > EN_330)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 37


 652:Src/spi_MEncoder.c **** 					{
 653:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim  = EN_0;
 654:Src/spi_MEncoder.c **** 					}
 655:Src/spi_MEncoder.c **** 					else
 656:Src/spi_MEncoder.c **** 					{
 657:Src/spi_MEncoder.c **** 						cnt_temp = cnt_temp - 1;
 658:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim = cnt_temp*EN_360/2000;//2s һȦ����ת�ٶ�
 659:Src/spi_MEncoder.c **** 						if(g_ElectricAngle_sim<EN_0)
 660:Src/spi_MEncoder.c **** 						{
 661:Src/spi_MEncoder.c **** 							cnt_temp = 0;
 662:Src/spi_MEncoder.c **** 						}
 663:Src/spi_MEncoder.c **** 					}	
 664:Src/spi_MEncoder.c **** 		}
 665:Src/spi_MEncoder.c **** 		else if(g_CmdMap[SYS_MOT_TEST] == 4 )//��� ����� ���еĲ���
 666:Src/spi_MEncoder.c **** 		{
 667:Src/spi_MEncoder.c **** 					g_ElectricAngle_sim = EN_30;//2s һȦ����ת�ٶ�
 668:Src/spi_MEncoder.c **** 		}
 669:Src/spi_MEncoder.c **** 		else if(g_CmdMap[SYS_MOT_TEST] == 5)//��� ����� ���еĲ���
 670:Src/spi_MEncoder.c **** 		{
 671:Src/spi_MEncoder.c **** 					g_ElectricAngle_sim = EN_30;//2s һȦ����ת�ٶ�
 1287              		.loc 1 671 0
 1288 00dc 1060     		str	r0, [r2]
 1289 00de 0FE0     		b	.L109
 1290              	.L107:
 632:Src/spi_MEncoder.c **** 		{
 1291              		.loc 1 632 0
 1292 00e0 B3F81A22 		ldrh	r2, [r3, #538]
 1293 00e4 12B2     		sxth	r2, r2
 1294 00e6 022A     		cmp	r2, #2
 1295 00e8 1ED1     		bne	.L110
 634:Src/spi_MEncoder.c **** 					{
 1296              		.loc 1 634 0
 1297 00ea 2D48     		ldr	r0, .L119+20
 1298 00ec 314C     		ldr	r4, .L119+40
 1299 00ee 0268     		ldr	r2, [r0]
 1300 00f0 B4F90040 		ldrsh	r4, [r4]
 1301 00f4 9442     		cmp	r4, r2
 1302 00f6 07DD     		ble	.L111
 636:Src/spi_MEncoder.c **** 						
 1303              		.loc 1 636 0
 1304 00f8 2A4A     		ldr	r2, .L119+24
 1305 00fa B2F90020 		ldrsh	r2, [r2]
 1306 00fe 0260     		str	r2, [r0]
 1307              	.L109:
 672:Src/spi_MEncoder.c **** 		}
 673:Src/spi_MEncoder.c **** 		sys_mot_test_last = g_CmdMap[SYS_MOT_TEST];			
 1308              		.loc 1 673 0
 1309 0100 B3F81A32 		ldrh	r3, [r3, #538]
 1310 0104 0B80     		strh	r3, [r1]	@ movhi
 674:Src/spi_MEncoder.c **** }
 1311              		.loc 1 674 0
 1312 0106 30BD     		pop	{r4, r5, pc}
 1313              	.L111:
 641:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim = cnt_temp*EN_360/2000;//2s һȦ����ת�ٶ�
 1314              		.loc 1 641 0
 1315 0108 244C     		ldr	r4, .L119+16
 1316 010a 2268     		ldr	r2, [r4]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 38


 1317 010c 0132     		adds	r2, r2, #1
 1318 010e 2260     		str	r2, [r4]
 642:Src/spi_MEncoder.c **** 						if(g_ElectricAngle_sim>EN_360)
 1319              		.loc 1 642 0
 1320 0110 214C     		ldr	r4, .L119+12
 1321 0112 B4F90040 		ldrsh	r4, [r4]
 1322 0116 4FF4FA65 		mov	r5, #2000
 1323 011a 6243     		muls	r2, r4, r2
 1324 011c 92FBF5F2 		sdiv	r2, r2, r5
 1325 0120 0260     		str	r2, [r0]
 643:Src/spi_MEncoder.c **** 						{
 1326              		.loc 1 643 0
 1327 0122 0268     		ldr	r2, [r0]
 1328 0124 9442     		cmp	r4, r2
 1329 0126 D6E7     		b	.L116
 1330              	.L110:
 649:Src/spi_MEncoder.c **** 		{
 1331              		.loc 1 649 0
 1332 0128 B3F81A22 		ldrh	r2, [r3, #538]
 1333 012c 12B2     		sxth	r2, r2
 1334 012e 032A     		cmp	r2, #3
 1335 0130 1BD1     		bne	.L113
 651:Src/spi_MEncoder.c **** 					{
 1336              		.loc 1 651 0
 1337 0132 1B48     		ldr	r0, .L119+20
 1338 0134 204D     		ldr	r5, .L119+44
 1339 0136 0268     		ldr	r2, [r0]
 1340 0138 B5F90050 		ldrsh	r5, [r5]
 1341 013c 194C     		ldr	r4, .L119+24
 1342 013e 9542     		cmp	r5, r2
 1343 0140 B4F90040 		ldrsh	r4, [r4]
 1344 0144 01DA     		bge	.L114
 653:Src/spi_MEncoder.c **** 					}
 1345              		.loc 1 653 0
 1346 0146 0460     		str	r4, [r0]
 1347 0148 DAE7     		b	.L109
 1348              	.L114:
 657:Src/spi_MEncoder.c **** 						g_ElectricAngle_sim = cnt_temp*EN_360/2000;//2s һȦ����ת�ٶ�
 1349              		.loc 1 657 0
 1350 014a 144D     		ldr	r5, .L119+16
 1351 014c 2A68     		ldr	r2, [r5]
 1352 014e 013A     		subs	r2, r2, #1
 1353 0150 2A60     		str	r2, [r5]
 658:Src/spi_MEncoder.c **** 						if(g_ElectricAngle_sim<EN_0)
 1354              		.loc 1 658 0
 1355 0152 114D     		ldr	r5, .L119+12
 1356 0154 B5F90050 		ldrsh	r5, [r5]
 1357 0158 6A43     		muls	r2, r5, r2
 1358 015a 4FF4FA65 		mov	r5, #2000
 1359 015e 92FBF5F2 		sdiv	r2, r2, r5
 1360 0162 0260     		str	r2, [r0]
 659:Src/spi_MEncoder.c **** 						{
 1361              		.loc 1 659 0
 1362 0164 0268     		ldr	r2, [r0]
 1363 0166 A242     		cmp	r2, r4
 1364 0168 B5E7     		b	.L116
 1365              	.L113:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 39


 665:Src/spi_MEncoder.c **** 		{
 1366              		.loc 1 665 0
 1367 016a B3F81A22 		ldrh	r2, [r3, #538]
 1368 016e 12B2     		sxth	r2, r2
 1369 0170 042A     		cmp	r2, #4
 1370 0172 04D1     		bne	.L115
 1371              	.L117:
 671:Src/spi_MEncoder.c **** 		}
 1372              		.loc 1 671 0
 1373 0174 0F4A     		ldr	r2, .L119+40
 1374 0176 B2F90000 		ldrsh	r0, [r2]
 1375 017a 094A     		ldr	r2, .L119+20
 1376 017c AEE7     		b	.L118
 1377              	.L115:
 669:Src/spi_MEncoder.c **** 		{
 1378              		.loc 1 669 0
 1379 017e B3F81A22 		ldrh	r2, [r3, #538]
 1380 0182 12B2     		sxth	r2, r2
 1381 0184 052A     		cmp	r2, #5
 1382 0186 BBD1     		bne	.L109
 1383 0188 F4E7     		b	.L117
 1384              	.L120:
 1385 018a 00BF     		.align	2
 1386              	.L119:
 1387 018c 00000000 		.word	g_CmdMap
 1388 0190 00000000 		.word	.LANCHOR10
 1389 0194 00000000 		.word	EN_60
 1390 0198 00000000 		.word	EN_360
 1391 019c 00000000 		.word	.LANCHOR11
 1392 01a0 00000000 		.word	g_ElectricAngle_sim
 1393 01a4 00000000 		.word	EN_0
 1394 01a8 00000000 		.word	.LANCHOR12
 1395 01ac 00000000 		.word	.LANCHOR13
 1396 01b0 00000000 		.word	EN_300
 1397 01b4 00000000 		.word	EN_30
 1398 01b8 00000000 		.word	EN_330
 1399              		.cfi_endproc
 1400              	.LFE341:
 1402              		.section	.text.Encode_Single_to_Multi_R,"ax",%progbits
 1403              		.align	1
 1404              		.global	Encode_Single_to_Multi_R
 1405              		.syntax unified
 1406              		.thumb
 1407              		.thumb_func
 1408              		.fpu fpv4-sp-d16
 1410              	Encode_Single_to_Multi_R:
 1411              	.LFB342:
 675:Src/spi_MEncoder.c **** 
 676:Src/spi_MEncoder.c **** 	volatile s32 flag_first_exe = 0;
 677:Src/spi_MEncoder.c **** void Encode_Single_to_Multi_R(u8 flag_reverse,u8 flag_cycle,s32 single_value_raw,s32* p_multi_value
 678:Src/spi_MEncoder.c **** {
 1412              		.loc 1 678 0
 1413              		.cfi_startproc
 1414              		@ args = 8, pretend = 0, frame = 0
 1415              		@ frame_needed = 0, uses_anonymous_args = 0
 1416              	.LVL67:
 1417 0000 F0B5     		push	{r4, r5, r6, r7, lr}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 40


 1418              	.LCFI15:
 1419              		.cfi_def_cfa_offset 20
 1420              		.cfi_offset 4, -20
 1421              		.cfi_offset 5, -16
 1422              		.cfi_offset 6, -12
 1423              		.cfi_offset 7, -8
 1424              		.cfi_offset 14, -4
 679:Src/spi_MEncoder.c **** 	static s32 single_value_last_raw = 0;
 680:Src/spi_MEncoder.c **** 
 681:Src/spi_MEncoder.c **** 	s32 single_value = 0;
 682:Src/spi_MEncoder.c **** 	s32 single_value_last = 0;
 683:Src/spi_MEncoder.c **** 	s32 inc = 0;
 684:Src/spi_MEncoder.c **** 	s32 mod_half = 0; 
 685:Src/spi_MEncoder.c **** 	if(flag_first_exe == 0)
 1425              		.loc 1 685 0
 1426 0002 154C     		ldr	r4, .L131
 1427 0004 154E     		ldr	r6, .L131+4
 1428 0006 2768     		ldr	r7, [r4]
 678:Src/spi_MEncoder.c **** 	static s32 single_value_last_raw = 0;
 1429              		.loc 1 678 0
 1430 0008 DDE9055C 		ldrd	r5, ip, [sp, #20]
 1431              		.loc 1 685 0
 1432 000c 1FB9     		cbnz	r7, .L122
 686:Src/spi_MEncoder.c **** 	{
 687:Src/spi_MEncoder.c **** 		flag_first_exe = 1;
 1433              		.loc 1 687 0
 1434 000e 0123     		movs	r3, #1
 1435              	.LVL68:
 1436 0010 2360     		str	r3, [r4]
 688:Src/spi_MEncoder.c **** 		single_value_last_raw = single_value_raw;
 1437              		.loc 1 688 0
 1438 0012 3260     		str	r2, [r6]
 1439              	.LVL69:
 1440              	.L121:
 689:Src/spi_MEncoder.c **** 		return;
 690:Src/spi_MEncoder.c **** 	}
 691:Src/spi_MEncoder.c **** 	if(flag_reverse == 1)
 692:Src/spi_MEncoder.c **** 	{
 693:Src/spi_MEncoder.c **** 		single_value = mod_single - single_value_raw;
 694:Src/spi_MEncoder.c **** 		single_value_last = mod_single - single_value_last_raw;
 695:Src/spi_MEncoder.c **** 	}
 696:Src/spi_MEncoder.c **** 	else
 697:Src/spi_MEncoder.c **** 	{
 698:Src/spi_MEncoder.c **** 		single_value = single_value_raw;
 699:Src/spi_MEncoder.c **** 		single_value_last = single_value_last_raw;	
 700:Src/spi_MEncoder.c **** 	}
 701:Src/spi_MEncoder.c **** 	inc = single_value - single_value_last;
 702:Src/spi_MEncoder.c **** 	mod_half = (mod_single>>1)-1;
 703:Src/spi_MEncoder.c **** 	if(inc>mod_half)//���� ��ת
 704:Src/spi_MEncoder.c **** 	{
 705:Src/spi_MEncoder.c **** 		inc = inc - mod_single;
 706:Src/spi_MEncoder.c **** 	}
 707:Src/spi_MEncoder.c **** 	if(inc<-mod_half)//���� ��ת
 708:Src/spi_MEncoder.c **** 	{
 709:Src/spi_MEncoder.c **** 		inc = inc + mod_single;
 710:Src/spi_MEncoder.c **** 	}
 711:Src/spi_MEncoder.c **** 	single_value_last = single_value;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 41


 712:Src/spi_MEncoder.c **** 	if(flag_reverse == 1)
 713:Src/spi_MEncoder.c **** 	{
 714:Src/spi_MEncoder.c **** 		single_value_last_raw = mod_single - single_value_last;
 715:Src/spi_MEncoder.c **** 	}
 716:Src/spi_MEncoder.c **** 	else
 717:Src/spi_MEncoder.c **** 	{
 718:Src/spi_MEncoder.c **** 		single_value_last_raw = single_value_last;	
 719:Src/spi_MEncoder.c **** 	}
 720:Src/spi_MEncoder.c **** 	if(flag_cycle == 0)
 721:Src/spi_MEncoder.c **** 	{
 722:Src/spi_MEncoder.c **** 		*p_multi_value = *p_multi_value+inc;
 723:Src/spi_MEncoder.c **** 		return;
 724:Src/spi_MEncoder.c **** 	}
 725:Src/spi_MEncoder.c **** 	*p_multi_value = *p_multi_value%mod_multi;
 726:Src/spi_MEncoder.c **** }
 1441              		.loc 1 726 0
 1442 0014 F0BD     		pop	{r4, r5, r6, r7, pc}
 1443              	.LVL70:
 1444              	.L122:
 1445 0016 3468     		ldr	r4, [r6]
 691:Src/spi_MEncoder.c **** 	{
 1446              		.loc 1 691 0
 1447 0018 0128     		cmp	r0, #1
 693:Src/spi_MEncoder.c **** 		single_value_last = mod_single - single_value_last_raw;
 1448              		.loc 1 693 0
 1449 001a 04BF     		itt	eq
 1450 001c AA1A     		subeq	r2, r5, r2
 1451              	.LVL71:
 694:Src/spi_MEncoder.c **** 	}
 1452              		.loc 1 694 0
 1453 001e 2C1B     		subeq	r4, r5, r4
 1454              	.LVL72:
 702:Src/spi_MEncoder.c **** 	if(inc>mod_half)//���� ��ת
 1455              		.loc 1 702 0
 1456 0020 6F10     		asrs	r7, r5, #1
 701:Src/spi_MEncoder.c **** 	mod_half = (mod_single>>1)-1;
 1457              		.loc 1 701 0
 1458 0022 141B     		subs	r4, r2, r4
 1459              	.LVL73:
 702:Src/spi_MEncoder.c **** 	if(inc>mod_half)//���� ��ת
 1460              		.loc 1 702 0
 1461 0024 07F1FF3E 		add	lr, r7, #-1
 1462              	.LVL74:
 703:Src/spi_MEncoder.c **** 	{
 1463              		.loc 1 703 0
 1464 0028 7445     		cmp	r4, lr
 1465              	.LVL75:
 705:Src/spi_MEncoder.c **** 	}
 1466              		.loc 1 705 0
 1467 002a C8BF     		it	gt
 1468 002c 641B     		subgt	r4, r4, r5
 1469              	.LVL76:
 707:Src/spi_MEncoder.c **** 	{
 1470              		.loc 1 707 0
 1471 002e C7F10107 		rsb	r7, r7, #1
 1472 0032 A742     		cmp	r7, r4
 709:Src/spi_MEncoder.c **** 	}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 42


 1473              		.loc 1 709 0
 1474 0034 C8BF     		it	gt
 1475 0036 6419     		addgt	r4, r4, r5
 1476              	.LVL77:
 712:Src/spi_MEncoder.c **** 	{
 1477              		.loc 1 712 0
 1478 0038 0128     		cmp	r0, #1
 714:Src/spi_MEncoder.c **** 	}
 1479              		.loc 1 714 0
 1480 003a 0ABF     		itet	eq
 1481 003c AD1A     		subeq	r5, r5, r2
 718:Src/spi_MEncoder.c **** 	}
 1482              		.loc 1 718 0
 1483 003e 3260     		strne	r2, [r6]
 714:Src/spi_MEncoder.c **** 	}
 1484              		.loc 1 714 0
 1485 0040 3560     		streq	r5, [r6]
 1486 0042 1A68     		ldr	r2, [r3]
 1487              	.LVL78:
 720:Src/spi_MEncoder.c **** 	{
 1488              		.loc 1 720 0
 1489 0044 11B9     		cbnz	r1, .L129
 1490              	.LVL79:
 722:Src/spi_MEncoder.c **** 		return;
 1491              		.loc 1 722 0
 1492 0046 1444     		add	r4, r4, r2
 1493              	.LVL80:
 1494              	.L130:
 725:Src/spi_MEncoder.c **** }
 1495              		.loc 1 725 0
 1496 0048 1C60     		str	r4, [r3]
 1497 004a E3E7     		b	.L121
 1498              	.LVL81:
 1499              	.L129:
 1500 004c 92FBFCF4 		sdiv	r4, r2, ip
 1501              	.LVL82:
 1502 0050 0CFB1424 		mls	r4, ip, r4, r2
 1503 0054 F8E7     		b	.L130
 1504              	.L132:
 1505 0056 00BF     		.align	2
 1506              	.L131:
 1507 0058 00000000 		.word	.LANCHOR14
 1508 005c 00000000 		.word	.LANCHOR15
 1509              		.cfi_endproc
 1510              	.LFE342:
 1512              		.global	flag_first_exe
 1513              		.global	g_ElectricAngle_add
 1514              		.global	s_Encoder_Inc
 1515              		.global	g_ElectricAngle_15bit_Last
 1516              		.global	estimated_phase_integ_int_1
 1517              		.global	estimated_phase_integ_int
 1518              		.global	pll_pid_integ_int
 1519              		.global	temp_spd_filed
 1520              		.global	temp_spd
 1521              		.global	temp_spd_index
 1522              		.global	g_measured_phase
 1523              		.global	estimated_SPD_filterd
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 43


 1524              		.global	pll_pid_out
 1525              		.global	pll_pid_integ
 1526              		.global	pll_estimated_spd
 1527              		.global	pll_estimated_phase
 1528              		.global	start_speed_sample
 1529              		.global	g_CurrentSpeed
 1530              		.global	s_ForecastCnt1
 1531              		.global	s_IntNum1
 1532              		.global	speed_MCal
 1533              		.global	speed_TCal
 1534              		.global	speed_def
 1535              		.global	s_ForecastTimeAdd1
 1536              		.global	s_SpeedTimeAdd1
 1537              		.global	Encoder_Inc
 1538              		.global	Encoder_Last
 1539              		.global	Encoder_Current
 1540              		.comm	hspi3,100,4
 1541              		.global	sincos_sample_c_
 1542              		.global	sincos_sample_s_
 1543              		.comm	htim2,76,4
 1544              		.global	tim4_cnt
 1545              		.global	tim3_cnt
 1546              		.global	g_Encode_offset_EN
 1547              		.global	g_Encode_offset
 1548              		.global	Num_Turns
 1549              		.global	g_Encode_Inc
 1550              		.global	g_Encode_AbsPos_Last
 1551              		.global	g_Encode_AbsPos
 1552              		.global	g_MEncode
 1553              		.global	EncoderAB_PulseWidth_Array
 1554              		.section	.bss.EncoderAB_PulseWidth_Array,"aw",%nobits
 1555              		.align	1
 1558              	EncoderAB_PulseWidth_Array:
 1559 0000 00000000 		.space	32
 1559      00000000 
 1559      00000000 
 1559      00000000 
 1559      00000000 
 1560              		.section	.bss.Encoder_Current,"aw",%nobits
 1561              		.align	2
 1564              	Encoder_Current:
 1565 0000 00000000 		.space	4
 1566              		.section	.bss.Encoder_Inc,"aw",%nobits
 1567              		.align	2
 1570              	Encoder_Inc:
 1571 0000 00000000 		.space	4
 1572              		.section	.bss.Encoder_Last,"aw",%nobits
 1573              		.align	2
 1576              	Encoder_Last:
 1577 0000 00000000 		.space	4
 1578              		.section	.bss.Num_Turns,"aw",%nobits
 1579              		.align	2
 1582              	Num_Turns:
 1583 0000 00000000 		.space	4
 1584              		.section	.bss.cnt.12047,"aw",%nobits
 1585              		.align	2
 1586              		.set	.LANCHOR0,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 44


 1589              	cnt.12047:
 1590 0000 00000000 		.space	4
 1591              		.section	.bss.cnt_temp.12060,"aw",%nobits
 1592              		.align	2
 1593              		.set	.LANCHOR11,. + 0
 1596              	cnt_temp.12060:
 1597 0000 00000000 		.space	4
 1598              		.section	.bss.count1.12054,"aw",%nobits
 1599              		.align	2
 1600              		.set	.LANCHOR9,. + 0
 1603              	count1.12054:
 1604 0000 00000000 		.space	4
 1605              		.section	.bss.estimated_SPD_filterd,"aw",%nobits
 1606              		.align	2
 1607              		.set	.LANCHOR5,. + 0
 1610              	estimated_SPD_filterd:
 1611 0000 00000000 		.space	4
 1612              		.section	.bss.estimated_phase_integ_int,"aw",%nobits
 1613              		.align	2
 1614              		.set	.LANCHOR3,. + 0
 1617              	estimated_phase_integ_int:
 1618 0000 00000000 		.space	4
 1619              		.section	.bss.estimated_phase_integ_int_1,"aw",%nobits
 1620              		.align	2
 1623              	estimated_phase_integ_int_1:
 1624 0000 00000000 		.space	4
 1625              		.section	.bss.flag_first_exe,"aw",%nobits
 1626              		.align	2
 1627              		.set	.LANCHOR14,. + 0
 1630              	flag_first_exe:
 1631 0000 00000000 		.space	4
 1632              		.section	.bss.g_CurrentSpeed,"aw",%nobits
 1633              		.align	2
 1636              	g_CurrentSpeed:
 1637 0000 00000000 		.space	4
 1638              		.section	.bss.g_ElectricAngle_15bit_Last,"aw",%nobits
 1639              		.align	2
 1642              	g_ElectricAngle_15bit_Last:
 1643 0000 00000000 		.space	4
 1644              		.section	.bss.g_ElectricAngle_add,"aw",%nobits
 1645              		.align	2
 1648              	g_ElectricAngle_add:
 1649 0000 00000000 		.space	4
 1650              		.section	.bss.g_Encode_AbsPos,"aw",%nobits
 1651              		.align	2
 1654              	g_Encode_AbsPos:
 1655 0000 00000000 		.space	4
 1656              		.section	.bss.g_Encode_AbsPos_Last,"aw",%nobits
 1657              		.align	2
 1660              	g_Encode_AbsPos_Last:
 1661 0000 00000000 		.space	4
 1662              		.section	.bss.g_Encode_Inc,"aw",%nobits
 1663              		.align	2
 1666              	g_Encode_Inc:
 1667 0000 00000000 		.space	4
 1668              		.section	.bss.g_Encode_offset,"aw",%nobits
 1669              		.align	2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 45


 1670              		.set	.LANCHOR13,. + 0
 1673              	g_Encode_offset:
 1674 0000 00000000 		.space	4
 1675              		.section	.bss.g_Encode_offset_EN,"aw",%nobits
 1676              		.align	2
 1677              		.set	.LANCHOR12,. + 0
 1680              	g_Encode_offset_EN:
 1681 0000 00000000 		.space	4
 1682              		.section	.bss.g_MEncode,"aw",%nobits
 1683              		.align	2
 1686              	g_MEncode:
 1687 0000 00000000 		.space	4
 1688              		.section	.bss.g_measured_phase,"aw",%nobits
 1689              		.align	2
 1690              		.set	.LANCHOR8,. + 0
 1693              	g_measured_phase:
 1694 0000 00000000 		.space	4
 1695              		.section	.bss.pll_estimated_phase,"aw",%nobits
 1696              		.align	2
 1699              	pll_estimated_phase:
 1700 0000 00000000 		.space	4
 1701              		.section	.bss.pll_estimated_spd,"aw",%nobits
 1702              		.align	2
 1705              	pll_estimated_spd:
 1706 0000 00000000 		.space	4
 1707              		.section	.bss.pll_pid_integ,"aw",%nobits
 1708              		.align	2
 1709              		.set	.LANCHOR2,. + 0
 1712              	pll_pid_integ:
 1713 0000 00000000 		.space	4
 1714              		.section	.bss.pll_pid_integ_int,"aw",%nobits
 1715              		.align	2
 1716              		.set	.LANCHOR1,. + 0
 1719              	pll_pid_integ_int:
 1720 0000 00000000 		.space	4
 1721              		.section	.bss.pll_pid_out,"aw",%nobits
 1722              		.align	2
 1725              	pll_pid_out:
 1726 0000 00000000 		.space	4
 1727              		.section	.bss.s_Encoder_Inc,"aw",%nobits
 1728              		.align	2
 1731              	s_Encoder_Inc:
 1732 0000 00000000 		.space	4
 1733              		.section	.bss.s_ForecastTimeAdd1,"aw",%nobits
 1734              		.align	2
 1737              	s_ForecastTimeAdd1:
 1738 0000 00000000 		.space	4
 1739              		.section	.bss.s_IntNum1,"aw",%nobits
 1740              		.align	2
 1743              	s_IntNum1:
 1744 0000 00000000 		.space	4
 1745              		.section	.bss.s_SpeedTimeAdd1,"aw",%nobits
 1746              		.align	2
 1749              	s_SpeedTimeAdd1:
 1750 0000 00000000 		.space	4
 1751              		.section	.bss.sincos_sample_c_,"aw",%nobits
 1752              		.align	2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 46


 1755              	sincos_sample_c_:
 1756 0000 00000000 		.space	4
 1757              		.section	.bss.sincos_sample_s_,"aw",%nobits
 1758              		.align	2
 1761              	sincos_sample_s_:
 1762 0000 00000000 		.space	4
 1763              		.section	.bss.single_value_last_raw.12070,"aw",%nobits
 1764              		.align	2
 1765              		.set	.LANCHOR15,. + 0
 1768              	single_value_last_raw.12070:
 1769 0000 00000000 		.space	4
 1770              		.section	.bss.speed_MCal,"aw",%nobits
 1771              		.align	2
 1774              	speed_MCal:
 1775 0000 00000000 		.space	4
 1776              		.section	.bss.speed_TCal,"aw",%nobits
 1777              		.align	2
 1780              	speed_TCal:
 1781 0000 00000000 		.space	4
 1782              		.section	.bss.start_speed_sample,"aw",%nobits
 1783              		.align	2
 1786              	start_speed_sample:
 1787 0000 00000000 		.space	4
 1788              		.section	.bss.sys_mot_test_last.12059,"aw",%nobits
 1789              		.align	1
 1790              		.set	.LANCHOR10,. + 0
 1793              	sys_mot_test_last.12059:
 1794 0000 0000     		.space	2
 1795              		.section	.bss.temp_spd,"aw",%nobits
 1796              		.align	2
 1797              		.set	.LANCHOR7,. + 0
 1800              	temp_spd:
 1801 0000 00000000 		.space	96
 1801      00000000 
 1801      00000000 
 1801      00000000 
 1801      00000000 
 1802              		.section	.bss.temp_spd_filed,"aw",%nobits
 1803              		.align	2
 1804              		.set	.LANCHOR6,. + 0
 1807              	temp_spd_filed:
 1808 0000 00000000 		.space	96
 1808      00000000 
 1808      00000000 
 1808      00000000 
 1808      00000000 
 1809              		.section	.bss.temp_spd_index,"aw",%nobits
 1810              		.align	2
 1811              		.set	.LANCHOR4,. + 0
 1814              	temp_spd_index:
 1815 0000 00000000 		.space	4
 1816              		.section	.bss.tim3_cnt,"aw",%nobits
 1817              		.align	2
 1820              	tim3_cnt:
 1821 0000 00000000 		.space	4
 1822              		.section	.bss.tim4_cnt,"aw",%nobits
 1823              		.align	2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 47


 1826              	tim4_cnt:
 1827 0000 00000000 		.space	4
 1828              		.section	.data.s_ForecastCnt1,"aw",%progbits
 1829              		.align	2
 1832              	s_ForecastCnt1:
 1833 0000 01000000 		.word	1
 1834              		.section	.data.speed_def,"aw",%progbits
 1835              		.align	2
 1838              	speed_def:
 1839 0000 40000000 		.word	64
 1840 0004 00000000 		.word	0
 1841              		.text
 1842              	.Letext0:
 1843              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 1844              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 1845              		.file 4 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1846              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 1847              		.file 6 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/system_stm32g4xx.h"
 1848              		.file 7 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 1849              		.file 8 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g4xx.h"
 1850              		.file 9 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 1851              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_gpio.h"
 1852              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 1853              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc.h"
 1854              		.file 13 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_flash.h"
 1855              		.file 14 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 1856              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim.h"
 1857              		.file 16 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 1858              		.file 17 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1859              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1860              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 1861              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1862              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 1863              		.file 22 "Inc/uart.h"
 1864              		.file 23 "Inc/pwm.h"
 1865              		.file 24 "Inc/spi_MEncoder.h"
 1866              		.file 25 "Inc/adc.h"
 1867              		.file 26 "Inc/stm32_math_sin.h"
 1868              		.file 27 "Inc/pid.h"
 1869              		.file 28 "Inc/profile_joint.h"
 1870              		.file 29 "Inc/icmu.h"
 1871              		.file 30 "Inc/performance_test.h"
 1872              		.file 31 "Inc/global.h"
 1873              		.file 32 "Inc/sensorless.h"
 1874              		.file 33 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim_ex.h"
 1875              		.file 34 "<built-in>"
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 48


DEFINED SYMBOLS
                            *ABS*:00000000 spi_MEncoder.c
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:18     .text.HAL_SPI_MspInit:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:25     .text.HAL_SPI_MspInit:00000000 HAL_SPI_MspInit
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:299    .text.HAL_SPI_MspInit:00000164 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:312    .text.HAL_SPI_MspDeInit:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:319    .text.HAL_SPI_MspDeInit:00000000 HAL_SPI_MspDeInit
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:373    .text.HAL_SPI_MspDeInit:00000038 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:381    .text.MX_SPI3_Init:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:388    .text.MX_SPI3_Init:00000000 MX_SPI3_Init
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:452    .text.MX_SPI3_Init:00000050 $d
                            *COM*:00000064 hspi3
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:458    .text.MX_TIM2_Init:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:465    .text.MX_TIM2_Init:00000000 MX_TIM2_Init
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:659    .text.MX_TIM2_Init:000000e4 $d
                            *COM*:0000004c htim2
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:664    .text.hall_Configuration:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:671    .text.hall_Configuration:00000000 hall_Configuration
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:701    .text.hall_Configuration:00000020 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:706    .text.MTPro:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:713    .text.MTPro:00000000 MTPro
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:727    .text.Pll_phase:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:734    .text.Pll_phase:00000000 Pll_phase
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:945    .text.Pll_phase:00000190 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:966    .text.GetElectricAngle:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:973    .text.GetElectricAngle:00000000 GetElectricAngle
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1141   .text.GetElectricAngle:00000100 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1160   .text.sim_ElectricAngle:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1167   .text.sim_ElectricAngle:00000000 sim_ElectricAngle
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1387   .text.sim_ElectricAngle:0000018c $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1403   .text.Encode_Single_to_Multi_R:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1410   .text.Encode_Single_to_Multi_R:00000000 Encode_Single_to_Multi_R
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1507   .text.Encode_Single_to_Multi_R:00000058 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1630   .bss.flag_first_exe:00000000 flag_first_exe
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1648   .bss.g_ElectricAngle_add:00000000 g_ElectricAngle_add
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1731   .bss.s_Encoder_Inc:00000000 s_Encoder_Inc
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1642   .bss.g_ElectricAngle_15bit_Last:00000000 g_ElectricAngle_15bit_Last
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1623   .bss.estimated_phase_integ_int_1:00000000 estimated_phase_integ_int_1
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1617   .bss.estimated_phase_integ_int:00000000 estimated_phase_integ_int
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1719   .bss.pll_pid_integ_int:00000000 pll_pid_integ_int
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1807   .bss.temp_spd_filed:00000000 temp_spd_filed
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1800   .bss.temp_spd:00000000 temp_spd
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1814   .bss.temp_spd_index:00000000 temp_spd_index
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1693   .bss.g_measured_phase:00000000 g_measured_phase
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1610   .bss.estimated_SPD_filterd:00000000 estimated_SPD_filterd
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1725   .bss.pll_pid_out:00000000 pll_pid_out
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1712   .bss.pll_pid_integ:00000000 pll_pid_integ
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1705   .bss.pll_estimated_spd:00000000 pll_estimated_spd
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1699   .bss.pll_estimated_phase:00000000 pll_estimated_phase
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1786   .bss.start_speed_sample:00000000 start_speed_sample
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1636   .bss.g_CurrentSpeed:00000000 g_CurrentSpeed
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1832   .data.s_ForecastCnt1:00000000 s_ForecastCnt1
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1743   .bss.s_IntNum1:00000000 s_IntNum1
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1774   .bss.speed_MCal:00000000 speed_MCal
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1780   .bss.speed_TCal:00000000 speed_TCal
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1838   .data.speed_def:00000000 speed_def
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1737   .bss.s_ForecastTimeAdd1:00000000 s_ForecastTimeAdd1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 49


C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1749   .bss.s_SpeedTimeAdd1:00000000 s_SpeedTimeAdd1
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1570   .bss.Encoder_Inc:00000000 Encoder_Inc
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1576   .bss.Encoder_Last:00000000 Encoder_Last
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1564   .bss.Encoder_Current:00000000 Encoder_Current
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1755   .bss.sincos_sample_c_:00000000 sincos_sample_c_
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1761   .bss.sincos_sample_s_:00000000 sincos_sample_s_
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1826   .bss.tim4_cnt:00000000 tim4_cnt
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1820   .bss.tim3_cnt:00000000 tim3_cnt
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1680   .bss.g_Encode_offset_EN:00000000 g_Encode_offset_EN
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1673   .bss.g_Encode_offset:00000000 g_Encode_offset
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1582   .bss.Num_Turns:00000000 Num_Turns
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1666   .bss.g_Encode_Inc:00000000 g_Encode_Inc
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1660   .bss.g_Encode_AbsPos_Last:00000000 g_Encode_AbsPos_Last
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1654   .bss.g_Encode_AbsPos:00000000 g_Encode_AbsPos
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1686   .bss.g_MEncode:00000000 g_MEncode
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1558   .bss.EncoderAB_PulseWidth_Array:00000000 EncoderAB_PulseWidth_Array
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1555   .bss.EncoderAB_PulseWidth_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1561   .bss.Encoder_Current:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1567   .bss.Encoder_Inc:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1573   .bss.Encoder_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1579   .bss.Num_Turns:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1585   .bss.cnt.12047:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1589   .bss.cnt.12047:00000000 cnt.12047
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1592   .bss.cnt_temp.12060:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1596   .bss.cnt_temp.12060:00000000 cnt_temp.12060
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1599   .bss.count1.12054:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1603   .bss.count1.12054:00000000 count1.12054
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1606   .bss.estimated_SPD_filterd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1613   .bss.estimated_phase_integ_int:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1620   .bss.estimated_phase_integ_int_1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1626   .bss.flag_first_exe:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1633   .bss.g_CurrentSpeed:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1639   .bss.g_ElectricAngle_15bit_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1645   .bss.g_ElectricAngle_add:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1651   .bss.g_Encode_AbsPos:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1657   .bss.g_Encode_AbsPos_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1663   .bss.g_Encode_Inc:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1669   .bss.g_Encode_offset:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1676   .bss.g_Encode_offset_EN:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1683   .bss.g_MEncode:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1689   .bss.g_measured_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1696   .bss.pll_estimated_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1702   .bss.pll_estimated_spd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1708   .bss.pll_pid_integ:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1715   .bss.pll_pid_integ_int:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1722   .bss.pll_pid_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1728   .bss.s_Encoder_Inc:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1734   .bss.s_ForecastTimeAdd1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1740   .bss.s_IntNum1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1746   .bss.s_SpeedTimeAdd1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1752   .bss.sincos_sample_c_:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1758   .bss.sincos_sample_s_:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1764   .bss.single_value_last_raw.12070:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1768   .bss.single_value_last_raw.12070:00000000 single_value_last_raw.12070
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1771   .bss.speed_MCal:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1777   .bss.speed_TCal:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1783   .bss.start_speed_sample:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s 			page 50


C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1789   .bss.sys_mot_test_last.12059:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1793   .bss.sys_mot_test_last.12059:00000000 sys_mot_test_last.12059
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1796   .bss.temp_spd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1803   .bss.temp_spd_filed:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1810   .bss.temp_spd_index:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1817   .bss.tim3_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1823   .bss.tim4_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1829   .data.s_ForecastCnt1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccpO7Ums.s:1835   .data.speed_def:00000000 $d

UNDEFINED SYMBOLS
memset
HAL_GPIO_Init
HAL_DMA_Init
Error_Handler
hdma_spi1_rx
hdma_spi1_tx
HAL_GPIO_DeInit
HAL_SPI_Init
HAL_TIM_Base_Init
HAL_TIM_ConfigClockSource
HAL_TIM_IC_Init
HAL_TIMEx_MasterConfigSynchronization
TIM_TI1_SetConfig
HAL_TIM_IC_ConfigChannel
HAL_TIM_ConfigTI1Input
TIM_CCxChannelCmd
g_CmdMap
motor_
g_MechanicsAngle_15bit
g_MechanicsAngle_15bit_last
EN_360
g_ElectricAngle_15bit_Raw
g_ElectricAngle_act
g_ElectricAngle
EN_0
g_ElectricAngle_15bit
g_ElectricAngle_sim
EN_60
EN_300
EN_30
EN_330
