ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pid.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.PID_ini,"ax",%progbits
  18              		.align	1
  19              		.global	PID_ini
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	PID_ini:
  26              	.LFB333:
  27              		.file 1 "Src/pid.c"
   1:Src/pid.c     **** #include "pid.h"
   2:Src/pid.c     **** #include "global.h"
   3:Src/pid.c     **** #include "icmu.h"
   4:Src/pid.c     **** #include "parameter_identification.h"
   5:Src/pid.c     **** #include "sensorless.h"
   6:Src/pid.c     **** //#include "ouj_cmd.h"
   7:Src/pid.c     **** //3ï¿½Õ»ï¿½ï¿½Å·ï¿½ï¿½ï¿½Ø²ï¿½ï¿½ï¿½
   8:Src/pid.c     **** s16 g_IA = 0,g_IA_Raw = 0;			        
   9:Src/pid.c     **** s16 g_IB = 0,g_IB_Raw = 0;			        
  10:Src/pid.c     **** s16 g_IC = 0,g_IC_Raw = 0;
  11:Src/pid.c     **** s16 g_Sum_ABC = 0;
  12:Src/pid.c     **** volatile s32  g_Iq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  13:Src/pid.c     **** volatile s32  g_Id = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  14:Src/pid.c     **** volatile s32 g_Iq_filter;			// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  15:Src/pid.c     **** volatile s32 g_Id_filter;			// Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  16:Src/pid.c     **** volatile s32  g_Iq_Array[CUR_ARRAY_NUM] = {0};			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  17:Src/pid.c     **** volatile s32  g_Id_Array[CUR_ARRAY_NUM] = {0};			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  18:Src/pid.c     **** volatile s32 g_I_Array_Index = 0;
  19:Src/pid.c     **** volatile s32 g_I_Array_Index_Invalid = 0;
  20:Src/pid.c     **** volatile s32 g_Iq_sum = 0;
  21:Src/pid.c     **** volatile s32 g_Id_sum = 0;
  22:Src/pid.c     **** s32 g_Vq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹
  23:Src/pid.c     **** s32 g_Vd = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  24:Src/pid.c     **** s32 g_Vq_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  25:Src/pid.c     **** s32 g_Vd_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  26:Src/pid.c     **** s32 g_V_Alpha = 0;
  27:Src/pid.c     **** s32 g_V_Beta = 0;
  28:Src/pid.c     **** 
  29:Src/pid.c     **** s32 g_Sector = 0;		      // ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  30:Src/pid.c     **** float g_Spd_Icnt = 0;		    // ï¿½Ù¶ï¿½Iï¿½Û»ï¿½Öµ
  31:Src/pid.c     **** int64_t g_Pos_Icnt = 0;       // Î»ï¿½Ã»ï¿½Iï¿½Û»ï¿½Öµ
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 2


  32:Src/pid.c     **** float Speed_P_out = 0;
  33:Src/pid.c     **** float Speed_I_out = 0;
  34:Src/pid.c     **** s32 g_Pos_PID_16BIT = 0;  // Î»ï¿½Ã»ï¿½PIï¿½ï¿½
  35:Src/pid.c     **** s32 g_Pos_Spd = 0;        // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ
  36:Src/pid.c     **** volatile s32 V_AddReg = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿½ï
  37:Src/pid.c     **** volatile s32 V_SetTotal = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿
  38:Src/pid.c     **** 
  39:Src/pid.c     **** 
  40:Src/pid.c     **** s16 g_testAngle = 0;           //
  41:Src/pid.c     **** 
  42:Src/pid.c     **** 
  43:Src/pid.c     **** //u8 SpeedPID_Enable = 0;
  44:Src/pid.c     **** //u8 PostionPID_Enable = 0;
  45:Src/pid.c     **** s32 g_posPID_e = 0;
  46:Src/pid.c     **** u8 PosAtDead_Flag = 0;
  47:Src/pid.c     **** u8 PosAtDead_Flag_Last = 0;
  48:Src/pid.c     **** 
  49:Src/pid.c     **** volatile int time4_capture_ch1;
  50:Src/pid.c     **** extern int g_ElectricAngle_add ;
  51:Src/pid.c     **** extern float  pll_estimated_spd;
  52:Src/pid.c     **** extern float pll_estimated_phase ;
  53:Src/pid.c     **** 
  54:Src/pid.c     **** 
  55:Src/pid.c     **** s32 g_spd_error = 0;           //
  56:Src/pid.c     **** extern volatile int32_t SPI_X[9] ;
  57:Src/pid.c     **** extern volatile int32_t SPI_Y[9];
  58:Src/pid.c     **** extern volatile int16_t SPI_0_Array[250];
  59:Src/pid.c     **** s16 anlge_reg;
  60:Src/pid.c     **** s32 g_decLen = 0;
  61:Src/pid.c     **** s32 g_X, g_Y, g_Z;
  62:Src/pid.c     **** s16 Spd_RPM_CatchLimit = 0;//ï¿½Ð³ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½
  63:Src/pid.c     **** //ï¿½ï¿½ï¿½ï¿½ï¿½Õ¢ï¿½ß¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½ï¿½ï¿½
  64:Src/pid.c     **** volatile u8 Grriper_Ready = 0;
  65:Src/pid.c     **** volatile u8 Grriper_Run = 0,Grriper_Run_last = 0;
  66:Src/pid.c     **** volatile s32 Grriper_Run_on_delay_cnt = 0,Grriper_Run_off_delay_cnt = 0;
  67:Src/pid.c     **** volatile u8  Brake_rellease_delay = 0;
  68:Src/pid.c     **** volatile s32 Brake_rellease_delay_cnt = 0;
  69:Src/pid.c     **** volatile u8  Flag_Set_OpenLen = 0;
  70:Src/pid.c     **** volatile u8 Test_perm = 0;
  71:Src/pid.c     **** volatile s32 Test_dirt = 1;
  72:Src/pid.c     **** volatile s32 Test_dirt_last = 1;
  73:Src/pid.c     **** volatile s32 sin_wave_t_us = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê± us
  74:Src/pid.c     **** volatile s32 motor_para_identification_count_Tms = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  75:Src/pid.c     **** volatile s32 I_phase[3][100] = {0};//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  76:Src/pid.c     **** volatile s32 index_I_phase = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  77:Src/pid.c     **** volatile s32 Para_Identificaion = 0;
  78:Src/pid.c     **** double T_t = 0.0;
  79:Src/pid.c     **** double T_t_1 = 0.0;
  80:Src/pid.c     **** volatile s32 pos_error_to_target = 0;
  81:Src/pid.c     **** struct PID_TYPE pid_IQ,pid_ID,pid_force,pid_spd,pid_pos,pid_pll;
  82:Src/pid.c     **** 
  83:Src/pid.c     **** void hfi_update_angle(void);
  84:Src/pid.c     **** void PID_ini(struct PID_TYPE * p_pid,u32 freq)   //PID
  85:Src/pid.c     **** {
  28              		.loc 1 85 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 3


  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              	.LVL0:
  86:Src/pid.c     **** 		p_pid->integral = 0;
  34              		.loc 1 86 0
  35 0000 0023     		movs	r3, #0
  36 0002 4364     		str	r3, [r0, #68]
  87:Src/pid.c     **** 		p_pid->error = 0;
  88:Src/pid.c     **** 		p_pid->error_last = 0;
  37              		.loc 1 88 0
  38 0004 C0E90633 		strd	r3, r3, [r0, #24]
  89:Src/pid.c     **** 		p_pid->out = 0;
  90:Src/pid.c     **** 		p_pid->frequency = freq;
  39              		.loc 1 90 0
  40 0008 C0E90D31 		strd	r3, r1, [r0, #52]
  91:Src/pid.c     **** }
  41              		.loc 1 91 0
  42 000c 7047     		bx	lr
  43              		.cfi_endproc
  44              	.LFE333:
  46              		.section	.text.PID_control,"ax",%progbits
  47              		.align	1
  48              		.global	PID_control
  49              		.syntax unified
  50              		.thumb
  51              		.thumb_func
  52              		.fpu fpv4-sp-d16
  54              	PID_control:
  55              	.LFB334:
  92:Src/pid.c     **** void PID_control(s32 set,s32 act,struct PID_TYPE * p_pid)   //PID
  93:Src/pid.c     **** {
  56              		.loc 1 93 0
  57              		.cfi_startproc
  58              		@ args = 0, pretend = 0, frame = 0
  59              		@ frame_needed = 0, uses_anonymous_args = 0
  60              	.LVL1:
  94:Src/pid.c     **** 	s32 deriv=0;
  95:Src/pid.c     **** 	
  96:Src/pid.c     **** 	if(p_pid->enable == 0)
  61              		.loc 1 96 0
  62 0000 1368     		ldr	r3, [r2]
  93:Src/pid.c     **** 	s32 deriv=0;
  63              		.loc 1 93 0
  64 0002 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
  65              	.LCFI0:
  66              		.cfi_def_cfa_offset 24
  67              		.cfi_offset 4, -24
  68              		.cfi_offset 5, -20
  69              		.cfi_offset 6, -16
  70              		.cfi_offset 7, -12
  71              		.cfi_offset 8, -8
  72              		.cfi_offset 14, -4
  73              		.loc 1 96 0
  74 0006 5BB9     		cbnz	r3, .L3
  97:Src/pid.c     **** 	{
  98:Src/pid.c     **** 		p_pid->integral = 0;
  99:Src/pid.c     **** 		p_pid->error = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 4


 100:Src/pid.c     **** 		p_pid->error_last = 0;
 101:Src/pid.c     **** 		p_pid->out = 0;
 102:Src/pid.c     **** 		p_pid->Part_P = 0;
 103:Src/pid.c     **** 		p_pid->Part_I = 0;
  75              		.loc 1 103 0
  76 0008 0020     		movs	r0, #0
  77              	.LVL2:
  78 000a 0021     		movs	r1, #0
  79              	.LVL3:
 100:Src/pid.c     **** 		p_pid->out = 0;
  80              		.loc 1 100 0
  81 000c C2E90633 		strd	r3, r3, [r2, #24]
  82              		.loc 1 103 0
  83 0010 C2E90A01 		strd	r0, [r2, #40]
  98:Src/pid.c     **** 		p_pid->error = 0;
  84              		.loc 1 98 0
  85 0014 5364     		str	r3, [r2, #68]
 101:Src/pid.c     **** 		p_pid->Part_P = 0;
  86              		.loc 1 101 0
  87 0016 5363     		str	r3, [r2, #52]
 102:Src/pid.c     **** 		p_pid->Part_I = 0;
  88              		.loc 1 102 0
  89 0018 1362     		str	r3, [r2, #32]
 104:Src/pid.c     **** 		p_pid->Part_D = 0;
  90              		.loc 1 104 0
  91 001a 1363     		str	r3, [r2, #48]
  92              	.L2:
 105:Src/pid.c     **** 		return;
 106:Src/pid.c     **** 	}
 107:Src/pid.c     **** 	p_pid->error = set - act; 
 108:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 109:Src/pid.c     **** 	{
 110:Src/pid.c     **** 		p_pid->is_at_dead_zone = 1;
 111:Src/pid.c     **** 		p_pid->error = 0;
 112:Src/pid.c     **** 	}	
 113:Src/pid.c     **** 	if ((p_pid->out < p_pid->Up_limit && p_pid->out > p_pid->Low_limit) ||
 114:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 115:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 116:Src/pid.c     **** 	{
 117:Src/pid.c     **** //		if(p_pid->Ki>1000)
 118:Src/pid.c     **** //		{
 119:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*(p_pid->Ki/100));
 120:Src/pid.c     **** //		}
 121:Src/pid.c     **** //		else
 122:Src/pid.c     **** //		{
 123:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*p_pid->Ki);
 124:Src/pid.c     **** //		}
 125:Src/pid.c     **** 		if(p_pid->Ki>1000)
 126:Src/pid.c     **** 		{
 127:Src/pid.c     **** 			p_pid->integral += (p_pid->error*(p_pid->Ki/100));
 128:Src/pid.c     **** 		}
 129:Src/pid.c     **** 		else
 130:Src/pid.c     **** 		{
 131:Src/pid.c     **** 			p_pid->integral += (p_pid->error*p_pid->Ki);
 132:Src/pid.c     **** 		}
 133:Src/pid.c     **** 	}
 134:Src/pid.c     **** 	p_pid->Part_P = p_pid->error * p_pid->Kp/100;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 5


 135:Src/pid.c     **** 	
 136:Src/pid.c     **** 	
 137:Src/pid.c     **** //	if(p_pid->Ki>1000)
 138:Src/pid.c     **** //	{
 139:Src/pid.c     **** //		p_pid->Part_I = (s32)(100.0f*p_pid->integral/(float)p_pid->frequency);
 140:Src/pid.c     **** //	}
 141:Src/pid.c     **** //	else
 142:Src/pid.c     **** //	{
 143:Src/pid.c     **** //		p_pid->Part_I = (s32)(p_pid->integral/(float)p_pid->frequency);
 144:Src/pid.c     **** //	}
 145:Src/pid.c     **** 	if(p_pid->Ki>1000)
 146:Src/pid.c     **** 	{
 147:Src/pid.c     **** 		p_pid->Part_I = (s32)(100*p_pid->integral/p_pid->frequency);
 148:Src/pid.c     **** 	}
 149:Src/pid.c     **** 	else
 150:Src/pid.c     **** 	{
 151:Src/pid.c     **** 		p_pid->Part_I = (s32)(p_pid->integral/p_pid->frequency);
 152:Src/pid.c     **** 	}	
 153:Src/pid.c     **** 	if(p_pid->Part_I>0x7FFFFFFF)
 154:Src/pid.c     **** 	{
 155:Src/pid.c     **** 		p_pid->Part_I = 0x7FFFFFFF;
 156:Src/pid.c     **** 	}
 157:Src/pid.c     **** 	else if(p_pid->Part_I<(-1*0x7FFFFFFF))
 158:Src/pid.c     **** 	{
 159:Src/pid.c     **** 		p_pid->Part_I = -1*0x7FFFFFFF;
 160:Src/pid.c     **** 	}
 161:Src/pid.c     **** 	deriv = p_pid->Part_D;
 162:Src/pid.c     **** 	p_pid->Part_D = p_pid->Kd * ( 9*deriv + 1*(p_pid->error-p_pid->error_last) )   /1000 ;
 163:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 164:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 165:Src/pid.c     **** 	{
 166:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 167:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 168:Src/pid.c     **** 	}
 169:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 170:Src/pid.c     **** 	{
 171:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 172:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 173:Src/pid.c     **** 	}	
 174:Src/pid.c     **** 	return;
 175:Src/pid.c     **** }
  93              		.loc 1 175 0
  94 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
  95              	.LVL4:
  96              	.L3:
  97              	.LBB4:
  98              	.LBB5:
 108:Src/pid.c     **** 	{
  99              		.loc 1 108 0
 100 0020 5369     		ldr	r3, [r2, #20]
 107:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 101              		.loc 1 107 0
 102 0022 411A     		subs	r1, r0, r1
 103              	.LVL5:
 108:Src/pid.c     **** 	{
 104              		.loc 1 108 0
 105 0024 9942     		cmp	r1, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 6


 107:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 106              		.loc 1 107 0
 107 0026 9161     		str	r1, [r2, #24]
 108:Src/pid.c     **** 	{
 108              		.loc 1 108 0
 109 0028 06DA     		bge	.L5
 110 002a 5B42     		negs	r3, r3
 111 002c 9942     		cmp	r1, r3
 110:Src/pid.c     **** 		p_pid->error = 0;
 112              		.loc 1 110 0
 113 002e C1BF     		itttt	gt
 114 0030 0123     		movgt	r3, #1
 115 0032 5360     		strgt	r3, [r2, #4]
 111:Src/pid.c     **** 	}	
 116              		.loc 1 111 0
 117 0034 0023     		movgt	r3, #0
 118 0036 9361     		strgt	r3, [r2, #24]
 119              	.L5:
 120 0038 D2E90F5C 		ldrd	r5, ip, [r2, #60]
 113:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 121              		.loc 1 113 0
 122 003c 516B     		ldr	r1, [r2, #52]
 123 003e 9369     		ldr	r3, [r2, #24]
 124 0040 D668     		ldr	r6, [r2, #12]
 125 0042 A942     		cmp	r1, r5
 126 0044 12DA     		bge	.L6
 127 0046 6145     		cmp	r1, ip
 128 0048 01DC     		bgt	.L7
 129              	.L8:
 115:Src/pid.c     **** 	{
 130              		.loc 1 115 0
 131 004a 002B     		cmp	r3, #0
 132 004c 12DD     		ble	.L9
 133              	.L7:
 125:Src/pid.c     **** 		{
 134              		.loc 1 125 0
 135 004e B6F57A7F 		cmp	r6, #1000
 136 0052 506C     		ldr	r0, [r2, #68]
 137              	.LVL6:
 127:Src/pid.c     **** 		}
 138              		.loc 1 127 0
 139 0054 C9BF     		itett	gt
 140 0056 6421     		movgt	r1, #100
 131:Src/pid.c     **** 		}
 141              		.loc 1 131 0
 142 0058 03FB0600 		mlale	r0, r3, r6, r0
 127:Src/pid.c     **** 		}
 143              		.loc 1 127 0
 144 005c 96FBF1F1 		sdivgt	r1, r6, r1
 145 0060 03FB0101 		mlagt	r1, r3, r1, r0
 146 0064 CCBF     		ite	gt
 147 0066 5164     		strgt	r1, [r2, #68]
 131:Src/pid.c     **** 		}
 148              		.loc 1 131 0
 149 0068 5064     		strle	r0, [r2, #68]
 150 006a 03E0     		b	.L9
 151              	.LVL7:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 7


 152              	.L6:
 114:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 153              		.loc 1 114 0
 154 006c 002B     		cmp	r3, #0
 155 006e EEDB     		blt	.L7
 156 0070 6145     		cmp	r1, ip
 157 0072 EADD     		ble	.L8
 158              	.LVL8:
 159              	.L9:
 134:Src/pid.c     **** 	
 160              		.loc 1 134 0
 161 0074 9168     		ldr	r1, [r2, #8]
 162 0076 506C     		ldr	r0, [r2, #68]
 163 0078 946B     		ldr	r4, [r2, #56]
 145:Src/pid.c     **** 	{
 164              		.loc 1 145 0
 165 007a B6F57A7F 		cmp	r6, #1000
 134:Src/pid.c     **** 	
 166              		.loc 1 134 0
 167 007e 01FB03FE 		mul	lr, r1, r3
 168 0082 4FF06401 		mov	r1, #100
 147:Src/pid.c     **** 	}
 169              		.loc 1 147 0
 170 0086 C8BF     		it	gt
 171 0088 4843     		mulgt	r0, r1, r0
 134:Src/pid.c     **** 	
 172              		.loc 1 134 0
 173 008a 9EFBF1FE 		sdiv	lr, lr, r1
 151:Src/pid.c     **** 	}	
 174              		.loc 1 151 0
 175 008e 90FBF4F0 		sdiv	r0, r0, r4
 176 0092 C117     		asrs	r1, r0, #31
 177 0094 C2E90A01 		strd	r0, [r2, #40]
 153:Src/pid.c     **** 	{
 178              		.loc 1 153 0
 179 0098 D2E90A67 		ldrd	r6, [r2, #40]
 180 009c 6FF00040 		mvn	r0, #-2147483648
 181 00a0 0021     		movs	r1, #0
 182 00a2 B042     		cmp	r0, r6
 183 00a4 71EB0708 		sbcs	r8, r1, r7
 134:Src/pid.c     **** 	
 184              		.loc 1 134 0
 185 00a8 C2F820E0 		str	lr, [r2, #32]
 153:Src/pid.c     **** 	{
 186              		.loc 1 153 0
 187 00ac 02DA     		bge	.L13
 188              	.L17:
 159:Src/pid.c     **** 	}
 189              		.loc 1 159 0
 190 00ae C2E90A01 		strd	r0, [r2, #40]
 191 00b2 06E0     		b	.L14
 192              	.L13:
 157:Src/pid.c     **** 	{
 193              		.loc 1 157 0
 194 00b4 1348     		ldr	r0, .L18
 195 00b6 4FF0FF31 		mov	r1, #-1
 196 00ba 8642     		cmp	r6, r0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 8


 197 00bc 77EB0106 		sbcs	r6, r7, r1
 198 00c0 F5DB     		blt	.L17
 199              	.L14:
 200              	.LVL9:
 162:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 201              		.loc 1 162 0
 202 00c2 116B     		ldr	r1, [r2, #48]
 203 00c4 D069     		ldr	r0, [r2, #28]
 204 00c6 01EBC101 		add	r1, r1, r1, lsl #3
 205 00ca 1B1A     		subs	r3, r3, r0
 206 00cc 0B44     		add	r3, r3, r1
 207 00ce 1169     		ldr	r1, [r2, #16]
 208 00d0 4B43     		muls	r3, r1, r3
 209 00d2 4FF47A71 		mov	r1, #1000
 210 00d6 93FBF1F3 		sdiv	r3, r3, r1
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 211              		.loc 1 163 0
 212 00da 916A     		ldr	r1, [r2, #40]
 162:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 213              		.loc 1 162 0
 214 00dc 1363     		str	r3, [r2, #48]
 215              	.LVL10:
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 216              		.loc 1 163 0
 217 00de 8E44     		add	lr, lr, r1
 218 00e0 7344     		add	r3, r3, lr
 164:Src/pid.c     **** 	{
 219              		.loc 1 164 0
 220 00e2 9D42     		cmp	r5, r3
 166:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 221              		.loc 1 166 0
 222 00e4 B4BF     		ite	lt
 223 00e6 5563     		strlt	r5, [r2, #52]
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 224              		.loc 1 163 0
 225 00e8 5363     		strge	r3, [r2, #52]
 169:Src/pid.c     **** 	{
 226              		.loc 1 169 0
 227 00ea 536B     		ldr	r3, [r2, #52]
 167:Src/pid.c     **** 	}
 228              		.loc 1 167 0
 229 00ec BCBF     		itt	lt
 230 00ee 6543     		mullt	r5, r4, r5
 231 00f0 5564     		strlt	r5, [r2, #68]
 169:Src/pid.c     **** 	{
 232              		.loc 1 169 0
 233 00f2 6345     		cmp	r3, ip
 172:Src/pid.c     **** 	}	
 234              		.loc 1 172 0
 235 00f4 BEBF     		ittt	lt
 236 00f6 04FB0CF4 		mullt	r4, r4, ip
 171:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 237              		.loc 1 171 0
 238 00fa C2F834C0 		strlt	ip, [r2, #52]
 172:Src/pid.c     **** 	}	
 239              		.loc 1 172 0
 240 00fe 5464     		strlt	r4, [r2, #68]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 9


 241 0100 8CE7     		b	.L2
 242              	.L19:
 243 0102 00BF     		.align	2
 244              	.L18:
 245 0104 01000080 		.word	-2147483647
 246              	.LBE5:
 247              	.LBE4:
 248              		.cfi_endproc
 249              	.LFE334:
 251              		.section	.text.force_PID_out,"ax",%progbits
 252              		.align	1
 253              		.global	force_PID_out
 254              		.syntax unified
 255              		.thumb
 256              		.thumb_func
 257              		.fpu fpv4-sp-d16
 259              	force_PID_out:
 260              	.LFB335:
 176:Src/pid.c     **** //Force PID output
 177:Src/pid.c     **** void force_PID_out(s32 out,struct PID_TYPE * p_pid)   //PID
 178:Src/pid.c     **** {
 261              		.loc 1 178 0
 262              		.cfi_startproc
 263              		@ args = 0, pretend = 0, frame = 0
 264              		@ frame_needed = 0, uses_anonymous_args = 0
 265              	.LVL11:
 179:Src/pid.c     **** 	p_pid->out = out;
 180:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 266              		.loc 1 180 0
 267 0000 CB6B     		ldr	r3, [r1, #60]
 179:Src/pid.c     **** 	p_pid->out = out;
 268              		.loc 1 179 0
 269 0002 4863     		str	r0, [r1, #52]
 270              		.loc 1 180 0
 271 0004 8342     		cmp	r3, r0
 181:Src/pid.c     **** 	{
 182:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 272              		.loc 1 182 0
 273 0006 B8BF     		it	lt
 274 0008 4B63     		strlt	r3, [r1, #52]
 183:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 184:Src/pid.c     **** 	}
 185:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 275              		.loc 1 185 0
 276 000a 4A6B     		ldr	r2, [r1, #52]
 277 000c 0B6C     		ldr	r3, [r1, #64]
 178:Src/pid.c     **** 	p_pid->out = out;
 278              		.loc 1 178 0
 279 000e 30B5     		push	{r4, r5, lr}
 280              	.LCFI1:
 281              		.cfi_def_cfa_offset 12
 282              		.cfi_offset 4, -12
 283              		.cfi_offset 5, -8
 284              		.cfi_offset 14, -4
 285              		.loc 1 185 0
 286 0010 9A42     		cmp	r2, r3
 186:Src/pid.c     **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 10


 187:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 188:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 189:Src/pid.c     **** 	}	
 190:Src/pid.c     **** 	p_pid->error = 0;
 191:Src/pid.c     **** 	p_pid->error_last = 0;
 192:Src/pid.c     **** 	p_pid->Part_P = 0;
 193:Src/pid.c     **** 	p_pid->Part_I = out;
 194:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 287              		.loc 1 194 0
 288 0012 8A6B     		ldr	r2, [r1, #56]
 187:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 289              		.loc 1 187 0
 290 0014 B8BF     		it	lt
 291 0016 4B63     		strlt	r3, [r1, #52]
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 292              		.loc 1 193 0
 293 0018 0446     		mov	r4, r0
 190:Src/pid.c     **** 	p_pid->error_last = 0;
 294              		.loc 1 190 0
 295 001a 0023     		movs	r3, #0
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 296              		.loc 1 193 0
 297 001c C517     		asrs	r5, r0, #31
 298              		.loc 1 194 0
 299 001e 5043     		muls	r0, r2, r0
 300              	.LVL12:
 191:Src/pid.c     **** 	p_pid->Part_P = 0;
 301              		.loc 1 191 0
 302 0020 C1E90633 		strd	r3, r3, [r1, #24]
 192:Src/pid.c     **** 	p_pid->Part_I = out;
 303              		.loc 1 192 0
 304 0024 0B62     		str	r3, [r1, #32]
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 305              		.loc 1 193 0
 306 0026 C1E90A45 		strd	r4, [r1, #40]
 307              		.loc 1 194 0
 308 002a 4864     		str	r0, [r1, #68]
 195:Src/pid.c     **** 	p_pid->Part_D = 0;
 309              		.loc 1 195 0
 310 002c 0B63     		str	r3, [r1, #48]
 196:Src/pid.c     **** }
 311              		.loc 1 196 0
 312 002e 30BD     		pop	{r4, r5, pc}
 313              		.cfi_endproc
 314              	.LFE335:
 316              		.section	.text.PositionPID,"ax",%progbits
 317              		.align	1
 318              		.global	PositionPID
 319              		.syntax unified
 320              		.thumb
 321              		.thumb_func
 322              		.fpu fpv4-sp-d16
 324              	PositionPID:
 325              	.LFB340:
 197:Src/pid.c     **** static void ForcePID(void)
 198:Src/pid.c     **** {
 199:Src/pid.c     **** 	s16 error_force = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 11


 200:Src/pid.c     **** 	s16 error_force_abs = 0;
 201:Src/pid.c     **** //	static u8 flag_in_dead = 0;
 202:Src/pid.c     **** //	static u16 delayCnt_in_dead = 0;
 203:Src/pid.c     **** 	if(g_CmdMap[CMD_FORCE_DIR] == 0)
 204:Src/pid.c     **** 	{
 205:Src/pid.c     **** 		force_set = g_CmdMap[CMD_FORCE_SET_PU];
 206:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 207:Src/pid.c     **** 	}
 208:Src/pid.c     **** 	else
 209:Src/pid.c     **** 	{
 210:Src/pid.c     **** 		force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 211:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 212:Src/pid.c     **** 	}
 213:Src/pid.c     **** ////	if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-819) && g_CmdMap[CMD_POS_ACT_PU]
 214:Src/pid.c     **** ////	{
 215:Src/pid.c     **** //				if(force_set>16)
 216:Src/pid.c     **** //				{
 217:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FORCE
 218:Src/pid.c     **** //					pid_force.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 219:Src/pid.c     **** //				}
 220:Src/pid.c     **** //				else if(force_set<-16)
 221:Src/pid.c     **** //				{
 222:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 223:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FOR
 224:Src/pid.c     **** //				}
 225:Src/pid.c     **** //				else
 226:Src/pid.c     **** //				{
 227:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>7)
 228:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]-(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>
 229:Src/pid.c     **** //				}
 230:Src/pid.c     **** //////	}
 231:Src/pid.c     **** ////	if(pid_force.Up_limit<g_CmdMap[SYS_RESISTANCE_CURPU])
 232:Src/pid.c     **** ////	{
 233:Src/pid.c     **** ////		pid_force.Up_limit=g_CmdMap[SYS_RESISTANCE_CURPU];
 234:Src/pid.c     **** ////	}
 235:Src/pid.c     **** ////	if(pid_force.Low_limit>(-1*g_CmdMap[SYS_RESISTANCE_CURPU]))
 236:Src/pid.c     **** ////	{
 237:Src/pid.c     **** ////		pid_force.Low_limit=-1*g_CmdMap[SYS_RESISTANCE_CURPU];
 238:Src/pid.c     **** ////	}
 239:Src/pid.c     **** 	pid_force.Up_limit = ((g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])>>0);
 240:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 241:Src/pid.c     **** 	
 242:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]>g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 243:Src/pid.c     **** 	{
 244:Src/pid.c     **** 		pid_force.Up_limit = 0;
 245:Src/pid.c     **** 		
 246:Src/pid.c     **** 	}
 247:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]>(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-409)&& g_CmdMap[CMD_CUR_SET_PU]
 248:Src/pid.c     **** 	{
 249:Src/pid.c     **** 		pid_force.Up_limit = 0;
 250:Src/pid.c     **** 		
 251:Src/pid.c     **** 	}
 252:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]<g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 253:Src/pid.c     **** 	{
 254:Src/pid.c     **** 		pid_force.Low_limit = 0;
 255:Src/pid.c     **** 		
 256:Src/pid.c     **** 	}	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 12


 257:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_LOWER_LIMIT_PU]+409)  && g_CmdMap[CMD_CUR_SET_P
 258:Src/pid.c     **** 	{
 259:Src/pid.c     **** 		pid_force.Low_limit = 0;
 260:Src/pid.c     **** 		
 261:Src/pid.c     **** 	}
 262:Src/pid.c     **** 	
 263:Src/pid.c     **** 
 264:Src/pid.c     **** 	
 265:Src/pid.c     **** //	error_force = force_set - force_act;
 266:Src/pid.c     **** //	error_force_abs = ABS(error_force);
 267:Src/pid.c     **** //	if(error_force < (pid_force.dead_zone>>1))
 268:Src/pid.c     **** //	{
 269:Src/pid.c     **** //		if(delayCnt_in_dead<1000)
 270:Src/pid.c     **** //		{
 271:Src/pid.c     **** //			delayCnt_in_dead++;
 272:Src/pid.c     **** //		}
 273:Src/pid.c     **** //		else
 274:Src/pid.c     **** //		{
 275:Src/pid.c     **** //			flag_in_dead = 1;
 276:Src/pid.c     **** //		}
 277:Src/pid.c     **** //	}
 278:Src/pid.c     **** //	if(error_force_abs > pid_force.dead_zone)
 279:Src/pid.c     **** //	{
 280:Src/pid.c     **** //		delayCnt_in_dead = 0;
 281:Src/pid.c     **** //		flag_in_dead = 0;
 282:Src/pid.c     **** //	}
 283:Src/pid.c     **** //	if(flag_in_dead == 1)
 284:Src/pid.c     **** //	{
 285:Src/pid.c     **** //		force_PID_out(0,&pid_force);
 286:Src/pid.c     **** //	}
 287:Src/pid.c     **** //	else
 288:Src/pid.c     **** //	{
 289:Src/pid.c     **** 		PID_control(force_set,force_act,&pid_force);
 290:Src/pid.c     **** //	}
 291:Src/pid.c     **** 	//
 292:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_force.out;
 293:Src/pid.c     **** 	
 294:Src/pid.c     **** 	if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_4_FORCE || (g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MO
 295:Src/pid.c     **** 	{
 296:Src/pid.c     **** 		Flag_Profile_Enable = 0;
 297:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 298:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 299:Src/pid.c     **** 	}
 300:Src/pid.c     **** }
 301:Src/pid.c     **** 
 302:Src/pid.c     **** // SVPWMï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½
 303:Src/pid.c     **** static void Calculate_CCR_SVP(TIM_TypeDef* TIMx, int sector, int X, int Y, int Z)
 304:Src/pid.c     **** {
 305:Src/pid.c     ****   s32 t0, tk, tk_1;
 306:Src/pid.c     ****   s32 CCR1 = 0;
 307:Src/pid.c     ****   s32 CCR2 = 0;
 308:Src/pid.c     ****   s32 CCR3 = 0;
 309:Src/pid.c     ****   switch (sector)
 310:Src/pid.c     ****   {
 311:Src/pid.c     ****     case 1:
 312:Src/pid.c     **** 			tk_1 = Z;
 313:Src/pid.c     **** 			tk = Y;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 13


 314:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 315:Src/pid.c     **** 			CCR3 = t0>>1;
 316:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 317:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
 318:Src/pid.c     **** 		break;		
 319:Src/pid.c     **** 		case 2:
 320:Src/pid.c     **** 			tk_1 = Y;
 321:Src/pid.c     **** 			tk = -X;
 322:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 323:Src/pid.c     **** 			CCR2 = t0>>1;
 324:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 325:Src/pid.c     **** 			CCR1 = CCR3 + tk_1;
 326:Src/pid.c     **** 		break;		
 327:Src/pid.c     **** 		case 3:
 328:Src/pid.c     **** 			tk_1 = X;
 329:Src/pid.c     **** 			tk = -Z;
 330:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 331:Src/pid.c     **** 			CCR3 = t0>>1;
 332:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 333:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 334:Src/pid.c     **** 		break;		
 335:Src/pid.c     **** 		case 4:
 336:Src/pid.c     **** 			tk_1 = -X;
 337:Src/pid.c     **** 			tk = Z;
 338:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 339:Src/pid.c     **** 			CCR1 = t0>>1;
 340:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 341:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 342:Src/pid.c     **** 		break;
 343:Src/pid.c     **** 		case 5:
 344:Src/pid.c     **** 			tk_1 = -Y;
 345:Src/pid.c     **** 			tk = X;
 346:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 347:Src/pid.c     **** 			CCR1 = t0>>1;
 348:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 349:Src/pid.c     **** 			CCR2 = CCR3 + tk;
 350:Src/pid.c     **** 		break;
 351:Src/pid.c     **** 		case 6:
 352:Src/pid.c     **** 			tk_1 = -Z;
 353:Src/pid.c     **** 			tk = -Y;
 354:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 355:Src/pid.c     **** 			CCR2 = t0>>1;
 356:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 357:Src/pid.c     **** 			CCR3 = CCR1 + tk;
 358:Src/pid.c     **** 		break;
 359:Src/pid.c     **** 		default:
 360:Src/pid.c     **** 			CCR1 = REAL_CCR >> 1;
 361:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 362:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 363:Src/pid.c     **** 		break;
 364:Src/pid.c     ****   }
 365:Src/pid.c     **** 	CCR1 = CCR1>N97_CCR?N97_CCR:(CCR1<0?0:CCR1);
 366:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 367:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 368:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 369:Src/pid.c     **** 	{
 370:Src/pid.c     **** 			motor_para_identification_count_Tms = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 14


 371:Src/pid.c     **** 			sin_wave_t_us = 0;
 372:Src/pid.c     **** 	}
 373:Src/pid.c     ****    // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½97%
 374:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¶ Step1:ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Step2ï¿½ï¿½ï¿½ï¿½ï¿½Ð²ï¿½ï¿½ï
 375:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4 || g_CmdMap[SYS_MOT_TEST] == 5)
 376:Src/pid.c     **** 	{
 377:Src/pid.c     **** 		sin_wave_t_us = sin_wave_t_us + 4;
 378:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 379:Src/pid.c     **** 		{
 380:Src/pid.c     **** 			sin_wave_t_us = 0;
 381:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 382:Src/pid.c     **** 		}
 383:Src/pid.c     **** 	}
 384:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4)
 385:Src/pid.c     **** 	{
 386:Src/pid.c     **** 		CCR1 = 1;
 387:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 388:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 389:Src/pid.c     **** 		Para_Identificaion++;
 390:Src/pid.c     **** 		if(Para_Identificaion>=0)
 391:Src/pid.c     **** 		{
 392:Src/pid.c     **** 			Para_Identificaion = 0;
 393:Src/pid.c     **** 			if(index_I_phase<100)
 394:Src/pid.c     **** 			{
 395:Src/pid.c     **** 				I_phase[0][index_I_phase] = -g_IA_Raw;
 396:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
 397:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 398:Src/pid.c     **** 			}
 399:Src/pid.c     **** 			index_I_phase++;
 400:Src/pid.c     **** 		}
 401:Src/pid.c     **** 		if(motor_para_identification_count_Tms > 200)//1sï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 402:Src/pid.c     **** 		{	
 403:Src/pid.c     **** 			T_t = 0.000040/(log(-1.0*(double)I_phase[0][99]/((double)(I_phase[0][2] - I_phase[0][99])))   );
 404:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 405:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 406:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 407:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
 408:Src/pid.c     **** 		}
 409:Src/pid.c     **** 	}	 
 410:Src/pid.c     ****   TIMx->CCR3 = CCR3;
 411:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 412:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 413:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 414:Src/pid.c     **** 	TIMx->CCER = (u16)PWM_OUTPUT_REG;
 415:Src/pid.c     **** }
 416:Src/pid.c     **** 
 417:Src/pid.c     **** extern volatile int g_high_fre_pulse;
 418:Src/pid.c     **** float dec_bemf=0;
 419:Src/pid.c     **** float Vq = 0;
 420:Src/pid.c     **** float Iq_filter =0.0f;
 421:Src/pid.c     **** float Id_filter =0.0f;
 422:Src/pid.c     **** // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½20KHz
 423:Src/pid.c     **** static void CurrentPID(void)
 424:Src/pid.c     **** {            
 425:Src/pid.c     ****   s32 temp32 = 0;       
 426:Src/pid.c     ****   s32 X, Y, Z;
 427:Src/pid.c     **** 	static u16 test = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 15


 428:Src/pid.c     **** 	s32 abs_g_Vq;
 429:Src/pid.c     **** 	s16 set_current = 0;
 430:Src/pid.c     **** 	static int inr_angle =0;
 431:Src/pid.c     **** 	
 432:Src/pid.c     **** 	if (g_CmdMap[TAG_WORK_MODE] != MODE_CURRENT)  // ï¿½ï¿½Ç°Ä£Ê½ï¿½ï¿½ï¿½Çµï¿½ï¿½ï¿½ï¿½ï¿½
 433:Src/pid.c     **** 	{
 434:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED || g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
 435:Src/pid.c     **** 		{
 436:Src/pid.c     **** 		//	g_CmdMap[CMD_CUR_FWD_PU] = 1*((s32)g_CmdMap[CMD_ACC_PRE_PU]*5)>>4;
 437:Src/pid.c     **** 			g_CmdMap[CMD_CUR_FWD_PU] = 1*(s32)g_CmdMap[CMD_ACC_PRE_PU];
 438:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 439:Src/pid.c     **** 		}
 440:Src/pid.c     **** 		else if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
 441:Src/pid.c     **** 		{
 442:Src/pid.c     **** //			g_CmdMap[CMD_CUR_SET_PU] = pid_force.out;
 443:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out ;
 444:Src/pid.c     **** 		
 445:Src/pid.c     **** 		}
 446:Src/pid.c     **** 		else
 447:Src/pid.c     **** 		{
 448:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 449:Src/pid.c     **** 		}	
 450:Src/pid.c     **** 	}
 451:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô£ï¿½ï¿½Ü²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ£ï¿½Ö»ï¿½ï¿½ï¿½ï¿½1msÎªï
 452:Src/pid.c     **** 	if(g_CmdMap[SYS_SELF_TUNING] == 1)//
 453:Src/pid.c     **** 	{
 454:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 455:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 456:Src/pid.c     **** 		if(test++ > (50))
 457:Src/pid.c     **** 		{
 458:Src/pid.c     **** 			test = 0;
 459:Src/pid.c     **** 		}
 460:Src/pid.c     **** 		if(test>(25))
 461:Src/pid.c     **** 		{
 462:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 16*200;
 463:Src/pid.c     **** 		}
 464:Src/pid.c     **** 		else
 465:Src/pid.c     **** 		{
 466:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = -16*200;		
 467:Src/pid.c     **** 		}	
 468:Src/pid.c     **** 	}
 469:Src/pid.c     **** 	else if(g_CmdMap[SYS_SELF_TUNING] == 3)//ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 470:Src/pid.c     **** 	{
 471:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 472:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 473:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 474:Src/pid.c     **** 		{
 475:Src/pid.c     **** 			state_Jtest = 0;
 476:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 477:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 478:Src/pid.c     **** 		}
 479:Src/pid.c     **** 		switch(state_Jtest)
 480:Src/pid.c     **** 		{
 481:Src/pid.c     **** 			case 0:
 482:Src/pid.c     **** 			{	
 483:Src/pid.c     **** 				flag_processing_Jtest = 1;
 484:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 16


 485:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 486:Src/pid.c     **** 				{
 487:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME1] = g_CmdMap[CMD_JTEST_TIME1] + SVPWM_PERIOD_US;					
 488:Src/pid.c     **** 				}
 489:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>(8192+819))
 490:Src/pid.c     **** 				{
 491:Src/pid.c     **** 					state_Jtest++;
 492:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 493:Src/pid.c     **** 				}
 494:Src/pid.c     **** 				break;
 495:Src/pid.c     **** 			}
 496:Src/pid.c     **** 			case 1:
 497:Src/pid.c     **** 			{	
 498:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = -8192;
 499:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 500:Src/pid.c     **** 				{
 501:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = g_CmdMap[CMD_JTEST_TIME2] + SVPWM_PERIOD_US;					
 502:Src/pid.c     **** 				}
 503:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 504:Src/pid.c     **** 				{
 505:Src/pid.c     **** 					state_Jtest++;
 506:Src/pid.c     **** 				}
 507:Src/pid.c     **** 				break;
 508:Src/pid.c     **** 			}
 509:Src/pid.c     **** 			case 2:
 510:Src/pid.c     **** 			{	
 511:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 512:Src/pid.c     **** 				{
 513:Src/pid.c     **** 					state_Jtest++;
 514:Src/pid.c     **** 				}				
 515:Src/pid.c     **** 				break;
 516:Src/pid.c     **** 			}
 517:Src/pid.c     **** 			default:
 518:Src/pid.c     **** 			{	
 519:Src/pid.c     **** 				g_CmdMap[SYS_SELF_TUNING] = 0;
 520:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 521:Src/pid.c     **** 				flag_processing_Jtest = 0;
 522:Src/pid.c     **** 				break;
 523:Src/pid.c     **** 			}
 524:Src/pid.c     **** 		}
 525:Src/pid.c     **** 	}
 526:Src/pid.c     **** 		else if(g_CmdMap[SYS_SELF_TUNING] == 4)//
 527:Src/pid.c     **** 	{
 528:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 529:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 530:Src/pid.c     **** 
 531:Src/pid.c     **** 		
 532:Src/pid.c     **** 		test++;
 533:Src/pid.c     **** 		if(test < (10*10))
 534:Src/pid.c     **** 		{
 535:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 536:Src/pid.c     **** 		}
 537:Src/pid.c     **** 		else if(test < (10*60))
 538:Src/pid.c     **** 		{
 539:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 4096;
 540:Src/pid.c     **** 		}
 541:Src/pid.c     **** 		else if(test < (10*110))
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 17


 542:Src/pid.c     **** 		{
 543:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 544:Src/pid.c     **** 		}
 545:Src/pid.c     **** 		else if(test < (10*160))
 546:Src/pid.c     **** 		{
 547:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = -4096;
 548:Src/pid.c     **** 		}
 549:Src/pid.c     **** 		else if(test < (10*170))
 550:Src/pid.c     **** 		{
 551:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 552:Src/pid.c     **** 		}
 553:Src/pid.c     **** 		else
 554:Src/pid.c     **** 		{
 555:Src/pid.c     **** 			test = 0;
 556:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 557:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 558:Src/pid.c     **** 		}
 559:Src/pid.c     **** 	}
 560:Src/pid.c     **** 	else
 561:Src/pid.c     **** 	{
 562:Src/pid.c     **** 
 563:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]> g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 564:Src/pid.c     **** 		{
 565:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 566:Src/pid.c     **** 		}
 567:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]< g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 568:Src/pid.c     **** 		{
 569:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 570:Src/pid.c     **** 		}
 571:Src/pid.c     **** 	}
 572:Src/pid.c     **** 	
 573:Src/pid.c     **** 	float Ierr_d = 0.f - (float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000.0f
 574:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 575:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 576:Src/pid.c     ****     Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_control_.p_
 577:Src/pid.c     **** 
 578:Src/pid.c     ****     Iq_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000.
 579:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 580:Src/pid.c     ****     
 581:Src/pid.c     ****     float dec_vd=0, dec_vq=0,pm_flux_linkage=0;
 582:Src/pid.c     ****     pm_flux_linkage =  motor_.config_.pm_flux_linkage*1.f;
 583:Src/pid.c     ****     dec_vd = Iq_filter * (*motor_.vel_estimate_erad_) *  motor_.config_.phase_inductance;
 584:Src/pid.c     ****     dec_vq = Id_filter * (*motor_.vel_estimate_erad_) *  motor_.config_.phase_inductance;
 585:Src/pid.c     ****     dec_bemf = (*motor_.vel_estimate_erad_) * pm_flux_linkage;
 586:Src/pid.c     **** 
 587:Src/pid.c     ****     Vd -=  dec_vd;
 588:Src/pid.c     ****     Vq +=  dec_vq + dec_bemf;  
 589:Src/pid.c     **** 
 590:Src/pid.c     ****     float mod_to_V = one_by_sqrt3 * bus_voltage_;
 591:Src/pid.c     ****     float V_to_mod = 1.0f / mod_to_V;
 592:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 593:Src/pid.c     ****     float mod_q = V_to_mod * Vq;
 594:Src/pid.c     **** 
 595:Src/pid.c     **** 	float mod_scalefactor =  0.9f / sqrtf(mod_d * mod_d + mod_q * mod_q);
 596:Src/pid.c     **** 	if(mod_scalefactor < 1.0f)
 597:Src/pid.c     **** 	{
 598:Src/pid.c     ****         mod_d *= mod_scalefactor;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 18


 599:Src/pid.c     ****         mod_q *= mod_scalefactor;
 600:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d *= 0.99f;
 601:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 602:Src/pid.c     **** 	}
 603:Src/pid.c     **** 	else
 604:Src/pid.c     **** 	{
 605:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d += Ierr_d * (motor_.current_control_.i_gain 
 606:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q += Ierr_q * (motor_.current_control_.i
 607:Src/pid.c     **** 	}
 608:Src/pid.c     **** 
 609:Src/pid.c     **** 
 610:Src/pid.c     **** 	
 611:Src/pid.c     **** 	
 612:Src/pid.c     **** 	g_Vq = (s16)(mod_q*(float)REAL_CCR);
 613:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 614:Src/pid.c     **** 	
 615:Src/pid.c     **** //	g_Vq = 100;//g_high_fre_pulse * 500;
 616:Src/pid.c     **** //	g_Vd = g_high_fre_pulse * 1000;
 617:Src/pid.c     **** 	
 618:Src/pid.c     **** 	g_high_fre_pulse = 0 - g_high_fre_pulse;
 619:Src/pid.c     **** 	
 620:Src/pid.c     **** //	inr_angle += 1;
 621:Src/pid.c     **** //	g_ElectricAngle = inr_angle;
 622:Src/pid.c     **** 	
 623:Src/pid.c     ****   // Parkï¿½ï¿½ï¿½ä»»
 624:Src/pid.c     **** //	
 625:Src/pid.c     **** //		g_ElectricAngle_add = (int)pll_estimated_spd /100000;
 626:Src/pid.c     **** //		g_ElectricAngle = g_ElectricAngle + g_ElectricAngle_add;// * 0.000025;
 627:Src/pid.c     **** 	
 628:Src/pid.c     **** 	X = Math_Sin_EN360( g_ElectricAngle  );
 629:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 630:Src/pid.c     **** 	//g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½
 631:Src/pid.c     **** 	//g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 632:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,Y) - Q15_MUL(g_Vq,X);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 633:Src/pid.c     **** 	g_V_Beta = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);
 634:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 635:Src/pid.c     **** 	X = g_V_Beta;
 636:Src/pid.c     **** 	temp32 = Q16_MUL(g_V_Alpha,113512);
 637:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 638:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 639:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
 640:Src/pid.c     ****   temp32 = 0;
 641:Src/pid.c     **** 	/** ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ª**/	
 642:Src/pid.c     **** 	if (X > 0) temp32 = 1;
 643:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 644:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 645:Src/pid.c     **** 	g_Sector = temp32;
 646:Src/pid.c     **** 	g_Sector_test = g_Sector;
 647:Src/pid.c     **** 	g_X = X;
 648:Src/pid.c     **** 	g_Y = Y;
 649:Src/pid.c     **** 	g_Z = Z;
 650:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 651:Src/pid.c     **** 
 652:Src/pid.c     **** }
 653:Src/pid.c     **** static void SpeedPID(void)
 654:Src/pid.c     **** { 
 655:Src/pid.c     **** 	static s32 s_test_speed_t_count = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 19


 656:Src/pid.c     **** 	s16 spd_test = 0;
 657:Src/pid.c     **** 	
 658:Src/pid.c     ****   if (g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT ||g_CmdMap[TAG_WORK_MODE] == MODE_POSITION||g_CmdMap[
 659:Src/pid.c     ****   {
 660:Src/pid.c     **** 			g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_PROFILE_SPD_PU] + g_CmdMap[CMD_SPD_ADD_PU];
 661:Src/pid.c     ****   }
 662:Src/pid.c     **** 	else if( g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 663:Src/pid.c     **** 	{
 664:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_ADD_PU];
 665:Src/pid.c     **** 		
 666:Src/pid.c     **** 		pid_spd.enable =1;
 667:Src/pid.c     **** 	}
 668:Src/pid.c     ****   else if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED)
 669:Src/pid.c     ****   {
 670:Src/pid.c     **** 			if(status_Mode_POSITION_FORCE == 2) //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ÐµÄµï¿½ï¿½ï¿½ï¿½Ù
 671:Src/pid.c     **** 			{
 672:Src/pid.c     **** 				if(g_CmdMap[CMD_FORCE_DIR] == 0)
 673:Src/pid.c     **** 				{
 674:Src/pid.c     **** 					force_set = g_CmdMap[CMD_FORCE_SET_PU];
 675:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 676:Src/pid.c     **** 				}
 677:Src/pid.c     **** 				else
 678:Src/pid.c     **** 				{
 679:Src/pid.c     **** 					force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 680:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 681:Src/pid.c     **** 				}
 682:Src/pid.c     **** 				if(force_set >= 0 )
 683:Src/pid.c     **** 				{
 684:Src/pid.c     **** 					if(force_act>force_set || g_CmdMap[CMD_POS_ACT_PU] > g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 685:Src/pid.c     **** 					{
 686:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
 687:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;	
 688:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force);
 689:Src/pid.c     **** 					
 690:Src/pid.c     **** 					}
 691:Src/pid.c     **** 					else
 692:Src/pid.c     **** 					{
 693:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SOFT_SET_PU];
 694:Src/pid.c     **** 					}
 695:Src/pid.c     **** 				}
 696:Src/pid.c     **** 				else
 697:Src/pid.c     **** 				{
 698:Src/pid.c     **** 					if(force_act<force_set || g_CmdMap[CMD_POS_ACT_PU] < g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 699:Src/pid.c     **** 					{
 700:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
 701:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 702:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 703:Src/pid.c     ****  		
 704:Src/pid.c     **** 					}
 705:Src/pid.c     **** 					else
 706:Src/pid.c     **** 					{
 707:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = -1*g_CmdMap[CMD_SPD_SOFT_SET_PU];
 708:Src/pid.c     **** 					}
 709:Src/pid.c     **** 				}
 710:Src/pid.c     **** 			}
 711:Src/pid.c     **** 			else
 712:Src/pid.c     **** 			{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 20


 713:Src/pid.c     **** 							if(g_CmdMap[SYS_SPEED_TEST] == 0)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 714:Src/pid.c     **** 							{
 715:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SET_PU];
 716:Src/pid.c     **** 							}
 717:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 1)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½ï
 718:Src/pid.c     **** 							{
 719:Src/pid.c     **** 								
 720:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ACT_PU] < 1638)
 721:Src/pid.c     **** 								{
 722:Src/pid.c     **** 									Test_dirt = 1;					
 723:Src/pid.c     **** 								}
 724:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ACT_PU] > (16384-1638))
 725:Src/pid.c     **** 								{
 726:Src/pid.c     **** 									Test_dirt = -1;					
 727:Src/pid.c     **** 								}
 728:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*g_CmdMap[CMD_SPD_SET_PU];
 729:Src/pid.c     **** 
 730:Src/pid.c     **** 							}	
 731:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 11)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½
 732:Src/pid.c     **** 							{
 733:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(0)])
 734:Src/pid.c     **** 								{
 735:Src/pid.c     **** 									Test_dirt = 1;
 736:Src/pid.c     **** 								}
 737:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ADC_12BIT] > g_CmdMap[POS_LINEARITY_ADC(30)])
 738:Src/pid.c     **** 								{
 739:Src/pid.c     **** 									Test_dirt = -1;
 740:Src/pid.c     **** 								}
 741:Src/pid.c     **** 								spd_test = ABS(g_CmdMap[CMD_SPD_SET_PU]);
 742:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 743:Src/pid.c     **** 								{
 744:Src/pid.c     **** 									s_test_speed_t_count = 0;
 745:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 746:Src/pid.c     **** 									{
 747:Src/pid.c     **** 										Test_perm = 0;   //4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 748:Src/pid.c     **** 									}
 749:Src/pid.c     **** 									else
 750:Src/pid.c     **** 									{
 751:Src/pid.c     **** 										Test_perm = 1;//4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 752:Src/pid.c     **** 									}
 753:Src/pid.c     **** 									g_flag_monitor_from_host = 0;
 754:Src/pid.c     **** 								}
 755:Src/pid.c     **** 												if(Test_perm == 1)
 756:Src/pid.c     **** 								{
 757:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*spd_test;
 758:Src/pid.c     **** 								}
 759:Src/pid.c     **** 								else
 760:Src/pid.c     **** 								{
 761:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 762:Src/pid.c     **** 								}				
 763:Src/pid.c     **** 							}				
 764:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 12)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½Ð¡Î»ï
 765:Src/pid.c     **** 							{
 766:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] >g_CmdMap[POS_LINEARITY_ADC(0)])
 767:Src/pid.c     **** 								{
 768:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = -8192;
 769:Src/pid.c     **** 								}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 21


 770:Src/pid.c     **** 								else
 771:Src/pid.c     **** 								{
 772:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 773:Src/pid.c     **** 								}
 774:Src/pid.c     **** 							}
 775:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 13)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½ï¿½Î»
 776:Src/pid.c     **** 							{
 777:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(30)])
 778:Src/pid.c     **** 								{
 779:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 8192;
 780:Src/pid.c     **** 								}
 781:Src/pid.c     **** 								else
 782:Src/pid.c     **** 								{
 783:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 784:Src/pid.c     **** 								}
 785:Src/pid.c     **** 							}
 786:Src/pid.c     **** 							else
 787:Src/pid.c     **** 							{
 788:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 789:Src/pid.c     **** 							}				
 790:Src/pid.c     **** 			}
 791:Src/pid.c     **** 	}
 792:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]> g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])
 793:Src/pid.c     **** 	{
 794:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_UPPER_LIMIT_PU];
 795:Src/pid.c     **** 	}
 796:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]< g_CmdMap[SYS_SPD_LOWER_LIMIT_PU])
 797:Src/pid.c     **** 	{
 798:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_LOWER_LIMIT_PU];
 799:Src/pid.c     **** 	}
 800:Src/pid.c     **** 
 801:Src/pid.c     **** 
 802:Src/pid.c     **** 	
 803:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] > g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 804:Src/pid.c     **** 	{
 805:Src/pid.c     **** 		//g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 806:Src/pid.c     **** 	}
 807:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] < g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 808:Src/pid.c     **** 	{
 809:Src/pid.c     **** 		//g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 810:Src/pid.c     **** 	}
 811:Src/pid.c     **** 	
 812:Src/pid.c     **** 	pid_spd.Up_limit = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 813:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];		
 814:Src/pid.c     **** 	
 815:Src/pid.c     **** 	
 816:Src/pid.c     **** 	
 817:Src/pid.c     **** 	
 818:Src/pid.c     **** 	
 819:Src/pid.c     **** //	
 820:Src/pid.c     **** //	pid_spd.Up_limit = 1000;
 821:Src/pid.c     **** //	pid_spd.Low_limit = -1000;		
 822:Src/pid.c     **** //	
 823:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_SPDREG_REF_PU],g_CmdMap[CMD_SPD_ACT_PU],&pid_spd);	
 824:Src/pid.c     **** }
 825:Src/pid.c     **** void PositionPID(void)   //ï¿½Å½ï¿½ï¿½ï¿½ï¿½ï¿½ Î»ï¿½Ãµï¿½ï¿½ï¿½ï¿½ï¿½Ï²ï¿½ï¿½Î·ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿
 826:Src/pid.c     **** {	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 22


 326              		.loc 1 826 0
 327              		.cfi_startproc
 328              		@ args = 0, pretend = 0, frame = 0
 329              		@ frame_needed = 0, uses_anonymous_args = 0
 330 0000 38B5     		push	{r3, r4, r5, lr}
 331              	.LCFI2:
 332              		.cfi_def_cfa_offset 16
 333              		.cfi_offset 3, -16
 334              		.cfi_offset 4, -12
 335              		.cfi_offset 5, -8
 336              		.cfi_offset 14, -4
 827:Src/pid.c     **** 	static s16 delay_cnt = 0;
 828:Src/pid.c     **** 	pos_error_to_target = g_CmdMap[CMD_POS_SET_PU]-g_CmdMap[CMD_POS_ACT_PU];  // Æ«ï¿½ï¿½
 337              		.loc 1 828 0
 338 0002 2C4C     		ldr	r4, .L35
 829:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 830:Src/pid.c     **** 	if(ABS(pos_error_to_target)<gPos_ds && Profile_moving == 0)
 339              		.loc 1 830 0
 340 0004 2C49     		ldr	r1, .L35+4
 828:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 341              		.loc 1 828 0
 342 0006 B4F84820 		ldrh	r2, [r4, #72]
 343 000a B4F84C30 		ldrh	r3, [r4, #76]
 344              		.loc 1 830 0
 345 000e 0868     		ldr	r0, [r1]
 346 0010 2A49     		ldr	r1, .L35+8
 828:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 347              		.loc 1 828 0
 348 0012 1BB2     		sxth	r3, r3
 349 0014 12B2     		sxth	r2, r2
 350 0016 D21A     		subs	r2, r2, r3
 351 0018 294B     		ldr	r3, .L35+12
 352 001a 1A60     		str	r2, [r3]
 353              		.loc 1 830 0
 354 001c 1A68     		ldr	r2, [r3]
 355 001e 002A     		cmp	r2, #0
 356 0020 1A68     		ldr	r2, [r3]
 357 0022 B8BF     		it	lt
 358 0024 5242     		rsblt	r2, r2, #0
 359 0026 9042     		cmp	r0, r2
 360 0028 0BDD     		ble	.L26
 361              		.loc 1 830 0 is_stmt 0 discriminator 5
 362 002a 264A     		ldr	r2, .L35+16
 363 002c 1268     		ldr	r2, [r2]
 364 002e 42B9     		cbnz	r2, .L26
 831:Src/pid.c     **** 	{
 832:Src/pid.c     **** 		if(delay_cnt <50)
 365              		.loc 1 832 0 is_stmt 1
 366 0030 254D     		ldr	r5, .L35+20
 367 0032 B5F90020 		ldrsh	r2, [r5]
 368 0036 312A     		cmp	r2, #49
 833:Src/pid.c     **** 		{
 834:Src/pid.c     **** 			delay_cnt++;
 369              		.loc 1 834 0
 370 0038 D5BF     		itete	le
 371 003a 0132     		addle	r2, r2, #1
 835:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 23


 836:Src/pid.c     **** 		else
 837:Src/pid.c     **** 		{
 838:Src/pid.c     **** 			PosAtDead_Flag = 1;
 372              		.loc 1 838 0
 373 003c 0122     		movgt	r2, #1
 834:Src/pid.c     **** 		}
 374              		.loc 1 834 0
 375 003e 2A80     		strhle	r2, [r5]	@ movhi
 376              		.loc 1 838 0
 377 0040 0A70     		strbgt	r2, [r1]
 378              	.L26:
 839:Src/pid.c     **** 		}
 840:Src/pid.c     **** 	}
 841:Src/pid.c     **** 	if(ABS(pos_error_to_target)>2*gPos_ds || Profile_moving == 1)
 379              		.loc 1 841 0
 380 0042 1A68     		ldr	r2, [r3]
 381 0044 1B68     		ldr	r3, [r3]
 382 0046 002A     		cmp	r2, #0
 383 0048 B8BF     		it	lt
 384 004a 5B42     		rsblt	r3, r3, #0
 385 004c B3EB400F 		cmp	r3, r0, lsl #1
 386 0050 03DC     		bgt	.L30
 387              		.loc 1 841 0 is_stmt 0 discriminator 5
 388 0052 1C4B     		ldr	r3, .L35+16
 389 0054 1B68     		ldr	r3, [r3]
 390 0056 012B     		cmp	r3, #1
 391 0058 03D1     		bne	.L31
 392              	.L30:
 842:Src/pid.c     **** 	{
 843:Src/pid.c     **** 		PosAtDead_Flag = 0;
 844:Src/pid.c     **** 		delay_cnt = 0;
 393              		.loc 1 844 0 is_stmt 1
 394 005a 1B4A     		ldr	r2, .L35+20
 843:Src/pid.c     **** 		delay_cnt = 0;
 395              		.loc 1 843 0
 396 005c 0023     		movs	r3, #0
 397 005e 0B70     		strb	r3, [r1]
 398              		.loc 1 844 0
 399 0060 1380     		strh	r3, [r2]	@ movhi
 400              	.L31:
 845:Src/pid.c     **** 	}	
 846:Src/pid.c     **** 	PosAtDead_Flag_Last = PosAtDead_Flag;
 401              		.loc 1 846 0
 402 0062 1A4B     		ldr	r3, .L35+24
 403 0064 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 404 0066 1A70     		strb	r2, [r3]
 847:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 848:Src/pid.c     **** 	// ï¿½ï¿½ï¿½Ö¼ï¿½ï¿½ï¿½	
 849:Src/pid.c     **** 	if(flag_posReg_strengthen == 1)
 405              		.loc 1 849 0
 406 0068 194B     		ldr	r3, .L35+28
 407 006a 1A4D     		ldr	r5, .L35+32
 408 006c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 850:Src/pid.c     **** 	{
 851:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU];
 852:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 853:Src/pid.c     **** 	}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 24


 854:Src/pid.c     **** 	else
 855:Src/pid.c     **** 	{
 856:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5;
 857:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 858:Src/pid.c     **** 	}		
 859:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_PROFILE_POS_PU],g_CmdMap[CMD_POS_ACT_PU],&pid_pos);
 409              		.loc 1 859 0
 410 006e 194A     		ldr	r2, .L35+32
 849:Src/pid.c     **** 	{
 411              		.loc 1 849 0
 412 0070 012B     		cmp	r3, #1
 851:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 413              		.loc 1 851 0
 414 0072 B4F89232 		ldrh	r3, [r4, #658]
 415 0076 0BBF     		itete	eq
 416 0078 1BB2     		sxtheq	r3, r3
 856:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 417              		.loc 1 856 0
 418 007a 43F34A13 		sbfxne	r3, r3, #5, #11
 851:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 419              		.loc 1 851 0
 420 007e EB63     		streq	r3, [r5, #60]
 856:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 421              		.loc 1 856 0
 422 0080 EB63     		strne	r3, [r5, #60]
 852:Src/pid.c     **** 	}
 423              		.loc 1 852 0
 424 0082 0CBF     		ite	eq
 425 0084 B4F89232 		ldrheq	r3, [r4, #658]
 857:Src/pid.c     **** 	}		
 426              		.loc 1 857 0
 427 0088 B4F89232 		ldrhne	r3, [r4, #658]
 428              		.loc 1 859 0
 429 008c B4F86000 		ldrh	r0, [r4, #96]
 430 0090 B4F84C10 		ldrh	r1, [r4, #76]
 852:Src/pid.c     **** 	}
 431              		.loc 1 852 0
 432 0094 0CBF     		ite	eq
 433 0096 1BB2     		sxtheq	r3, r3
 857:Src/pid.c     **** 	}		
 434              		.loc 1 857 0
 435 0098 43F34A13 		sbfxne	r3, r3, #5, #11
 436 009c 5B42     		negs	r3, r3
 437              		.loc 1 859 0
 438 009e 09B2     		sxth	r1, r1
 439 00a0 00B2     		sxth	r0, r0
 857:Src/pid.c     **** 	}		
 440              		.loc 1 857 0
 441 00a2 2B64     		str	r3, [r5, #64]
 442              		.loc 1 859 0
 443 00a4 FFF7FEFF 		bl	PID_control
 444              	.LVL13:
 860:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_pos.out;
 445              		.loc 1 860 0
 446 00a8 B5F93430 		ldrsh	r3, [r5, #52]
 447 00ac A4F85E30 		strh	r3, [r4, #94]	@ movhi
 861:Src/pid.c     **** }
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 25


 448              		.loc 1 861 0
 449 00b0 38BD     		pop	{r3, r4, r5, pc}
 450              	.L36:
 451 00b2 00BF     		.align	2
 452              	.L35:
 453 00b4 00000000 		.word	g_CmdMap
 454 00b8 00000000 		.word	gPos_ds
 455 00bc 00000000 		.word	.LANCHOR2
 456 00c0 00000000 		.word	.LANCHOR0
 457 00c4 00000000 		.word	Profile_moving
 458 00c8 00000000 		.word	.LANCHOR1
 459 00cc 00000000 		.word	.LANCHOR3
 460 00d0 00000000 		.word	flag_posReg_strengthen
 461 00d4 00000000 		.word	pid_pos
 462              		.cfi_endproc
 463              	.LFE340:
 465              		.section	.text.Gripper_control,"ax",%progbits
 466              		.align	1
 467              		.global	Gripper_control
 468              		.syntax unified
 469              		.thumb
 470              		.thumb_func
 471              		.fpu fpv4-sp-d16
 473              	Gripper_control:
 474              	.LFB341:
 862:Src/pid.c     **** //int16_t Force_set_drop_detection = 0;
 863:Src/pid.c     **** //Î»ï¿½Ã¿ï¿½ï¿½ï¿½
 864:Src/pid.c     **** void Gripper_control(void)
 865:Src/pid.c     **** {
 475              		.loc 1 865 0
 476              		.cfi_startproc
 477              		@ args = 0, pretend = 0, frame = 0
 478              		@ frame_needed = 0, uses_anonymous_args = 0
 479 0000 70B5     		push	{r4, r5, r6, lr}
 480              	.LCFI3:
 481              		.cfi_def_cfa_offset 16
 482              		.cfi_offset 4, -16
 483              		.cfi_offset 5, -12
 484              		.cfi_offset 6, -8
 485              		.cfi_offset 14, -4
 866:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
 486              		.loc 1 866 0
 487 0002 464C     		ldr	r4, .L59
 488 0004 464E     		ldr	r6, .L59+4
 489 0006 B4F84830 		ldrh	r3, [r4, #72]
 490 000a B4F84C00 		ldrh	r0, [r4, #76]
 867:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 491              		.loc 1 867 0
 492 000e B4F80422 		ldrh	r2, [r4, #516]
 493 0012 444D     		ldr	r5, .L59+8
 494 0014 12B2     		sxth	r2, r2
 495 0016 032A     		cmp	r2, #3
 866:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
 496              		.loc 1 866 0
 497 0018 1BB2     		sxth	r3, r3
 498 001a 00B2     		sxth	r0, r0
 499              	.LVL14:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 26


 500              		.loc 1 867 0
 501 001c 03D1     		bne	.L38
 502              		.loc 1 867 0 is_stmt 0 discriminator 1
 503 001e 424A     		ldr	r2, .L59+12
 504 0020 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 505 0022 012A     		cmp	r2, #1
 506 0024 0BD1     		bne	.L39
 507              	.L38:
 868:Src/pid.c     **** 	{
 869:Src/pid.c     **** 		Gripper_Move = 0x00;
 870:Src/pid.c     **** 		Grriper_Run = 0;
 871:Src/pid.c     **** 		Flag_contact = 0;
 508              		.loc 1 871 0 is_stmt 1
 509 0026 414A     		ldr	r2, .L59+16
 869:Src/pid.c     **** 		Grriper_Run = 0;
 510              		.loc 1 869 0
 511 0028 0023     		movs	r3, #0
 512              	.LVL15:
 513              		.loc 1 871 0
 514 002a 1370     		strb	r3, [r2]
 872:Src/pid.c     **** 		Flag_grip_F_OK = 0;
 515              		.loc 1 872 0
 516 002c 404A     		ldr	r2, .L59+20
 869:Src/pid.c     **** 		Grriper_Run = 0;
 517              		.loc 1 869 0
 518 002e 3380     		strh	r3, [r6]	@ movhi
 519              		.loc 1 872 0
 520 0030 1370     		strb	r3, [r2]
 873:Src/pid.c     **** 		Flag_grip_P_OK = 0;
 521              		.loc 1 873 0
 522 0032 404A     		ldr	r2, .L59+24
 870:Src/pid.c     **** 		Flag_contact = 0;
 523              		.loc 1 870 0
 524 0034 2B70     		strb	r3, [r5]
 525              		.loc 1 873 0
 526 0036 1370     		strb	r3, [r2]
 874:Src/pid.c     **** 		Flag_rellease_P_OK = 0;
 527              		.loc 1 874 0
 528 0038 3F4A     		ldr	r2, .L59+28
 529 003a 1370     		strb	r3, [r2]
 875:Src/pid.c     **** 	}	
 876:Src/pid.c     **** 	else
 877:Src/pid.c     **** 	{
 878:Src/pid.c     **** 		
 879:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]>g_CmdMap[CMD_POS_UPPER_LIMIT_PU])
 880:Src/pid.c     **** //		{
 881:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] =g_CmdMap[CMD_POS_UPPER_LIMIT_PU];		
 882:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] > 16384)
 883:Src/pid.c     **** //			{
 884:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 16384;
 885:Src/pid.c     **** //			}
 886:Src/pid.c     **** //		}
 887:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]<g_CmdMap[CMD_POS_LOWER_LIMIT_PU])
 888:Src/pid.c     **** //		{
 889:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_LOWER_LIMIT_PU];
 890:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] < 0)
 891:Src/pid.c     **** //			{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 27


 892:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 0;
 893:Src/pid.c     **** //			}
 894:Src/pid.c     **** //		}
 895:Src/pid.c     **** 		
 896:Src/pid.c     **** 		
 897:Src/pid.c     **** 		
 898:Src/pid.c     **** 		if(Flag_Set_OpenLen == 1  && (error_Pos>g_CmdMap[SEV_POSITION_DS]||error_Pos<-g_CmdMap[SEV_POSITI
 899:Src/pid.c     **** 		{
 900:Src/pid.c     **** 				Flag_Set_OpenLen = 0;
 901:Src/pid.c     **** 			
 902:Src/pid.c     **** 				if(g_CmdMap[CMD_E_STOP] == 0)
 903:Src/pid.c     **** 				{
 904:Src/pid.c     **** 				
 905:Src/pid.c     **** 				}
 906:Src/pid.c     **** 				
 907:Src/pid.c     **** 				g_CmdMap[TAG_WORK_MODE] = MODE_POSITION;	
 908:Src/pid.c     **** 				Profile_ParaSet();
 909:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 910:Src/pid.c     **** 				{
 911:Src/pid.c     **** 					tCnt_f = 0.0;
 912:Src/pid.c     **** 				}
 913:Src/pid.c     **** 				
 914:Src/pid.c     **** 				Flag_contact = 0;
 915:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 916:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 917:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 918:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 919:Src/pid.c     **** 				{
 920:Src/pid.c     **** 					Gripper_Move = 0x01;//ï¿½ï¿½È¡
 921:Src/pid.c     **** 					Grriper_Run = 1;
 922:Src/pid.c     **** 					pid_spd.enable = 1;
 923:Src/pid.c     **** 					pid_pos.enable = 1;
 924:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 925:Src/pid.c     **** 					{
 926:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 927:Src/pid.c     **** 					}
 928:Src/pid.c     **** 					//g_Flag_drop_detection = 1;   // 1-ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½ 0-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½
 929:Src/pid.c     **** 					Grriper_Run_last = 0;
 930:Src/pid.c     **** 				}
 931:Src/pid.c     **** 				else if(g_CmdMap[CMD_POS_SET_PU] > g_CmdMap[CMD_POS_ACT_PU])
 932:Src/pid.c     **** 				{
 933:Src/pid.c     **** 					Gripper_Move = 0x02;//ï¿½É¿ï¿½
 934:Src/pid.c     **** 					Grriper_Run = 1;
 935:Src/pid.c     **** 					pid_spd.enable = 1;
 936:Src/pid.c     **** 					pid_pos.enable = 1;
 937:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 938:Src/pid.c     **** 					{
 939:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 940:Src/pid.c     **** 					}
 941:Src/pid.c     **** 					Grriper_Run_last = 0;
 942:Src/pid.c     **** 				}
 943:Src/pid.c     **** 				else
 944:Src/pid.c     **** 				{
 945:Src/pid.c     **** 				}
 946:Src/pid.c     **** 		}
 947:Src/pid.c     **** 		g_pos_tag = g_CmdMap[CMD_POS_SET_PU];
 948:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 28


 949:Src/pid.c     **** 		if(Gripper_Move == 1)
 950:Src/pid.c     **** 		{
 951:Src/pid.c     **** 			Flag_grip_F_OK = 1;
 952:Src/pid.c     **** 		}
 953:Src/pid.c     **** 		if(Grriper_Run == 1 && g_CmdMap[TAG_MOTOR_ENABLE] == 1)
 954:Src/pid.c     **** 		{		
 955:Src/pid.c     **** 			Flag_Profile_Enable = 1;
 956:Src/pid.c     **** 		}
 957:Src/pid.c     **** 		else
 958:Src/pid.c     **** 		{
 959:Src/pid.c     **** 			Flag_Profile_Enable = 0;
 960:Src/pid.c     **** 		}
 961:Src/pid.c     **** 		//ï¿½ï¿½ï¿½Î·ï¿½ï¿½ï¿½
 962:Src/pid.c     **** 		Profile();
 963:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
 964:Src/pid.c     **** 		PositionPID();	
 965:Src/pid.c     **** 	}
 966:Src/pid.c     **** }
 530              		.loc 1 966 0
 531 003c 70BD     		pop	{r4, r5, r6, pc}
 532              	.LVL16:
 533              	.L39:
 898:Src/pid.c     **** 		{
 534              		.loc 1 898 0
 535 003e 3F4A     		ldr	r2, .L59+32
 536 0040 1178     		ldrb	r1, [r2]	@ zero_extendqisi2
 537 0042 0129     		cmp	r1, #1
 538 0044 1146     		mov	r1, r2
 539 0046 40D1     		bne	.L42
 898:Src/pid.c     **** 		{
 540              		.loc 1 898 0 is_stmt 0 discriminator 1
 541 0048 B4F8B622 		ldrh	r2, [r4, #694]
 866:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 542              		.loc 1 866 0 is_stmt 1 discriminator 1
 543 004c 1B1A     		subs	r3, r3, r0
 544              	.LVL17:
 898:Src/pid.c     **** 		{
 545              		.loc 1 898 0 discriminator 1
 546 004e 12B2     		sxth	r2, r2
 547 0050 9A42     		cmp	r2, r3
 548 0052 05DB     		blt	.L43
 898:Src/pid.c     **** 		{
 549              		.loc 1 898 0 is_stmt 0 discriminator 2
 550 0054 B4F8B622 		ldrh	r2, [r4, #694]
 551 0058 12B2     		sxth	r2, r2
 552 005a 5242     		negs	r2, r2
 553 005c 9A42     		cmp	r2, r3
 554 005e 34DD     		ble	.L42
 555              	.L43:
 900:Src/pid.c     **** 			
 556              		.loc 1 900 0 is_stmt 1
 557 0060 0023     		movs	r3, #0
 558 0062 0B70     		strb	r3, [r1]
 902:Src/pid.c     **** 				{
 559              		.loc 1 902 0
 560 0064 638A     		ldrh	r3, [r4, #18]
 907:Src/pid.c     **** 				Profile_ParaSet();
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 29


 561              		.loc 1 907 0
 562 0066 0323     		movs	r3, #3
 563 0068 A4F80432 		strh	r3, [r4, #516]	@ movhi
 908:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 564              		.loc 1 908 0
 565 006c FFF7FEFF 		bl	Profile_ParaSet
 566              	.LVL18:
 909:Src/pid.c     **** 				{
 567              		.loc 1 909 0
 568 0070 B4F84030 		ldrh	r3, [r4, #64]
 569 0074 1BB2     		sxth	r3, r3
 570 0076 012B     		cmp	r3, #1
 911:Src/pid.c     **** 				}
 571              		.loc 1 911 0
 572 0078 02BF     		ittt	eq
 573 007a 314B     		ldreq	r3, .L59+36
 574 007c 0022     		moveq	r2, #0
 575 007e 1A60     		streq	r2, [r3]	@ float
 914:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 576              		.loc 1 914 0
 577 0080 2A4A     		ldr	r2, .L59+16
 578 0082 0023     		movs	r3, #0
 579 0084 1370     		strb	r3, [r2]
 915:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 580              		.loc 1 915 0
 581 0086 2A4A     		ldr	r2, .L59+20
 582 0088 1370     		strb	r3, [r2]
 916:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 583              		.loc 1 916 0
 584 008a 2A4A     		ldr	r2, .L59+24
 585 008c 1370     		strb	r3, [r2]
 917:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 586              		.loc 1 917 0
 587 008e 2A4A     		ldr	r2, .L59+28
 588 0090 1370     		strb	r3, [r2]
 918:Src/pid.c     **** 				{
 589              		.loc 1 918 0
 590 0092 B4F84820 		ldrh	r2, [r4, #72]
 591 0096 B4F84C30 		ldrh	r3, [r4, #76]
 592 009a 12B2     		sxth	r2, r2
 593 009c 1BB2     		sxth	r3, r3
 594 009e 9A42     		cmp	r2, r3
 595 00a0 2EDA     		bge	.L46
 920:Src/pid.c     **** 					Grriper_Run = 1;
 596              		.loc 1 920 0
 597 00a2 0123     		movs	r3, #1
 598 00a4 3380     		strh	r3, [r6]	@ movhi
 599              	.L58:
 935:Src/pid.c     **** 					pid_pos.enable = 1;
 600              		.loc 1 935 0
 601 00a6 274A     		ldr	r2, .L59+40
 934:Src/pid.c     **** 					pid_spd.enable = 1;
 602              		.loc 1 934 0
 603 00a8 2B70     		strb	r3, [r5]
 935:Src/pid.c     **** 					pid_pos.enable = 1;
 604              		.loc 1 935 0
 605 00aa 1360     		str	r3, [r2]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 30


 936:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 606              		.loc 1 936 0
 607 00ac 264A     		ldr	r2, .L59+44
 608 00ae 1360     		str	r3, [r2]
 937:Src/pid.c     **** 					{
 609              		.loc 1 937 0
 610 00b0 628A     		ldrh	r2, [r4, #18]
 611 00b2 12B2     		sxth	r2, r2
 612 00b4 32B9     		cbnz	r2, .L48
 937:Src/pid.c     **** 					{
 613              		.loc 1 937 0 is_stmt 0 discriminator 1
 614 00b6 B4F85420 		ldrh	r2, [r4, #84]
 615 00ba C2F30B02 		ubfx	r2, r2, #0, #12
 616 00be 0AB9     		cbnz	r2, .L48
 939:Src/pid.c     **** 					}
 617              		.loc 1 939 0 is_stmt 1
 618 00c0 A4F80232 		strh	r3, [r4, #514]	@ movhi
 619              	.L48:
 941:Src/pid.c     **** 				}
 620              		.loc 1 941 0
 621 00c4 214B     		ldr	r3, .L59+48
 622 00c6 0022     		movs	r2, #0
 623 00c8 1A70     		strb	r2, [r3]
 624              	.L42:
 947:Src/pid.c     **** 
 625              		.loc 1 947 0
 626 00ca B4F84830 		ldrh	r3, [r4, #72]
 627 00ce 204A     		ldr	r2, .L59+52
 628 00d0 1BB2     		sxth	r3, r3
 629 00d2 1360     		str	r3, [r2]
 949:Src/pid.c     **** 		{
 630              		.loc 1 949 0
 631 00d4 B6F90030 		ldrsh	r3, [r6]
 632 00d8 012B     		cmp	r3, #1
 951:Src/pid.c     **** 		}
 633              		.loc 1 951 0
 634 00da 04BF     		itt	eq
 635 00dc 144A     		ldreq	r2, .L59+20
 636 00de 1370     		strbeq	r3, [r2]
 953:Src/pid.c     **** 		{		
 637              		.loc 1 953 0
 638 00e0 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
 639 00e2 1C4A     		ldr	r2, .L59+56
 640 00e4 012B     		cmp	r3, #1
 641 00e6 17D1     		bne	.L50
 953:Src/pid.c     **** 		{		
 642              		.loc 1 953 0 is_stmt 0 discriminator 1
 643 00e8 B4F80232 		ldrh	r3, [r4, #514]
 644 00ec 1BB2     		sxth	r3, r3
 645 00ee 012B     		cmp	r3, #1
 646 00f0 12D1     		bne	.L50
 647              	.L53:
 959:Src/pid.c     **** 		}
 648              		.loc 1 959 0 is_stmt 1
 649 00f2 1360     		str	r3, [r2]
 962:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
 650              		.loc 1 962 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 31


 651 00f4 FFF7FEFF 		bl	Profile
 652              	.LVL19:
 653              		.loc 1 966 0
 654 00f8 BDE87040 		pop	{r4, r5, r6, lr}
 655              	.LCFI4:
 656              		.cfi_remember_state
 657              		.cfi_restore 14
 658              		.cfi_restore 6
 659              		.cfi_restore 5
 660              		.cfi_restore 4
 661              		.cfi_def_cfa_offset 0
 964:Src/pid.c     **** 	}
 662              		.loc 1 964 0
 663 00fc FFF7FEBF 		b	PositionPID
 664              	.LVL20:
 665              	.L46:
 666              	.LCFI5:
 667              		.cfi_restore_state
 931:Src/pid.c     **** 				{
 668              		.loc 1 931 0
 669 0100 B4F84820 		ldrh	r2, [r4, #72]
 670 0104 B4F84C30 		ldrh	r3, [r4, #76]
 671 0108 12B2     		sxth	r2, r2
 672 010a 1BB2     		sxth	r3, r3
 673 010c 9A42     		cmp	r2, r3
 674 010e DCDD     		ble	.L42
 933:Src/pid.c     **** 					Grriper_Run = 1;
 675              		.loc 1 933 0
 676 0110 0223     		movs	r3, #2
 677 0112 3380     		strh	r3, [r6]	@ movhi
 934:Src/pid.c     **** 					pid_spd.enable = 1;
 678              		.loc 1 934 0
 679 0114 0123     		movs	r3, #1
 680 0116 C6E7     		b	.L58
 681              	.L50:
 959:Src/pid.c     **** 		}
 682              		.loc 1 959 0
 683 0118 0023     		movs	r3, #0
 684 011a EAE7     		b	.L53
 685              	.L60:
 686              		.align	2
 687              	.L59:
 688 011c 00000000 		.word	g_CmdMap
 689 0120 00000000 		.word	Gripper_Move
 690 0124 00000000 		.word	.LANCHOR4
 691 0128 00000000 		.word	Motor_forbidden
 692 012c 00000000 		.word	Flag_contact
 693 0130 00000000 		.word	Flag_grip_F_OK
 694 0134 00000000 		.word	Flag_grip_P_OK
 695 0138 00000000 		.word	Flag_rellease_P_OK
 696 013c 00000000 		.word	.LANCHOR5
 697 0140 00000000 		.word	tCnt_f
 698 0144 00000000 		.word	pid_spd
 699 0148 00000000 		.word	pid_pos
 700 014c 00000000 		.word	.LANCHOR6
 701 0150 00000000 		.word	g_pos_tag
 702 0154 00000000 		.word	Flag_Profile_Enable
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 32


 703              		.cfi_endproc
 704              	.LFE341:
 706              		.section	.text.phase_current_from_adcval,"ax",%progbits
 707              		.align	1
 708              		.global	phase_current_from_adcval
 709              		.syntax unified
 710              		.thumb
 711              		.thumb_func
 712              		.fpu fpv4-sp-d16
 714              	phase_current_from_adcval:
 715              	.LFB345:
 967:Src/pid.c     **** 	float v = 11.84;
 968:Src/pid.c     **** 	float L,temp_L;
 969:Src/pid.c     **** 
 970:Src/pid.c     **** extern volatile  int delta_alpha;
 971:Src/pid.c     **** extern volatile  int delata_beta;
 972:Src/pid.c     **** 
 973:Src/pid.c     **** int observer_ElectricAngle;
 974:Src/pid.c     **** int observer_speed;
 975:Src/pid.c     **** int integre_observer_ElectricAngle;
 976:Src/pid.c     **** 
 977:Src/pid.c     **** void hfi_update_angle(void)
 978:Src/pid.c     **** {
 979:Src/pid.c     **** 	int X,Y;
 980:Src/pid.c     **** 	int temp_x;
 981:Src/pid.c     **** 	int temp_y;
 982:Src/pid.c     **** 	int pll_intput;
 983:Src/pid.c     **** 	int temp_q,temp_d;
 984:Src/pid.c     **** 	static float inr_angle = 0;
 985:Src/pid.c     **** 	int  observer_ElectricAngle1;
 986:Src/pid.c     **** 	
 987:Src/pid.c     **** 	pid_pll.dead_zone = 0;
 988:Src/pid.c     **** 	pid_pll.Kp = 1000;
 989:Src/pid.c     **** 	pid_pll.Ki = 10;
 990:Src/pid.c     **** 	pid_pll.Kd = 0;
 991:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 992:Src/pid.c     **** 	pid_pll.enable =1;
 993:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 994:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 995:Src/pid.c     **** 	
 996:Src/pid.c     **** 	
 997:Src/pid.c     **** 	park_transform(delta_alpha, delata_beta, &temp_q, &temp_d,g_ElectricAngle);
 998:Src/pid.c     **** 	
 999:Src/pid.c     **** 	L = v *1.7321*500*1000 /(g_Iq * F_CUR_REGULATOR_HZ/1000 ) /3 /MAX_CCR*0.58*0.7; //0.7 Ïµï¿½ï¿½ï¿½ï
1000:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
1001:Src/pid.c     **** 	
1002:Src/pid.c     **** 	X = Math_Sin_EN360(observer_ElectricAngle);
1003:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
1004:Src/pid.c     **** 	
1005:Src/pid.c     **** 	temp_x = Q15_MUL(delta_alpha,X);
1006:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
1007:Src/pid.c     **** 	
1008:Src/pid.c     **** 	pll_intput = temp_x - temp_y;  //+ 90ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ x -y ? ,y -x ï¿½ï¿½
1009:Src/pid.c     **** 	
1010:Src/pid.c     **** 	PID_control(0,pll_intput,&pid_pll);
1011:Src/pid.c     **** 	observer_speed = pid_pll.out;
1012:Src/pid.c     **** 	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 33


1013:Src/pid.c     **** 	integre_observer_ElectricAngle +=observer_speed; //update angle
1014:Src/pid.c     **** 	
1015:Src/pid.c     **** 	observer_ElectricAngle = integre_observer_ElectricAngle /100;
1016:Src/pid.c     **** 	
1017:Src/pid.c     **** 	observer_ElectricAngle  &= 0x7fff; 
1018:Src/pid.c     **** 	
1019:Src/pid.c     **** 	observer_ElectricAngle1= observer_ElectricAngle  + EN_90;// EN_90;//EN_90; 
1020:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
1021:Src/pid.c     **** 	
1022:Src/pid.c     **** 	g_ElectricAngle = observer_ElectricAngle1;
1023:Src/pid.c     **** 	
1024:Src/pid.c     **** #if 0 	 //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½Å³ï¿½
1025:Src/pid.c     **** 	inr_angle  += 0.1;
1026:Src/pid.c     **** 	if(inr_angle  > 32768 )
1027:Src/pid.c     **** 		inr_angle = 0;
1028:Src/pid.c     **** 	g_ElectricAngle = 0;
1029:Src/pid.c     **** #endif
1030:Src/pid.c     **** 	
1031:Src/pid.c     **** }
1032:Src/pid.c     **** 
1033:Src/pid.c     **** 
1034:Src/pid.c     **** static void OpenLoop(void)
1035:Src/pid.c     **** {
1036:Src/pid.c     **** 	int X,Y;
1037:Src/pid.c     **** 	int temp_x;
1038:Src/pid.c     **** 	int temp_y;
1039:Src/pid.c     **** 	int pll_intput;
1040:Src/pid.c     **** 	
1041:Src/pid.c     ****   s16 temp32 = g_CmdMap[TAG_OPEN_PWM] * REAL_CCR / 100;  // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï
1042:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
1043:Src/pid.c     **** 	
1044:Src/pid.c     **** 	g_Vq = g_Timer1CCR;  
1045:Src/pid.c     **** 	g_Vd = 0;
1046:Src/pid.c     **** 
1047:Src/pid.c     **** 	X = Math_Sin_EN360( g_ElectricAngle  );
1048:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
1049:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
1050:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
1051:Src/pid.c     **** 
1052:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
1053:Src/pid.c     **** 
1054:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1055:Src/pid.c     **** //	if(observer_speed < 0)
1056:Src/pid.c     **** //	{
1057:Src/pid.c     **** //		g_ElectricAngle = 0 - g_ElectricAngle;
1058:Src/pid.c     **** //	}
1059:Src/pid.c     **** //	g_ElectricAngle += 32768;
1060:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1061:Src/pid.c     **** 	anlge_reg = g_ElectricAngle;//observer_ElectricAngle;
1062:Src/pid.c     **** 	
1063:Src/pid.c     **** 	if(anlge_reg < EN_0)
1064:Src/pid.c     **** 	{
1065:Src/pid.c     **** 		anlge_reg = anlge_reg+EN_360;
1066:Src/pid.c     **** 	}
1067:Src/pid.c     **** 	else if(anlge_reg > EN_360)
1068:Src/pid.c     **** 	{
1069:Src/pid.c     **** 		anlge_reg = anlge_reg-EN_360;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 34


1070:Src/pid.c     **** 	}
1071:Src/pid.c     ****   PWM_OutPut_Open(TIM1, anlge_reg, g_Timer1CCR);
1072:Src/pid.c     **** }
1073:Src/pid.c     **** // ï¿½Õ»ï¿½Ä£Ê½ï¿½ï¿½ï¿½
1074:Src/pid.c     **** //static void CheckModeChange(void)
1075:Src/pid.c     **** //{
1076:Src/pid.c     **** //  static s32 s_OldMode = 0;
1077:Src/pid.c     **** //  if (s_OldMode != g_CmdMap[TAG_WORK_MODE])
1078:Src/pid.c     **** //  {
1079:Src/pid.c     **** //    if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1080:Src/pid.c     **** //		{
1081:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 16384;
1082:Src/pid.c     **** //		}
1083:Src/pid.c     **** //		else
1084:Src/pid.c     **** //		{
1085:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 0;
1086:Src/pid.c     **** //		}
1087:Src/pid.c     **** //    g_CmdMap[CMD_CUR_SET_PU] = 0;
1088:Src/pid.c     **** //  }
1089:Src/pid.c     **** //  s_OldMode = g_CmdMap[TAG_WORK_MODE];
1090:Src/pid.c     **** //}
1091:Src/pid.c     **** 
1092:Src/pid.c     ****  volatile s32 s_Disable_Delay = 0;
1093:Src/pid.c     **** 
1094:Src/pid.c     **** static void Pos_Spd_PID(void)
1095:Src/pid.c     **** {
1096:Src/pid.c     **** 	static s32 s_count = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1097:Src/pid.c     ****   static s32 s_Enable_Delay = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1098:Src/pid.c     ****  GPIOA->BRR  |= (uint32_t)GPIO_PIN_4;
1099:Src/pid.c     **** 	//CheckModeChange();
1100:Src/pid.c     **** 	MTPro();
1101:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
1102:Src/pid.c     **** 	{
1103:Src/pid.c     **** 		g_servo_cmd_period_cnt++; //ï¿½ï¿½ÆµÎ»ï¿½ï¿½ï¿½Å·ï¿½ï¿½Â£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½Ê±
1104:Src/pid.c     **** 	}
1105:Src/pid.c     **** 	get_average_force_data();	
1106:Src/pid.c     **** 	
1107:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
1108:Src/pid.c     **** 	{
1109:Src/pid.c     **** 		ForcePID();
1110:Src/pid.c     **** 	}
1111:Src/pid.c     **** 	
1112:Src/pid.c     **** 	
1113:Src/pid.c     **** 	Loop3_EnableManage();
1114:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
1115:Src/pid.c     **** 	{
1116:Src/pid.c     **** 		s_count = 0;
1117:Src/pid.c     **** 		Flag_1ms = 1;
1118:Src/pid.c     **** 		if(++s_count_50ms>50)
1119:Src/pid.c     **** 		{
1120:Src/pid.c     **** 			s_count_50ms = 0;
1121:Src/pid.c     **** 			Flag_50ms = 1;
1122:Src/pid.c     **** 		}
1123:Src/pid.c     **** 		
1124:Src/pid.c     **** 		
1125:Src/pid.c     **** 		
1126:Src/pid.c     **** 		Get_Pos_Rod();
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 35


1127:Src/pid.c     **** 		Stroke_protection();
1128:Src/pid.c     **** 		
1129:Src/pid.c     **** //		if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1130:Src/pid.c     **** 		{
1131:Src/pid.c     **** 			Gripper_control();	
1132:Src/pid.c     **** 		}
1133:Src/pid.c     **** 	}
1134:Src/pid.c     **** 	
1135:Src/pid.c     **** 	icmu_sdtransmission_test();
1136:Src/pid.c     **** 	
1137:Src/pid.c     **** 	
1138:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION || g_CmdMap[TAG_WORK_MODE] == MODE_SPEED  ||  g_CmdMap
1139:Src/pid.c     **** 	{
1140:Src/pid.c     **** 		SpeedPID();
1141:Src/pid.c     **** 	}	
1142:Src/pid.c     ****   // Hï¿½Å´Ó½ï¿½ï¿½Üµï¿½Ê¹ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½ï¿½È´ï¿½ï¿½Ìµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿
1143:Src/pid.c     ****   if(g_CmdMap[TAG_MOTOR_ENABLE] == 0 || Motor_forbidden == 1 || Motor_emergercy_stop == 1 || Motor_
1144:Src/pid.c     **** 	{
1145:Src/pid.c     **** 		s_Enable_Delay = 0;
1146:Src/pid.c     **** 		Motor_forbidden = 0;
1147:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1148:Src/pid.c     **** 		{
1149:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
1150:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
1151:Src/pid.c     **** 		}
1152:Src/pid.c     **** 		if(g_CmdMap[CMD_ERROR] != 0)
1153:Src/pid.c     **** 		{	
1154:Src/pid.c     **** 			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
1155:Src/pid.c     **** 		}			
1156:Src/pid.c     **** //		if(s_Disable_Delay <= 1) s_Disable_Delay ++;
1157:Src/pid.c     **** //		if (s_Disable_Delay == 1) // ï¿½ï¿½Ê¹ï¿½Ü±ï¿½Îªï¿½ï¿½ï¿½ï¿½ 50ms
1158:Src/pid.c     **** 		{
1159:Src/pid.c     **** //			s_Disable_Delay = 0;
1160:Src/pid.c     **** 			g_Timer1CCR = 0;
1161:Src/pid.c     ****       Motor_emergercy_stop =0;
1162:Src/pid.c     **** 			Motor_pause_flag = 0;
1163:Src/pid.c     **** 			PWM_Disable();
1164:Src/pid.c     **** 		}
1165:Src/pid.c     **** //		if (s_Disable_Delay > 1)
1166:Src/pid.c     **** //		{
1167:Src/pid.c     **** //			s_Disable_Delay =2;
1168:Src/pid.c     **** //		}
1169:Src/pid.c     **** 		g_Vq = 0;
1170:Src/pid.c     **** 		return;
1171:Src/pid.c     **** 	}
1172:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && Motor_forbidden == 0)
1173:Src/pid.c     **** 	{
1174:Src/pid.c     **** 		if(s_Enable_Delay <= 2) s_Enable_Delay ++;
1175:Src/pid.c     **** 		s_Disable_Delay = 0;
1176:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
1177:Src/pid.c     **** 		{
1178:Src/pid.c     **** 			if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1179:Src/pid.c     **** 			{
1180:Src/pid.c     **** 				g_CmdMap[CMD_SPD_SET_PU] = 0;
1181:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
1182:Src/pid.c     **** 			}
1183:Src/pid.c     **** 			g_Timer1CCR = 0;		
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 36


1184:Src/pid.c     **** 			PWM_Enable();			
1185:Src/pid.c     **** 		}
1186:Src/pid.c     **** 		return;
1187:Src/pid.c     **** 	}  
1188:Src/pid.c     **** }
1189:Src/pid.c     **** s32 I_Alpha, I_Beta; 
1190:Src/pid.c     **** extern 	volatile  int hall_ture_value;
1191:Src/pid.c     **** extern 	volatile  int last_hall_ture_value;
1192:Src/pid.c     **** extern volatile  s32 sample_invered;
1193:Src/pid.c     **** 
1194:Src/pid.c     **** volatile  int delta_alpha;
1195:Src/pid.c     **** volatile  int delata_beta;
1196:Src/pid.c     **** int last_alpha = 0;
1197:Src/pid.c     **** int last_beta = 0;
1198:Src/pid.c     **** 
1199:Src/pid.c     **** float phase_current_rev_gain_ = 1.0f/16.5f;
1200:Src/pid.c     **** float shunt_conductance1 = 1.0f/(0.011f * 1.1f);
1201:Src/pid.c     **** float shunt_conductance2 = 1.0f/(0.01f*1.1f);
1202:Src/pid.c     **** 
1203:Src/pid.c     **** 
1204:Src/pid.c     **** float phase_current_from_adcval(s32 adcval_bal)
1205:Src/pid.c     **** {
 716              		.loc 1 1205 0
 717              		.cfi_startproc
 718              		@ args = 0, pretend = 0, frame = 0
 719              		@ frame_needed = 0, uses_anonymous_args = 0
 720              		@ link register save eliminated.
 721              	.LVL21:
1206:Src/pid.c     ****   float amp_out_volt = (3300.0f / (float)(1 << 12)) * (float)adcval_bal;
 722              		.loc 1 1206 0
 723 0000 07EE900A 		vmov	s15, r0	@ int
 724 0004 9FED050A 		vldr.32	s0, .L62
1207:Src/pid.c     ****   float shunt_volt = amp_out_volt * phase_current_rev_gain_;
 725              		.loc 1 1207 0
 726 0008 054B     		ldr	r3, .L62+4
1206:Src/pid.c     ****   float amp_out_volt = (3300.0f / (float)(1 << 12)) * (float)adcval_bal;
 727              		.loc 1 1206 0
 728 000a F8EEE77A 		vcvt.f32.s32	s15, s15
 729 000e 67EE807A 		vmul.f32	s15, s15, s0
 730              	.LVL22:
 731              		.loc 1 1207 0
 732 0012 93ED000A 		vldr.32	s0, [r3]
1208:Src/pid.c     ****   return shunt_volt ;
1209:Src/pid.c     **** }
 733              		.loc 1 1209 0
 734 0016 27EE800A 		vmul.f32	s0, s15, s0
 735              	.LVL23:
 736 001a 7047     		bx	lr
 737              	.L63:
 738              		.align	2
 739              	.L62:
 740 001c 00404E3F 		.word	1062092800
 741 0020 00000000 		.word	.LANCHOR7
 742              		.cfi_endproc
 743              	.LFE345:
 745              		.section	.text.GetCurrent,"ax",%progbits
 746              		.align	1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 37


 747              		.global	GetCurrent
 748              		.syntax unified
 749              		.thumb
 750              		.thumb_func
 751              		.fpu fpv4-sp-d16
 753              	GetCurrent:
 754              	.LFB346:
1210:Src/pid.c     **** void GetCurrent(void)
1211:Src/pid.c     **** {
 755              		.loc 1 1211 0
 756              		.cfi_startproc
 757              		@ args = 0, pretend = 0, frame = 0
 758              		@ frame_needed = 0, uses_anonymous_args = 0
 759              	.LVL24:
1212:Src/pid.c     ****   s32 i=0, j=0,I_B1 = 0,I_C1 = 0;
1213:Src/pid.c     **** 
1214:Src/pid.c     **** 	
1215:Src/pid.c     **** 	g_IC_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorC)*1*1000.0f); // mA	
 760              		.loc 1 1215 0
 761 0000 4FF0A041 		mov	r1, #1342177280
 762 0004 624B     		ldr	r3, .L74
 763 0006 D1F88000 		ldr	r0, [r1, #128]
 764 000a 1B68     		ldr	r3, [r3]
1211:Src/pid.c     ****   s32 i=0, j=0,I_B1 = 0,I_C1 = 0;
 765              		.loc 1 1211 0
 766 000c 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 767              	.LCFI6:
 768              		.cfi_def_cfa_offset 24
 769              		.cfi_offset 4, -24
 770              		.cfi_offset 5, -20
 771              		.cfi_offset 6, -16
 772              		.cfi_offset 7, -12
 773              		.cfi_offset 8, -8
 774              		.cfi_offset 14, -4
 775              		.loc 1 1215 0
 776 0010 C01A     		subs	r0, r0, r3
 777 0012 FFF7FEFF 		bl	phase_current_from_adcval
 778              	.LVL25:
 779 0016 9FED5F7A 		vldr.32	s14, .L74+4
 780 001a 5F4B     		ldr	r3, .L74+8
1216:Src/pid.c     **** 	g_IB_Raw = (s16)(-phase_current_from_adcval(ADC2->JDR1-g_ZeroCur_MotorB)*shunt_conductance2); // m
1217:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
1218:Src/pid.c     **** 	
1219:Src/pid.c     **** 	g_IA = g_IA_Raw;
1220:Src/pid.c     **** 	g_IB = g_IB_Raw;
 781              		.loc 1 1220 0
 782 001c 5F4D     		ldr	r5, .L74+12
1221:Src/pid.c     **** 	g_IC = 0 - g_IA_Raw -g_IB_Raw;
 783              		.loc 1 1221 0
 784 001e 604C     		ldr	r4, .L74+16
1222:Src/pid.c     **** 	
1223:Src/pid.c     **** 	update_current_meas(&motor_, g_IA/1000.0f, g_IB/1000.0f, g_IC/1000.0f);
1224:Src/pid.c     **** 
1225:Src/pid.c     **** 	I_Alpha = -(g_IB + g_IC);             // ï¿½È·ï¿½Clark:I_Alpha = (2/3)*(I_a - 0.5*I_b - 0.5*I_c)= 
1226:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 785              		.loc 1 1226 0
 786 0020 604E     		ldr	r6, .L74+20
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 38


1215:Src/pid.c     **** 	g_IB_Raw = (s16)(-phase_current_from_adcval(ADC2->JDR1-g_ZeroCur_MotorB)*shunt_conductance2); // m
 787              		.loc 1 1215 0
 788 0022 20EE470A 		vnmul.f32	s0, s0, s14
 789 0026 BDEEC00A 		vcvt.s32.f32	s0, s0
 790 002a 10EE102A 		vmov	r2, s0	@ int
 791 002e 1A80     		strh	r2, [r3]	@ movhi
1216:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
 792              		.loc 1 1216 0
 793 0030 5D4B     		ldr	r3, .L74+24
 794 0032 D3F88000 		ldr	r0, [r3, #128]
 795 0036 5D4B     		ldr	r3, .L74+28
 796 0038 1B68     		ldr	r3, [r3]
 797 003a C01A     		subs	r0, r0, r3
 798 003c FFF7FEFF 		bl	phase_current_from_adcval
 799              	.LVL26:
 800 0040 5B4B     		ldr	r3, .L74+32
1217:Src/pid.c     **** 	
 801              		.loc 1 1217 0
 802 0042 D1F88000 		ldr	r0, [r1, #128]
1216:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
 803              		.loc 1 1216 0
 804 0046 D3ED007A 		vldr.32	s15, [r3]
 805 004a 20EE670A 		vnmul.f32	s0, s0, s15
 806 004e BDEEC00A 		vcvt.s32.f32	s0, s0
 807 0052 10EE103A 		vmov	r3, s0	@ int
 808 0056 1AB2     		sxth	r2, r3
 809 0058 564B     		ldr	r3, .L74+36
 810 005a 1A80     		strh	r2, [r3]	@ movhi
1217:Src/pid.c     **** 	
 811              		.loc 1 1217 0
 812 005c 564B     		ldr	r3, .L74+40
 813 005e 1B68     		ldr	r3, [r3]
 814 0060 C01A     		subs	r0, r0, r3
 815 0062 FFF7FEFF 		bl	phase_current_from_adcval
 816              	.LVL27:
 817 0066 554B     		ldr	r3, .L74+44
 818 0068 5549     		ldr	r1, .L74+48
 819 006a D3ED007A 		vldr.32	s15, [r3]
1223:Src/pid.c     **** 
 820              		.loc 1 1223 0
 821 006e 5548     		ldr	r0, .L74+52
1220:Src/pid.c     **** 	g_IC = 0 - g_IA_Raw -g_IB_Raw;
 822              		.loc 1 1220 0
 823 0070 2A80     		strh	r2, [r5]	@ movhi
1217:Src/pid.c     **** 	
 824              		.loc 1 1217 0
 825 0072 20EE670A 		vnmul.f32	s0, s0, s15
 826 0076 BDEEC00A 		vcvt.s32.f32	s0, s0
 827 007a 10EE103A 		vmov	r3, s0	@ int
 828 007e 1BB2     		sxth	r3, r3
 829 0080 0B80     		strh	r3, [r1]	@ movhi
1219:Src/pid.c     **** 	g_IB = g_IB_Raw;
 830              		.loc 1 1219 0
 831 0082 5149     		ldr	r1, .L74+56
 832 0084 0B80     		strh	r3, [r1]	@ movhi
1221:Src/pid.c     **** 	
 833              		.loc 1 1221 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 39


 834 0086 D118     		adds	r1, r2, r3
 835 0088 4942     		negs	r1, r1
 836 008a 09B2     		sxth	r1, r1
1223:Src/pid.c     **** 
 837              		.loc 1 1223 0
 838 008c 07EE901A 		vmov	s15, r1	@ int
 839 0090 B8EEE71A 		vcvt.f32.s32	s2, s15
 840 0094 07EE902A 		vmov	s15, r2	@ int
 841 0098 F8EEE70A 		vcvt.f32.s32	s1, s15
 842 009c 07EE903A 		vmov	s15, r3	@ int
 843 00a0 B8EEE70A 		vcvt.f32.s32	s0, s15
 844 00a4 81EE071A 		vdiv.f32	s2, s2, s14
1221:Src/pid.c     **** 	
 845              		.loc 1 1221 0
 846 00a8 2180     		strh	r1, [r4]	@ movhi
1223:Src/pid.c     **** 
 847              		.loc 1 1223 0
 848 00aa C0EE870A 		vdiv.f32	s1, s1, s14
 849 00ae 80EE070A 		vdiv.f32	s0, s0, s14
 850 00b2 FFF7FEFF 		bl	update_current_meas
 851              	.LVL28:
1225:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 852              		.loc 1 1225 0
 853 00b6 B4F90020 		ldrsh	r2, [r4]
 854 00ba B5F90000 		ldrsh	r0, [r5]
 855 00be 434C     		ldr	r4, .L74+60
1227:Src/pid.c     **** 	
1228:Src/pid.c     **** 	delta_alpha = I_Alpha - last_alpha;
 856              		.loc 1 1228 0
 857 00c0 434D     		ldr	r5, .L74+64
1225:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 858              		.loc 1 1225 0
 859 00c2 8318     		adds	r3, r0, r2
 860 00c4 5B42     		negs	r3, r3
1226:Src/pid.c     **** 	
 861              		.loc 1 1226 0
 862 00c6 44F6E711 		movw	r1, #18919
 863 00ca 801A     		subs	r0, r0, r2
1225:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 864              		.loc 1 1225 0
 865 00cc 2360     		str	r3, [r4]
1226:Src/pid.c     **** 	
 866              		.loc 1 1226 0
 867 00ce FFF7FEFF 		bl	Q15_MUL
 868              	.LVL29:
 869              		.loc 1 1228 0
 870 00d2 2768     		ldr	r7, [r4]
 871 00d4 2B68     		ldr	r3, [r5]
1229:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 872              		.loc 1 1229 0
 873 00d6 DFF820C1 		ldr	ip, .L74+104
1228:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 874              		.loc 1 1228 0
 875 00da 3E4A     		ldr	r2, .L74+68
1230:Src/pid.c     **** 	
1231:Src/pid.c     **** 	delta_alpha *= g_high_fre_pulse;
 876              		.loc 1 1231 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 40


 877 00dc DFF81CE1 		ldr	lr, .L74+108
1232:Src/pid.c     **** 	delata_beta *= g_high_fre_pulse;
1233:Src/pid.c     **** 	
1234:Src/pid.c     **** 	last_alpha = I_Alpha;
 878              		.loc 1 1234 0
 879 00e0 2F60     		str	r7, [r5]
1228:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 880              		.loc 1 1228 0
 881 00e2 FB1A     		subs	r3, r7, r3
 882 00e4 1360     		str	r3, [r2]
1229:Src/pid.c     **** 	
 883              		.loc 1 1229 0
 884 00e6 DCF80030 		ldr	r3, [ip]
1235:Src/pid.c     **** 	last_beta = I_Beta;
1236:Src/pid.c     **** 	
1237:Src/pid.c     **** 	i = Math_Sin_EN360(g_ElectricAngle );
 885              		.loc 1 1237 0
 886 00ea 3B4D     		ldr	r5, .L74+72
1235:Src/pid.c     **** 	last_beta = I_Beta;
 887              		.loc 1 1235 0
 888 00ec CCF80000 		str	r0, [ip]
1229:Src/pid.c     **** 	
 889              		.loc 1 1229 0
 890 00f0 C11A     		subs	r1, r0, r3
 891 00f2 3A4B     		ldr	r3, .L74+76
1226:Src/pid.c     **** 	
 892              		.loc 1 1226 0
 893 00f4 3060     		str	r0, [r6]
1229:Src/pid.c     **** 	
 894              		.loc 1 1229 0
 895 00f6 1960     		str	r1, [r3]
1231:Src/pid.c     **** 	delata_beta *= g_high_fre_pulse;
 896              		.loc 1 1231 0
 897 00f8 DEF80010 		ldr	r1, [lr]
 898 00fc D2F80080 		ldr	r8, [r2]
 899 0100 01FB08F1 		mul	r1, r1, r8
 900 0104 1160     		str	r1, [r2]
1232:Src/pid.c     **** 	
 901              		.loc 1 1232 0
 902 0106 DEF80020 		ldr	r2, [lr]
 903 010a 1968     		ldr	r1, [r3]
 904 010c 4A43     		muls	r2, r1, r2
 905 010e 1A60     		str	r2, [r3]
 906              		.loc 1 1237 0
 907 0110 2868     		ldr	r0, [r5]
 908 0112 80B2     		uxth	r0, r0
 909 0114 FFF7FEFF 		bl	Math_Sin_EN360
 910              	.LVL30:
 911 0118 0746     		mov	r7, r0
 912              	.LVL31:
1238:Src/pid.c     **** 	j = Math_Cos_EN360(g_ElectricAngle );
 913              		.loc 1 1238 0
 914 011a 2868     		ldr	r0, [r5]
 915              	.LVL32:
 916 011c 80B2     		uxth	r0, r0
 917 011e FFF7FEFF 		bl	Math_Cos_EN360
 918              	.LVL33:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 41


1239:Src/pid.c     **** 	//I_B1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
1240:Src/pid.c     **** 	//I_C1 = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
1241:Src/pid.c     **** 	I_B1 = -Q15_MUL(i, I_Alpha) + Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 919              		.loc 1 1241 0
 920 0122 3168     		ldr	r1, [r6]
1238:Src/pid.c     **** 	j = Math_Cos_EN360(g_ElectricAngle );
 921              		.loc 1 1238 0
 922 0124 8046     		mov	r8, r0
 923              	.LVL34:
 924              		.loc 1 1241 0
 925 0126 FFF7FEFF 		bl	Q15_MUL
 926              	.LVL35:
 927 012a 2168     		ldr	r1, [r4]
 928 012c 0546     		mov	r5, r0
 929 012e 3846     		mov	r0, r7
 930 0130 FFF7FEFF 		bl	Q15_MUL
 931              	.LVL36:
1242:Src/pid.c     **** 	I_C1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 932              		.loc 1 1242 0
 933 0134 2168     		ldr	r1, [r4]
1241:Src/pid.c     **** 	I_C1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 934              		.loc 1 1241 0
 935 0136 2D1A     		subs	r5, r5, r0
 936              	.LVL37:
 937              		.loc 1 1242 0
 938 0138 4046     		mov	r0, r8
 939 013a FFF7FEFF 		bl	Q15_MUL
 940              	.LVL38:
 941 013e 3168     		ldr	r1, [r6]
 942 0140 0446     		mov	r4, r0
 943 0142 3846     		mov	r0, r7
 944 0144 FFF7FEFF 		bl	Q15_MUL
 945              	.LVL39:
1243:Src/pid.c     **** //		I_B1 = (I_B1>>3)<<3;
1244:Src/pid.c     **** //		I_C1 = (I_C1>>3)<<3;
1245:Src/pid.c     **** 
1246:Src/pid.c     ****   if (g_bEnableHB != 0 && (pid_IQ.enable == 1||g_CmdMap[TAG_WORK_MODE] == MODE_OPEN))
 946              		.loc 1 1246 0
 947 0148 254B     		ldr	r3, .L74+80
 948 014a 2649     		ldr	r1, .L74+84
 949 014c 1A88     		ldrh	r2, [r3]
 950 014e 264B     		ldr	r3, .L74+88
 951 0150 12B2     		sxth	r2, r2
1242:Src/pid.c     **** //		I_B1 = (I_B1>>3)<<3;
 952              		.loc 1 1242 0
 953 0152 2044     		add	r0, r0, r4
 954              	.LVL40:
 955 0154 254C     		ldr	r4, .L74+92
 956              		.loc 1 1246 0
 957 0156 2AB1     		cbz	r2, .L65
 958              		.loc 1 1246 0 is_stmt 0 discriminator 1
 959 0158 254A     		ldr	r2, .L74+96
 960 015a 1268     		ldr	r2, [r2]
 961 015c 012A     		cmp	r2, #1
 962 015e 18BF     		it	ne
 963 0160 B1F80422 		ldrhne	r2, [r1, #516]
 964              	.L65:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 42


1247:Src/pid.c     ****   {
1248:Src/pid.c     **** 		g_Iq = I_B1;
1249:Src/pid.c     **** 		g_Id = I_C1;	
1250:Src/pid.c     **** 	}
1251:Src/pid.c     **** 	else
1252:Src/pid.c     **** 	{
1253:Src/pid.c     **** 		g_Iq = I_B1;
 965              		.loc 1 1253 0 is_stmt 1
 966 0164 2560     		str	r5, [r4]
1254:Src/pid.c     **** 		g_Id = I_C1;	
 967              		.loc 1 1254 0
 968 0166 1860     		str	r0, [r3]
1255:Src/pid.c     **** 	}
1256:Src/pid.c     **** 	g_CmdMap[CMD_CUR_D_ACT_PU] = g_Id*PU_REFERENCE/(*g_pCur_ref_base_mA);
 969              		.loc 1 1256 0
 970 0168 1A68     		ldr	r2, [r3]
 971 016a 224B     		ldr	r3, .L74+100
 972 016c 1B68     		ldr	r3, [r3]
 973 016e 9203     		lsls	r2, r2, #14
 974 0170 1868     		ldr	r0, [r3]
 975              	.LVL41:
 976 0172 92FBF0F2 		sdiv	r2, r2, r0
 977 0176 12B2     		sxth	r2, r2
 978 0178 A1F89422 		strh	r2, [r1, #660]	@ movhi
 979              	.LVL42:
1257:Src/pid.c     **** 	g_CmdMap[CMD_CUR_ACT_PU] = g_Iq*PU_REFERENCE/(*g_pCur_ref_base_mA);
 980              		.loc 1 1257 0
 981 017c 2368     		ldr	r3, [r4]
 982 017e 9B03     		lsls	r3, r3, #14
 983 0180 93FBF0F3 		sdiv	r3, r3, r0
 984 0184 1BB2     		sxth	r3, r3
 985 0186 A1F84E30 		strh	r3, [r1, #78]	@ movhi
1258:Src/pid.c     **** 	
1259:Src/pid.c     **** 	
1260:Src/pid.c     **** }
 986              		.loc 1 1260 0
 987 018a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 988              	.LVL43:
 989              	.L75:
 990 018e 00BF     		.align	2
 991              	.L74:
 992 0190 00000000 		.word	g_ZeroCur_MotorC
 993 0194 00007A44 		.word	1148846080
 994 0198 00000000 		.word	.LANCHOR8
 995 019c 00000000 		.word	.LANCHOR14
 996 01a0 00000000 		.word	.LANCHOR15
 997 01a4 00000000 		.word	I_Beta
 998 01a8 00010050 		.word	1342177536
 999 01ac 00000000 		.word	g_ZeroCur_MotorB
 1000 01b0 00000000 		.word	.LANCHOR9
 1001 01b4 00000000 		.word	.LANCHOR10
 1002 01b8 00000000 		.word	g_ZeroCur_MotorA
 1003 01bc 00000000 		.word	.LANCHOR11
 1004 01c0 00000000 		.word	.LANCHOR12
 1005 01c4 00000000 		.word	motor_
 1006 01c8 00000000 		.word	.LANCHOR13
 1007 01cc 00000000 		.word	I_Alpha
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 43


 1008 01d0 00000000 		.word	.LANCHOR16
 1009 01d4 00000000 		.word	delta_alpha
 1010 01d8 00000000 		.word	g_ElectricAngle
 1011 01dc 00000000 		.word	delata_beta
 1012 01e0 00000000 		.word	g_bEnableHB
 1013 01e4 00000000 		.word	g_CmdMap
 1014 01e8 00000000 		.word	.LANCHOR19
 1015 01ec 00000000 		.word	.LANCHOR18
 1016 01f0 00000000 		.word	pid_IQ
 1017 01f4 00000000 		.word	g_pCur_ref_base_mA
 1018 01f8 00000000 		.word	.LANCHOR17
 1019 01fc 00000000 		.word	g_high_fre_pulse
 1020              		.cfi_endproc
 1021              	.LFE346:
 1023              		.section	.text.park_transform,"ax",%progbits
 1024              		.align	1
 1025              		.global	park_transform
 1026              		.syntax unified
 1027              		.thumb
 1028              		.thumb_func
 1029              		.fpu fpv4-sp-d16
 1031              	park_transform:
 1032              	.LFB347:
1261:Src/pid.c     **** 
1262:Src/pid.c     **** 
1263:Src/pid.c     **** void park_transform(int alpha, int beta, int*q, int*d,int ElectricAngle )
1264:Src/pid.c     **** {
 1033              		.loc 1 1264 0
 1034              		.cfi_startproc
 1035              		@ args = 4, pretend = 0, frame = 0
 1036              		@ frame_needed = 0, uses_anonymous_args = 0
 1037              	.LVL44:
 1038 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1039              	.LCFI7:
 1040              		.cfi_def_cfa_offset 32
 1041              		.cfi_offset 4, -32
 1042              		.cfi_offset 5, -28
 1043              		.cfi_offset 6, -24
 1044              		.cfi_offset 7, -20
 1045              		.cfi_offset 8, -16
 1046              		.cfi_offset 9, -12
 1047              		.cfi_offset 10, -8
 1048              		.cfi_offset 14, -4
1265:Src/pid.c     **** 	int i,j;
1266:Src/pid.c     **** 	
1267:Src/pid.c     **** 	i = Math_Sin_EN360(ElectricAngle);
 1049              		.loc 1 1267 0
 1050 0004 BDF82040 		ldrh	r4, [sp, #32]
1268:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
1269:Src/pid.c     **** 	*q = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 1051              		.loc 1 1269 0
 1052 0008 124F     		ldr	r7, .L77
 1053 000a 134D     		ldr	r5, .L77+4
1267:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1054              		.loc 1 1267 0
 1055 000c 2046     		mov	r0, r4
 1056              	.LVL45:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 44


1264:Src/pid.c     **** 	int i,j;
 1057              		.loc 1 1264 0
 1058 000e 9246     		mov	r10, r2
 1059 0010 9846     		mov	r8, r3
1267:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1060              		.loc 1 1267 0
 1061 0012 FFF7FEFF 		bl	Math_Sin_EN360
 1062              	.LVL46:
 1063 0016 0646     		mov	r6, r0
 1064              	.LVL47:
1268:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1065              		.loc 1 1268 0
 1066 0018 2046     		mov	r0, r4
 1067              	.LVL48:
 1068 001a FFF7FEFF 		bl	Math_Cos_EN360
 1069              	.LVL49:
 1070              		.loc 1 1269 0
 1071 001e 3968     		ldr	r1, [r7]
1268:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1072              		.loc 1 1268 0
 1073 0020 8146     		mov	r9, r0
 1074              	.LVL50:
 1075              		.loc 1 1269 0
 1076 0022 FFF7FEFF 		bl	Q15_MUL
 1077              	.LVL51:
 1078 0026 2968     		ldr	r1, [r5]
 1079 0028 0446     		mov	r4, r0
 1080 002a 3046     		mov	r0, r6
 1081 002c FFF7FEFF 		bl	Q15_MUL
 1082              	.LVL52:
 1083 0030 2044     		add	r0, r0, r4
 1084 0032 CAF80000 		str	r0, [r10]
1270:Src/pid.c     **** 	*d = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 1085              		.loc 1 1270 0
 1086 0036 3968     		ldr	r1, [r7]
 1087 0038 3046     		mov	r0, r6
 1088 003a FFF7FEFF 		bl	Q15_MUL
 1089              	.LVL53:
 1090 003e 2968     		ldr	r1, [r5]
 1091 0040 0446     		mov	r4, r0
 1092 0042 4846     		mov	r0, r9
 1093 0044 FFF7FEFF 		bl	Q15_MUL
 1094              	.LVL54:
 1095 0048 201A     		subs	r0, r4, r0
 1096 004a C8F80000 		str	r0, [r8]
1271:Src/pid.c     **** }
 1097              		.loc 1 1271 0
 1098 004e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1099              	.LVL55:
 1100              	.L78:
 1101 0052 00BF     		.align	2
 1102              	.L77:
 1103 0054 00000000 		.word	I_Alpha
 1104 0058 00000000 		.word	I_Beta
 1105              		.cfi_endproc
 1106              	.LFE347:
 1108              		.global	__aeabi_f2d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 45


 1109              		.global	__aeabi_dmul
 1110              		.global	__aeabi_i2d
 1111              		.global	__aeabi_ddiv
 1112              		.global	__aeabi_d2f
 1113              		.section	.text.hfi_update_angle,"ax",%progbits
 1114              		.align	1
 1115              		.global	hfi_update_angle
 1116              		.syntax unified
 1117              		.thumb
 1118              		.thumb_func
 1119              		.fpu fpv4-sp-d16
 1121              	hfi_update_angle:
 1122              	.LFB342:
 978:Src/pid.c     **** 	int X,Y;
 1123              		.loc 1 978 0
 1124              		.cfi_startproc
 1125              		@ args = 0, pretend = 0, frame = 8
 1126              		@ frame_needed = 0, uses_anonymous_args = 0
 1127 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1128              	.LCFI8:
 1129              		.cfi_def_cfa_offset 36
 1130              		.cfi_offset 4, -36
 1131              		.cfi_offset 5, -32
 1132              		.cfi_offset 6, -28
 1133              		.cfi_offset 7, -24
 1134              		.cfi_offset 8, -20
 1135              		.cfi_offset 9, -16
 1136              		.cfi_offset 10, -12
 1137              		.cfi_offset 11, -8
 1138              		.cfi_offset 14, -4
 987:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1139              		.loc 1 987 0
 1140 0004 5E4C     		ldr	r4, .L80+32
 997:Src/pid.c     **** 	
 1141              		.loc 1 997 0
 1142 0006 DFF8ACB1 		ldr	fp, .L80+84
 1143 000a DFF8ACA1 		ldr	r10, .L80+88
 1144 000e 5D4D     		ldr	r5, .L80+36
 1145 0010 DBF80000 		ldr	r0, [fp]
 1146 0014 DAF80010 		ldr	r1, [r10]
 989:Src/pid.c     **** 	pid_pll.Kd = 0;
 1147              		.loc 1 989 0
 1148 0018 4FF47A72 		mov	r2, #1000
 1149 001c 0A23     		movs	r3, #10
 1150 001e C4E90223 		strd	r2, r3, [r4, #8]
 991:Src/pid.c     **** 	pid_pll.enable =1;
 1151              		.loc 1 991 0
 1152 0022 46F2A813 		movw	r3, #25000
 1153 0026 A363     		str	r3, [r4, #56]
 992:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 1154              		.loc 1 992 0
 1155 0028 0123     		movs	r3, #1
 1156 002a 2360     		str	r3, [r4]
 993:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 1157              		.loc 1 993 0
 1158 002c 6FF00043 		mvn	r3, #-2147483648
 978:Src/pid.c     **** 	int X,Y;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 46


 1159              		.loc 1 978 0
 1160 0030 85B0     		sub	sp, sp, #20
 1161              	.LCFI9:
 1162              		.cfi_def_cfa_offset 56
 993:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 1163              		.loc 1 993 0
 1164 0032 E363     		str	r3, [r4, #60]
 994:Src/pid.c     **** 	
 1165              		.loc 1 994 0
 1166 0034 0233     		adds	r3, r3, #2
 1167 0036 2364     		str	r3, [r4, #64]
 997:Src/pid.c     **** 	
 1168              		.loc 1 997 0
 1169 0038 2B68     		ldr	r3, [r5]
 1170 003a 0093     		str	r3, [sp]
 987:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1171              		.loc 1 987 0
 1172 003c 0027     		movs	r7, #0
 997:Src/pid.c     **** 	
 1173              		.loc 1 997 0
 1174 003e 02AA     		add	r2, sp, #8
 1175 0040 03AB     		add	r3, sp, #12
 987:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1176              		.loc 1 987 0
 1177 0042 6761     		str	r7, [r4, #20]
 990:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 1178              		.loc 1 990 0
 1179 0044 2761     		str	r7, [r4, #16]
 997:Src/pid.c     **** 	
 1180              		.loc 1 997 0
 1181 0046 FFF7FEFF 		bl	park_transform
 1182              	.LVL56:
 999:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
 1183              		.loc 1 999 0
 1184 004a 4F4B     		ldr	r3, .L80+40
 1185 004c 1868     		ldr	r0, [r3]	@ float
 1186 004e FFF7FEFF 		bl	__aeabi_f2d
 1187              	.LVL57:
 1188 0052 43A3     		adr	r3, .L80
 1189 0054 D3E90023 		ldrd	r2, [r3]
 1190 0058 FFF7FEFF 		bl	__aeabi_dmul
 1191              	.LVL58:
 1192 005c 0022     		movs	r2, #0
 1193 005e 4B4B     		ldr	r3, .L80+44
 1194 0060 FFF7FEFF 		bl	__aeabi_dmul
 1195              	.LVL59:
 1196 0064 0022     		movs	r2, #0
 1197 0066 4A4B     		ldr	r3, .L80+48
 1198 0068 FFF7FEFF 		bl	__aeabi_dmul
 1199              	.LVL60:
 1200 006c 494B     		ldr	r3, .L80+52
 1201 006e 8046     		mov	r8, r0
 1202 0070 1868     		ldr	r0, [r3]
 1203 0072 1926     		movs	r6, #25
 1204 0074 7043     		muls	r0, r6, r0
 1205 0076 8946     		mov	r9, r1
 1206 0078 FFF7FEFF 		bl	__aeabi_i2d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 47


 1207              	.LVL61:
 1208 007c 0246     		mov	r2, r0
 1209 007e 0B46     		mov	r3, r1
 1210 0080 4046     		mov	r0, r8
 1211 0082 4946     		mov	r1, r9
 1212 0084 FFF7FEFF 		bl	__aeabi_ddiv
 1213              	.LVL62:
 1214 0088 0022     		movs	r2, #0
 1215 008a 434B     		ldr	r3, .L80+56
 1216 008c FFF7FEFF 		bl	__aeabi_ddiv
 1217              	.LVL63:
 1218 0090 35A3     		adr	r3, .L80+8
 1219 0092 D3E90023 		ldrd	r2, [r3]
 1220 0096 FFF7FEFF 		bl	__aeabi_ddiv
 1221              	.LVL64:
 1222 009a 35A3     		adr	r3, .L80+16
 1223 009c D3E90023 		ldrd	r2, [r3]
 1224 00a0 FFF7FEFF 		bl	__aeabi_dmul
 1225              	.LVL65:
 1226 00a4 34A3     		adr	r3, .L80+24
 1227 00a6 D3E90023 		ldrd	r2, [r3]
 1228 00aa FFF7FEFF 		bl	__aeabi_dmul
 1229              	.LVL66:
 1230 00ae FFF7FEFF 		bl	__aeabi_d2f
 1231              	.LVL67:
 1232 00b2 3A4B     		ldr	r3, .L80+60
 1233 00b4 1860     		str	r0, [r3]	@ float
1000:Src/pid.c     **** 	
 1234              		.loc 1 1000 0
 1235 00b6 0398     		ldr	r0, [sp, #12]
 1236 00b8 7043     		muls	r0, r6, r0
 1237 00ba FFF7FEFF 		bl	__aeabi_i2d
 1238              	.LVL68:
 1239 00be 0246     		mov	r2, r0
 1240 00c0 0B46     		mov	r3, r1
 1241 00c2 4046     		mov	r0, r8
 1242 00c4 4946     		mov	r1, r9
 1243 00c6 FFF7FEFF 		bl	__aeabi_ddiv
 1244              	.LVL69:
 1245 00ca 0022     		movs	r2, #0
 1246 00cc 324B     		ldr	r3, .L80+56
1002:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 1247              		.loc 1 1002 0
 1248 00ce 344E     		ldr	r6, .L80+64
1000:Src/pid.c     **** 	
 1249              		.loc 1 1000 0
 1250 00d0 FFF7FEFF 		bl	__aeabi_ddiv
 1251              	.LVL70:
 1252 00d4 24A3     		adr	r3, .L80+8
 1253 00d6 D3E90023 		ldrd	r2, [r3]
 1254 00da FFF7FEFF 		bl	__aeabi_ddiv
 1255              	.LVL71:
 1256 00de 24A3     		adr	r3, .L80+16
 1257 00e0 D3E90023 		ldrd	r2, [r3]
 1258 00e4 FFF7FEFF 		bl	__aeabi_dmul
 1259              	.LVL72:
 1260 00e8 23A3     		adr	r3, .L80+24
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 48


 1261 00ea D3E90023 		ldrd	r2, [r3]
 1262 00ee FFF7FEFF 		bl	__aeabi_dmul
 1263              	.LVL73:
 1264 00f2 FFF7FEFF 		bl	__aeabi_d2f
 1265              	.LVL74:
 1266 00f6 2B4B     		ldr	r3, .L80+68
 1267 00f8 1860     		str	r0, [r3]	@ float
1002:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 1268              		.loc 1 1002 0
 1269 00fa 3088     		ldrh	r0, [r6]
 1270 00fc FFF7FEFF 		bl	Math_Sin_EN360
 1271              	.LVL75:
 1272 0100 8046     		mov	r8, r0
 1273              	.LVL76:
1003:Src/pid.c     **** 	
 1274              		.loc 1 1003 0
 1275 0102 3088     		ldrh	r0, [r6]
 1276              	.LVL77:
 1277 0104 FFF7FEFF 		bl	Math_Cos_EN360
 1278              	.LVL78:
1005:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1279              		.loc 1 1005 0
 1280 0108 4146     		mov	r1, r8
1003:Src/pid.c     **** 	
 1281              		.loc 1 1003 0
 1282 010a 8146     		mov	r9, r0
 1283              	.LVL79:
1005:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1284              		.loc 1 1005 0
 1285 010c DBF80000 		ldr	r0, [fp]
 1286              	.LVL80:
 1287 0110 FFF7FEFF 		bl	Q15_MUL
 1288              	.LVL81:
1006:Src/pid.c     **** 	
 1289              		.loc 1 1006 0
 1290 0114 4946     		mov	r1, r9
1005:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1291              		.loc 1 1005 0
 1292 0116 8046     		mov	r8, r0
 1293              	.LVL82:
1006:Src/pid.c     **** 	
 1294              		.loc 1 1006 0
 1295 0118 DAF80000 		ldr	r0, [r10]
 1296              	.LVL83:
 1297 011c FFF7FEFF 		bl	Q15_MUL
 1298              	.LVL84:
1010:Src/pid.c     **** 	observer_speed = pid_pll.out;
 1299              		.loc 1 1010 0
 1300 0120 2246     		mov	r2, r4
 1301 0122 A8EB0001 		sub	r1, r8, r0
 1302              	.LVL85:
 1303 0126 3846     		mov	r0, r7
 1304              	.LVL86:
 1305 0128 FFF7FEFF 		bl	PID_control
 1306              	.LVL87:
1011:Src/pid.c     **** 	
 1307              		.loc 1 1011 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 49


 1308 012c 1E4A     		ldr	r2, .L80+72
 1309 012e 636B     		ldr	r3, [r4, #52]
 1310 0130 1360     		str	r3, [r2]
1013:Src/pid.c     **** 	
 1311              		.loc 1 1013 0
 1312 0132 1E4A     		ldr	r2, .L80+76
 1313 0134 1168     		ldr	r1, [r2]
 1314 0136 0B44     		add	r3, r3, r1
 1315 0138 1360     		str	r3, [r2]
1015:Src/pid.c     **** 	
 1316              		.loc 1 1015 0
 1317 013a 6422     		movs	r2, #100
 1318 013c 93FBF2F3 		sdiv	r3, r3, r2
1019:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 1319              		.loc 1 1019 0
 1320 0140 1B4A     		ldr	r2, .L80+80
 1321 0142 B2F90020 		ldrsh	r2, [r2]
1017:Src/pid.c     **** 	
 1322              		.loc 1 1017 0
 1323 0146 C3F30E03 		ubfx	r3, r3, #0, #15
 1324 014a 3360     		str	r3, [r6]
1019:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 1325              		.loc 1 1019 0
 1326 014c 1344     		add	r3, r3, r2
 1327              	.LVL88:
1020:Src/pid.c     **** 	
 1328              		.loc 1 1020 0
 1329 014e C3F30E03 		ubfx	r3, r3, #0, #15
 1330              	.LVL89:
1022:Src/pid.c     **** 	
 1331              		.loc 1 1022 0
 1332 0152 2B60     		str	r3, [r5]
1031:Src/pid.c     **** 
 1333              		.loc 1 1031 0
 1334 0154 05B0     		add	sp, sp, #20
 1335              	.LCFI10:
 1336              		.cfi_def_cfa_offset 36
 1337              		@ sp needed
 1338 0156 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1339              	.LVL90:
 1340              	.L81:
 1341 015a 00BFAFF3 		.align	3
 1341      0080
 1342              	.L80:
 1343 0160 F46C567D 		.word	2102815988
 1344 0164 AEB6FB3F 		.word	1073460910
 1345 0168 00000000 		.word	0
 1346 016c 00A0A740 		.word	1084727296
 1347 0170 8FC2F528 		.word	687194767
 1348 0174 5C8FE23F 		.word	1071812444
 1349 0178 66666666 		.word	1717986918
 1350 017c 6666E63F 		.word	1072064102
 1351 0180 00000000 		.word	pid_pll
 1352 0184 00000000 		.word	g_ElectricAngle
 1353 0188 00000000 		.word	.LANCHOR20
 1354 018c 00407F40 		.word	1082081280
 1355 0190 00408F40 		.word	1083129856
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 50


 1356 0194 00000000 		.word	.LANCHOR18
 1357 0198 00000840 		.word	1074266112
 1358 019c 00000000 		.word	L
 1359 01a0 00000000 		.word	observer_ElectricAngle
 1360 01a4 00000000 		.word	temp_L
 1361 01a8 00000000 		.word	observer_speed
 1362 01ac 00000000 		.word	integre_observer_ElectricAngle
 1363 01b0 00000000 		.word	EN_90
 1364 01b4 00000000 		.word	delta_alpha
 1365 01b8 00000000 		.word	delata_beta
 1366              		.cfi_endproc
 1367              	.LFE342:
 1369              		.global	__aeabi_d2uiz
 1370              		.section	.text.ServoPro_Fast,"ax",%progbits
 1371              		.align	1
 1372              		.global	ServoPro_Fast
 1373              		.syntax unified
 1374              		.thumb
 1375              		.thumb_func
 1376              		.fpu fpv4-sp-d16
 1378              	ServoPro_Fast:
 1379              	.LFB348:
1272:Src/pid.c     **** 
1273:Src/pid.c     **** s32 ServoPro_En_count = 0;
1274:Src/pid.c     **** extern volatile s32 Encoder_Inc;   							// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1275:Src/pid.c     **** extern volatile s32 s_SpeedTimeAdd1;   					// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1276:Src/pid.c     **** extern volatile s32 start_speed_sample;
1277:Src/pid.c     ****  volatile  int pid_hall_ture_value1;
1278:Src/pid.c     ****   volatile  int pid_last_hall_ture_value1;
1279:Src/pid.c     ****  volatile int last_hall_sample_time = 0;
1280:Src/pid.c     ****  volatile int speed1,speed2,speed3;
1281:Src/pid.c     **** 
1282:Src/pid.c     **** extern volatile int time4_capture_ch1;
1283:Src/pid.c     **** 
1284:Src/pid.c     **** int pid_hall_sample_time_point[10];
1285:Src/pid.c     **** int pid_hall_sample_time_index = 0;
1286:Src/pid.c     **** volatile int last_time4_capture_ch1 = 0;
1287:Src/pid.c     **** 
1288:Src/pid.c     **** volatile int hall_speed_sample_timeout_cnt=0; //ï¿½ï¿½ï¿½ãµ½30ms
1289:Src/pid.c     **** volatile int  hall_speed_sample_cnt = 0;
1290:Src/pid.c     **** volatile int hall_speed_sample_timeout =0;
1291:Src/pid.c     **** volatile int hall_cnt = 0;
1292:Src/pid.c     **** 
1293:Src/pid.c     **** volatile int hall_now_time = 0;
1294:Src/pid.c     **** volatile int hall_previous_1_time = 0;
1295:Src/pid.c     **** volatile int hall_previous_2_time = 0;
1296:Src/pid.c     **** volatile int hall_previous_3_time = 0;
1297:Src/pid.c     **** int64_t hall_total_time;
1298:Src/pid.c     **** 
1299:Src/pid.c     **** volatile int64_t Vel_PPS_raw1 =0;
1300:Src/pid.c     **** 
1301:Src/pid.c     **** void ServoPro_Fast(void)
1302:Src/pid.c     **** {
 1380              		.loc 1 1302 0
 1381              		.cfi_startproc
 1382              		@ args = 0, pretend = 0, frame = 16
 1383              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 51


 1384              	.LVL91:
 1385 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1386              	.LCFI11:
 1387              		.cfi_def_cfa_offset 36
 1388              		.cfi_offset 4, -36
 1389              		.cfi_offset 5, -32
 1390              		.cfi_offset 6, -28
 1391              		.cfi_offset 7, -24
 1392              		.cfi_offset 8, -20
 1393              		.cfi_offset 9, -16
 1394              		.cfi_offset 10, -12
 1395              		.cfi_offset 11, -8
 1396              		.cfi_offset 14, -4
1303:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
1304:Src/pid.c     **** 
1305:Src/pid.c     **** 	
1306:Src/pid.c     **** 	int64_t speed;
1307:Src/pid.c     **** 
1308:Src/pid.c     **** 	
1309:Src/pid.c     **** 	static u8 PlusPosition_flag = 0;
1310:Src/pid.c     ****   static s32 s_count = 0;
1311:Src/pid.c     ****   static int s_hal_cnt=0;
1312:Src/pid.c     **** 	EXTI_HandleTypeDef EXTI_Handle;
1313:Src/pid.c     **** 	
1314:Src/pid.c     **** GPIOA->BSRR  |= (uint32_t)GPIO_PIN_15;
 1397              		.loc 1 1314 0
 1398 0004 4FF09042 		mov	r2, #1207959552
1302:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
 1399              		.loc 1 1302 0
 1400 0008 2DED088B 		vpush.64	{d8, d9, d10, d11}
 1401              	.LCFI12:
 1402              		.cfi_def_cfa_offset 68
 1403              		.cfi_offset 80, -68
 1404              		.cfi_offset 81, -64
 1405              		.cfi_offset 82, -60
 1406              		.cfi_offset 83, -56
 1407              		.cfi_offset 84, -52
 1408              		.cfi_offset 85, -48
 1409              		.cfi_offset 86, -44
 1410              		.cfi_offset 87, -40
 1411              		.loc 1 1314 0
 1412 000c 9369     		ldr	r3, [r2, #24]
 1413 000e 43F40043 		orr	r3, r3, #32768
 1414 0012 9361     		str	r3, [r2, #24]
1302:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
 1415              		.loc 1 1302 0
 1416 0014 85B0     		sub	sp, sp, #20
 1417              	.LCFI13:
 1418              		.cfi_def_cfa_offset 88
1315:Src/pid.c     **** 	
1316:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X01);
1317:Src/pid.c     **** 	//---------------------------------ï¿½ï¿½ï¿½Â´ï¿½ï¿½ï¿½20KHz(50us)Ö´ï¿½ï¿½-----------------
1318:Src/pid.c     **** //	if(g_BeginPIDFlag == 1)
1319:Src/pid.c     **** 	{
1320:Src/pid.c     **** 		GetElectricAngle();//ï¿½ï¿½È¡ï¿½ï¿½Ç¶ï¿½
 1419              		.loc 1 1320 0
 1420 0016 FFF7FEFF 		bl	GetElectricAngle
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 52


 1421              	.LVL92:
1321:Src/pid.c     **** 		GetCurrent();   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 	
 1422              		.loc 1 1321 0
 1423 001a FFF7FEFF 		bl	GetCurrent
 1424              	.LVL93:
1322:Src/pid.c     **** 		
1323:Src/pid.c     **** //		hfi_update_angle();
1324:Src/pid.c     **** 		
1325:Src/pid.c     **** 	}
1326:Src/pid.c     **** 	
1327:Src/pid.c     **** 
1328:Src/pid.c     **** 	measure_R();
 1425              		.loc 1 1328 0
 1426 001e FFF7FEFF 		bl	measure_R
 1427              	.LVL94:
1329:Src/pid.c     **** 	if(g_bEnableHB) 																											// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ or ï¿½ï¿½ï¿½ï¿½
 1428              		.loc 1 1329 0
 1429 0022 724B     		ldr	r3, .L168
 1430 0024 1B88     		ldrh	r3, [r3]
 1431 0026 1BB2     		sxth	r3, r3
 1432 0028 002B     		cmp	r3, #0
 1433 002a 7FD0     		beq	.L83
 1434              	.LBB13:
1330:Src/pid.c     **** 	{
1331:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_OPEN)
 1435              		.loc 1 1331 0
 1436 002c 704B     		ldr	r3, .L168+4
 1437 002e 714D     		ldr	r5, .L168+8
 1438 0030 B3F80412 		ldrh	r1, [r3, #516]
 1439 0034 704E     		ldr	r6, .L168+12
 1440 0036 DFF8FC81 		ldr	r8, .L168+72
 1441 003a 704F     		ldr	r7, .L168+16
 1442 003c DFF8F891 		ldr	r9, .L168+76
 1443 0040 DFF8F8A1 		ldr	r10, .L168+80
 1444 0044 9FED6E9A 		vldr.32	s18, .L168+20
 1445 0048 DFED6E9A 		vldr.32	s19, .L168+24
 1446 004c 09B2     		sxth	r1, r1
 1447 004e 1C46     		mov	r4, r3
 1448 0050 0029     		cmp	r1, #0
 1449 0052 40F08B80 		bne	.L84
 1450              	.LBB14:
 1451              	.LBB15:
1041:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
 1452              		.loc 1 1041 0
 1453 0056 B3F86032 		ldrh	r3, [r3, #608]
1045:Src/pid.c     **** 
 1454              		.loc 1 1045 0
 1455 005a 3160     		str	r1, [r6]
1041:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
 1456              		.loc 1 1041 0
 1457 005c 4FF45262 		mov	r2, #3360
 1458 0060 13FB02F3 		smulbb	r3, r3, r2
 1459 0064 6422     		movs	r2, #100
 1460 0066 93FBF2F3 		sdiv	r3, r3, r2
 1461              	.LVL95:
1042:Src/pid.c     **** 	
 1462              		.loc 1 1042 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 53


 1463 006a 03F55262 		add	r2, r3, #3360
 1464 006e 92B2     		uxth	r2, r2
 1465 0070 B2F5D25F 		cmp	r2, #6720
 1466 0074 88BF     		it	hi
 1467 0076 4FF43D63 		movhi	r3, #3024
 1468              	.LVL96:
 1469 007a 634A     		ldr	r2, .L168+28
1044:Src/pid.c     **** 	g_Vd = 0;
 1470              		.loc 1 1044 0
 1471 007c 0192     		str	r2, [sp, #4]
 1472 007e 1BB2     		sxth	r3, r3
1042:Src/pid.c     **** 	
 1473              		.loc 1 1042 0
 1474 0080 1360     		str	r3, [r2]
1044:Src/pid.c     **** 	g_Vd = 0;
 1475              		.loc 1 1044 0
 1476 0082 1368     		ldr	r3, [r2]
1047:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 1477              		.loc 1 1047 0
 1478 0084 D8F80000 		ldr	r0, [r8]
1044:Src/pid.c     **** 	g_Vd = 0;
 1479              		.loc 1 1044 0
 1480 0088 2B60     		str	r3, [r5]
1047:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 1481              		.loc 1 1047 0
 1482 008a 80B2     		uxth	r0, r0
 1483 008c FFF7FEFF 		bl	Math_Sin_EN360
 1484              	.LVL97:
 1485 0090 0446     		mov	r4, r0
 1486              	.LVL98:
1048:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 1487              		.loc 1 1048 0
 1488 0092 D8F80000 		ldr	r0, [r8]
 1489              	.LVL99:
 1490 0096 80B2     		uxth	r0, r0
 1491 0098 FFF7FEFF 		bl	Math_Cos_EN360
 1492              	.LVL100:
1049:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 1493              		.loc 1 1049 0
 1494 009c 2146     		mov	r1, r4
1048:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 1495              		.loc 1 1048 0
 1496 009e 8346     		mov	fp, r0
 1497              	.LVL101:
1049:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 1498              		.loc 1 1049 0
 1499 00a0 3068     		ldr	r0, [r6]
 1500              	.LVL102:
 1501 00a2 FFF7FEFF 		bl	Q15_MUL
 1502              	.LVL103:
 1503 00a6 5946     		mov	r1, fp
 1504 00a8 0090     		str	r0, [sp]
 1505 00aa 2868     		ldr	r0, [r5]
 1506 00ac FFF7FEFF 		bl	Q15_MUL
 1507              	.LVL104:
 1508 00b0 009B     		ldr	r3, [sp]
 1509 00b2 1844     		add	r0, r0, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 54


 1510 00b4 3860     		str	r0, [r7]
1050:Src/pid.c     **** 
 1511              		.loc 1 1050 0
 1512 00b6 3068     		ldr	r0, [r6]
 1513 00b8 5946     		mov	r1, fp
 1514 00ba 4042     		negs	r0, r0
 1515 00bc FFF7FEFF 		bl	Q15_MUL
 1516              	.LVL105:
 1517 00c0 2146     		mov	r1, r4
 1518 00c2 0646     		mov	r6, r0
 1519 00c4 2868     		ldr	r0, [r5]
1063:Src/pid.c     **** 	{
 1520              		.loc 1 1063 0
 1521 00c6 514C     		ldr	r4, .L168+32
 1522              	.LVL106:
1050:Src/pid.c     **** 
 1523              		.loc 1 1050 0
 1524 00c8 FFF7FEFF 		bl	Q15_MUL
 1525              	.LVL107:
1052:Src/pid.c     **** 
 1526              		.loc 1 1052 0
 1527 00cc 9AED000A 		vldr.32	s0, [r10]
1050:Src/pid.c     **** 
 1528              		.loc 1 1050 0
 1529 00d0 3044     		add	r0, r0, r6
1052:Src/pid.c     **** 
 1530              		.loc 1 1052 0
 1531 00d2 20EE099A 		vmul.f32	s18, s0, s18
 1532 00d6 07EE900A 		vmov	s15, r0	@ int
 1533 00da 97ED000A 		vldr.32	s0, [r7]	@ int
1050:Src/pid.c     **** 
 1534              		.loc 1 1050 0
 1535 00de C9F80000 		str	r0, [r9]
1052:Src/pid.c     **** 
 1536              		.loc 1 1052 0
 1537 00e2 F8EEE70A 		vcvt.f32.s32	s1, s15
 1538 00e6 B8EEC00A 		vcvt.f32.s32	s0, s0
 1539 00ea 60EE890A 		vmul.f32	s1, s1, s18
 1540 00ee 20EE090A 		vmul.f32	s0, s0, s18
 1541 00f2 4748     		ldr	r0, .L168+36
 1542 00f4 C0EEA90A 		vdiv.f32	s1, s1, s19
 1543 00f8 80EE290A 		vdiv.f32	s0, s0, s19
 1544 00fc FFF7FEFF 		bl	update_current_control
 1545              	.LVL108:
1061:Src/pid.c     **** 	
 1546              		.loc 1 1061 0
 1547 0100 D8F80030 		ldr	r3, [r8]
1063:Src/pid.c     **** 	{
 1548              		.loc 1 1063 0
 1549 0104 B4F90040 		ldrsh	r4, [r4]
1061:Src/pid.c     **** 	
 1550              		.loc 1 1061 0
 1551 0108 4249     		ldr	r1, .L168+40
 1552 010a 019A     		ldr	r2, [sp, #4]
 1553 010c 18B2     		sxth	r0, r3
1063:Src/pid.c     **** 	{
 1554              		.loc 1 1063 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 55


 1555 010e 8442     		cmp	r4, r0
1061:Src/pid.c     **** 	
 1556              		.loc 1 1061 0
 1557 0110 0880     		strh	r0, [r1]	@ movhi
 1558 0112 414C     		ldr	r4, .L168+44
1063:Src/pid.c     **** 	{
 1559              		.loc 1 1063 0
 1560 0114 24DD     		ble	.L86
1065:Src/pid.c     **** 	}
 1561              		.loc 1 1065 0
 1562 0116 2088     		ldrh	r0, [r4]
 1563 0118 0344     		add	r3, r3, r0
 1564              	.L159:
1069:Src/pid.c     **** 	}
 1565              		.loc 1 1069 0
 1566 011a 0B80     		strh	r3, [r1]	@ movhi
 1567              	.L87:
1071:Src/pid.c     **** }
 1568              		.loc 1 1071 0
 1569 011c 1268     		ldr	r2, [r2]
 1570 011e B1F90010 		ldrsh	r1, [r1]
 1571 0122 3E48     		ldr	r0, .L168+48
 1572 0124 FFF7FEFF 		bl	PWM_OutPut_Open
 1573              	.LVL109:
 1574              	.L88:
 1575              	.LBE15:
 1576              	.LBE14:
1332:Src/pid.c     **** 		{
1333:Src/pid.c     **** 			OpenLoop();
1334:Src/pid.c     **** 		}
1335:Src/pid.c     **** 		else
1336:Src/pid.c     **** 		{
1337:Src/pid.c     **** 			CurrentPID();
1338:Src/pid.c     **** 		}
1339:Src/pid.c     **** 		motor_fault_check(); //Â¼Ã¬Â²Ã©ÂµÃ§Â»ÃºÃÃÂ·Ã±ÃÃÃÃ½Â³Â£Â¹Â¤ÃÃ·
 1577              		.loc 1 1339 0
 1578 0128 FFF7FEFF 		bl	motor_fault_check
 1579              	.LVL110:
 1580              	.L83:
 1581              	.LBE13:
1340:Src/pid.c     **** 	}
1341:Src/pid.c     **** 	
1342:Src/pid.c     **** 
1343:Src/pid.c     **** 	PlusPosition_flag ^= 0x1;
 1582              		.loc 1 1343 0
 1583 012c 3C4A     		ldr	r2, .L168+52
 1584 012e 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1585 0130 83F00103 		eor	r3, r3, #1
 1586 0134 1370     		strb	r3, [r2]
1344:Src/pid.c     **** 
1345:Src/pid.c     **** 	non_linear_flux_observer();
 1587              		.loc 1 1345 0
 1588 0136 FFF7FEFF 		bl	non_linear_flux_observer
 1589              	.LVL111:
1346:Src/pid.c     **** 	encode_sample();
 1590              		.loc 1 1346 0
 1591 013a FFF7FEFF 		bl	encode_sample
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 56


 1592              	.LVL112:
1347:Src/pid.c     ****     sensorless_sensor_phase_switch();
 1593              		.loc 1 1347 0
 1594 013e FFF7FEFF 		bl	sensorless_sensor_phase_switch
 1595              	.LVL113:
1348:Src/pid.c     **** 
1349:Src/pid.c     **** 	s_count ++;
 1596              		.loc 1 1349 0
 1597 0142 384A     		ldr	r2, .L168+56
 1598 0144 1368     		ldr	r3, [r2]
 1599 0146 0133     		adds	r3, r3, #1
1350:Src/pid.c     **** 	if(s_count >= (F_CUR_REGULATOR_HZ/F_SPD_REGULATOR_HZ))
 1600              		.loc 1 1350 0
 1601 0148 052B     		cmp	r3, #5
 1602 014a 00F38C83 		bgt	.L136
1349:Src/pid.c     **** 	if(s_count >= (F_CUR_REGULATOR_HZ/F_SPD_REGULATOR_HZ))
 1603              		.loc 1 1349 0
 1604 014e 1360     		str	r3, [r2]
 1605              	.L137:
1351:Src/pid.c     **** 	{	
1352:Src/pid.c     **** 		s_count = 0;    		
1353:Src/pid.c     **** 		EXTI->SWIER1 |= 0x08;
1354:Src/pid.c     **** 		EXTI_Handle.Line = 3;
1355:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
1356:Src/pid.c     **** 	} 
1357:Src/pid.c     **** 
1358:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1359:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1360:Src/pid.c     **** 	
1361:Src/pid.c     **** 	SPI3->DR =0X0000;
 1606              		.loc 1 1361 0
 1607 0150 354B     		ldr	r3, .L168+60
 1608 0152 0022     		movs	r2, #0
 1609 0154 DA60     		str	r2, [r3, #12]
1362:Src/pid.c     **** 	
1363:Src/pid.c     **** }
 1610              		.loc 1 1363 0
 1611 0156 05B0     		add	sp, sp, #20
 1612              	.LCFI14:
 1613              		.cfi_remember_state
 1614              		.cfi_def_cfa_offset 68
 1615              		@ sp needed
 1616 0158 BDEC088B 		vldm	sp!, {d8-d11}
 1617              	.LCFI15:
 1618              		.cfi_restore 86
 1619              		.cfi_restore 87
 1620              		.cfi_restore 84
 1621              		.cfi_restore 85
 1622              		.cfi_restore 82
 1623              		.cfi_restore 83
 1624              		.cfi_restore 80
 1625              		.cfi_restore 81
 1626              		.cfi_def_cfa_offset 36
 1627 015c BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1628              	.LVL114:
 1629              	.L86:
 1630              	.LCFI16:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 57


 1631              		.cfi_restore_state
 1632              	.LBB26:
 1633              	.LBB17:
 1634              	.LBB16:
1067:Src/pid.c     **** 	{
 1635              		.loc 1 1067 0
 1636 0160 B4F90040 		ldrsh	r4, [r4]
 1637 0164 A042     		cmp	r0, r4
 1638 0166 D9DD     		ble	.L87
1069:Src/pid.c     **** 	}
 1639              		.loc 1 1069 0
 1640 0168 1B1B     		subs	r3, r3, r4
 1641 016a D6E7     		b	.L159
 1642              	.LVL115:
 1643              	.L84:
 1644              	.LBE16:
 1645              	.LBE17:
 1646              	.LBB18:
 1647              	.LBB19:
 432:Src/pid.c     **** 	{
 1648              		.loc 1 432 0
 1649 016c B3F80432 		ldrh	r3, [r3, #516]
 1650 0170 1BB2     		sxth	r3, r3
 1651 0172 012B     		cmp	r3, #1
 1652 0174 15D0     		beq	.L89
 434:Src/pid.c     **** 		{
 1653              		.loc 1 434 0
 1654 0176 B4F80432 		ldrh	r3, [r4, #516]
 1655 017a 1BB2     		sxth	r3, r3
 1656 017c 022B     		cmp	r3, #2
 1657 017e 04D0     		beq	.L90
 1658 0180 B4F80432 		ldrh	r3, [r4, #516]
 1659 0184 1BB2     		sxth	r3, r3
 1660 0186 032B     		cmp	r3, #3
 1661 0188 25D1     		bne	.L91
 1662              	.L90:
 437:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 1663              		.loc 1 437 0
 1664 018a B4F87032 		ldrh	r3, [r4, #624]
 1665 018e A4F86E32 		strh	r3, [r4, #622]	@ movhi
 438:Src/pid.c     **** 		}
 1666              		.loc 1 438 0
 1667 0192 264B     		ldr	r3, .L168+64
 1668 0194 B4F86E22 		ldrh	r2, [r4, #622]
 1669 0198 5B6B     		ldr	r3, [r3, #52]
 1670 019a 1344     		add	r3, r3, r2
 1671 019c 1BB2     		sxth	r3, r3
 1672              	.L160:
 448:Src/pid.c     **** 		}	
 1673              		.loc 1 448 0
 1674 019e A4F84230 		strh	r3, [r4, #66]	@ movhi
 1675              	.L89:
 452:Src/pid.c     **** 	{
 1676              		.loc 1 452 0
 1677 01a2 B4F85432 		ldrh	r3, [r4, #596]
 1678 01a6 1AB2     		sxth	r2, r3
 1679 01a8 012A     		cmp	r2, #1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 58


 1680 01aa 49D1     		bne	.L93
 454:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1681              		.loc 1 454 0
 1682 01ac A4F80232 		strh	r3, [r4, #514]	@ movhi
 455:Src/pid.c     **** 		if(test++ > (50))
 1683              		.loc 1 455 0
 1684 01b0 A4F80432 		strh	r3, [r4, #516]	@ movhi
 456:Src/pid.c     **** 		{
 1685              		.loc 1 456 0
 1686 01b4 1E4B     		ldr	r3, .L168+68
 1687 01b6 1A88     		ldrh	r2, [r3]
 1688 01b8 322A     		cmp	r2, #50
 1689 01ba 94BF     		ite	ls
 1690 01bc 0132     		addls	r2, r2, #1
 458:Src/pid.c     **** 		}
 1691              		.loc 1 458 0
 1692 01be 0022     		movhi	r2, #0
 1693 01c0 1A80     		strh	r2, [r3]	@ movhi
 460:Src/pid.c     **** 		{
 1694              		.loc 1 460 0
 1695 01c2 1B88     		ldrh	r3, [r3]
 1696 01c4 192B     		cmp	r3, #25
 462:Src/pid.c     **** 		}
 1697              		.loc 1 462 0
 1698 01c6 8CBF     		ite	hi
 1699 01c8 4FF44863 		movhi	r3, #3200
 466:Src/pid.c     **** 		}	
 1700              		.loc 1 466 0
 1701 01cc 4FF28033 		movwls	r3, #62336
 1702              	.L162:
 569:Src/pid.c     **** 		}
 1703              		.loc 1 569 0
 1704 01d0 A4F84230 		strh	r3, [r4, #66]	@ movhi
 1705 01d4 75E0     		b	.L97
 1706              	.L91:
 440:Src/pid.c     **** 		{
 1707              		.loc 1 440 0
 1708 01d6 B4F80432 		ldrh	r3, [r4, #516]
 1709 01da 1BB2     		sxth	r3, r3
 1710 01dc 042B     		cmp	r3, #4
 443:Src/pid.c     **** 		
 1711              		.loc 1 443 0
 1712 01de 0ABF     		itet	eq
 1713 01e0 124B     		ldreq	r3, .L168+64
 448:Src/pid.c     **** 		}	
 1714              		.loc 1 448 0
 1715 01e2 0023     		movne	r3, #0
 443:Src/pid.c     **** 		
 1716              		.loc 1 443 0
 1717 01e4 B3F93430 		ldrsheq	r3, [r3, #52]
 1718 01e8 D9E7     		b	.L160
 1719              	.L169:
 1720 01ea 00BF     		.align	2
 1721              	.L168:
 1722 01ec 00000000 		.word	g_bEnableHB
 1723 01f0 00000000 		.word	g_CmdMap
 1724 01f4 00000000 		.word	.LANCHOR21
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 59


 1725 01f8 00000000 		.word	.LANCHOR22
 1726 01fc 00000000 		.word	.LANCHOR23
 1727 0200 3ACD133F 		.word	1058262330
 1728 0204 00005245 		.word	1163001856
 1729 0208 00000000 		.word	g_Timer1CCR
 1730 020c 00000000 		.word	EN_0
 1731 0210 00000000 		.word	motor_
 1732 0214 00000000 		.word	anlge_reg
 1733 0218 00000000 		.word	EN_360
 1734 021c 002C0140 		.word	1073818624
 1735 0220 00000000 		.word	.LANCHOR38
 1736 0224 00000000 		.word	.LANCHOR39
 1737 0228 003C0040 		.word	1073757184
 1738 022c 00000000 		.word	pid_spd
 1739 0230 00000000 		.word	.LANCHOR25
 1740 0234 00000000 		.word	g_ElectricAngle
 1741 0238 00000000 		.word	.LANCHOR24
 1742 023c 00000000 		.word	bus_voltage_
 1743              	.L93:
 469:Src/pid.c     **** 	{
 1744              		.loc 1 469 0
 1745 0240 B4F85432 		ldrh	r3, [r4, #596]
 1746 0244 1BB2     		sxth	r3, r3
 1747 0246 032B     		cmp	r3, #3
 1748 0248 40F0C081 		bne	.L98
 471:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1749              		.loc 1 471 0
 1750 024c 0123     		movs	r3, #1
 473:Src/pid.c     **** 		{
 1751              		.loc 1 473 0
 1752 024e CA4A     		ldr	r2, .L170
 471:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1753              		.loc 1 471 0
 1754 0250 A4F80232 		strh	r3, [r4, #514]	@ movhi
 472:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 1755              		.loc 1 472 0
 1756 0254 A4F80432 		strh	r3, [r4, #516]	@ movhi
 473:Src/pid.c     **** 		{
 1757              		.loc 1 473 0
 1758 0258 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 1759 025a C84B     		ldr	r3, .L170+4
 1760 025c 00F0FF01 		and	r1, r0, #255
 1761 0260 20B9     		cbnz	r0, .L99
 475:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 1762              		.loc 1 475 0
 1763 0262 1980     		strh	r1, [r3]	@ movhi
 476:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 1764              		.loc 1 476 0
 1765 0264 A4F8C010 		strh	r1, [r4, #192]	@ movhi
 477:Src/pid.c     **** 		}
 1766              		.loc 1 477 0
 1767 0268 A4F8C210 		strh	r1, [r4, #194]	@ movhi
 1768              	.L99:
 479:Src/pid.c     **** 		{
 1769              		.loc 1 479 0
 1770 026c 1988     		ldrh	r1, [r3]
 1771 026e 09B2     		sxth	r1, r1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 60


 1772 0270 0129     		cmp	r1, #1
 1773 0272 00F05B81 		beq	.L101
 1774 0276 0229     		cmp	r1, #2
 1775 0278 00F06981 		beq	.L102
 1776 027c 0029     		cmp	r1, #0
 1777 027e 40F07381 		bne	.L157
 483:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
 1778              		.loc 1 483 0
 1779 0282 0121     		movs	r1, #1
 1780 0284 1170     		strb	r1, [r2]
 484:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 1781              		.loc 1 484 0
 1782 0286 4FF40052 		mov	r2, #8192
 1783 028a A4F84220 		strh	r2, [r4, #66]	@ movhi
 485:Src/pid.c     **** 				{
 1784              		.loc 1 485 0
 1785 028e B4F85020 		ldrh	r2, [r4, #80]
 1786 0292 12B2     		sxth	r2, r2
 1787 0294 B2F54D7F 		cmp	r2, #820
 487:Src/pid.c     **** 				}
 1788              		.loc 1 487 0
 1789 0298 A1BF     		itttt	ge
 1790 029a B4F8C020 		ldrhge	r2, [r4, #192]
 1791 029e 2832     		addge	r2, r2, #40
 1792 02a0 12B2     		sxthge	r2, r2
 1793 02a2 A4F8C020 		strhge	r2, [r4, #192]	@ movhi
 489:Src/pid.c     **** 				{
 1794              		.loc 1 489 0
 1795 02a6 B4F85020 		ldrh	r2, [r4, #80]
 1796 02aa 42F23331 		movw	r1, #9011
 1797 02ae 12B2     		sxth	r2, r2
 1798 02b0 8A42     		cmp	r2, r1
 1799 02b2 06DD     		ble	.L97
 491:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 1800              		.loc 1 491 0
 1801 02b4 1A88     		ldrh	r2, [r3]
 1802 02b6 0132     		adds	r2, r2, #1
 1803 02b8 12B2     		sxth	r2, r2
 1804 02ba 1A80     		strh	r2, [r3]	@ movhi
 492:Src/pid.c     **** 				}
 1805              		.loc 1 492 0
 1806 02bc 0023     		movs	r3, #0
 1807 02be A4F8C230 		strh	r3, [r4, #194]	@ movhi
 1808              	.L97:
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1809              		.loc 1 573 0
 1810 02c2 AF4A     		ldr	r2, .L170+8
 1811 02c4 B4F89432 		ldrh	r3, [r4, #660]
 1812 02c8 1268     		ldr	r2, [r2]
 1813 02ca DFEDAE5A 		vldr.32	s11, .L170+12
 1814 02ce 1268     		ldr	r2, [r2]
 575:Src/pid.c     ****     Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_control_.p_
 1815              		.loc 1 575 0
 1816 02d0 DFF8DCB2 		ldr	fp, .L170+56
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1817              		.loc 1 573 0
 1818 02d4 9FEDACAA 		vldr.32	s20, .L170+16
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 61


 576:Src/pid.c     **** 
 1819              		.loc 1 576 0
 1820 02d8 9BED0D8A 		vldr.32	s16, [fp, #52]
 575:Src/pid.c     ****     Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_control_.p_
 1821              		.loc 1 575 0
 1822 02dc DBED0C8A 		vldr.32	s17, [fp, #48]
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1823              		.loc 1 578 0
 1824 02e0 DFEDAA4A 		vldr.32	s9, .L170+20
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1825              		.loc 1 573 0
 1826 02e4 1BB2     		sxth	r3, r3
 1827 02e6 4FF48041 		mov	r1, #16384
 1828 02ea 5343     		muls	r3, r2, r3
 1829 02ec 93FBF1F3 		sdiv	r3, r3, r1
 1830 02f0 07EE903A 		vmov	s15, r3	@ int
 574:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1831              		.loc 1 574 0
 1832 02f4 B4F84230 		ldrh	r3, [r4, #66]
 1833 02f8 B4F84E00 		ldrh	r0, [r4, #78]
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1834              		.loc 1 573 0
 1835 02fc F8EEE77A 		vcvt.f32.s32	s15, s15
 574:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1836              		.loc 1 574 0
 1837 0300 00B2     		sxth	r0, r0
 1838 0302 1BB2     		sxth	r3, r3
 1839 0304 1B1A     		subs	r3, r3, r0
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1840              		.loc 1 573 0
 1841 0306 87EEA57A 		vdiv.f32	s14, s15, s11
 574:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1842              		.loc 1 574 0
 1843 030a 5343     		muls	r3, r2, r3
 1844 030c 93FBF1F3 		sdiv	r3, r3, r1
 576:Src/pid.c     **** 
 1845              		.loc 1 576 0
 1846 0310 9F48     		ldr	r0, .L170+24
 574:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1847              		.loc 1 574 0
 1848 0312 07EE903A 		vmov	s15, r3	@ int
 1849 0316 F8EEE77A 		vcvt.f32.s32	s15, s15
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1850              		.loc 1 578 0
 1851 031a B4F84E30 		ldrh	r3, [r4, #78]
 579:Src/pid.c     ****     
 1852              		.loc 1 579 0
 1853 031e B4F894C2 		ldrh	ip, [r4, #660]
 574:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1854              		.loc 1 574 0
 1855 0322 C7EEA5AA 		vdiv.f32	s21, s15, s11
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1856              		.loc 1 578 0
 1857 0326 1BB2     		sxth	r3, r3
 579:Src/pid.c     ****     
 1858              		.loc 1 579 0
 1859 0328 0FFA8CFC 		sxth	ip, ip
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 62


 575:Src/pid.c     ****     Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_control_.p_
 1860              		.loc 1 575 0
 1861 032c DBED0A7A 		vldr.32	s15, [fp, #40]
 573:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1862              		.loc 1 573 0
 1863 0330 3AEE47AA 		vsub.f32	s20, s20, s14
 1864              	.LVL116:
 576:Src/pid.c     **** 
 1865              		.loc 1 576 0
 1866 0334 B0EE486A 		vmov.f32	s12, s16
 1867 0338 AAEEA76A 		vfma.f32	s12, s21, s15
 575:Src/pid.c     ****     Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_control_.p_
 1868              		.loc 1 575 0
 1869 033c EAEE278A 		vfma.f32	s17, s20, s15
 1870              	.LVL117:
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1871              		.loc 1 578 0
 1872 0340 06EE902A 		vmov	s13, r2	@ int
 1873 0344 07EE903A 		vmov	s15, r3	@ int
 1874 0348 F8EEE66A 		vcvt.f32.s32	s13, s13
 1875 034c F8EEE77A 		vcvt.f32.s32	s15, s15
 1876 0350 904B     		ldr	r3, .L170+28
 576:Src/pid.c     **** 
 1877              		.loc 1 576 0
 1878 0352 80ED006A 		vstr.32	s12, [r0]
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1879              		.loc 1 578 0
 1880 0356 67EEA67A 		vmul.f32	s15, s15, s13
 1881 035a DFED8F6A 		vldr.32	s13, .L170+32
 1882 035e 93ED007A 		vldr.32	s14, [r3]
 585:Src/pid.c     **** 
 1883              		.loc 1 585 0
 1884 0362 9BED038A 		vldr.32	s16, [fp, #12]
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1885              		.loc 1 578 0
 1886 0366 67EEA67A 		vmul.f32	s15, s15, s13
 579:Src/pid.c     ****     
 1887              		.loc 1 579 0
 1888 036a 02FB0CF2 		mul	r2, r2, ip
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1889              		.loc 1 578 0
 1890 036e C7EEA56A 		vdiv.f32	s13, s15, s11
 579:Src/pid.c     ****     
 1891              		.loc 1 579 0
 1892 0372 92FBF1F2 		sdiv	r2, r2, r1
 591:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 1893              		.loc 1 591 0
 1894 0376 B7EE00BA 		vmov.f32	s22, #1.0e+0
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1895              		.loc 1 578 0
 1896 037a 76EEC77A 		vsub.f32	s15, s13, s14
 1897 037e A7EEA47A 		vfma.f32	s14, s15, s9
 579:Src/pid.c     ****     
 1898              		.loc 1 579 0
 1899 0382 07EE902A 		vmov	s15, r2	@ int
 1900 0386 F8EEE77A 		vcvt.f32.s32	s15, s15
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 63


 1901              		.loc 1 578 0
 1902 038a 83ED007A 		vstr.32	s14, [r3]
 579:Src/pid.c     ****     
 1903              		.loc 1 579 0
 1904 038e 87EEA55A 		vdiv.f32	s10, s15, s11
 1905 0392 824B     		ldr	r3, .L170+36
 578:Src/pid.c     ****     Id_filter += 0.1f * ((float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000
 1906              		.loc 1 578 0
 1907 0394 F0EE476A 		vmov.f32	s13, s14
 579:Src/pid.c     ****     
 1908              		.loc 1 579 0
 1909 0398 93ED007A 		vldr.32	s14, [r3]
 583:Src/pid.c     ****     dec_vq = Id_filter * (*motor_.vel_estimate_erad_) *  motor_.config_.phase_inductance;
 1910              		.loc 1 583 0
 1911 039c DBED015A 		vldr.32	s11, [fp, #4]
 579:Src/pid.c     ****     
 1912              		.loc 1 579 0
 1913 03a0 75EE477A 		vsub.f32	s15, s10, s14
 1914 03a4 A7EEA47A 		vfma.f32	s14, s15, s9
 1915 03a8 83ED007A 		vstr.32	s14, [r3]
 1916              	.LVL118:
 583:Src/pid.c     ****     dec_vq = Id_filter * (*motor_.vel_estimate_erad_) *  motor_.config_.phase_inductance;
 1917              		.loc 1 583 0
 1918 03ac DBF86C30 		ldr	r3, [fp, #108]
 579:Src/pid.c     ****     
 1919              		.loc 1 579 0
 1920 03b0 F0EE477A 		vmov.f32	s15, s14
 583:Src/pid.c     ****     dec_vq = Id_filter * (*motor_.vel_estimate_erad_) *  motor_.config_.phase_inductance;
 1921              		.loc 1 583 0
 1922 03b4 93ED007A 		vldr.32	s14, [r3]
 1923              	.LVL119:
 585:Src/pid.c     **** 
 1924              		.loc 1 585 0
 1925 03b8 794B     		ldr	r3, .L170+40
 1926 03ba 27EE088A 		vmul.f32	s16, s14, s16
 584:Src/pid.c     ****     dec_bemf = (*motor_.vel_estimate_erad_) * pm_flux_linkage;
 1927              		.loc 1 584 0
 1928 03be 67EE877A 		vmul.f32	s15, s15, s14
 1929              	.LVL120:
 585:Src/pid.c     **** 
 1930              		.loc 1 585 0
 1931 03c2 83ED008A 		vstr.32	s16, [r3]
 1932              	.LVL121:
 588:Src/pid.c     **** 
 1933              		.loc 1 588 0
 1934 03c6 A5EEA78A 		vfma.f32	s16, s11, s15
 590:Src/pid.c     ****     float V_to_mod = 1.0f / mod_to_V;
 1935              		.loc 1 590 0
 1936 03ca DAED007A 		vldr.32	s15, [r10]
 1937 03ce 67EE897A 		vmul.f32	s15, s15, s18
 588:Src/pid.c     **** 
 1938              		.loc 1 588 0
 1939 03d2 38EE068A 		vadd.f32	s16, s16, s12
 591:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 1940              		.loc 1 591 0
 1941 03d6 8BEE276A 		vdiv.f32	s12, s22, s15
 587:Src/pid.c     ****     Vq +=  dec_vq + dec_bemf;  
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 64


 1942              		.loc 1 587 0
 1943 03da 27EE667A 		vnmul.f32	s14, s14, s13
 1944              	.LVL122:
 588:Src/pid.c     **** 
 1945              		.loc 1 588 0
 1946 03de 80ED008A 		vstr.32	s16, [r0]
 1947              	.LVL123:
 587:Src/pid.c     ****     Vq +=  dec_vq + dec_bemf;  
 1948              		.loc 1 587 0
 1949 03e2 E7EE258A 		vfma.f32	s17, s14, s11
 1950              	.LVL124:
 593:Src/pid.c     **** 
 1951              		.loc 1 593 0
 1952 03e6 28EE068A 		vmul.f32	s16, s16, s12
 592:Src/pid.c     ****     float mod_q = V_to_mod * Vq;
 1953              		.loc 1 592 0
 1954 03ea 68EE868A 		vmul.f32	s17, s17, s12
 1955              	.LVL125:
 595:Src/pid.c     **** 	if(mod_scalefactor < 1.0f)
 1956              		.loc 1 595 0
 1957 03ee 28EE080A 		vmul.f32	s0, s16, s16
 1958 03f2 A8EEA80A 		vfma.f32	s0, s17, s17
 1959 03f6 FFF7FEFF 		bl	sqrtf
 1960              	.LVL126:
 1961 03fa DFED6A7A 		vldr.32	s15, .L170+44
 1962 03fe 87EE800A 		vdiv.f32	s0, s15, s0
 1963              	.LVL127:
 596:Src/pid.c     **** 	{
 1964              		.loc 1 596 0
 1965 0402 B4EECB0A 		vcmpe.f32	s0, s22
 1966 0406 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1967 040a 40F12781 		bpl	.L158
 600:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1968              		.loc 1 600 0
 1969 040e 9BED0C7A 		vldr.32	s14, [fp, #48]
 1970 0412 DFED656A 		vldr.32	s13, .L170+48
 601:Src/pid.c     **** 	}
 1971              		.loc 1 601 0
 1972 0416 DBED0D7A 		vldr.32	s15, [fp, #52]
 600:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1973              		.loc 1 600 0
 1974 041a 27EE267A 		vmul.f32	s14, s14, s13
 598:Src/pid.c     ****         mod_q *= mod_scalefactor;
 1975              		.loc 1 598 0
 1976 041e 68EE808A 		vmul.f32	s17, s17, s0
 1977              	.LVL128:
 599:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d *= 0.99f;
 1978              		.loc 1 599 0
 1979 0422 28EE008A 		vmul.f32	s16, s16, s0
 1980              	.LVL129:
 601:Src/pid.c     **** 	}
 1981              		.loc 1 601 0
 1982 0426 67EEA67A 		vmul.f32	s15, s15, s13
 600:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1983              		.loc 1 600 0
 1984 042a 8BED0C7A 		vstr.32	s14, [fp, #48]
 1985              	.L165:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 65


 612:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1986              		.loc 1 612 0
 1987 042e 28EE298A 		vmul.f32	s16, s16, s19
 1988              	.LVL130:
 613:Src/pid.c     **** 	
 1989              		.loc 1 613 0
 1990 0432 68EEA98A 		vmul.f32	s17, s17, s19
 1991              	.LVL131:
 612:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1992              		.loc 1 612 0
 1993 0436 BDEEC88A 		vcvt.s32.f32	s16, s16
 613:Src/pid.c     **** 	
 1994              		.loc 1 613 0
 1995 043a FDEEE88A 		vcvt.s32.f32	s17, s17
 612:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1996              		.loc 1 612 0
 1997 043e 18EE103A 		vmov	r3, s16	@ int
 1998 0442 1BB2     		sxth	r3, r3
 1999 0444 2B60     		str	r3, [r5]
 613:Src/pid.c     **** 	
 2000              		.loc 1 613 0
 2001 0446 18EE903A 		vmov	r3, s17	@ int
 618:Src/pid.c     **** 	
 2002              		.loc 1 618 0
 2003 044a 584A     		ldr	r2, .L170+52
 606:Src/pid.c     **** 	}
 2004              		.loc 1 606 0
 2005 044c CBED0D7A 		vstr.32	s15, [fp, #52]
 613:Src/pid.c     **** 	
 2006              		.loc 1 613 0
 2007 0450 1BB2     		sxth	r3, r3
 2008 0452 3360     		str	r3, [r6]
 618:Src/pid.c     **** 	
 2009              		.loc 1 618 0
 2010 0454 1368     		ldr	r3, [r2]
 2011 0456 5B42     		negs	r3, r3
 2012 0458 1360     		str	r3, [r2]
 628:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 2013              		.loc 1 628 0
 2014 045a D8F80000 		ldr	r0, [r8]
 2015 045e 80B2     		uxth	r0, r0
 2016 0460 FFF7FEFF 		bl	Math_Sin_EN360
 2017              	.LVL132:
 2018 0464 8346     		mov	fp, r0
 2019              	.LVL133:
 629:Src/pid.c     **** 	//g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½
 2020              		.loc 1 629 0
 2021 0466 D8F80000 		ldr	r0, [r8]
 2022              	.LVL134:
 2023 046a 80B2     		uxth	r0, r0
 2024 046c FFF7FEFF 		bl	Math_Cos_EN360
 2025              	.LVL135:
 632:Src/pid.c     **** 	g_V_Beta = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);
 2026              		.loc 1 632 0
 2027 0470 0146     		mov	r1, r0
 2028 0472 0090     		str	r0, [sp]
 2029 0474 3068     		ldr	r0, [r6]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 66


 2030              	.LVL136:
 2031 0476 FFF7FEFF 		bl	Q15_MUL
 2032              	.LVL137:
 2033 047a 5946     		mov	r1, fp
 2034 047c 8046     		mov	r8, r0
 2035 047e 2868     		ldr	r0, [r5]
 2036 0480 FFF7FEFF 		bl	Q15_MUL
 2037              	.LVL138:
 2038 0484 A8EB0000 		sub	r0, r8, r0
 2039 0488 3860     		str	r0, [r7]
 633:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 2040              		.loc 1 633 0
 2041 048a 5946     		mov	r1, fp
 2042 048c 3068     		ldr	r0, [r6]
 2043 048e FFF7FEFF 		bl	Q15_MUL
 2044              	.LVL139:
 2045 0492 009B     		ldr	r3, [sp]
 2046 0494 0646     		mov	r6, r0
 2047 0496 1946     		mov	r1, r3
 2048 0498 2868     		ldr	r0, [r5]
 2049 049a FFF7FEFF 		bl	Q15_MUL
 2050              	.LVL140:
 2051 049e 3044     		add	r0, r0, r6
 634:Src/pid.c     **** 	X = g_V_Beta;
 2052              		.loc 1 634 0
 2053 04a0 07EE900A 		vmov	s15, r0	@ int
 2054 04a4 9AED000A 		vldr.32	s0, [r10]
 633:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 2055              		.loc 1 633 0
 2056 04a8 C9F80000 		str	r0, [r9]
 634:Src/pid.c     **** 	X = g_V_Beta;
 2057              		.loc 1 634 0
 2058 04ac F8EEE70A 		vcvt.f32.s32	s1, s15
 2059 04b0 D7ED007A 		vldr.32	s15, [r7]	@ int
 2060 04b4 3E48     		ldr	r0, .L170+56
 2061 04b6 20EE099A 		vmul.f32	s18, s0, s18
 2062 04ba B8EEE70A 		vcvt.f32.s32	s0, s15
 2063 04be 60EE890A 		vmul.f32	s1, s1, s18
 2064 04c2 20EE090A 		vmul.f32	s0, s0, s18
 2065 04c6 C0EEA90A 		vdiv.f32	s1, s1, s19
 2066 04ca 80EE290A 		vdiv.f32	s0, s0, s19
 2067 04ce FFF7FEFF 		bl	update_current_control
 2068              	.LVL141:
 636:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 2069              		.loc 1 636 0
 2070 04d2 3849     		ldr	r1, .L170+60
 2071 04d4 3868     		ldr	r0, [r7]
 635:Src/pid.c     **** 	temp32 = Q16_MUL(g_V_Alpha,113512);
 2072              		.loc 1 635 0
 2073 04d6 D9F80050 		ldr	r5, [r9]
 2074              	.LVL142:
 636:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 2075              		.loc 1 636 0
 2076 04da FFF7FEFF 		bl	Q16_MUL
 2077              	.LVL143:
 637:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 2078              		.loc 1 637 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 67


 2079 04de D9F80030 		ldr	r3, [r9]
 645:Src/pid.c     **** 	g_Sector_test = g_Sector;
 2080              		.loc 1 645 0
 2081 04e2 354A     		ldr	r2, .L170+64
 637:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 2082              		.loc 1 637 0
 2083 04e4 C618     		adds	r6, r0, r3
 642:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 2084              		.loc 1 642 0
 2085 04e6 002D     		cmp	r5, #0
 638:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
 2086              		.loc 1 638 0
 2087 04e8 A3EB0000 		sub	r0, r3, r0
 2088              	.LVL144:
 637:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 2089              		.loc 1 637 0
 2090 04ec 4FEA6606 		asr	r6, r6, #1
 2091              	.LVL145:
 642:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 2092              		.loc 1 642 0
 2093 04f0 D4BF     		ite	le
 2094 04f2 0023     		movle	r3, #0
 2095 04f4 0123     		movgt	r3, #1
 2096              	.LVL146:
 643:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 2097              		.loc 1 643 0
 2098 04f6 4010     		asrs	r0, r0, #1
 2099              	.LVL147:
 2100 04f8 48BF     		it	mi
 2101 04fa 0233     		addmi	r3, r3, #2
 2102              	.LVL148:
 644:Src/pid.c     **** 	g_Sector = temp32;
 2103              		.loc 1 644 0
 2104 04fc 002E     		cmp	r6, #0
 2105 04fe B8BF     		it	lt
 2106 0500 0433     		addlt	r3, r3, #4
 2107              	.LVL149:
 645:Src/pid.c     **** 	g_Sector_test = g_Sector;
 2108              		.loc 1 645 0
 2109 0502 1360     		str	r3, [r2]
 646:Src/pid.c     **** 	g_X = X;
 2110              		.loc 1 646 0
 2111 0504 2D4A     		ldr	r2, .L170+68
 2112 0506 1380     		strh	r3, [r2]	@ movhi
 647:Src/pid.c     **** 	g_Y = Y;
 2113              		.loc 1 647 0
 2114 0508 2D4A     		ldr	r2, .L170+72
 2115 050a 1560     		str	r5, [r2]
 648:Src/pid.c     **** 	g_Z = Z;
 2116              		.loc 1 648 0
 2117 050c 2D4A     		ldr	r2, .L170+76
 2118 050e 1660     		str	r6, [r2]
 649:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 2119              		.loc 1 649 0
 2120 0510 2D4A     		ldr	r2, .L170+80
 2121              	.LBB20:
 2122              	.LBB21:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 68


 309:Src/pid.c     ****   {
 2123              		.loc 1 309 0
 2124 0512 013B     		subs	r3, r3, #1
 2125              	.LVL150:
 2126              	.LBE21:
 2127              	.LBE20:
 649:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 2128              		.loc 1 649 0
 2129 0514 1060     		str	r0, [r2]
 2130              	.LVL151:
 2131              	.LBB24:
 2132              	.LBB22:
 309:Src/pid.c     ****   {
 2133              		.loc 1 309 0
 2134 0516 052B     		cmp	r3, #5
 2135 0518 00F21A81 		bhi	.L139
 2136 051c DFE813F0 		tbh	[pc, r3, lsl #1]
 2137              	.L122:
 2138 0520 B100     		.2byte	(.L121-.L122)/2
 2139 0522 F500     		.2byte	(.L123-.L122)/2
 2140 0524 FC00     		.2byte	(.L124-.L122)/2
 2141 0526 0301     		.2byte	(.L125-.L122)/2
 2142 0528 0A01     		.2byte	(.L126-.L122)/2
 2143 052a 1101     		.2byte	(.L127-.L122)/2
 2144              	.LVL152:
 2145              		.p2align 1
 2146              	.L101:
 2147              	.LBE22:
 2148              	.LBE24:
 498:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 2149              		.loc 1 498 0
 2150 052c 4FF46042 		mov	r2, #57344
 2151 0530 A4F84220 		strh	r2, [r4, #66]	@ movhi
 499:Src/pid.c     **** 				{
 2152              		.loc 1 499 0
 2153 0534 B4F85020 		ldrh	r2, [r4, #80]
 2154 0538 42F23231 		movw	r1, #9010
 2155 053c 12B2     		sxth	r2, r2
 2156 053e 8A42     		cmp	r2, r1
 501:Src/pid.c     **** 				}
 2157              		.loc 1 501 0
 2158 0540 DFBF     		itttt	le
 2159 0542 B4F8C220 		ldrhle	r2, [r4, #194]
 2160 0546 2832     		addle	r2, r2, #40
 2161 0548 12B2     		sxthle	r2, r2
 2162 054a A4F8C220 		strhle	r2, [r4, #194]	@ movhi
 2163              	.L102:
 511:Src/pid.c     **** 				{
 2164              		.loc 1 511 0
 2165 054e B4F85020 		ldrh	r2, [r4, #80]
 2166 0552 40F23231 		movw	r1, #818
 2167 0556 12B2     		sxth	r2, r2
 2168 0558 8A42     		cmp	r2, r1
 2169 055a 3FF7B2AE 		bgt	.L97
 513:Src/pid.c     **** 				}				
 2170              		.loc 1 513 0
 2171 055e 1A88     		ldrh	r2, [r3]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 69


 2172 0560 0132     		adds	r2, r2, #1
 2173 0562 12B2     		sxth	r2, r2
 2174 0564 1A80     		strh	r2, [r3]	@ movhi
 2175 0566 ACE6     		b	.L97
 2176              	.L157:
 519:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 2177              		.loc 1 519 0
 2178 0568 0023     		movs	r3, #0
 2179 056a A4F85432 		strh	r3, [r4, #596]	@ movhi
 520:Src/pid.c     **** 				flag_processing_Jtest = 0;
 2180              		.loc 1 520 0
 2181 056e A4F84230 		strh	r3, [r4, #66]	@ movhi
 521:Src/pid.c     **** 				break;
 2182              		.loc 1 521 0
 2183 0572 1370     		strb	r3, [r2]
 2184 0574 A5E6     		b	.L97
 2185              	.L171:
 2186 0576 00BF     		.align	2
 2187              	.L170:
 2188 0578 00000000 		.word	flag_processing_Jtest
 2189 057c 00000000 		.word	state_Jtest
 2190 0580 00000000 		.word	g_pCur_ref_base_mA
 2191 0584 00007A44 		.word	1148846080
 2192 0588 00000000 		.word	0
 2193 058c CDCCCC3D 		.word	1036831949
 2194 0590 00000000 		.word	.LANCHOR26
 2195 0594 00000000 		.word	.LANCHOR27
 2196 0598 00008038 		.word	947912704
 2197 059c 00000000 		.word	.LANCHOR28
 2198 05a0 00000000 		.word	.LANCHOR29
 2199 05a4 6666663F 		.word	1063675494
 2200 05a8 A4707D3F 		.word	1065185444
 2201 05ac 00000000 		.word	g_high_fre_pulse
 2202 05b0 00000000 		.word	motor_
 2203 05b4 68BB0100 		.word	113512
 2204 05b8 00000000 		.word	.LANCHOR30
 2205 05bc 00000000 		.word	g_Sector_test
 2206 05c0 00000000 		.word	g_X
 2207 05c4 00000000 		.word	g_Y
 2208 05c8 00000000 		.word	g_Z
 2209              	.L98:
 526:Src/pid.c     **** 	{
 2210              		.loc 1 526 0
 2211 05cc B4F85432 		ldrh	r3, [r4, #596]
 2212 05d0 1BB2     		sxth	r3, r3
 2213 05d2 042B     		cmp	r3, #4
 2214 05d4 2AD1     		bne	.L108
 528:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 2215              		.loc 1 528 0
 2216 05d6 0123     		movs	r3, #1
 532:Src/pid.c     **** 		if(test < (10*10))
 2217              		.loc 1 532 0
 2218 05d8 AD4A     		ldr	r2, .L172+8
 528:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 2219              		.loc 1 528 0
 2220 05da A4F80232 		strh	r3, [r4, #514]	@ movhi
 529:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 70


 2221              		.loc 1 529 0
 2222 05de 0223     		movs	r3, #2
 2223 05e0 A4F80432 		strh	r3, [r4, #516]	@ movhi
 532:Src/pid.c     **** 		if(test < (10*10))
 2224              		.loc 1 532 0
 2225 05e4 1388     		ldrh	r3, [r2]
 2226 05e6 0133     		adds	r3, r3, #1
 2227 05e8 9BB2     		uxth	r3, r3
 533:Src/pid.c     **** 		{
 2228              		.loc 1 533 0
 2229 05ea 632B     		cmp	r3, #99
 532:Src/pid.c     **** 		if(test < (10*10))
 2230              		.loc 1 532 0
 2231 05ec 1380     		strh	r3, [r2]	@ movhi
 533:Src/pid.c     **** 		{
 2232              		.loc 1 533 0
 2233 05ee 01D8     		bhi	.L109
 2234              	.L167:
 543:Src/pid.c     **** 		}
 2235              		.loc 1 543 0
 2236 05f0 0023     		movs	r3, #0
 2237 05f2 04E0     		b	.L163
 2238              	.L109:
 537:Src/pid.c     **** 		{
 2239              		.loc 1 537 0
 2240 05f4 B3F5167F 		cmp	r3, #600
 2241 05f8 04D2     		bcs	.L110
 539:Src/pid.c     **** 		}
 2242              		.loc 1 539 0
 2243 05fa 4FF48053 		mov	r3, #4096
 2244              	.L163:
 557:Src/pid.c     **** 		}
 2245              		.loc 1 557 0
 2246 05fe A4F84630 		strh	r3, [r4, #70]	@ movhi
 2247 0602 5EE6     		b	.L97
 2248              	.L110:
 541:Src/pid.c     **** 		{
 2249              		.loc 1 541 0
 2250 0604 40F24B41 		movw	r1, #1099
 2251 0608 8B42     		cmp	r3, r1
 2252 060a F1D9     		bls	.L167
 545:Src/pid.c     **** 		{
 2253              		.loc 1 545 0
 2254 060c B3F5C86F 		cmp	r3, #1600
 2255 0610 02D2     		bcs	.L112
 547:Src/pid.c     **** 		}
 2256              		.loc 1 547 0
 2257 0612 4FF47043 		mov	r3, #61440
 2258 0616 F2E7     		b	.L163
 2259              	.L112:
 549:Src/pid.c     **** 		{
 2260              		.loc 1 549 0
 2261 0618 40F2A361 		movw	r1, #1699
 2262 061c 8B42     		cmp	r3, r1
 2263 061e 4FF00003 		mov	r3, #0
 555:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 2264              		.loc 1 555 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 71


 2265 0622 84BF     		itt	hi
 2266 0624 1380     		strhhi	r3, [r2]	@ movhi
 556:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 2267              		.loc 1 556 0
 2268 0626 A4F85432 		strhhi	r3, [r4, #596]	@ movhi
 2269 062a E8E7     		b	.L163
 2270              	.L108:
 563:Src/pid.c     **** 		{
 2271              		.loc 1 563 0
 2272 062c B4F84220 		ldrh	r2, [r4, #66]
 2273 0630 B4F88032 		ldrh	r3, [r4, #640]
 2274 0634 12B2     		sxth	r2, r2
 2275 0636 1BB2     		sxth	r3, r3
 2276 0638 9A42     		cmp	r2, r3
 565:Src/pid.c     **** 		}
 2277              		.loc 1 565 0
 2278 063a C4BF     		itt	gt
 2279 063c B4F88032 		ldrhgt	r3, [r4, #640]
 2280 0640 A4F84230 		strhgt	r3, [r4, #66]	@ movhi
 567:Src/pid.c     **** 		{
 2281              		.loc 1 567 0
 2282 0644 B4F84220 		ldrh	r2, [r4, #66]
 2283 0648 B4F88232 		ldrh	r3, [r4, #642]
 2284 064c 12B2     		sxth	r2, r2
 2285 064e 1BB2     		sxth	r3, r3
 2286 0650 9A42     		cmp	r2, r3
 2287 0652 BFF636AE 		bge	.L97
 569:Src/pid.c     **** 		}
 2288              		.loc 1 569 0
 2289 0656 B4F88232 		ldrh	r3, [r4, #642]
 2290 065a B9E5     		b	.L162
 2291              	.LVL153:
 2292              	.L158:
 605:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q += Ierr_q * (motor_.current_control_.i
 2293              		.loc 1 605 0
 2294 065c 9FED8D7A 		vldr.32	s14, .L172+12
 2295 0660 DBED0B7A 		vldr.32	s15, [fp, #44]
 2296 0664 67EE877A 		vmul.f32	s15, s15, s14
 2297 0668 9BED0C7A 		vldr.32	s14, [fp, #48]
 2298 066c AAEE277A 		vfma.f32	s14, s20, s15
 2299 0670 8BED0C7A 		vstr.32	s14, [fp, #48]
 606:Src/pid.c     **** 	}
 2300              		.loc 1 606 0
 2301 0674 9BED0D7A 		vldr.32	s14, [fp, #52]
 2302 0678 AAEEA77A 		vfma.f32	s14, s21, s15
 2303 067c F0EE477A 		vmov.f32	s15, s14
 2304 0680 D5E6     		b	.L165
 2305              	.LVL154:
 2306              	.L121:
 2307              	.LBB25:
 2308              	.LBB23:
 314:Src/pid.c     **** 			CCR3 = t0>>1;
 2309              		.loc 1 314 0
 2310 0682 C6F55263 		rsb	r3, r6, #3360
 2311 0686 1B1A     		subs	r3, r3, r0
 315:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 2312              		.loc 1 315 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 72


 2313 0688 5B10     		asrs	r3, r3, #1
 2314              	.LVL155:
 316:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
 2315              		.loc 1 316 0
 2316 068a F218     		adds	r2, r6, r3
 2317              	.LVL156:
 317:Src/pid.c     **** 		break;		
 2318              		.loc 1 317 0
 2319 068c 8118     		adds	r1, r0, r2
 2320              	.LVL157:
 2321              	.L120:
 368:Src/pid.c     **** 	{
 2322              		.loc 1 368 0
 2323 068e B4F81A02 		ldrh	r0, [r4, #538]
 2324              	.LVL158:
 2325 0692 00B2     		sxth	r0, r0
 2326 0694 18B9     		cbnz	r0, .L128
 370:Src/pid.c     **** 			sin_wave_t_us = 0;
 2327              		.loc 1 370 0
 2328 0696 804D     		ldr	r5, .L172+16
 2329              	.LVL159:
 2330 0698 2860     		str	r0, [r5]
 371:Src/pid.c     **** 	}
 2331              		.loc 1 371 0
 2332 069a 804D     		ldr	r5, .L172+20
 2333 069c 2860     		str	r0, [r5]
 2334              	.L128:
 375:Src/pid.c     **** 	{
 2335              		.loc 1 375 0
 2336 069e B4F81A02 		ldrh	r0, [r4, #538]
 2337 06a2 00B2     		sxth	r0, r0
 2338 06a4 0428     		cmp	r0, #4
 2339 06a6 04D0     		beq	.L129
 2340 06a8 B4F81A02 		ldrh	r0, [r4, #538]
 2341 06ac 00B2     		sxth	r0, r0
 2342 06ae 0528     		cmp	r0, #5
 2343 06b0 0DD1     		bne	.L130
 2344              	.L129:
 377:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 2345              		.loc 1 377 0
 2346 06b2 7A48     		ldr	r0, .L172+20
 2347 06b4 0568     		ldr	r5, [r0]
 2348 06b6 0435     		adds	r5, r5, #4
 2349 06b8 0560     		str	r5, [r0]
 378:Src/pid.c     **** 		{
 2350              		.loc 1 378 0
 2351 06ba 0568     		ldr	r5, [r0]
 2352 06bc B5F57A7F 		cmp	r5, #1000
 2353 06c0 05DD     		ble	.L130
 380:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 2354              		.loc 1 380 0
 2355 06c2 0025     		movs	r5, #0
 2356 06c4 0560     		str	r5, [r0]
 381:Src/pid.c     **** 		}
 2357              		.loc 1 381 0
 2358 06c6 744D     		ldr	r5, .L172+16
 2359 06c8 2868     		ldr	r0, [r5]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 73


 2360 06ca 0130     		adds	r0, r0, #1
 2361 06cc 2860     		str	r0, [r5]
 2362              	.L130:
 384:Src/pid.c     **** 	{
 2363              		.loc 1 384 0
 2364 06ce B4F81A02 		ldrh	r0, [r4, #538]
 2365 06d2 00B2     		sxth	r0, r0
 2366 06d4 0428     		cmp	r0, #4
 2367 06d6 40D0     		beq	.L132
 2368 06d8 40F67530 		movw	r0, #2933
 365:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 2369              		.loc 1 365 0
 2370 06dc 22EAE272 		bic	r2, r2, r2, asr #31
 2371              	.LVL160:
 2372 06e0 8242     		cmp	r2, r0
 366:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 2373              		.loc 1 366 0
 2374 06e2 21EAE171 		bic	r1, r1, r1, asr #31
 2375              	.LVL161:
 367:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 2376              		.loc 1 367 0
 2377 06e6 23EAE373 		bic	r3, r3, r3, asr #31
 2378              	.LVL162:
 2379 06ea A8BF     		it	ge
 2380 06ec 0246     		movge	r2, r0
 2381 06ee 8142     		cmp	r1, r0
 2382 06f0 A8BF     		it	ge
 2383 06f2 0146     		movge	r1, r0
 2384 06f4 8342     		cmp	r3, r0
 2385 06f6 A8BF     		it	ge
 2386 06f8 0346     		movge	r3, r0
 2387              	.LVL163:
 2388              	.L133:
 410:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 2389              		.loc 1 410 0
 2390 06fa 6948     		ldr	r0, .L172+24
 2391 06fc C363     		str	r3, [r0, #60]
 414:Src/pid.c     **** }
 2392              		.loc 1 414 0
 2393 06fe 45F25553 		movw	r3, #21845
 2394              	.LVL164:
 411:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 2395              		.loc 1 411 0
 2396 0702 8163     		str	r1, [r0, #56]
 2397              	.LVL165:
 412:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 2398              		.loc 1 412 0
 2399 0704 4263     		str	r2, [r0, #52]
 414:Src/pid.c     **** }
 2400              		.loc 1 414 0
 2401 0706 0362     		str	r3, [r0, #32]
 2402 0708 0EE5     		b	.L88
 2403              	.LVL166:
 2404              	.L123:
 322:Src/pid.c     **** 			CCR2 = t0>>1;
 2405              		.loc 1 322 0
 2406 070a 05F55261 		add	r1, r5, #3360
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 74


 2407 070e 891B     		subs	r1, r1, r6
 323:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 2408              		.loc 1 323 0
 2409 0710 4910     		asrs	r1, r1, #1
 2410              	.LVL167:
 2411 0712 4B1B     		subs	r3, r1, r5
 2412              	.LVL168:
 325:Src/pid.c     **** 		break;		
 2413              		.loc 1 325 0
 2414 0714 F218     		adds	r2, r6, r3
 2415              	.LVL169:
 2416 0716 BAE7     		b	.L120
 2417              	.LVL170:
 2418              	.L124:
 330:Src/pid.c     **** 			CCR3 = t0>>1;
 2419              		.loc 1 330 0
 2420 0718 00F55263 		add	r3, r0, #3360
 2421 071c 5B1B     		subs	r3, r3, r5
 331:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 2422              		.loc 1 331 0
 2423 071e 5B10     		asrs	r3, r3, #1
 2424              	.LVL171:
 332:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 2425              		.loc 1 332 0
 2426 0720 E918     		adds	r1, r5, r3
 2427              	.LVL172:
 2428 0722 0A1A     		subs	r2, r1, r0
 2429              	.LVL173:
 2430 0724 B3E7     		b	.L120
 2431              	.LVL174:
 2432              	.L125:
 338:Src/pid.c     **** 			CCR1 = t0>>1;
 2433              		.loc 1 338 0
 2434 0726 C0F55262 		rsb	r2, r0, #3360
 2435 072a 2A44     		add	r2, r2, r5
 339:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 2436              		.loc 1 339 0
 2437 072c 5210     		asrs	r2, r2, #1
 2438              	.LVL175:
 340:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 2439              		.loc 1 340 0
 2440 072e 8118     		adds	r1, r0, r2
 2441              	.LVL176:
 2442 0730 4B1B     		subs	r3, r1, r5
 2443              	.LVL177:
 2444 0732 ACE7     		b	.L120
 2445              	.LVL178:
 2446              	.L126:
 346:Src/pid.c     **** 			CCR1 = t0>>1;
 2447              		.loc 1 346 0
 2448 0734 C5F55262 		rsb	r2, r5, #3360
 2449 0738 3244     		add	r2, r2, r6
 347:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 2450              		.loc 1 347 0
 2451 073a 5210     		asrs	r2, r2, #1
 2452              	.LVL179:
 2453 073c 931B     		subs	r3, r2, r6
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 75


 2454              	.LVL180:
 349:Src/pid.c     **** 		break;
 2455              		.loc 1 349 0
 2456 073e E918     		adds	r1, r5, r3
 2457              	.LVL181:
 2458 0740 A5E7     		b	.L120
 2459              	.LVL182:
 2460              	.L127:
 354:Src/pid.c     **** 			CCR2 = t0>>1;
 2461              		.loc 1 354 0
 2462 0742 06F55261 		add	r1, r6, #3360
 2463 0746 0144     		add	r1, r1, r0
 355:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 2464              		.loc 1 355 0
 2465 0748 4910     		asrs	r1, r1, #1
 2466              	.LVL183:
 2467 074a 0A1A     		subs	r2, r1, r0
 2468              	.LVL184:
 2469 074c 931B     		subs	r3, r2, r6
 2470              	.LVL185:
 2471 074e 9EE7     		b	.L120
 2472              	.LVL186:
 2473              	.L139:
 362:Src/pid.c     **** 		break;
 2474              		.loc 1 362 0
 2475 0750 4FF4D263 		mov	r3, #1680
 361:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 2476              		.loc 1 361 0
 2477 0754 1946     		mov	r1, r3
 360:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 2478              		.loc 1 360 0
 2479 0756 1A46     		mov	r2, r3
 2480 0758 99E7     		b	.L120
 2481              	.LVL187:
 2482              	.L132:
 389:Src/pid.c     **** 		if(Para_Identificaion>=0)
 2483              		.loc 1 389 0
 2484 075a 524B     		ldr	r3, .L172+28
 2485 075c 1A68     		ldr	r2, [r3]
 2486 075e 0132     		adds	r2, r2, #1
 2487 0760 1A60     		str	r2, [r3]
 390:Src/pid.c     **** 		{
 2488              		.loc 1 390 0
 2489 0762 1A68     		ldr	r2, [r3]
 2490 0764 002A     		cmp	r2, #0
 2491 0766 20DB     		blt	.L134
 392:Src/pid.c     **** 			if(index_I_phase<100)
 2492              		.loc 1 392 0
 2493 0768 0022     		movs	r2, #0
 2494 076a 1A60     		str	r2, [r3]
 393:Src/pid.c     **** 			{
 2495              		.loc 1 393 0
 2496 076c 4E4B     		ldr	r3, .L172+32
 2497 076e 1A68     		ldr	r2, [r3]
 2498 0770 632A     		cmp	r2, #99
 2499 0772 17DC     		bgt	.L135
 395:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 76


 2500              		.loc 1 395 0
 2501 0774 4D4A     		ldr	r2, .L172+36
 2502 0776 1968     		ldr	r1, [r3]
 2503 0778 B2F90020 		ldrsh	r2, [r2]
 2504 077c 4C48     		ldr	r0, .L172+40
 2505 077e 5242     		negs	r2, r2
 2506 0780 40F82120 		str	r2, [r0, r1, lsl #2]
 396:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 2507              		.loc 1 396 0
 2508 0784 4B49     		ldr	r1, .L172+44
 2509 0786 1A68     		ldr	r2, [r3]
 2510 0788 B1F90010 		ldrsh	r1, [r1]
 2511 078c 6432     		adds	r2, r2, #100
 2512 078e 4942     		negs	r1, r1
 2513 0790 40F82210 		str	r1, [r0, r2, lsl #2]
 397:Src/pid.c     **** 			}
 2514              		.loc 1 397 0
 2515 0794 4849     		ldr	r1, .L172+48
 2516 0796 1A68     		ldr	r2, [r3]
 2517 0798 B1F90010 		ldrsh	r1, [r1]
 2518 079c C832     		adds	r2, r2, #200
 2519 079e 4942     		negs	r1, r1
 2520 07a0 40F82210 		str	r1, [r0, r2, lsl #2]
 2521              	.L135:
 399:Src/pid.c     **** 		}
 2522              		.loc 1 399 0
 2523 07a4 1A68     		ldr	r2, [r3]
 2524 07a6 0132     		adds	r2, r2, #1
 2525 07a8 1A60     		str	r2, [r3]
 2526              	.L134:
 401:Src/pid.c     **** 		{	
 2527              		.loc 1 401 0
 2528 07aa 3B4B     		ldr	r3, .L172+16
 2529 07ac 1B68     		ldr	r3, [r3]
 2530 07ae C82B     		cmp	r3, #200
 2531 07b0 54DD     		ble	.L140
 403:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 2532              		.loc 1 403 0
 2533 07b2 3F4D     		ldr	r5, .L172+40
 2534 07b4 D5F88C01 		ldr	r0, [r5, #396]
 2535 07b8 D5F80890 		ldr	r9, [r5, #8]
 2536 07bc D5F88C81 		ldr	r8, [r5, #396]
 2537 07c0 FFF7FEFF 		bl	__aeabi_i2d
 2538              	.LVL188:
 2539 07c4 0646     		mov	r6, r0
 2540              	.LVL189:
 2541 07c6 A9EB0800 		sub	r0, r9, r8
 2542 07ca 01F10047 		add	r7, r1, #-2147483648
 2543 07ce FFF7FEFF 		bl	__aeabi_i2d
 2544              	.LVL190:
 2545 07d2 0246     		mov	r2, r0
 2546 07d4 0B46     		mov	r3, r1
 2547 07d6 3046     		mov	r0, r6
 2548 07d8 3946     		mov	r1, r7
 2549 07da FFF7FEFF 		bl	__aeabi_ddiv
 2550              	.LVL191:
 2551 07de 41EC100B 		vmov	d0, r0, r1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 77


 2552 07e2 FFF7FEFF 		bl	log
 2553              	.LVL192:
 2554 07e6 28A1     		adr	r1, .L172
 2555 07e8 D1E90001 		ldrd	r0, [r1]
 2556 07ec 53EC102B 		vmov	r2, r3, d0
 2557 07f0 FFF7FEFF 		bl	__aeabi_ddiv
 2558              	.LVL193:
 2559 07f4 314B     		ldr	r3, .L172+52
 2560 07f6 0646     		mov	r6, r0
 2561 07f8 0F46     		mov	r7, r1
 2562 07fa C3E90067 		strd	r6, [r3]
 404:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 2563              		.loc 1 404 0
 2564 07fe 0246     		mov	r2, r0
 2565 0800 0B46     		mov	r3, r1
 2566 0802 0020     		movs	r0, #0
 2567 0804 2E49     		ldr	r1, .L172+56
 2568 0806 FFF7FEFF 		bl	__aeabi_ddiv
 2569              	.LVL194:
 2570 080a 2E4B     		ldr	r3, .L172+60
 2571 080c C3E90001 		strd	r0, [r3]
 405:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 2572              		.loc 1 405 0
 2573 0810 0023     		movs	r3, #0
 2574 0812 A4F81A32 		strh	r3, [r4, #538]	@ movhi
 406:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
 2575              		.loc 1 406 0
 2576 0816 D5F88C21 		ldr	r2, [r5, #396]
 2577 081a 2B4B     		ldr	r3, .L172+64
 2578 081c 02EB4202 		add	r2, r2, r2, lsl #1
 2579 0820 93FBF2F3 		sdiv	r3, r3, r2
 2580 0824 1BB2     		sxth	r3, r3
 2581 0826 A4F84032 		strh	r3, [r4, #576]	@ movhi
 407:Src/pid.c     **** 		}
 2582              		.loc 1 407 0
 2583 082a 0022     		movs	r2, #0
 2584 082c 274B     		ldr	r3, .L172+68
 2585 082e B4F84052 		ldrh	r5, [r4, #576]
 2586 0832 3046     		mov	r0, r6
 2587 0834 3946     		mov	r1, r7
 2588 0836 FFF7FEFF 		bl	__aeabi_dmul
 2589              	.LVL195:
 2590 083a 2DB2     		sxth	r5, r5
 2591 083c 0646     		mov	r6, r0
 2592 083e 2846     		mov	r0, r5
 2593 0840 0F46     		mov	r7, r1
 2594 0842 FFF7FEFF 		bl	__aeabi_i2d
 2595              	.LVL196:
 2596 0846 0246     		mov	r2, r0
 2597 0848 0B46     		mov	r3, r1
 2598 084a 3046     		mov	r0, r6
 2599 084c 3946     		mov	r1, r7
 2600 084e FFF7FEFF 		bl	__aeabi_dmul
 2601              	.LVL197:
 2602 0852 FFF7FEFF 		bl	__aeabi_d2uiz
 2603              	.LVL198:
 2604 0856 00B2     		sxth	r0, r0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 78


 2605 0858 A4F84202 		strh	r0, [r4, #578]	@ movhi
 2606              	.L140:
 388:Src/pid.c     **** 		Para_Identificaion++;
 2607              		.loc 1 388 0
 2608 085c 40F61F53 		movw	r3, #3359
 387:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 2609              		.loc 1 387 0
 2610 0860 1946     		mov	r1, r3
 386:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 2611              		.loc 1 386 0
 2612 0862 0122     		movs	r2, #1
 2613 0864 49E7     		b	.L133
 2614              	.LVL199:
 2615              	.L136:
 2616              	.LBE23:
 2617              	.LBE25:
 2618              	.LBE19:
 2619              	.LBE18:
 2620              	.LBE26:
1352:Src/pid.c     **** 		EXTI->SWIER1 |= 0x08;
 2621              		.loc 1 1352 0
 2622 0866 0023     		movs	r3, #0
 2623 0868 1360     		str	r3, [r2]
1353:Src/pid.c     **** 		EXTI_Handle.Line = 3;
 2624              		.loc 1 1353 0
 2625 086a 194A     		ldr	r2, .L172+72
 2626 086c 1369     		ldr	r3, [r2, #16]
1354:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
 2627              		.loc 1 1354 0
 2628 086e 04A8     		add	r0, sp, #16
1353:Src/pid.c     **** 		EXTI_Handle.Line = 3;
 2629              		.loc 1 1353 0
 2630 0870 43F00803 		orr	r3, r3, #8
 2631 0874 1361     		str	r3, [r2, #16]
1354:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
 2632              		.loc 1 1354 0
 2633 0876 0323     		movs	r3, #3
 2634 0878 40F8083D 		str	r3, [r0, #-8]!
1355:Src/pid.c     **** 	} 
 2635              		.loc 1 1355 0
 2636 087c FFF7FEFF 		bl	HAL_EXTI_GenerateSWI
 2637              	.LVL200:
 2638 0880 66E4     		b	.L137
 2639              	.L173:
 2640 0882 00BFAFF3 		.align	3
 2640      0080
 2641              	.L172:
 2642 0888 F168E388 		.word	-1998362383
 2643 088c B5F8043F 		.word	1057290421
 2644 0890 00000000 		.word	.LANCHOR25
 2645 0894 ACC52738 		.word	942130604
 2646 0898 00000000 		.word	.LANCHOR31
 2647 089c 00000000 		.word	.LANCHOR32
 2648 08a0 002C0140 		.word	1073818624
 2649 08a4 00000000 		.word	.LANCHOR33
 2650 08a8 00000000 		.word	.LANCHOR34
 2651 08ac 00000000 		.word	.LANCHOR12
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 79


 2652 08b0 00000000 		.word	.LANCHOR35
 2653 08b4 00000000 		.word	.LANCHOR10
 2654 08b8 00000000 		.word	.LANCHOR8
 2655 08bc 00000000 		.word	.LANCHOR36
 2656 08c0 0000F0BF 		.word	-1074790400
 2657 08c4 00000000 		.word	.LANCHOR37
 2658 08c8 00366E01 		.word	24000000
 2659 08cc 00408F40 		.word	1083129856
 2660 08d0 00040140 		.word	1073808384
 2661              		.cfi_endproc
 2662              	.LFE348:
 2664              		.section	.text.Loop3_EnableManage,"ax",%progbits
 2665              		.align	1
 2666              		.global	Loop3_EnableManage
 2667              		.syntax unified
 2668              		.thumb
 2669              		.thumb_func
 2670              		.fpu fpv4-sp-d16
 2672              	Loop3_EnableManage:
 2673              	.LFB349:
1364:Src/pid.c     **** void Loop3_EnableManage(void)   //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æµï¿½Ê¹ï¿½Ü¹ï¿½ï¿½ï¿½
1365:Src/pid.c     **** {
 2674              		.loc 1 1365 0
 2675              		.cfi_startproc
 2676              		@ args = 0, pretend = 0, frame = 0
 2677              		@ frame_needed = 0, uses_anonymous_args = 0
 2678              		@ link register save eliminated.
1366:Src/pid.c     **** 	//Ç¿ï¿½Ã¹Ø±ï¿½ï¿½Ù¶ï¿½
1367:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2679              		.loc 1 1367 0
 2680 0000 2E4B     		ldr	r3, .L200
 2681 0002 2F48     		ldr	r0, .L200+4
 2682 0004 B3F80222 		ldrh	r2, [r3, #514]
 2683 0008 2E49     		ldr	r1, .L200+8
 2684 000a 12B2     		sxth	r2, r2
 2685 000c 012A     		cmp	r2, #1
 2686 000e 4BD1     		bne	.L175
1368:Src/pid.c     **** 			&& 	(	g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT	  //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 2687              		.loc 1 1368 0
 2688 0010 B3F80422 		ldrh	r2, [r3, #516]
 2689 0014 12B2     		sxth	r2, r2
 2690 0016 012A     		cmp	r2, #1
 2691 0018 12D0     		beq	.L176
1369:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_FORCE 	//ï¿½ï¿½ï¿½Ø»ï¿½				
 2692              		.loc 1 1369 0
 2693 001a B3F80422 		ldrh	r2, [r3, #516]
 2694 001e 12B2     		sxth	r2, r2
 2695 0020 042A     		cmp	r2, #4
 2696 0022 0DD0     		beq	.L176
1370:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
 2697              		.loc 1 1370 0
 2698 0024 B3F80422 		ldrh	r2, [r3, #516]
 2699 0028 12B2     		sxth	r2, r2
 2700 002a 022A     		cmp	r2, #2
 2701 002c 08D0     		beq	.L176
1371:Src/pid.c     **** 						|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿
 2702              		.loc 1 1371 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 80


 2703 002e B3F80422 		ldrh	r2, [r3, #516]
 2704 0032 12B2     		sxth	r2, r2
 2705 0034 032A     		cmp	r2, #3
 2706 0036 37D1     		bne	.L175
 2707              		.loc 1 1371 0 is_stmt 0 discriminator 1
 2708 0038 234A     		ldr	r2, .L200+12
 2709 003a 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 2710 003c 002A     		cmp	r2, #0
 2711 003e 33D1     		bne	.L175
 2712              	.L176:
1372:Src/pid.c     **** 					)
1373:Src/pid.c     **** 		)
1374:Src/pid.c     **** 	{	
1375:Src/pid.c     **** 		pid_IQ.enable = 1;
 2713              		.loc 1 1375 0 is_stmt 1
 2714 0040 0122     		movs	r2, #1
 2715              	.L197:
1376:Src/pid.c     **** 		pid_ID.enable = 1;
1377:Src/pid.c     **** 	}
1378:Src/pid.c     **** 	else
1379:Src/pid.c     **** 	{
1380:Src/pid.c     **** 		pid_IQ.enable = 0;
 2716              		.loc 1 1380 0
 2717 0042 0260     		str	r2, [r0]
1381:Src/pid.c     **** 		pid_ID.enable = 0;
 2718              		.loc 1 1381 0
 2719 0044 0A60     		str	r2, [r1]
1382:Src/pid.c     **** 	}
1383:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 2720              		.loc 1 1383 0
 2721 0046 B3F80222 		ldrh	r2, [r3, #514]
 2722 004a 2048     		ldr	r0, .L200+16
 2723 004c 12B2     		sxth	r2, r2
 2724 004e 012A     		cmp	r2, #1
 2725 0050 2CD1     		bne	.L178
 2726              		.loc 1 1383 0 is_stmt 0 discriminator 1
 2727 0052 B3F80412 		ldrh	r1, [r3, #516]
 2728 0056 09B2     		sxth	r1, r1
 2729 0058 0429     		cmp	r1, #4
 2730 005a 27D1     		bne	.L178
 2731              	.L198:
1384:Src/pid.c     **** 	{	
1385:Src/pid.c     **** 		pid_force.enable = 1;
1386:Src/pid.c     **** 	}
1387:Src/pid.c     **** 	else
1388:Src/pid.c     **** 	{
1389:Src/pid.c     **** 		pid_force.enable = 0;
 2732              		.loc 1 1389 0 is_stmt 1
 2733 005c 0260     		str	r2, [r0]
1390:Src/pid.c     **** 	}	
1391:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2734              		.loc 1 1391 0
 2735 005e B3F80222 		ldrh	r2, [r3, #514]
 2736 0062 1B49     		ldr	r1, .L200+20
 2737 0064 12B2     		sxth	r2, r2
 2738 0066 012A     		cmp	r2, #1
 2739 0068 22D1     		bne	.L180
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 81


1392:Src/pid.c     **** 			&& ( g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
 2740              		.loc 1 1392 0
 2741 006a B3F80422 		ldrh	r2, [r3, #516]
 2742 006e 12B2     		sxth	r2, r2
 2743 0070 022A     		cmp	r2, #2
 2744 0072 07D0     		beq	.L181
1393:Src/pid.c     **** 					|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½
 2745              		.loc 1 1393 0
 2746 0074 B3F80422 		ldrh	r2, [r3, #516]
 2747 0078 12B2     		sxth	r2, r2
 2748 007a 032A     		cmp	r2, #3
 2749 007c 18D1     		bne	.L180
 2750              		.loc 1 1393 0 is_stmt 0 discriminator 1
 2751 007e 124A     		ldr	r2, .L200+12
 2752 0080 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 2753 0082 AAB9     		cbnz	r2, .L180
 2754              	.L181:
1394:Src/pid.c     **** 					)
1395:Src/pid.c     **** 		)
1396:Src/pid.c     **** 	{	
1397:Src/pid.c     **** 		pid_spd.enable = 1;
 2755              		.loc 1 1397 0 is_stmt 1
 2756 0084 0122     		movs	r2, #1
 2757              	.L199:
1398:Src/pid.c     **** 	}
1399:Src/pid.c     **** 	else
1400:Src/pid.c     **** 	{
1401:Src/pid.c     **** 		pid_spd.enable = 0;
 2758              		.loc 1 1401 0
 2759 0086 0A60     		str	r2, [r1]
1402:Src/pid.c     **** 	}
1403:Src/pid.c     **** 	if(	g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2760              		.loc 1 1403 0
 2761 0088 B3F80222 		ldrh	r2, [r3, #514]
 2762 008c 1149     		ldr	r1, .L200+24
 2763 008e 12B2     		sxth	r2, r2
 2764 0090 012A     		cmp	r2, #1
 2765 0092 0FD1     		bne	.L183
1404:Src/pid.c     **** 			&& (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0) //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½ï¿½
 2766              		.loc 1 1404 0
 2767 0094 B3F80432 		ldrh	r3, [r3, #516]
 2768 0098 1BB2     		sxth	r3, r3
 2769 009a 032B     		cmp	r3, #3
 2770 009c 0AD1     		bne	.L183
 2771              		.loc 1 1404 0 is_stmt 0 discriminator 1
 2772 009e 0A4B     		ldr	r3, .L200+12
 2773 00a0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2774 00a2 3BB9     		cbnz	r3, .L183
1405:Src/pid.c     **** 		)
1406:Src/pid.c     **** 	{	
1407:Src/pid.c     **** 		pid_pos.enable = 1;
 2775              		.loc 1 1407 0 is_stmt 1
 2776 00a4 0A60     		str	r2, [r1]
 2777 00a6 7047     		bx	lr
 2778              	.L175:
1380:Src/pid.c     **** 		pid_ID.enable = 0;
 2779              		.loc 1 1380 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 82


 2780 00a8 0022     		movs	r2, #0
 2781 00aa CAE7     		b	.L197
 2782              	.L178:
1389:Src/pid.c     **** 	}	
 2783              		.loc 1 1389 0
 2784 00ac 0022     		movs	r2, #0
 2785 00ae D5E7     		b	.L198
 2786              	.L180:
1401:Src/pid.c     **** 	}
 2787              		.loc 1 1401 0
 2788 00b0 0022     		movs	r2, #0
 2789 00b2 E8E7     		b	.L199
 2790              	.L183:
1408:Src/pid.c     **** 	}
1409:Src/pid.c     **** 	else
1410:Src/pid.c     **** 	{
1411:Src/pid.c     **** 		pid_pos.enable = 0;
 2791              		.loc 1 1411 0
 2792 00b4 0023     		movs	r3, #0
 2793 00b6 0B60     		str	r3, [r1]
1412:Src/pid.c     **** 	}
1413:Src/pid.c     **** }
 2794              		.loc 1 1413 0
 2795 00b8 7047     		bx	lr
 2796              	.L201:
 2797 00ba 00BF     		.align	2
 2798              	.L200:
 2799 00bc 00000000 		.word	g_CmdMap
 2800 00c0 00000000 		.word	pid_IQ
 2801 00c4 00000000 		.word	pid_ID
 2802 00c8 00000000 		.word	.LANCHOR2
 2803 00cc 00000000 		.word	pid_force
 2804 00d0 00000000 		.word	pid_spd
 2805 00d4 00000000 		.word	pid_pos
 2806              		.cfi_endproc
 2807              	.LFE349:
 2809              		.section	.text.work_var_updata,"ax",%progbits
 2810              		.align	1
 2811              		.global	work_var_updata
 2812              		.syntax unified
 2813              		.thumb
 2814              		.thumb_func
 2815              		.fpu fpv4-sp-d16
 2817              	work_var_updata:
 2818              	.LFB350:
1414:Src/pid.c     **** // ï¿½ï¿½ï¿½Â¿ï¿½ï¿½Æ²ï¿½ï¿½ï¿½
1415:Src/pid.c     **** void work_var_updata(void)
1416:Src/pid.c     **** {
 2819              		.loc 1 1416 0
 2820              		.cfi_startproc
 2821              		@ args = 0, pretend = 0, frame = 0
 2822              		@ frame_needed = 0, uses_anonymous_args = 0
1417:Src/pid.c     ****   /************************************************************************************************
1418:Src/pid.c     **** 	g_Encode_offset = (int)g_CmdMap[MOT_EANGLE_OFFSET];
 2823              		.loc 1 1418 0
 2824 0000 464B     		ldr	r3, .L205
 2825 0002 4749     		ldr	r1, .L205+4
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 83


 2826 0004 B3F84C22 		ldrh	r2, [r3, #588]
 2827 0008 4648     		ldr	r0, .L205+8
 2828 000a 12B2     		sxth	r2, r2
1416:Src/pid.c     ****   /************************************************************************************************
 2829              		.loc 1 1416 0
 2830 000c F0B5     		push	{r4, r5, r6, r7, lr}
 2831              	.LCFI17:
 2832              		.cfi_def_cfa_offset 20
 2833              		.cfi_offset 4, -20
 2834              		.cfi_offset 5, -16
 2835              		.cfi_offset 6, -12
 2836              		.cfi_offset 7, -8
 2837              		.cfi_offset 14, -4
 2838              		.loc 1 1418 0
 2839 000e 0A60     		str	r2, [r1]
1419:Src/pid.c     **** 	if (g_CmdMap[SEV_PARAME_LOCKED] != 0)	 	// ï¿½Ç·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 2840              		.loc 1 1419 0
 2841 0010 B3F8A062 		ldrh	r6, [r3, #672]
 2842 0014 444D     		ldr	r5, .L205+12
 2843 0016 454C     		ldr	r4, .L205+16
 2844 0018 4549     		ldr	r1, .L205+20
 2845 001a 464A     		ldr	r2, .L205+24
 2846 001c 464F     		ldr	r7, .L205+28
 2847 001e 36B2     		sxth	r6, r6
 2848 0020 9EB3     		cbz	r6, .L203
1420:Src/pid.c     **** 	{
1421:Src/pid.c     **** 		pid_pos.Kp = g_ThreeLoopParaBefLock[(SEV_POSITION_P)&0x0F];
 2849              		.loc 1 1421 0
 2850 0022 464B     		ldr	r3, .L205+32
 2851 0024 B3F91060 		ldrsh	r6, [r3, #16]
 2852 0028 AE60     		str	r6, [r5, #8]
1422:Src/pid.c     **** 		pid_pos.Ki = g_ThreeLoopParaBefLock[(SEV_POSITION_I)&0x0F];
 2853              		.loc 1 1422 0
 2854 002a B3F91260 		ldrsh	r6, [r3, #18]
 2855 002e EE60     		str	r6, [r5, #12]
1423:Src/pid.c     **** 		pid_pos.Kd = 0;
1424:Src/pid.c     **** 		pid_pos.dead_zone = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 2856              		.loc 1 1424 0
 2857 0030 B3F916C0 		ldrsh	ip, [r3, #22]
 2858 0034 C5F814C0 		str	ip, [r5, #20]
1423:Src/pid.c     **** 		pid_pos.Kd = 0;
 2859              		.loc 1 1423 0
 2860 0038 0026     		movs	r6, #0
 2861 003a 2E61     		str	r6, [r5, #16]
1425:Src/pid.c     **** 		
1426:Src/pid.c     **** 		pid_spd.Kp = g_ThreeLoopParaBefLock[(SEV_SPEED_P)&0x0F];
 2862              		.loc 1 1426 0
 2863 003c B3F90850 		ldrsh	r5, [r3, #8]
 2864 0040 A560     		str	r5, [r4, #8]
1427:Src/pid.c     **** 		pid_spd.Ki = g_ThreeLoopParaBefLock[(SEV_SPEED_I)&0x0F];
 2865              		.loc 1 1427 0
 2866 0042 B3F90A50 		ldrsh	r5, [r3, #10]
1428:Src/pid.c     **** 		pid_spd.Kd = 0;
1429:Src/pid.c     **** 		pid_spd.dead_zone = g_ThreeLoopParaBefLock[(SEV_SPEED_DS)&0x0F];
1430:Src/pid.c     **** 
1431:Src/pid.c     **** 		pid_IQ.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
 2867              		.loc 1 1431 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 84


 2868 0046 B3F902E0 		ldrsh	lr, [r3, #2]
 2869 004a C0F808E0 		str	lr, [r0, #8]
1428:Src/pid.c     **** 		pid_spd.Kd = 0;
 2870              		.loc 1 1428 0
 2871 004e C4E90356 		strd	r5, r6, [r4, #12]
1429:Src/pid.c     **** 
 2872              		.loc 1 1429 0
 2873 0052 B3F90E50 		ldrsh	r5, [r3, #14]
 2874 0056 6561     		str	r5, [r4, #20]
1432:Src/pid.c     **** 		pid_IQ.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 2875              		.loc 1 1432 0
 2876 0058 B3F90450 		ldrsh	r5, [r3, #4]
1433:Src/pid.c     **** 		pid_IQ.Kd = 0;
1434:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2877              		.loc 1 1434 0
 2878 005c 0424     		movs	r4, #4
1435:Src/pid.c     **** 
1436:Src/pid.c     **** 		pid_ID.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
1437:Src/pid.c     **** 		pid_ID.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 2879              		.loc 1 1437 0
 2880 005e C1E902E5 		strd	lr, r5, [r1, #8]
1438:Src/pid.c     **** 		pid_ID.Kd = 0;
1439:Src/pid.c     **** 		pid_ID.dead_zone = 4;	
 2881              		.loc 1 1439 0
 2882 0062 C1E90464 		strd	r6, r4, [r1, #16]
1440:Src/pid.c     **** 
1441:Src/pid.c     **** 		pid_force.Kp = g_ThreeLoopParaBefLock[(SEV_FORCE_P)&0x0F];
 2883              		.loc 1 1441 0
 2884 0066 B3F91810 		ldrsh	r1, [r3, #24]
 2885 006a 9160     		str	r1, [r2, #8]
1442:Src/pid.c     **** 		pid_force.Ki = g_ThreeLoopParaBefLock[(SEV_FORCE_I)&0x0F];
 2886              		.loc 1 1442 0
 2887 006c B3F91A10 		ldrsh	r1, [r3, #26]
 2888 0070 D160     		str	r1, [r2, #12]
1443:Src/pid.c     **** 		pid_force.Kd = g_ThreeLoopParaBefLock[(SEV_FORCE_D)&0x0F];
 2889              		.loc 1 1443 0
 2890 0072 B3F91C10 		ldrsh	r1, [r3, #28]
1444:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
 2891              		.loc 1 1444 0
 2892 0076 B3F91E30 		ldrsh	r3, [r3, #30]
1434:Src/pid.c     **** 
 2893              		.loc 1 1434 0
 2894 007a 4461     		str	r4, [r0, #20]
1433:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2895              		.loc 1 1433 0
 2896 007c C0E90356 		strd	r5, r6, [r0, #12]
1443:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
 2897              		.loc 1 1443 0
 2898 0080 1161     		str	r1, [r2, #16]
 2899              		.loc 1 1444 0
 2900 0082 5361     		str	r3, [r2, #20]
1445:Src/pid.c     **** 		gPos_ds = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 2901              		.loc 1 1445 0
 2902 0084 C7F800C0 		str	ip, [r7]
 2903              	.L202:
1446:Src/pid.c     **** 	}
1447:Src/pid.c     **** 	else
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 85


1448:Src/pid.c     **** 	{
1449:Src/pid.c     **** 		pid_pos.Kp = g_CmdMap[SEV_POSITION_P];
1450:Src/pid.c     **** 		pid_pos.Ki = g_CmdMap[SEV_POSITION_I];
1451:Src/pid.c     **** 		pid_pos.Kd = 0;
1452:Src/pid.c     **** 		pid_pos.dead_zone = g_CmdMap[SEV_POSITION_DS];
1453:Src/pid.c     **** 		
1454:Src/pid.c     **** 		pid_spd.Kp = g_CmdMap[SEV_SPEED_P];
1455:Src/pid.c     **** 		pid_spd.Ki = g_CmdMap[SEV_SPEED_I];
1456:Src/pid.c     **** 		pid_spd.Kd = 0;
1457:Src/pid.c     **** 		pid_spd.dead_zone = g_CmdMap[SEV_SPEED_DS];
1458:Src/pid.c     **** 
1459:Src/pid.c     **** 		pid_IQ.Kp = g_CmdMap[SEV_CURRENT_P];
1460:Src/pid.c     **** 		pid_IQ.Ki = g_CmdMap[SEV_CURRENT_I];
1461:Src/pid.c     **** 		pid_IQ.Kd = 0;
1462:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
1463:Src/pid.c     **** 
1464:Src/pid.c     **** 		pid_ID.Kp = g_CmdMap[SEV_CURRENT_P];
1465:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
1466:Src/pid.c     **** 		pid_ID.Kd = 0;
1467:Src/pid.c     **** 		pid_ID.dead_zone = 4;
1468:Src/pid.c     **** 		
1469:Src/pid.c     **** 		pid_force.Kp = g_CmdMap[SEV_FORCE_P];
1470:Src/pid.c     **** 		pid_force.Ki = g_CmdMap[SEV_FORCE_I];
1471:Src/pid.c     **** 		pid_force.Kd = g_CmdMap[SEV_FORCE_D];
1472:Src/pid.c     **** 		pid_force.dead_zone = g_CmdMap[SEV_FORCE_DS];
1473:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
1474:Src/pid.c     **** 	}
1475:Src/pid.c     ****   /**************************************************************************/	
1476:Src/pid.c     **** }
 2904              		.loc 1 1476 0
 2905 0088 F0BD     		pop	{r4, r5, r6, r7, pc}
 2906              	.L203:
1449:Src/pid.c     **** 		pid_pos.Ki = g_CmdMap[SEV_POSITION_I];
 2907              		.loc 1 1449 0
 2908 008a B3F8B0C2 		ldrh	ip, [r3, #688]
 2909 008e 0FFA8CFC 		sxth	ip, ip
 2910 0092 C5F808C0 		str	ip, [r5, #8]
1450:Src/pid.c     **** 		pid_pos.Kd = 0;
 2911              		.loc 1 1450 0
 2912 0096 B3F8B2C2 		ldrh	ip, [r3, #690]
 2913 009a 0FFA8CFC 		sxth	ip, ip
1451:Src/pid.c     **** 		pid_pos.dead_zone = g_CmdMap[SEV_POSITION_DS];
 2914              		.loc 1 1451 0
 2915 009e C5E903C6 		strd	ip, r6, [r5, #12]
1452:Src/pid.c     **** 		
 2916              		.loc 1 1452 0
 2917 00a2 B3F8B6C2 		ldrh	ip, [r3, #694]
 2918 00a6 0FFA8CFC 		sxth	ip, ip
 2919 00aa C5F814C0 		str	ip, [r5, #20]
1454:Src/pid.c     **** 		pid_spd.Ki = g_CmdMap[SEV_SPEED_I];
 2920              		.loc 1 1454 0
 2921 00ae B3F8A852 		ldrh	r5, [r3, #680]
 2922 00b2 2DB2     		sxth	r5, r5
 2923 00b4 A560     		str	r5, [r4, #8]
1455:Src/pid.c     **** 		pid_spd.Kd = 0;
 2924              		.loc 1 1455 0
 2925 00b6 B3F8AA52 		ldrh	r5, [r3, #682]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 86


 2926 00ba 2DB2     		sxth	r5, r5
1456:Src/pid.c     **** 		pid_spd.dead_zone = g_CmdMap[SEV_SPEED_DS];
 2927              		.loc 1 1456 0
 2928 00bc C4E90356 		strd	r5, r6, [r4, #12]
1457:Src/pid.c     **** 
 2929              		.loc 1 1457 0
 2930 00c0 B3F8AE52 		ldrh	r5, [r3, #686]
 2931 00c4 2DB2     		sxth	r5, r5
 2932 00c6 6561     		str	r5, [r4, #20]
1459:Src/pid.c     **** 		pid_IQ.Ki = g_CmdMap[SEV_CURRENT_I];
 2933              		.loc 1 1459 0
 2934 00c8 B3F8A242 		ldrh	r4, [r3, #674]
 2935 00cc 24B2     		sxth	r4, r4
 2936 00ce 8460     		str	r4, [r0, #8]
1460:Src/pid.c     **** 		pid_IQ.Kd = 0;
 2937              		.loc 1 1460 0
 2938 00d0 B3F8A442 		ldrh	r4, [r3, #676]
 2939 00d4 24B2     		sxth	r4, r4
1461:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2940              		.loc 1 1461 0
 2941 00d6 C0E90346 		strd	r4, r6, [r0, #12]
1462:Src/pid.c     **** 
 2942              		.loc 1 1462 0
 2943 00da 0424     		movs	r4, #4
 2944 00dc 4461     		str	r4, [r0, #20]
1464:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
 2945              		.loc 1 1464 0
 2946 00de B3F8A202 		ldrh	r0, [r3, #674]
1467:Src/pid.c     **** 		
 2947              		.loc 1 1467 0
 2948 00e2 4C61     		str	r4, [r1, #20]
1464:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
 2949              		.loc 1 1464 0
 2950 00e4 00B2     		sxth	r0, r0
 2951 00e6 8860     		str	r0, [r1, #8]
1465:Src/pid.c     **** 		pid_ID.Kd = 0;
 2952              		.loc 1 1465 0
 2953 00e8 B3F8A402 		ldrh	r0, [r3, #676]
 2954 00ec 00B2     		sxth	r0, r0
1466:Src/pid.c     **** 		pid_ID.dead_zone = 4;
 2955              		.loc 1 1466 0
 2956 00ee C1E90306 		strd	r0, r6, [r1, #12]
1469:Src/pid.c     **** 		pid_force.Ki = g_CmdMap[SEV_FORCE_I];
 2957              		.loc 1 1469 0
 2958 00f2 B3F8B812 		ldrh	r1, [r3, #696]
 2959 00f6 09B2     		sxth	r1, r1
 2960 00f8 9160     		str	r1, [r2, #8]
1470:Src/pid.c     **** 		pid_force.Kd = g_CmdMap[SEV_FORCE_D];
 2961              		.loc 1 1470 0
 2962 00fa B3F8BA12 		ldrh	r1, [r3, #698]
 2963 00fe 09B2     		sxth	r1, r1
 2964 0100 D160     		str	r1, [r2, #12]
1471:Src/pid.c     **** 		pid_force.dead_zone = g_CmdMap[SEV_FORCE_DS];
 2965              		.loc 1 1471 0
 2966 0102 B3F8BC12 		ldrh	r1, [r3, #700]
 2967 0106 09B2     		sxth	r1, r1
 2968 0108 1161     		str	r1, [r2, #16]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 87


1472:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2969              		.loc 1 1472 0
 2970 010a B3F8BE12 		ldrh	r1, [r3, #702]
1473:Src/pid.c     **** 	}
 2971              		.loc 1 1473 0
 2972 010e B3F8B632 		ldrh	r3, [r3, #694]
1472:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2973              		.loc 1 1472 0
 2974 0112 09B2     		sxth	r1, r1
1473:Src/pid.c     **** 	}
 2975              		.loc 1 1473 0
 2976 0114 1BB2     		sxth	r3, r3
1472:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2977              		.loc 1 1472 0
 2978 0116 5161     		str	r1, [r2, #20]
1473:Src/pid.c     **** 	}
 2979              		.loc 1 1473 0
 2980 0118 3B60     		str	r3, [r7]
 2981              		.loc 1 1476 0
 2982 011a B5E7     		b	.L202
 2983              	.L206:
 2984              		.align	2
 2985              	.L205:
 2986 011c 00000000 		.word	g_CmdMap
 2987 0120 00000000 		.word	g_Encode_offset
 2988 0124 00000000 		.word	pid_IQ
 2989 0128 00000000 		.word	pid_pos
 2990 012c 00000000 		.word	pid_spd
 2991 0130 00000000 		.word	pid_ID
 2992 0134 00000000 		.word	pid_force
 2993 0138 00000000 		.word	gPos_ds
 2994 013c 00000000 		.word	g_ThreeLoopParaBefLock
 2995              		.cfi_endproc
 2996              	.LFE350:
 2998              		.section	.text.EXTI3_IRQHandler,"ax",%progbits
 2999              		.align	1
 3000              		.global	EXTI3_IRQHandler
 3001              		.syntax unified
 3002              		.thumb
 3003              		.thumb_func
 3004              		.fpu fpv4-sp-d16
 3006              	EXTI3_IRQHandler:
 3007              	.LFB351:
1477:Src/pid.c     **** 
1478:Src/pid.c     **** 
1479:Src/pid.c     **** // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½ï¿½ï¿½ï¿½Ð¶ï¿½ 2KHz
1480:Src/pid.c     **** void EXTI3_IRQHandler(void)
1481:Src/pid.c     **** {
 3008              		.loc 1 1481 0
 3009              		.cfi_startproc
 3010              		@ args = 0, pretend = 0, frame = 0
 3011              		@ frame_needed = 0, uses_anonymous_args = 0
1482:Src/pid.c     ****  // if(EXTI_GetITStatus(EXTI_Line3) != RESET)
1483:Src/pid.c     ****   {
1484:Src/pid.c     **** 		//LED2_TOOGLE(); fortest
1485:Src/pid.c     **** 		EXTI->PR1 |= 0x0008;		// ï¿½ï¿½ï¿½ï¿½ï¿½Ö¾
 3012              		.loc 1 1485 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 88


 3013 0000 A54A     		ldr	r2, .L310
 3014 0002 5369     		ldr	r3, [r2, #20]
 3015 0004 43F00803 		orr	r3, r3, #8
1481:Src/pid.c     ****  // if(EXTI_GetITStatus(EXTI_Line3) != RESET)
 3016              		.loc 1 1481 0
 3017 0008 70B5     		push	{r4, r5, r6, lr}
 3018              	.LCFI18:
 3019              		.cfi_def_cfa_offset 16
 3020              		.cfi_offset 4, -16
 3021              		.cfi_offset 5, -12
 3022              		.cfi_offset 6, -8
 3023              		.cfi_offset 14, -4
 3024              		.loc 1 1485 0
 3025 000a 5361     		str	r3, [r2, #20]
 3026              	.LBB33:
 3027              	.LBB34:
1098:Src/pid.c     **** 	//CheckModeChange();
 3028              		.loc 1 1098 0
 3029 000c 4FF09042 		mov	r2, #1207959552
1107:Src/pid.c     **** 	{
 3030              		.loc 1 1107 0
 3031 0010 A24C     		ldr	r4, .L310+4
1098:Src/pid.c     **** 	//CheckModeChange();
 3032              		.loc 1 1098 0
 3033 0012 936A     		ldr	r3, [r2, #40]
 3034 0014 43F01003 		orr	r3, r3, #16
 3035 0018 9362     		str	r3, [r2, #40]
1100:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
 3036              		.loc 1 1100 0
 3037 001a FFF7FEFF 		bl	MTPro
 3038              	.LVL201:
1101:Src/pid.c     **** 	{
 3039              		.loc 1 1101 0
 3040 001e A04A     		ldr	r2, .L310+8
 3041 0020 1368     		ldr	r3, [r2]
 3042 0022 B3F5FA6F 		cmp	r3, #2000
1103:Src/pid.c     **** 	}
 3043              		.loc 1 1103 0
 3044 0026 BCBF     		itt	lt
 3045 0028 0133     		addlt	r3, r3, #1
 3046 002a 1360     		strlt	r3, [r2]
1105:Src/pid.c     **** 	
 3047              		.loc 1 1105 0
 3048 002c FFF7FEFF 		bl	get_average_force_data
 3049              	.LVL202:
1107:Src/pid.c     **** 	{
 3050              		.loc 1 1107 0
 3051 0030 B4F80432 		ldrh	r3, [r4, #516]
 3052 0034 1BB2     		sxth	r3, r3
 3053 0036 042B     		cmp	r3, #4
 3054 0038 4CD1     		bne	.L210
 3055              	.LVL203:
 3056              	.LBB35:
 3057              	.LBB36:
 203:Src/pid.c     **** 	{
 3058              		.loc 1 203 0
 3059 003a 638D     		ldrh	r3, [r4, #42]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 89


 3060 003c 9949     		ldr	r1, .L310+12
 3061 003e 9A4A     		ldr	r2, .L310+16
 3062 0040 1BB2     		sxth	r3, r3
 3063 0042 002B     		cmp	r3, #0
 3064 0044 77D1     		bne	.L211
 205:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3065              		.loc 1 205 0
 3066 0046 B4F84430 		ldrh	r3, [r4, #68]
 3067 004a 0B80     		strh	r3, [r1]	@ movhi
 206:Src/pid.c     **** 	}
 3068              		.loc 1 206 0
 3069 004c B4F85A30 		ldrh	r3, [r4, #90]
 3070              	.L303:
 211:Src/pid.c     **** 	}
 3071              		.loc 1 211 0
 3072 0050 1380     		strh	r3, [r2]	@ movhi
 239:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 3073              		.loc 1 239 0
 3074 0052 B4F88432 		ldrh	r3, [r4, #644]
 3075 0056 954D     		ldr	r5, .L310+20
 3076 0058 1BB2     		sxth	r3, r3
 3077 005a EB63     		str	r3, [r5, #60]
 240:Src/pid.c     **** 	
 3078              		.loc 1 240 0
 3079 005c B4F88632 		ldrh	r3, [r4, #646]
 242:Src/pid.c     **** 	{
 3080              		.loc 1 242 0
 3081 0060 B4F84C00 		ldrh	r0, [r4, #76]
 240:Src/pid.c     **** 	
 3082              		.loc 1 240 0
 3083 0064 1BB2     		sxth	r3, r3
 3084 0066 2B64     		str	r3, [r5, #64]
 242:Src/pid.c     **** 	{
 3085              		.loc 1 242 0
 3086 0068 B4F88C32 		ldrh	r3, [r4, #652]
 3087 006c 00B2     		sxth	r0, r0
 3088 006e 1BB2     		sxth	r3, r3
 3089 0070 9842     		cmp	r0, r3
 3090 0072 6ADD     		ble	.L213
 3091              	.L215:
 244:Src/pid.c     **** 		
 3092              		.loc 1 244 0
 3093 0074 0023     		movs	r3, #0
 3094 0076 EB63     		str	r3, [r5, #60]
 3095              	.L214:
 252:Src/pid.c     **** 	{
 3096              		.loc 1 252 0
 3097 0078 B4F84C00 		ldrh	r0, [r4, #76]
 3098 007c B4F88E32 		ldrh	r3, [r4, #654]
 3099 0080 00B2     		sxth	r0, r0
 3100 0082 1BB2     		sxth	r3, r3
 3101 0084 9842     		cmp	r0, r3
 3102 0086 70DA     		bge	.L216
 3103              	.L218:
 254:Src/pid.c     **** 		
 3104              		.loc 1 254 0
 3105 0088 0023     		movs	r3, #0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 90


 3106 008a 2B64     		str	r3, [r5, #64]
 3107              	.L217:
 289:Src/pid.c     **** //	}
 3108              		.loc 1 289 0
 3109 008c 0888     		ldrh	r0, [r1]
 3110 008e 1188     		ldrh	r1, [r2]
 3111 0090 864A     		ldr	r2, .L310+20
 3112 0092 09B2     		sxth	r1, r1
 3113 0094 00B2     		sxth	r0, r0
 3114 0096 FFF7FEFF 		bl	PID_control
 3115              	.LVL204:
 292:Src/pid.c     **** 	
 3116              		.loc 1 292 0
 3117 009a B5F93430 		ldrsh	r3, [r5, #52]
 3118 009e A4F85E30 		strh	r3, [r4, #94]	@ movhi
 294:Src/pid.c     **** 	{
 3119              		.loc 1 294 0
 3120 00a2 B4F84030 		ldrh	r3, [r4, #64]
 3121 00a6 1BB2     		sxth	r3, r3
 3122 00a8 042B     		cmp	r3, #4
 3123 00aa 08D0     		beq	.L219
 3124 00ac B4F84030 		ldrh	r3, [r4, #64]
 3125 00b0 1BB2     		sxth	r3, r3
 3126 00b2 052B     		cmp	r3, #5
 3127 00b4 0ED1     		bne	.L210
 3128 00b6 7E4B     		ldr	r3, .L310+24
 3129 00b8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3130 00ba 032B     		cmp	r3, #3
 3131 00bc 0AD1     		bne	.L210
 3132              	.L219:
 296:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 3133              		.loc 1 296 0
 3134 00be 7D4B     		ldr	r3, .L310+28
 3135 00c0 0022     		movs	r2, #0
 3136 00c2 1A60     		str	r2, [r3]
 297:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 3137              		.loc 1 297 0
 3138 00c4 B4F84C30 		ldrh	r3, [r4, #76]
 3139 00c8 A4F86030 		strh	r3, [r4, #96]	@ movhi
 298:Src/pid.c     **** 	}
 3140              		.loc 1 298 0
 3141 00cc B4F84C30 		ldrh	r3, [r4, #76]
 3142 00d0 A4F84830 		strh	r3, [r4, #72]	@ movhi
 3143              	.LVL205:
 3144              	.L210:
 3145              	.LBE36:
 3146              	.LBE35:
1113:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
 3147              		.loc 1 1113 0
 3148 00d4 FFF7FEFF 		bl	Loop3_EnableManage
 3149              	.LVL206:
1114:Src/pid.c     **** 	{
 3150              		.loc 1 1114 0
 3151 00d8 774A     		ldr	r2, .L310+32
 3152 00da 1368     		ldr	r3, [r2]
 3153 00dc 0133     		adds	r3, r3, #1
 3154 00de 002B     		cmp	r3, #0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 91


 3155 00e0 52DC     		bgt	.L221
 3156 00e2 1360     		str	r3, [r2]
 3157              	.L222:
1135:Src/pid.c     **** 	
 3158              		.loc 1 1135 0
 3159 00e4 FFF7FEFF 		bl	icmu_sdtransmission_test
 3160              	.LVL207:
1138:Src/pid.c     **** 	{
 3161              		.loc 1 1138 0
 3162 00e8 B4F80432 		ldrh	r3, [r4, #516]
 3163 00ec 1BB2     		sxth	r3, r3
 3164 00ee 032B     		cmp	r3, #3
 3165 00f0 0AD0     		beq	.L225
 3166 00f2 B4F80432 		ldrh	r3, [r4, #516]
 3167 00f6 1BB2     		sxth	r3, r3
 3168 00f8 022B     		cmp	r3, #2
 3169 00fa 05D0     		beq	.L225
 3170 00fc B4F80432 		ldrh	r3, [r4, #516]
 3171 0100 1BB2     		sxth	r3, r3
 3172 0102 042B     		cmp	r3, #4
 3173 0104 40F09180 		bne	.L226
 3174              	.L225:
 3175              	.LVL208:
 3176              	.LBB38:
 3177              	.LBB39:
 658:Src/pid.c     ****   {
 3178              		.loc 1 658 0
 3179 0108 B4F80432 		ldrh	r3, [r4, #516]
 3180 010c 6B4D     		ldr	r5, .L310+36
 3181 010e 1BB2     		sxth	r3, r3
 3182 0110 012B     		cmp	r3, #1
 3183 0112 09D0     		beq	.L227
 3184 0114 B4F80432 		ldrh	r3, [r4, #516]
 3185 0118 1BB2     		sxth	r3, r3
 3186 011a 032B     		cmp	r3, #3
 3187 011c 04D0     		beq	.L227
 3188 011e B4F80432 		ldrh	r3, [r4, #516]
 3189 0122 1BB2     		sxth	r3, r3
 3190 0124 062B     		cmp	r3, #6
 3191 0126 45D1     		bne	.L228
 3192              	.L227:
 660:Src/pid.c     ****   }
 3193              		.loc 1 660 0
 3194 0128 B4F86230 		ldrh	r3, [r4, #98]
 3195 012c B4F85E20 		ldrh	r2, [r4, #94]
 3196 0130 1344     		add	r3, r3, r2
 3197              	.LVL209:
 3198              	.L308:
 757:Src/pid.c     **** 								}
 3199              		.loc 1 757 0
 3200 0132 1BB2     		sxth	r3, r3
 3201 0134 15E1     		b	.L307
 3202              	.LVL210:
 3203              	.L211:
 3204              	.LBE39:
 3205              	.LBE38:
 3206              	.LBB42:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 92


 3207              	.LBB37:
 210:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3208              		.loc 1 210 0
 3209 0136 B4F84430 		ldrh	r3, [r4, #68]
 3210 013a 5B42     		negs	r3, r3
 3211 013c 1BB2     		sxth	r3, r3
 3212 013e 0B80     		strh	r3, [r1]	@ movhi
 211:Src/pid.c     **** 	}
 3213              		.loc 1 211 0
 3214 0140 B4F85A30 		ldrh	r3, [r4, #90]
 3215 0144 5B42     		negs	r3, r3
 3216 0146 1BB2     		sxth	r3, r3
 3217 0148 82E7     		b	.L303
 3218              	.L213:
 247:Src/pid.c     **** 	{
 3219              		.loc 1 247 0
 3220 014a B4F88C32 		ldrh	r3, [r4, #652]
 3221 014e B4F84C00 		ldrh	r0, [r4, #76]
 3222 0152 1BB2     		sxth	r3, r3
 3223 0154 00B2     		sxth	r0, r0
 3224 0156 A3F5CC73 		sub	r3, r3, #408
 3225 015a 8342     		cmp	r3, r0
 3226 015c 8CDC     		bgt	.L214
 3227 015e B4F84230 		ldrh	r3, [r4, #66]
 3228 0162 1BB2     		sxth	r3, r3
 3229 0164 002B     		cmp	r3, #0
 3230 0166 85DC     		bgt	.L215
 3231 0168 86E7     		b	.L214
 3232              	.L216:
 257:Src/pid.c     **** 	{
 3233              		.loc 1 257 0
 3234 016a B4F88E32 		ldrh	r3, [r4, #654]
 3235 016e B4F84C00 		ldrh	r0, [r4, #76]
 3236 0172 1BB2     		sxth	r3, r3
 3237 0174 00B2     		sxth	r0, r0
 3238 0176 03F5CC73 		add	r3, r3, #408
 3239 017a 8342     		cmp	r3, r0
 3240 017c 86DB     		blt	.L217
 3241 017e B4F84230 		ldrh	r3, [r4, #66]
 3242 0182 1B04     		lsls	r3, r3, #16
 3243 0184 80D4     		bmi	.L218
 3244 0186 81E7     		b	.L217
 3245              	.LVL211:
 3246              	.L221:
 3247              	.LBE37:
 3248              	.LBE42:
1116:Src/pid.c     **** 		Flag_1ms = 1;
 3249              		.loc 1 1116 0
 3250 0188 0020     		movs	r0, #0
 3251 018a 1060     		str	r0, [r2]
1117:Src/pid.c     **** 		if(++s_count_50ms>50)
 3252              		.loc 1 1117 0
 3253 018c 4C4B     		ldr	r3, .L310+40
1118:Src/pid.c     **** 		{
 3254              		.loc 1 1118 0
 3255 018e 4D4A     		ldr	r2, .L310+44
1117:Src/pid.c     **** 		if(++s_count_50ms>50)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 93


 3256              		.loc 1 1117 0
 3257 0190 0121     		movs	r1, #1
 3258 0192 1970     		strb	r1, [r3]
1118:Src/pid.c     **** 		{
 3259              		.loc 1 1118 0
 3260 0194 1388     		ldrh	r3, [r2]
 3261 0196 0B44     		add	r3, r3, r1
 3262 0198 1BB2     		sxth	r3, r3
 3263 019a 322B     		cmp	r3, #50
1121:Src/pid.c     **** 		}
 3264              		.loc 1 1121 0
 3265 019c C9BF     		itett	gt
 3266 019e 4A4B     		ldrgt	r3, .L310+48
1118:Src/pid.c     **** 		{
 3267              		.loc 1 1118 0
 3268 01a0 1380     		strhle	r3, [r2]	@ movhi
1120:Src/pid.c     **** 			Flag_50ms = 1;
 3269              		.loc 1 1120 0
 3270 01a2 1080     		strhgt	r0, [r2]	@ movhi
1121:Src/pid.c     **** 		}
 3271              		.loc 1 1121 0
 3272 01a4 1980     		strhgt	r1, [r3]	@ movhi
1126:Src/pid.c     **** 		Stroke_protection();
 3273              		.loc 1 1126 0
 3274 01a6 FFF7FEFF 		bl	Get_Pos_Rod
 3275              	.LVL212:
1127:Src/pid.c     **** 		
 3276              		.loc 1 1127 0
 3277 01aa FFF7FEFF 		bl	Stroke_protection
 3278              	.LVL213:
1131:Src/pid.c     **** 		}
 3279              		.loc 1 1131 0
 3280 01ae FFF7FEFF 		bl	Gripper_control
 3281              	.LVL214:
 3282 01b2 97E7     		b	.L222
 3283              	.LVL215:
 3284              	.L228:
 3285              	.LBB43:
 3286              	.LBB40:
 662:Src/pid.c     **** 	{
 3287              		.loc 1 662 0
 3288 01b4 B4F80432 		ldrh	r3, [r4, #516]
 3289 01b8 1BB2     		sxth	r3, r3
 3290 01ba 042B     		cmp	r3, #4
 3291 01bc 40F09280 		bne	.L230
 664:Src/pid.c     **** 		
 3292              		.loc 1 664 0
 3293 01c0 B4F85E30 		ldrh	r3, [r4, #94]
 3294 01c4 A4F85C30 		strh	r3, [r4, #92]	@ movhi
 666:Src/pid.c     **** 	}
 3295              		.loc 1 666 0
 3296 01c8 0123     		movs	r3, #1
 3297 01ca 2B60     		str	r3, [r5]
 3298              	.LVL216:
 3299              	.L229:
 792:Src/pid.c     **** 	{
 3300              		.loc 1 792 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 94


 3301 01cc B4F85C20 		ldrh	r2, [r4, #92]
 3302 01d0 B4F88432 		ldrh	r3, [r4, #644]
 3303 01d4 12B2     		sxth	r2, r2
 3304 01d6 1BB2     		sxth	r3, r3
 3305 01d8 9A42     		cmp	r2, r3
 794:Src/pid.c     **** 	}
 3306              		.loc 1 794 0
 3307 01da C4BF     		itt	gt
 3308 01dc B4F88432 		ldrhgt	r3, [r4, #644]
 3309 01e0 A4F85C30 		strhgt	r3, [r4, #92]	@ movhi
 796:Src/pid.c     **** 	{
 3310              		.loc 1 796 0
 3311 01e4 B4F85C20 		ldrh	r2, [r4, #92]
 3312 01e8 B4F88632 		ldrh	r3, [r4, #646]
 3313 01ec 12B2     		sxth	r2, r2
 3314 01ee 1BB2     		sxth	r3, r3
 3315 01f0 9A42     		cmp	r2, r3
 798:Src/pid.c     **** 	}
 3316              		.loc 1 798 0
 3317 01f2 BCBF     		itt	lt
 3318 01f4 B4F88632 		ldrhlt	r3, [r4, #646]
 3319 01f8 A4F85C30 		strhlt	r3, [r4, #92]	@ movhi
 803:Src/pid.c     **** 	{
 3320              		.loc 1 803 0
 3321 01fc 638C     		ldrh	r3, [r4, #34]
 3322 01fe B4F88032 		ldrh	r3, [r4, #640]
 807:Src/pid.c     **** 	{
 3323              		.loc 1 807 0
 3324 0202 A38C     		ldrh	r3, [r4, #36]
 3325 0204 B4F88232 		ldrh	r3, [r4, #642]
 812:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];		
 3326              		.loc 1 812 0
 3327 0208 B4F88032 		ldrh	r3, [r4, #640]
 823:Src/pid.c     **** }
 3328              		.loc 1 823 0
 3329 020c 2B4A     		ldr	r2, .L310+36
 812:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];		
 3330              		.loc 1 812 0
 3331 020e 1BB2     		sxth	r3, r3
 3332 0210 EB63     		str	r3, [r5, #60]
 813:Src/pid.c     **** 	
 3333              		.loc 1 813 0
 3334 0212 B4F88232 		ldrh	r3, [r4, #642]
 823:Src/pid.c     **** }
 3335              		.loc 1 823 0
 3336 0216 B4F85C00 		ldrh	r0, [r4, #92]
 3337 021a B4F85010 		ldrh	r1, [r4, #80]
 813:Src/pid.c     **** 	
 3338              		.loc 1 813 0
 3339 021e 1BB2     		sxth	r3, r3
 823:Src/pid.c     **** }
 3340              		.loc 1 823 0
 3341 0220 09B2     		sxth	r1, r1
 3342 0222 00B2     		sxth	r0, r0
 813:Src/pid.c     **** 	
 3343              		.loc 1 813 0
 3344 0224 2B64     		str	r3, [r5, #64]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 95


 823:Src/pid.c     **** }
 3345              		.loc 1 823 0
 3346 0226 FFF7FEFF 		bl	PID_control
 3347              	.LVL217:
 3348              	.L226:
 3349              	.LBE40:
 3350              	.LBE43:
1143:Src/pid.c     **** 	{
 3351              		.loc 1 1143 0
 3352 022a B4F80222 		ldrh	r2, [r4, #514]
 3353 022e 274B     		ldr	r3, .L310+52
 3354 0230 2748     		ldr	r0, .L310+56
 3355 0232 2849     		ldr	r1, .L310+60
 3356 0234 12B2     		sxth	r2, r2
 3357 0236 4AB1     		cbz	r2, .L259
 3358 0238 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 3359 023a 012A     		cmp	r2, #1
 3360 023c 06D0     		beq	.L259
 3361 023e 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
 3362 0240 012A     		cmp	r2, #1
 3363 0242 03D0     		beq	.L259
 3364 0244 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 3365 0246 012A     		cmp	r2, #1
 3366 0248 40F02381 		bne	.L260
 3367              	.L259:
1145:Src/pid.c     **** 		Motor_forbidden = 0;
 3368              		.loc 1 1145 0
 3369 024c 0022     		movs	r2, #0
1146:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
 3370              		.loc 1 1146 0
 3371 024e 1A70     		strb	r2, [r3]
1147:Src/pid.c     **** 		{
 3372              		.loc 1 1147 0
 3373 0250 B4F80432 		ldrh	r3, [r4, #516]
1145:Src/pid.c     **** 		Motor_forbidden = 0;
 3374              		.loc 1 1145 0
 3375 0254 204D     		ldr	r5, .L310+64
1147:Src/pid.c     **** 		{
 3376              		.loc 1 1147 0
 3377 0256 1BB2     		sxth	r3, r3
 3378 0258 022B     		cmp	r3, #2
1145:Src/pid.c     **** 		Motor_forbidden = 0;
 3379              		.loc 1 1145 0
 3380 025a 2A60     		str	r2, [r5]
1147:Src/pid.c     **** 		{
 3381              		.loc 1 1147 0
 3382 025c 04D0     		beq	.L261
 3383 025e B4F80432 		ldrh	r3, [r4, #516]
 3384 0262 1BB2     		sxth	r3, r3
 3385 0264 012B     		cmp	r3, #1
 3386 0266 04D1     		bne	.L262
 3387              	.L261:
1149:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 3388              		.loc 1 1149 0
 3389 0268 0023     		movs	r3, #0
 3390 026a A4F84630 		strh	r3, [r4, #70]	@ movhi
1150:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 96


 3391              		.loc 1 1150 0
 3392 026e A4F84230 		strh	r3, [r4, #66]	@ movhi
 3393              	.L262:
1152:Src/pid.c     **** 		{	
 3394              		.loc 1 1152 0
 3395 0272 B4F85430 		ldrh	r3, [r4, #84]
 3396 0276 1BB2     		sxth	r3, r3
 3397 0278 1BB1     		cbz	r3, .L263
1154:Src/pid.c     **** 		}			
 3398              		.loc 1 1154 0
 3399 027a B4F84C30 		ldrh	r3, [r4, #76]
 3400 027e A4F84830 		strh	r3, [r4, #72]	@ movhi
 3401              	.L263:
1160:Src/pid.c     ****       Motor_emergercy_stop =0;
 3402              		.loc 1 1160 0
 3403 0282 164B     		ldr	r3, .L310+68
 3404 0284 0024     		movs	r4, #0
 3405 0286 1C60     		str	r4, [r3]
1161:Src/pid.c     **** 			Motor_pause_flag = 0;
 3406              		.loc 1 1161 0
 3407 0288 0470     		strb	r4, [r0]
1162:Src/pid.c     **** 			PWM_Disable();
 3408              		.loc 1 1162 0
 3409 028a 0C70     		strb	r4, [r1]
1163:Src/pid.c     **** 		}
 3410              		.loc 1 1163 0
 3411 028c FFF7FEFF 		bl	PWM_Disable
 3412              	.LVL218:
1169:Src/pid.c     **** 		return;
 3413              		.loc 1 1169 0
 3414 0290 134B     		ldr	r3, .L310+72
 3415 0292 1C60     		str	r4, [r3]
 3416              	.L207:
 3417              	.LBE34:
 3418              	.LBE33:
1486:Src/pid.c     ****     Pos_Spd_PID();  // ï¿½ï¿½ï¿½ï¿½Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½				
1487:Src/pid.c     **** 		//UpdateErrorStateLED(); 		
1488:Src/pid.c     ****   }
1489:Src/pid.c     **** }
 3419              		.loc 1 1489 0
 3420 0294 70BD     		pop	{r4, r5, r6, pc}
 3421              	.L311:
 3422 0296 00BF     		.align	2
 3423              	.L310:
 3424 0298 00040140 		.word	1073808384
 3425 029c 00000000 		.word	g_CmdMap
 3426 02a0 00000000 		.word	g_servo_cmd_period_cnt
 3427 02a4 00000000 		.word	force_set
 3428 02a8 00000000 		.word	force_act
 3429 02ac 00000000 		.word	pid_force
 3430 02b0 00000000 		.word	status_Mode_POSITION_FORCE
 3431 02b4 00000000 		.word	Flag_Profile_Enable
 3432 02b8 00000000 		.word	.LANCHOR40
 3433 02bc 00000000 		.word	pid_spd
 3434 02c0 00000000 		.word	Flag_1ms
 3435 02c4 00000000 		.word	s_count_50ms
 3436 02c8 00000000 		.word	Flag_50ms
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 97


 3437 02cc 00000000 		.word	Motor_forbidden
 3438 02d0 00000000 		.word	Motor_emergercy_stop
 3439 02d4 00000000 		.word	Motor_pause_flag
 3440 02d8 00000000 		.word	.LANCHOR44
 3441 02dc 00000000 		.word	g_Timer1CCR
 3442 02e0 00000000 		.word	.LANCHOR21
 3443              	.LVL219:
 3444              	.L230:
 3445              	.LBB47:
 3446              	.LBB45:
 3447              	.LBB44:
 3448              	.LBB41:
 668:Src/pid.c     ****   {
 3449              		.loc 1 668 0
 3450 02e4 B4F80432 		ldrh	r3, [r4, #516]
 3451 02e8 1BB2     		sxth	r3, r3
 3452 02ea 022B     		cmp	r3, #2
 3453 02ec 7FF46EAF 		bne	.L229
 670:Src/pid.c     **** 			{
 3454              		.loc 1 670 0
 3455 02f0 7E49     		ldr	r1, .L312
 3456 02f2 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 3457 02f4 022B     		cmp	r3, #2
 3458 02f6 45D1     		bne	.L231
 672:Src/pid.c     **** 				{
 3459              		.loc 1 672 0
 3460 02f8 638D     		ldrh	r3, [r4, #42]
 3461 02fa 7D48     		ldr	r0, .L312+4
 3462 02fc 7D4A     		ldr	r2, .L312+8
 3463 02fe 1BB2     		sxth	r3, r3
 3464 0300 1BBB     		cbnz	r3, .L232
 674:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3465              		.loc 1 674 0
 3466 0302 B4F84430 		ldrh	r3, [r4, #68]
 3467 0306 0380     		strh	r3, [r0]	@ movhi
 675:Src/pid.c     **** 				}
 3468              		.loc 1 675 0
 3469 0308 B4F85A30 		ldrh	r3, [r4, #90]
 3470              	.L304:
 680:Src/pid.c     **** 				}
 3471              		.loc 1 680 0
 3472 030c 1380     		strh	r3, [r2]	@ movhi
 682:Src/pid.c     **** 				{
 3473              		.loc 1 682 0
 3474 030e 0388     		ldrh	r3, [r0]
 684:Src/pid.c     **** 					{
 3475              		.loc 1 684 0
 3476 0310 1288     		ldrh	r2, [r2]
 682:Src/pid.c     **** 				{
 3477              		.loc 1 682 0
 3478 0312 13F4004F 		tst	r3, #32768
 684:Src/pid.c     **** 					{
 3479              		.loc 1 684 0
 3480 0316 0388     		ldrh	r3, [r0]
 3481 0318 12B2     		sxth	r2, r2
 3482 031a 1BB2     		sxth	r3, r3
 682:Src/pid.c     **** 				{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 98


 3483              		.loc 1 682 0
 3484 031c 24D1     		bne	.L234
 684:Src/pid.c     **** 					{
 3485              		.loc 1 684 0
 3486 031e 9A42     		cmp	r2, r3
 3487 0320 07DC     		bgt	.L237
 3488 0322 B4F84C20 		ldrh	r2, [r4, #76]
 3489 0326 B4F88C32 		ldrh	r3, [r4, #652]
 3490 032a 12B2     		sxth	r2, r2
 3491 032c 1BB2     		sxth	r3, r3
 3492 032e 9A42     		cmp	r2, r3
 3493 0330 15DD     		ble	.L236
 3494              	.L237:
 700:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 3495              		.loc 1 700 0
 3496 0332 0323     		movs	r3, #3
 3497 0334 0B70     		strb	r3, [r1]
 701:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 3498              		.loc 1 701 0
 3499 0336 0423     		movs	r3, #4
 3500 0338 A4F80432 		strh	r3, [r4, #516]	@ movhi
 702:Src/pid.c     ****  		
 3501              		.loc 1 702 0
 3502 033c B4F84200 		ldrh	r0, [r4, #66]
 3503 0340 6D49     		ldr	r1, .L312+12
 3504 0342 00B2     		sxth	r0, r0
 3505 0344 FFF7FEFF 		bl	force_PID_out
 3506              	.LVL220:
 3507 0348 40E7     		b	.L229
 3508              	.L232:
 679:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3509              		.loc 1 679 0
 3510 034a B4F84430 		ldrh	r3, [r4, #68]
 3511 034e 5B42     		negs	r3, r3
 3512 0350 1BB2     		sxth	r3, r3
 3513 0352 0380     		strh	r3, [r0]	@ movhi
 680:Src/pid.c     **** 				}
 3514              		.loc 1 680 0
 3515 0354 B4F85A30 		ldrh	r3, [r4, #90]
 3516 0358 5B42     		negs	r3, r3
 3517 035a 1BB2     		sxth	r3, r3
 3518 035c D6E7     		b	.L304
 3519              	.L236:
 693:Src/pid.c     **** 					}
 3520              		.loc 1 693 0
 3521 035e B4F84A30 		ldrh	r3, [r4, #74]
 3522              	.LVL221:
 3523              	.L307:
 788:Src/pid.c     **** 							}				
 3524              		.loc 1 788 0
 3525 0362 A4F85C30 		strh	r3, [r4, #92]	@ movhi
 3526 0366 31E7     		b	.L229
 3527              	.LVL222:
 3528              	.L234:
 698:Src/pid.c     **** 					{
 3529              		.loc 1 698 0
 3530 0368 9A42     		cmp	r2, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 99


 3531 036a E2DB     		blt	.L237
 3532 036c B4F84C20 		ldrh	r2, [r4, #76]
 3533 0370 B4F88E32 		ldrh	r3, [r4, #654]
 3534 0374 12B2     		sxth	r2, r2
 3535 0376 1BB2     		sxth	r3, r3
 3536 0378 9A42     		cmp	r2, r3
 3537 037a DADB     		blt	.L237
 707:Src/pid.c     **** 					}
 3538              		.loc 1 707 0
 3539 037c B4F84A30 		ldrh	r3, [r4, #74]
 3540 0380 5B42     		negs	r3, r3
 3541 0382 D6E6     		b	.L308
 3542              	.L231:
 713:Src/pid.c     **** 							{
 3543              		.loc 1 713 0
 3544 0384 B4F81C32 		ldrh	r3, [r4, #540]
 3545 0388 1BB2     		sxth	r3, r3
 3546 038a 13B9     		cbnz	r3, .L239
 715:Src/pid.c     **** 							}
 3547              		.loc 1 715 0
 3548 038c B4F84630 		ldrh	r3, [r4, #70]
 3549 0390 E7E7     		b	.L307
 3550              	.L239:
 717:Src/pid.c     **** 							{
 3551              		.loc 1 717 0
 3552 0392 B4F81C32 		ldrh	r3, [r4, #540]
 3553 0396 1BB2     		sxth	r3, r3
 3554 0398 012B     		cmp	r3, #1
 3555 039a 18D1     		bne	.L240
 720:Src/pid.c     **** 								{
 3556              		.loc 1 720 0
 3557 039c B4F84C20 		ldrh	r2, [r4, #76]
 3558 03a0 40F26561 		movw	r1, #1637
 3559 03a4 12B2     		sxth	r2, r2
 3560 03a6 8A42     		cmp	r2, r1
 3561 03a8 544A     		ldr	r2, .L312+16
 3562 03aa 06DC     		bgt	.L241
 3563              	.L305:
 726:Src/pid.c     **** 								}
 3564              		.loc 1 726 0
 3565 03ac 1360     		str	r3, [r2]
 3566              	.L242:
 728:Src/pid.c     **** 
 3567              		.loc 1 728 0
 3568 03ae B4F84630 		ldrh	r3, [r4, #70]
 3569              	.LVL223:
 3570              	.L309:
 757:Src/pid.c     **** 								}
 3571              		.loc 1 757 0
 3572 03b2 1268     		ldr	r2, [r2]
 3573 03b4 12FB03F3 		smulbb	r3, r2, r3
 3574 03b8 BBE6     		b	.L308
 3575              	.LVL224:
 3576              	.L241:
 724:Src/pid.c     **** 								{
 3577              		.loc 1 724 0
 3578 03ba B4F84C30 		ldrh	r3, [r4, #76]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 100


 3579 03be 43F69A11 		movw	r1, #14746
 3580 03c2 1BB2     		sxth	r3, r3
 3581 03c4 8B42     		cmp	r3, r1
 3582 03c6 F2DD     		ble	.L242
 726:Src/pid.c     **** 								}
 3583              		.loc 1 726 0
 3584 03c8 4FF0FF33 		mov	r3, #-1
 3585 03cc EEE7     		b	.L305
 3586              	.L240:
 731:Src/pid.c     **** 							{
 3587              		.loc 1 731 0
 3588 03ce B4F81C32 		ldrh	r3, [r4, #540]
 3589 03d2 1BB2     		sxth	r3, r3
 3590 03d4 0B2B     		cmp	r3, #11
 3591 03d6 3AD1     		bne	.L243
 733:Src/pid.c     **** 								{
 3592              		.loc 1 733 0
 3593 03d8 B4F86420 		ldrh	r2, [r4, #100]
 3594 03dc B4F8E032 		ldrh	r3, [r4, #736]
 3595 03e0 12B2     		sxth	r2, r2
 3596 03e2 1BB2     		sxth	r3, r3
 3597 03e4 9A42     		cmp	r2, r3
 3598 03e6 18DA     		bge	.L244
 735:Src/pid.c     **** 								}
 3599              		.loc 1 735 0
 3600 03e8 444B     		ldr	r3, .L312+16
 3601 03ea 0122     		movs	r2, #1
 3602              	.L306:
 739:Src/pid.c     **** 								}
 3603              		.loc 1 739 0
 3604 03ec 1A60     		str	r2, [r3]
 3605              	.L245:
 741:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3606              		.loc 1 741 0
 3607 03ee B4F84630 		ldrh	r3, [r4, #70]
 742:Src/pid.c     **** 								{
 3608              		.loc 1 742 0
 3609 03f2 4348     		ldr	r0, .L312+20
 3610 03f4 4349     		ldr	r1, .L312+24
 3611 03f6 0268     		ldr	r2, [r0]
 741:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3612              		.loc 1 741 0
 3613 03f8 13F4004F 		tst	r3, #32768
 3614 03fc B4F84630 		ldrh	r3, [r4, #70]
 3615 0400 18BF     		it	ne
 3616 0402 5B42     		rsbne	r3, r3, #0
 742:Src/pid.c     **** 								{
 3617              		.loc 1 742 0
 3618 0404 B2F57A6F 		cmp	r2, #4000
 741:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3619              		.loc 1 741 0
 3620 0408 1BB2     		sxth	r3, r3
 3621              	.LVL225:
 742:Src/pid.c     **** 								{
 3622              		.loc 1 742 0
 3623 040a 12DC     		bgt	.L248
 3624 040c 0132     		adds	r2, r2, #1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 101


 3625 040e 0260     		str	r2, [r0]
 3626              	.L249:
 755:Src/pid.c     **** 								{
 3627              		.loc 1 755 0
 3628 0410 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 3629 0412 012A     		cmp	r2, #1
 3630 0414 3BD1     		bne	.L255
 757:Src/pid.c     **** 								}
 3631              		.loc 1 757 0
 3632 0416 394A     		ldr	r2, .L312+16
 3633 0418 CBE7     		b	.L309
 3634              	.LVL226:
 3635              	.L244:
 737:Src/pid.c     **** 								{
 3636              		.loc 1 737 0
 3637 041a B4F86420 		ldrh	r2, [r4, #100]
 3638 041e B4F85833 		ldrh	r3, [r4, #856]
 3639 0422 12B2     		sxth	r2, r2
 3640 0424 1BB2     		sxth	r3, r3
 3641 0426 9A42     		cmp	r2, r3
 3642 0428 E1DD     		ble	.L245
 739:Src/pid.c     **** 								}
 3643              		.loc 1 739 0
 3644 042a 344B     		ldr	r3, .L312+16
 3645 042c 4FF0FF32 		mov	r2, #-1
 3646 0430 DCE7     		b	.L306
 3647              	.LVL227:
 3648              	.L248:
 744:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 3649              		.loc 1 744 0
 3650 0432 0022     		movs	r2, #0
 3651 0434 0260     		str	r2, [r0]
 745:Src/pid.c     **** 									{
 3652              		.loc 1 745 0
 3653 0436 344A     		ldr	r2, .L312+28
 3654 0438 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 3655 043a 00F0FF06 		and	r6, r0, #255
 3656 043e 18B9     		cbnz	r0, .L250
 747:Src/pid.c     **** 									}
 3657              		.loc 1 747 0
 3658 0440 0E70     		strb	r6, [r1]
 3659              	.L251:
 753:Src/pid.c     **** 								}
 3660              		.loc 1 753 0
 3661 0442 0020     		movs	r0, #0
 3662 0444 1070     		strb	r0, [r2]
 3663 0446 E3E7     		b	.L249
 3664              	.L250:
 751:Src/pid.c     **** 									}
 3665              		.loc 1 751 0
 3666 0448 0120     		movs	r0, #1
 3667 044a 0870     		strb	r0, [r1]
 3668 044c F9E7     		b	.L251
 3669              	.LVL228:
 3670              	.L243:
 764:Src/pid.c     **** 							{
 3671              		.loc 1 764 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 102


 3672 044e B4F81C32 		ldrh	r3, [r4, #540]
 3673 0452 1BB2     		sxth	r3, r3
 3674 0454 0C2B     		cmp	r3, #12
 3675 0456 0AD1     		bne	.L253
 766:Src/pid.c     **** 								{
 3676              		.loc 1 766 0
 3677 0458 B4F86420 		ldrh	r2, [r4, #100]
 3678 045c B4F8E032 		ldrh	r3, [r4, #736]
 3679 0460 12B2     		sxth	r2, r2
 3680 0462 1BB2     		sxth	r3, r3
 3681 0464 9A42     		cmp	r2, r3
 3682 0466 12DD     		ble	.L255
 768:Src/pid.c     **** 								}
 3683              		.loc 1 768 0
 3684 0468 4FF46043 		mov	r3, #57344
 3685 046c 79E7     		b	.L307
 3686              	.L253:
 775:Src/pid.c     **** 							{
 3687              		.loc 1 775 0
 3688 046e B4F81C32 		ldrh	r3, [r4, #540]
 3689 0472 1BB2     		sxth	r3, r3
 3690 0474 0D2B     		cmp	r3, #13
 3691 0476 0AD1     		bne	.L255
 777:Src/pid.c     **** 								{
 3692              		.loc 1 777 0
 3693 0478 B4F86420 		ldrh	r2, [r4, #100]
 3694 047c B4F85833 		ldrh	r3, [r4, #856]
 3695 0480 12B2     		sxth	r2, r2
 3696 0482 1BB2     		sxth	r3, r3
 3697 0484 9A42     		cmp	r2, r3
 3698 0486 02DA     		bge	.L255
 779:Src/pid.c     **** 								}
 3699              		.loc 1 779 0
 3700 0488 4FF40053 		mov	r3, #8192
 3701 048c 69E7     		b	.L307
 3702              	.LVL229:
 3703              	.L255:
 788:Src/pid.c     **** 							}				
 3704              		.loc 1 788 0
 3705 048e 0023     		movs	r3, #0
 3706 0490 67E7     		b	.L307
 3707              	.L260:
 3708              	.LBE41:
 3709              	.LBE44:
1172:Src/pid.c     **** 	{
 3710              		.loc 1 1172 0
 3711 0492 B4F80222 		ldrh	r2, [r4, #514]
 3712 0496 12B2     		sxth	r2, r2
 3713 0498 012A     		cmp	r2, #1
 3714 049a 7FF4FBAE 		bne	.L207
 3715 049e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3716 04a0 002B     		cmp	r3, #0
 3717 04a2 7FF4F7AE 		bne	.L207
1174:Src/pid.c     **** 		s_Disable_Delay = 0;
 3718              		.loc 1 1174 0
 3719 04a6 194B     		ldr	r3, .L312+32
 3720 04a8 1A68     		ldr	r2, [r3]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 103


 3721 04aa 022A     		cmp	r2, #2
 3722 04ac DCBF     		itt	le
 3723 04ae 0132     		addle	r2, r2, #1
 3724 04b0 1A60     		strle	r2, [r3]
1176:Src/pid.c     **** 		{
 3725              		.loc 1 1176 0
 3726 04b2 1B68     		ldr	r3, [r3]
1175:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
 3727              		.loc 1 1175 0
 3728 04b4 164A     		ldr	r2, .L312+36
 3729 04b6 0021     		movs	r1, #0
1176:Src/pid.c     **** 		{
 3730              		.loc 1 1176 0
 3731 04b8 012B     		cmp	r3, #1
1175:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
 3732              		.loc 1 1175 0
 3733 04ba 1160     		str	r1, [r2]
1176:Src/pid.c     **** 		{
 3734              		.loc 1 1176 0
 3735 04bc 7FF4EAAE 		bne	.L207
1178:Src/pid.c     **** 			{
 3736              		.loc 1 1178 0
 3737 04c0 B4F80432 		ldrh	r3, [r4, #516]
 3738 04c4 1BB2     		sxth	r3, r3
 3739 04c6 022B     		cmp	r3, #2
 3740 04c8 04D0     		beq	.L268
 3741 04ca B4F80432 		ldrh	r3, [r4, #516]
 3742 04ce 1BB2     		sxth	r3, r3
 3743 04d0 012B     		cmp	r3, #1
 3744 04d2 04D1     		bne	.L269
 3745              	.L268:
1180:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 3746              		.loc 1 1180 0
 3747 04d4 0023     		movs	r3, #0
 3748 04d6 A4F84630 		strh	r3, [r4, #70]	@ movhi
1181:Src/pid.c     **** 			}
 3749              		.loc 1 1181 0
 3750 04da A4F84230 		strh	r3, [r4, #66]	@ movhi
 3751              	.L269:
1183:Src/pid.c     **** 			PWM_Enable();			
 3752              		.loc 1 1183 0
 3753 04de 0D4B     		ldr	r3, .L312+40
 3754 04e0 0022     		movs	r2, #0
 3755              	.LBE45:
 3756              	.LBE47:
 3757              		.loc 1 1489 0
 3758 04e2 BDE87040 		pop	{r4, r5, r6, lr}
 3759              	.LCFI19:
 3760              		.cfi_restore 14
 3761              		.cfi_restore 6
 3762              		.cfi_restore 5
 3763              		.cfi_restore 4
 3764              		.cfi_def_cfa_offset 0
 3765              	.LBB48:
 3766              	.LBB46:
1183:Src/pid.c     **** 			PWM_Enable();			
 3767              		.loc 1 1183 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 104


 3768 04e6 1A60     		str	r2, [r3]
1184:Src/pid.c     **** 		}
 3769              		.loc 1 1184 0
 3770 04e8 FFF7FEBF 		b	PWM_Enable
 3771              	.LVL230:
 3772              	.L313:
 3773              		.align	2
 3774              	.L312:
 3775 04ec 00000000 		.word	status_Mode_POSITION_FORCE
 3776 04f0 00000000 		.word	force_set
 3777 04f4 00000000 		.word	force_act
 3778 04f8 00000000 		.word	pid_force
 3779 04fc 00000000 		.word	.LANCHOR41
 3780 0500 00000000 		.word	.LANCHOR42
 3781 0504 00000000 		.word	.LANCHOR43
 3782 0508 00000000 		.word	g_flag_monitor_from_host
 3783 050c 00000000 		.word	.LANCHOR44
 3784 0510 00000000 		.word	.LANCHOR45
 3785 0514 00000000 		.word	g_Timer1CCR
 3786              	.LBE46:
 3787              	.LBE48:
 3788              		.cfi_endproc
 3789              	.LFE351:
 3791              		.global	Vel_PPS_raw1
 3792              		.comm	hall_total_time,8,8
 3793              		.global	hall_previous_3_time
 3794              		.global	hall_previous_2_time
 3795              		.global	hall_previous_1_time
 3796              		.global	hall_now_time
 3797              		.global	hall_cnt
 3798              		.global	hall_speed_sample_timeout
 3799              		.global	hall_speed_sample_cnt
 3800              		.global	hall_speed_sample_timeout_cnt
 3801              		.global	last_time4_capture_ch1
 3802              		.global	pid_hall_sample_time_index
 3803              		.comm	pid_hall_sample_time_point,40,4
 3804              		.comm	speed3,4,4
 3805              		.comm	speed2,4,4
 3806              		.comm	speed1,4,4
 3807              		.global	last_hall_sample_time
 3808              		.comm	pid_last_hall_ture_value1,4,4
 3809              		.comm	pid_hall_ture_value1,4,4
 3810              		.global	ServoPro_En_count
 3811              		.global	shunt_conductance2
 3812              		.global	shunt_conductance1
 3813              		.global	phase_current_rev_gain_
 3814              		.global	last_beta
 3815              		.global	last_alpha
 3816              		.comm	delata_beta,4,4
 3817              		.comm	delta_alpha,4,4
 3818              		.comm	I_Beta,4,4
 3819              		.comm	I_Alpha,4,4
 3820              		.global	s_Disable_Delay
 3821              		.comm	integre_observer_ElectricAngle,4,4
 3822              		.comm	observer_speed,4,4
 3823              		.comm	observer_ElectricAngle,4,4
 3824              		.comm	temp_L,4,4
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 105


 3825              		.comm	L,4,4
 3826              		.global	v
 3827              		.global	Id_filter
 3828              		.global	Iq_filter
 3829              		.global	Vq
 3830              		.global	dec_bemf
 3831              		.comm	pid_pll,72,8
 3832              		.comm	pid_pos,72,8
 3833              		.comm	pid_spd,72,8
 3834              		.comm	pid_force,72,8
 3835              		.comm	pid_ID,72,8
 3836              		.comm	pid_IQ,72,8
 3837              		.global	pos_error_to_target
 3838              		.global	T_t_1
 3839              		.global	T_t
 3840              		.global	Para_Identificaion
 3841              		.global	index_I_phase
 3842              		.global	I_phase
 3843              		.global	motor_para_identification_count_Tms
 3844              		.global	sin_wave_t_us
 3845              		.global	Test_dirt_last
 3846              		.global	Test_dirt
 3847              		.global	Test_perm
 3848              		.global	Flag_Set_OpenLen
 3849              		.global	Brake_rellease_delay_cnt
 3850              		.global	Brake_rellease_delay
 3851              		.global	Grriper_Run_off_delay_cnt
 3852              		.global	Grriper_Run_on_delay_cnt
 3853              		.global	Grriper_Run_last
 3854              		.global	Grriper_Run
 3855              		.global	Grriper_Ready
 3856              		.global	Spd_RPM_CatchLimit
 3857              		.comm	g_Z,4,4
 3858              		.comm	g_Y,4,4
 3859              		.comm	g_X,4,4
 3860              		.global	g_decLen
 3861              		.comm	anlge_reg,2,2
 3862              		.global	g_spd_error
 3863              		.comm	time4_capture_ch1,4,4
 3864              		.global	PosAtDead_Flag_Last
 3865              		.global	PosAtDead_Flag
 3866              		.global	g_posPID_e
 3867              		.global	g_testAngle
 3868              		.global	V_SetTotal
 3869              		.global	V_AddReg
 3870              		.global	g_Pos_Spd
 3871              		.global	g_Pos_PID_16BIT
 3872              		.global	Speed_I_out
 3873              		.global	Speed_P_out
 3874              		.global	g_Pos_Icnt
 3875              		.global	g_Spd_Icnt
 3876              		.global	g_Sector
 3877              		.global	g_V_Beta
 3878              		.global	g_V_Alpha
 3879              		.global	g_Vd_Pu
 3880              		.global	g_Vq_Pu
 3881              		.global	g_Vd
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 106


 3882              		.global	g_Vq
 3883              		.global	g_Id_sum
 3884              		.global	g_Iq_sum
 3885              		.global	g_I_Array_Index_Invalid
 3886              		.global	g_I_Array_Index
 3887              		.global	g_Id_Array
 3888              		.global	g_Iq_Array
 3889              		.comm	g_Id_filter,4,4
 3890              		.comm	g_Iq_filter,4,4
 3891              		.global	g_Id
 3892              		.global	g_Iq
 3893              		.global	g_Sum_ABC
 3894              		.global	g_IC_Raw
 3895              		.global	g_IC
 3896              		.global	g_IB_Raw
 3897              		.global	g_IB
 3898              		.global	g_IA_Raw
 3899              		.global	g_IA
 3900              		.section	.bss.Brake_rellease_delay,"aw",%nobits
 3903              	Brake_rellease_delay:
 3904 0000 00       		.space	1
 3905              		.section	.bss.Brake_rellease_delay_cnt,"aw",%nobits
 3906              		.align	2
 3909              	Brake_rellease_delay_cnt:
 3910 0000 00000000 		.space	4
 3911              		.section	.bss.Flag_Set_OpenLen,"aw",%nobits
 3912              		.set	.LANCHOR5,. + 0
 3915              	Flag_Set_OpenLen:
 3916 0000 00       		.space	1
 3917              		.section	.bss.Grriper_Ready,"aw",%nobits
 3920              	Grriper_Ready:
 3921 0000 00       		.space	1
 3922              		.section	.bss.Grriper_Run,"aw",%nobits
 3923              		.set	.LANCHOR4,. + 0
 3926              	Grriper_Run:
 3927 0000 00       		.space	1
 3928              		.section	.bss.Grriper_Run_last,"aw",%nobits
 3929              		.set	.LANCHOR6,. + 0
 3932              	Grriper_Run_last:
 3933 0000 00       		.space	1
 3934              		.section	.bss.Grriper_Run_off_delay_cnt,"aw",%nobits
 3935              		.align	2
 3938              	Grriper_Run_off_delay_cnt:
 3939 0000 00000000 		.space	4
 3940              		.section	.bss.Grriper_Run_on_delay_cnt,"aw",%nobits
 3941              		.align	2
 3944              	Grriper_Run_on_delay_cnt:
 3945 0000 00000000 		.space	4
 3946              		.section	.bss.I_phase,"aw",%nobits
 3947              		.align	2
 3948              		.set	.LANCHOR35,. + 0
 3951              	I_phase:
 3952 0000 00000000 		.space	1200
 3952      00000000 
 3952      00000000 
 3952      00000000 
 3952      00000000 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 107


 3953              		.section	.bss.Id_filter,"aw",%nobits
 3954              		.align	2
 3955              		.set	.LANCHOR28,. + 0
 3958              	Id_filter:
 3959 0000 00000000 		.space	4
 3960              		.section	.bss.Iq_filter,"aw",%nobits
 3961              		.align	2
 3962              		.set	.LANCHOR27,. + 0
 3965              	Iq_filter:
 3966 0000 00000000 		.space	4
 3967              		.section	.bss.Para_Identificaion,"aw",%nobits
 3968              		.align	2
 3969              		.set	.LANCHOR33,. + 0
 3972              	Para_Identificaion:
 3973 0000 00000000 		.space	4
 3974              		.section	.bss.PlusPosition_flag.12165,"aw",%nobits
 3975              		.set	.LANCHOR38,. + 0
 3978              	PlusPosition_flag.12165:
 3979 0000 00       		.space	1
 3980              		.section	.bss.PosAtDead_Flag,"aw",%nobits
 3981              		.set	.LANCHOR2,. + 0
 3984              	PosAtDead_Flag:
 3985 0000 00       		.space	1
 3986              		.section	.bss.PosAtDead_Flag_Last,"aw",%nobits
 3987              		.set	.LANCHOR3,. + 0
 3990              	PosAtDead_Flag_Last:
 3991 0000 00       		.space	1
 3992              		.section	.bss.ServoPro_En_count,"aw",%nobits
 3993              		.align	2
 3996              	ServoPro_En_count:
 3997 0000 00000000 		.space	4
 3998              		.section	.bss.Spd_RPM_CatchLimit,"aw",%nobits
 3999              		.align	1
 4002              	Spd_RPM_CatchLimit:
 4003 0000 0000     		.space	2
 4004              		.section	.bss.Speed_I_out,"aw",%nobits
 4005              		.align	2
 4008              	Speed_I_out:
 4009 0000 00000000 		.space	4
 4010              		.section	.bss.Speed_P_out,"aw",%nobits
 4011              		.align	2
 4014              	Speed_P_out:
 4015 0000 00000000 		.space	4
 4016              		.section	.bss.T_t,"aw",%nobits
 4017              		.align	3
 4018              		.set	.LANCHOR36,. + 0
 4021              	T_t:
 4022 0000 00000000 		.space	8
 4022      00000000 
 4023              		.section	.bss.T_t_1,"aw",%nobits
 4024              		.align	3
 4025              		.set	.LANCHOR37,. + 0
 4028              	T_t_1:
 4029 0000 00000000 		.space	8
 4029      00000000 
 4030              		.section	.bss.Test_perm,"aw",%nobits
 4031              		.set	.LANCHOR43,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 108


 4034              	Test_perm:
 4035 0000 00       		.space	1
 4036              		.section	.bss.V_AddReg,"aw",%nobits
 4037              		.align	2
 4040              	V_AddReg:
 4041 0000 00000000 		.space	4
 4042              		.section	.bss.V_SetTotal,"aw",%nobits
 4043              		.align	2
 4046              	V_SetTotal:
 4047 0000 00000000 		.space	4
 4048              		.section	.bss.Vel_PPS_raw1,"aw",%nobits
 4049              		.align	3
 4052              	Vel_PPS_raw1:
 4053 0000 00000000 		.space	8
 4053      00000000 
 4054              		.section	.bss.Vq,"aw",%nobits
 4055              		.align	2
 4056              		.set	.LANCHOR26,. + 0
 4059              	Vq:
 4060 0000 00000000 		.space	4
 4061              		.section	.bss.dec_bemf,"aw",%nobits
 4062              		.align	2
 4063              		.set	.LANCHOR29,. + 0
 4066              	dec_bemf:
 4067 0000 00000000 		.space	4
 4068              		.section	.bss.delay_cnt.12063,"aw",%nobits
 4069              		.align	1
 4070              		.set	.LANCHOR1,. + 0
 4073              	delay_cnt.12063:
 4074 0000 0000     		.space	2
 4075              		.section	.bss.g_IA,"aw",%nobits
 4076              		.align	1
 4077              		.set	.LANCHOR13,. + 0
 4080              	g_IA:
 4081 0000 0000     		.space	2
 4082              		.section	.bss.g_IA_Raw,"aw",%nobits
 4083              		.align	1
 4084              		.set	.LANCHOR12,. + 0
 4087              	g_IA_Raw:
 4088 0000 0000     		.space	2
 4089              		.section	.bss.g_IB,"aw",%nobits
 4090              		.align	1
 4091              		.set	.LANCHOR14,. + 0
 4094              	g_IB:
 4095 0000 0000     		.space	2
 4096              		.section	.bss.g_IB_Raw,"aw",%nobits
 4097              		.align	1
 4098              		.set	.LANCHOR10,. + 0
 4101              	g_IB_Raw:
 4102 0000 0000     		.space	2
 4103              		.section	.bss.g_IC,"aw",%nobits
 4104              		.align	1
 4105              		.set	.LANCHOR15,. + 0
 4108              	g_IC:
 4109 0000 0000     		.space	2
 4110              		.section	.bss.g_IC_Raw,"aw",%nobits
 4111              		.align	1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 109


 4112              		.set	.LANCHOR8,. + 0
 4115              	g_IC_Raw:
 4116 0000 0000     		.space	2
 4117              		.section	.bss.g_I_Array_Index,"aw",%nobits
 4118              		.align	2
 4121              	g_I_Array_Index:
 4122 0000 00000000 		.space	4
 4123              		.section	.bss.g_I_Array_Index_Invalid,"aw",%nobits
 4124              		.align	2
 4127              	g_I_Array_Index_Invalid:
 4128 0000 00000000 		.space	4
 4129              		.section	.bss.g_Id,"aw",%nobits
 4130              		.align	2
 4131              		.set	.LANCHOR19,. + 0
 4134              	g_Id:
 4135 0000 00000000 		.space	4
 4136              		.section	.bss.g_Id_Array,"aw",%nobits
 4137              		.align	2
 4140              	g_Id_Array:
 4141 0000 00000000 		.space	2048
 4141      00000000 
 4141      00000000 
 4141      00000000 
 4141      00000000 
 4142              		.section	.bss.g_Id_sum,"aw",%nobits
 4143              		.align	2
 4146              	g_Id_sum:
 4147 0000 00000000 		.space	4
 4148              		.section	.bss.g_Iq,"aw",%nobits
 4149              		.align	2
 4150              		.set	.LANCHOR18,. + 0
 4153              	g_Iq:
 4154 0000 00000000 		.space	4
 4155              		.section	.bss.g_Iq_Array,"aw",%nobits
 4156              		.align	2
 4159              	g_Iq_Array:
 4160 0000 00000000 		.space	2048
 4160      00000000 
 4160      00000000 
 4160      00000000 
 4160      00000000 
 4161              		.section	.bss.g_Iq_sum,"aw",%nobits
 4162              		.align	2
 4165              	g_Iq_sum:
 4166 0000 00000000 		.space	4
 4167              		.section	.bss.g_Pos_Icnt,"aw",%nobits
 4168              		.align	3
 4171              	g_Pos_Icnt:
 4172 0000 00000000 		.space	8
 4172      00000000 
 4173              		.section	.bss.g_Pos_PID_16BIT,"aw",%nobits
 4174              		.align	2
 4177              	g_Pos_PID_16BIT:
 4178 0000 00000000 		.space	4
 4179              		.section	.bss.g_Pos_Spd,"aw",%nobits
 4180              		.align	2
 4183              	g_Pos_Spd:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 110


 4184 0000 00000000 		.space	4
 4185              		.section	.bss.g_Sector,"aw",%nobits
 4186              		.align	2
 4187              		.set	.LANCHOR30,. + 0
 4190              	g_Sector:
 4191 0000 00000000 		.space	4
 4192              		.section	.bss.g_Spd_Icnt,"aw",%nobits
 4193              		.align	2
 4196              	g_Spd_Icnt:
 4197 0000 00000000 		.space	4
 4198              		.section	.bss.g_Sum_ABC,"aw",%nobits
 4199              		.align	1
 4202              	g_Sum_ABC:
 4203 0000 0000     		.space	2
 4204              		.section	.bss.g_V_Alpha,"aw",%nobits
 4205              		.align	2
 4206              		.set	.LANCHOR23,. + 0
 4209              	g_V_Alpha:
 4210 0000 00000000 		.space	4
 4211              		.section	.bss.g_V_Beta,"aw",%nobits
 4212              		.align	2
 4213              		.set	.LANCHOR24,. + 0
 4216              	g_V_Beta:
 4217 0000 00000000 		.space	4
 4218              		.section	.bss.g_Vd,"aw",%nobits
 4219              		.align	2
 4220              		.set	.LANCHOR22,. + 0
 4223              	g_Vd:
 4224 0000 00000000 		.space	4
 4225              		.section	.bss.g_Vd_Pu,"aw",%nobits
 4226              		.align	2
 4229              	g_Vd_Pu:
 4230 0000 00000000 		.space	4
 4231              		.section	.bss.g_Vq,"aw",%nobits
 4232              		.align	2
 4233              		.set	.LANCHOR21,. + 0
 4236              	g_Vq:
 4237 0000 00000000 		.space	4
 4238              		.section	.bss.g_Vq_Pu,"aw",%nobits
 4239              		.align	2
 4242              	g_Vq_Pu:
 4243 0000 00000000 		.space	4
 4244              		.section	.bss.g_decLen,"aw",%nobits
 4245              		.align	2
 4248              	g_decLen:
 4249 0000 00000000 		.space	4
 4250              		.section	.bss.g_posPID_e,"aw",%nobits
 4251              		.align	2
 4254              	g_posPID_e:
 4255 0000 00000000 		.space	4
 4256              		.section	.bss.g_spd_error,"aw",%nobits
 4257              		.align	2
 4260              	g_spd_error:
 4261 0000 00000000 		.space	4
 4262              		.section	.bss.g_testAngle,"aw",%nobits
 4263              		.align	1
 4266              	g_testAngle:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 111


 4267 0000 0000     		.space	2
 4268              		.section	.bss.hall_cnt,"aw",%nobits
 4269              		.align	2
 4272              	hall_cnt:
 4273 0000 00000000 		.space	4
 4274              		.section	.bss.hall_now_time,"aw",%nobits
 4275              		.align	2
 4278              	hall_now_time:
 4279 0000 00000000 		.space	4
 4280              		.section	.bss.hall_previous_1_time,"aw",%nobits
 4281              		.align	2
 4284              	hall_previous_1_time:
 4285 0000 00000000 		.space	4
 4286              		.section	.bss.hall_previous_2_time,"aw",%nobits
 4287              		.align	2
 4290              	hall_previous_2_time:
 4291 0000 00000000 		.space	4
 4292              		.section	.bss.hall_previous_3_time,"aw",%nobits
 4293              		.align	2
 4296              	hall_previous_3_time:
 4297 0000 00000000 		.space	4
 4298              		.section	.bss.hall_speed_sample_cnt,"aw",%nobits
 4299              		.align	2
 4302              	hall_speed_sample_cnt:
 4303 0000 00000000 		.space	4
 4304              		.section	.bss.hall_speed_sample_timeout,"aw",%nobits
 4305              		.align	2
 4308              	hall_speed_sample_timeout:
 4309 0000 00000000 		.space	4
 4310              		.section	.bss.hall_speed_sample_timeout_cnt,"aw",%nobits
 4311              		.align	2
 4314              	hall_speed_sample_timeout_cnt:
 4315 0000 00000000 		.space	4
 4316              		.section	.bss.index_I_phase,"aw",%nobits
 4317              		.align	2
 4318              		.set	.LANCHOR34,. + 0
 4321              	index_I_phase:
 4322 0000 00000000 		.space	4
 4323              		.section	.bss.last_alpha,"aw",%nobits
 4324              		.align	2
 4325              		.set	.LANCHOR16,. + 0
 4328              	last_alpha:
 4329 0000 00000000 		.space	4
 4330              		.section	.bss.last_beta,"aw",%nobits
 4331              		.align	2
 4332              		.set	.LANCHOR17,. + 0
 4335              	last_beta:
 4336 0000 00000000 		.space	4
 4337              		.section	.bss.last_hall_sample_time,"aw",%nobits
 4338              		.align	2
 4341              	last_hall_sample_time:
 4342 0000 00000000 		.space	4
 4343              		.section	.bss.last_time4_capture_ch1,"aw",%nobits
 4344              		.align	2
 4347              	last_time4_capture_ch1:
 4348 0000 00000000 		.space	4
 4349              		.section	.bss.motor_para_identification_count_Tms,"aw",%nobits
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 112


 4350              		.align	2
 4351              		.set	.LANCHOR31,. + 0
 4354              	motor_para_identification_count_Tms:
 4355 0000 00000000 		.space	4
 4356              		.section	.bss.pid_hall_sample_time_index,"aw",%nobits
 4357              		.align	2
 4360              	pid_hall_sample_time_index:
 4361 0000 00000000 		.space	4
 4362              		.section	.bss.pos_error_to_target,"aw",%nobits
 4363              		.align	2
 4364              		.set	.LANCHOR0,. + 0
 4367              	pos_error_to_target:
 4368 0000 00000000 		.space	4
 4369              		.section	.bss.s_Disable_Delay,"aw",%nobits
 4370              		.align	2
 4371              		.set	.LANCHOR45,. + 0
 4374              	s_Disable_Delay:
 4375 0000 00000000 		.space	4
 4376              		.section	.bss.s_Enable_Delay.12102,"aw",%nobits
 4377              		.align	2
 4378              		.set	.LANCHOR44,. + 0
 4381              	s_Enable_Delay.12102:
 4382 0000 00000000 		.space	4
 4383              		.section	.bss.s_count.12101,"aw",%nobits
 4384              		.align	2
 4385              		.set	.LANCHOR40,. + 0
 4388              	s_count.12101:
 4389 0000 00000000 		.space	4
 4390              		.section	.bss.s_count.12166,"aw",%nobits
 4391              		.align	2
 4392              		.set	.LANCHOR39,. + 0
 4395              	s_count.12166:
 4396 0000 00000000 		.space	4
 4397              		.section	.bss.s_test_speed_t_count.12058,"aw",%nobits
 4398              		.align	2
 4399              		.set	.LANCHOR42,. + 0
 4402              	s_test_speed_t_count.12058:
 4403 0000 00000000 		.space	4
 4404              		.section	.bss.sin_wave_t_us,"aw",%nobits
 4405              		.align	2
 4406              		.set	.LANCHOR32,. + 0
 4409              	sin_wave_t_us:
 4410 0000 00000000 		.space	4
 4411              		.section	.bss.test.12035,"aw",%nobits
 4412              		.align	1
 4413              		.set	.LANCHOR25,. + 0
 4416              	test.12035:
 4417 0000 0000     		.space	2
 4418              		.section	.data.Test_dirt,"aw",%progbits
 4419              		.align	2
 4420              		.set	.LANCHOR41,. + 0
 4423              	Test_dirt:
 4424 0000 01000000 		.word	1
 4425              		.section	.data.Test_dirt_last,"aw",%progbits
 4426              		.align	2
 4429              	Test_dirt_last:
 4430 0000 01000000 		.word	1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 113


 4431              		.section	.data.phase_current_rev_gain_,"aw",%progbits
 4432              		.align	2
 4433              		.set	.LANCHOR7,. + 0
 4436              	phase_current_rev_gain_:
 4437 0000 103E783D 		.word	1031290384
 4438              		.section	.data.shunt_conductance1,"aw",%progbits
 4439              		.align	2
 4440              		.set	.LANCHOR11,. + 0
 4443              	shunt_conductance1:
 4444 0000 0D4AA542 		.word	1118128653
 4445              		.section	.data.shunt_conductance2,"aw",%progbits
 4446              		.align	2
 4447              		.set	.LANCHOR9,. + 0
 4450              	shunt_conductance2:
 4451 0000 74D1B542 		.word	1119211892
 4452              		.section	.data.v,"aw",%progbits
 4453              		.align	2
 4454              		.set	.LANCHOR20,. + 0
 4457              	v:
 4458 0000 A4703D41 		.word	1094545572
 4459              		.text
 4460              	.Letext0:
 4461              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4462              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4463              		.file 4 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 4464              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 4465              		.file 6 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/system_stm32g4xx.h"
 4466              		.file 7 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 4467              		.file 8 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g4xx.h"
 4468              		.file 9 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 4469              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 4470              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc.h"
 4471              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_exti.h"
 4472              		.file 13 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_flash.h"
 4473              		.file 14 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 4474              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim.h"
 4475              		.file 16 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 4476              		.file 17 "Inc/pid.h"
 4477              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4478              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4479              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 4480              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4481              		.file 22 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4482              		.file 23 "Inc/uart.h"
 4483              		.file 24 "Inc/pwm.h"
 4484              		.file 25 "Inc/spi_MEncoder.h"
 4485              		.file 26 "Inc/adc.h"
 4486              		.file 27 "Inc/stm32_math_sin.h"
 4487              		.file 28 "Inc/profile_joint.h"
 4488              		.file 29 "Inc/icmu.h"
 4489              		.file 30 "Inc/performance_test.h"
 4490              		.file 31 "Inc/global.h"
 4491              		.file 32 "Inc/sensorless.h"
 4492              		.file 33 "Inc/security.h"
 4493              		.file 34 "Inc/stm32_math.h"
 4494              		.file 35 "Inc/parameter_identification.h"
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 114


DEFINED SYMBOLS
                            *ABS*:00000000 pid.c
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:18     .text.PID_ini:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:25     .text.PID_ini:00000000 PID_ini
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:47     .text.PID_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:54     .text.PID_control:00000000 PID_control
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:245    .text.PID_control:00000104 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:252    .text.force_PID_out:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:259    .text.force_PID_out:00000000 force_PID_out
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:317    .text.PositionPID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:324    .text.PositionPID:00000000 PositionPID
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:453    .text.PositionPID:000000b4 $d
                            *COM*:00000048 pid_pos
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:466    .text.Gripper_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:473    .text.Gripper_control:00000000 Gripper_control
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:688    .text.Gripper_control:0000011c $d
                            *COM*:00000048 pid_spd
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:707    .text.phase_current_from_adcval:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:714    .text.phase_current_from_adcval:00000000 phase_current_from_adcval
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:740    .text.phase_current_from_adcval:0000001c $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:746    .text.GetCurrent:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:753    .text.GetCurrent:00000000 GetCurrent
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:992    .text.GetCurrent:00000190 $d
                            *COM*:00000004 I_Beta
                            *COM*:00000004 I_Alpha
                            *COM*:00000004 delta_alpha
                            *COM*:00000004 delata_beta
                            *COM*:00000048 pid_IQ
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1024   .text.park_transform:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1031   .text.park_transform:00000000 park_transform
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1103   .text.park_transform:00000054 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1114   .text.hfi_update_angle:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1121   .text.hfi_update_angle:00000000 hfi_update_angle
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1343   .text.hfi_update_angle:00000160 $d
                            *COM*:00000048 pid_pll
                            *COM*:00000004 L
                            *COM*:00000004 observer_ElectricAngle
                            *COM*:00000004 temp_L
                            *COM*:00000004 observer_speed
                            *COM*:00000004 integre_observer_ElectricAngle
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1371   .text.ServoPro_Fast:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1378   .text.ServoPro_Fast:00000000 ServoPro_Fast
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1722   .text.ServoPro_Fast:000001ec $d
                            *COM*:00000002 anlge_reg
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:1745   .text.ServoPro_Fast:00000240 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2138   .text.ServoPro_Fast:00000520 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2145   .text.ServoPro_Fast:0000052c $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2188   .text.ServoPro_Fast:00000578 $d
                            *COM*:00000004 g_X
                            *COM*:00000004 g_Y
                            *COM*:00000004 g_Z
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2211   .text.ServoPro_Fast:000005cc $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2642   .text.ServoPro_Fast:00000888 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2665   .text.Loop3_EnableManage:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2672   .text.Loop3_EnableManage:00000000 Loop3_EnableManage
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2799   .text.Loop3_EnableManage:000000bc $d
                            *COM*:00000048 pid_ID
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 115


                            *COM*:00000048 pid_force
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2810   .text.work_var_updata:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2817   .text.work_var_updata:00000000 work_var_updata
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2986   .text.work_var_updata:0000011c $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:2999   .text.EXTI3_IRQHandler:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3006   .text.EXTI3_IRQHandler:00000000 EXTI3_IRQHandler
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3424   .text.EXTI3_IRQHandler:00000298 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3450   .text.EXTI3_IRQHandler:000002e4 $t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3775   .text.EXTI3_IRQHandler:000004ec $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4052   .bss.Vel_PPS_raw1:00000000 Vel_PPS_raw1
                            *COM*:00000008 hall_total_time
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4296   .bss.hall_previous_3_time:00000000 hall_previous_3_time
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4290   .bss.hall_previous_2_time:00000000 hall_previous_2_time
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4284   .bss.hall_previous_1_time:00000000 hall_previous_1_time
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4278   .bss.hall_now_time:00000000 hall_now_time
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4272   .bss.hall_cnt:00000000 hall_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4308   .bss.hall_speed_sample_timeout:00000000 hall_speed_sample_timeout
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4302   .bss.hall_speed_sample_cnt:00000000 hall_speed_sample_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4314   .bss.hall_speed_sample_timeout_cnt:00000000 hall_speed_sample_timeout_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4347   .bss.last_time4_capture_ch1:00000000 last_time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4360   .bss.pid_hall_sample_time_index:00000000 pid_hall_sample_time_index
                            *COM*:00000028 pid_hall_sample_time_point
                            *COM*:00000004 speed3
                            *COM*:00000004 speed2
                            *COM*:00000004 speed1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4341   .bss.last_hall_sample_time:00000000 last_hall_sample_time
                            *COM*:00000004 pid_last_hall_ture_value1
                            *COM*:00000004 pid_hall_ture_value1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3996   .bss.ServoPro_En_count:00000000 ServoPro_En_count
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4450   .data.shunt_conductance2:00000000 shunt_conductance2
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4443   .data.shunt_conductance1:00000000 shunt_conductance1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4436   .data.phase_current_rev_gain_:00000000 phase_current_rev_gain_
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4335   .bss.last_beta:00000000 last_beta
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4328   .bss.last_alpha:00000000 last_alpha
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4374   .bss.s_Disable_Delay:00000000 s_Disable_Delay
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4457   .data.v:00000000 v
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3958   .bss.Id_filter:00000000 Id_filter
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3965   .bss.Iq_filter:00000000 Iq_filter
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4059   .bss.Vq:00000000 Vq
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4066   .bss.dec_bemf:00000000 dec_bemf
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4367   .bss.pos_error_to_target:00000000 pos_error_to_target
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4028   .bss.T_t_1:00000000 T_t_1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4021   .bss.T_t:00000000 T_t
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3972   .bss.Para_Identificaion:00000000 Para_Identificaion
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4321   .bss.index_I_phase:00000000 index_I_phase
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3951   .bss.I_phase:00000000 I_phase
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4354   .bss.motor_para_identification_count_Tms:00000000 motor_para_identification_count_Tms
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4409   .bss.sin_wave_t_us:00000000 sin_wave_t_us
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4429   .data.Test_dirt_last:00000000 Test_dirt_last
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4423   .data.Test_dirt:00000000 Test_dirt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4034   .bss.Test_perm:00000000 Test_perm
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3915   .bss.Flag_Set_OpenLen:00000000 Flag_Set_OpenLen
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3909   .bss.Brake_rellease_delay_cnt:00000000 Brake_rellease_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3903   .bss.Brake_rellease_delay:00000000 Brake_rellease_delay
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3938   .bss.Grriper_Run_off_delay_cnt:00000000 Grriper_Run_off_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3944   .bss.Grriper_Run_on_delay_cnt:00000000 Grriper_Run_on_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3932   .bss.Grriper_Run_last:00000000 Grriper_Run_last
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 116


C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3926   .bss.Grriper_Run:00000000 Grriper_Run
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3920   .bss.Grriper_Ready:00000000 Grriper_Ready
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4002   .bss.Spd_RPM_CatchLimit:00000000 Spd_RPM_CatchLimit
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4248   .bss.g_decLen:00000000 g_decLen
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4260   .bss.g_spd_error:00000000 g_spd_error
                            *COM*:00000004 time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3990   .bss.PosAtDead_Flag_Last:00000000 PosAtDead_Flag_Last
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3984   .bss.PosAtDead_Flag:00000000 PosAtDead_Flag
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4254   .bss.g_posPID_e:00000000 g_posPID_e
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4266   .bss.g_testAngle:00000000 g_testAngle
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4046   .bss.V_SetTotal:00000000 V_SetTotal
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4040   .bss.V_AddReg:00000000 V_AddReg
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4183   .bss.g_Pos_Spd:00000000 g_Pos_Spd
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4177   .bss.g_Pos_PID_16BIT:00000000 g_Pos_PID_16BIT
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4008   .bss.Speed_I_out:00000000 Speed_I_out
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4014   .bss.Speed_P_out:00000000 Speed_P_out
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4171   .bss.g_Pos_Icnt:00000000 g_Pos_Icnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4196   .bss.g_Spd_Icnt:00000000 g_Spd_Icnt
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4190   .bss.g_Sector:00000000 g_Sector
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4216   .bss.g_V_Beta:00000000 g_V_Beta
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4209   .bss.g_V_Alpha:00000000 g_V_Alpha
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4229   .bss.g_Vd_Pu:00000000 g_Vd_Pu
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4242   .bss.g_Vq_Pu:00000000 g_Vq_Pu
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4223   .bss.g_Vd:00000000 g_Vd
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4236   .bss.g_Vq:00000000 g_Vq
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4146   .bss.g_Id_sum:00000000 g_Id_sum
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4165   .bss.g_Iq_sum:00000000 g_Iq_sum
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4127   .bss.g_I_Array_Index_Invalid:00000000 g_I_Array_Index_Invalid
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4121   .bss.g_I_Array_Index:00000000 g_I_Array_Index
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4140   .bss.g_Id_Array:00000000 g_Id_Array
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4159   .bss.g_Iq_Array:00000000 g_Iq_Array
                            *COM*:00000004 g_Id_filter
                            *COM*:00000004 g_Iq_filter
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4134   .bss.g_Id:00000000 g_Id
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4153   .bss.g_Iq:00000000 g_Iq
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4202   .bss.g_Sum_ABC:00000000 g_Sum_ABC
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4115   .bss.g_IC_Raw:00000000 g_IC_Raw
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4108   .bss.g_IC:00000000 g_IC
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4101   .bss.g_IB_Raw:00000000 g_IB_Raw
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4094   .bss.g_IB:00000000 g_IB
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4087   .bss.g_IA_Raw:00000000 g_IA_Raw
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4080   .bss.g_IA:00000000 g_IA
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3904   .bss.Brake_rellease_delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3906   .bss.Brake_rellease_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3916   .bss.Flag_Set_OpenLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3921   .bss.Grriper_Ready:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3927   .bss.Grriper_Run:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3933   .bss.Grriper_Run_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3935   .bss.Grriper_Run_off_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3941   .bss.Grriper_Run_on_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3947   .bss.I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3954   .bss.Id_filter:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3961   .bss.Iq_filter:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3968   .bss.Para_Identificaion:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3978   .bss.PlusPosition_flag.12165:00000000 PlusPosition_flag.12165
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3979   .bss.PlusPosition_flag.12165:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3985   .bss.PosAtDead_Flag:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 117


C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3991   .bss.PosAtDead_Flag_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3993   .bss.ServoPro_En_count:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:3999   .bss.Spd_RPM_CatchLimit:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4005   .bss.Speed_I_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4011   .bss.Speed_P_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4017   .bss.T_t:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4024   .bss.T_t_1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4035   .bss.Test_perm:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4037   .bss.V_AddReg:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4043   .bss.V_SetTotal:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4049   .bss.Vel_PPS_raw1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4055   .bss.Vq:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4062   .bss.dec_bemf:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4069   .bss.delay_cnt.12063:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4073   .bss.delay_cnt.12063:00000000 delay_cnt.12063
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4076   .bss.g_IA:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4083   .bss.g_IA_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4090   .bss.g_IB:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4097   .bss.g_IB_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4104   .bss.g_IC:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4111   .bss.g_IC_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4118   .bss.g_I_Array_Index:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4124   .bss.g_I_Array_Index_Invalid:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4130   .bss.g_Id:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4137   .bss.g_Id_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4143   .bss.g_Id_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4149   .bss.g_Iq:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4156   .bss.g_Iq_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4162   .bss.g_Iq_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4168   .bss.g_Pos_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4174   .bss.g_Pos_PID_16BIT:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4180   .bss.g_Pos_Spd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4186   .bss.g_Sector:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4193   .bss.g_Spd_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4199   .bss.g_Sum_ABC:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4205   .bss.g_V_Alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4212   .bss.g_V_Beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4219   .bss.g_Vd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4226   .bss.g_Vd_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4232   .bss.g_Vq:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4239   .bss.g_Vq_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4245   .bss.g_decLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4251   .bss.g_posPID_e:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4257   .bss.g_spd_error:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4263   .bss.g_testAngle:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4269   .bss.hall_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4275   .bss.hall_now_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4281   .bss.hall_previous_1_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4287   .bss.hall_previous_2_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4293   .bss.hall_previous_3_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4299   .bss.hall_speed_sample_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4305   .bss.hall_speed_sample_timeout:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4311   .bss.hall_speed_sample_timeout_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4317   .bss.index_I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4324   .bss.last_alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4331   .bss.last_beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4338   .bss.last_hall_sample_time:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 118


C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4344   .bss.last_time4_capture_ch1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4350   .bss.motor_para_identification_count_Tms:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4357   .bss.pid_hall_sample_time_index:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4363   .bss.pos_error_to_target:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4370   .bss.s_Disable_Delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4377   .bss.s_Enable_Delay.12102:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4381   .bss.s_Enable_Delay.12102:00000000 s_Enable_Delay.12102
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4384   .bss.s_count.12101:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4388   .bss.s_count.12101:00000000 s_count.12101
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4391   .bss.s_count.12166:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4395   .bss.s_count.12166:00000000 s_count.12166
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4398   .bss.s_test_speed_t_count.12058:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4402   .bss.s_test_speed_t_count.12058:00000000 s_test_speed_t_count.12058
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4405   .bss.sin_wave_t_us:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4412   .bss.test.12035:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4416   .bss.test.12035:00000000 test.12035
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4419   .data.Test_dirt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4426   .data.Test_dirt_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4432   .data.phase_current_rev_gain_:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4439   .data.shunt_conductance1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4446   .data.shunt_conductance2:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s:4453   .data.v:00000000 $d

UNDEFINED SYMBOLS
g_CmdMap
gPos_ds
Profile_moving
flag_posReg_strengthen
Profile_ParaSet
Profile
Gripper_Move
Motor_forbidden
Flag_contact
Flag_grip_F_OK
Flag_grip_P_OK
Flag_rellease_P_OK
tCnt_f
g_pos_tag
Flag_Profile_Enable
update_current_meas
Q15_MUL
Math_Sin_EN360
Math_Cos_EN360
g_ZeroCur_MotorC
g_ZeroCur_MotorB
g_ZeroCur_MotorA
motor_
g_ElectricAngle
g_bEnableHB
g_pCur_ref_base_mA
g_high_fre_pulse
__aeabi_f2d
__aeabi_dmul
__aeabi_i2d
__aeabi_ddiv
__aeabi_d2f
EN_90
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccF2ejZx.s 			page 119


__aeabi_d2uiz
GetElectricAngle
measure_R
update_current_control
PWM_OutPut_Open
motor_fault_check
non_linear_flux_observer
encode_sample
sensorless_sensor_phase_switch
g_Timer1CCR
EN_0
EN_360
bus_voltage_
sqrtf
Q16_MUL
flag_processing_Jtest
state_Jtest
g_Sector_test
log
HAL_EXTI_GenerateSWI
g_Encode_offset
g_ThreeLoopParaBefLock
MTPro
get_average_force_data
icmu_sdtransmission_test
Get_Pos_Rod
Stroke_protection
PWM_Disable
g_servo_cmd_period_cnt
force_set
force_act
status_Mode_POSITION_FORCE
Flag_1ms
s_count_50ms
Flag_50ms
Motor_emergercy_stop
Motor_pause_flag
PWM_Enable
g_flag_monitor_from_host
