ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pid.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.OpenLoop,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	OpenLoop:
  25              	.LFB343:
  26              		.file 1 "Src/pid.c"
   1:Src/pid.c     **** #include "pid.h"
   2:Src/pid.c     **** #include "global.h"
   3:Src/pid.c     **** #include "icmu.h"
   4:Src/pid.c     **** #include "parameter_identification.h"
   5:Src/pid.c     **** 
   6:Src/pid.c     **** //#include "ouj_cmd.h"
   7:Src/pid.c     **** //3ï¿½Õ»ï¿½ï¿½Å·ï¿½ï¿½ï¿½Ø²ï¿½ï¿½ï¿½
   8:Src/pid.c     **** s16 g_IA = 0,g_IA_Raw = 0;			        
   9:Src/pid.c     **** s16 g_IB = 0,g_IB_Raw = 0;			        
  10:Src/pid.c     **** s16 g_IC = 0,g_IC_Raw = 0;
  11:Src/pid.c     **** s16 g_Sum_ABC = 0;
  12:Src/pid.c     **** volatile s32  g_Iq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  13:Src/pid.c     **** volatile s32  g_Id = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  14:Src/pid.c     **** volatile s32 g_Iq_filter;			// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  15:Src/pid.c     **** volatile s32 g_Id_filter;			// Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  16:Src/pid.c     **** volatile s32  g_Iq_Array[CUR_ARRAY_NUM] = {0};			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  17:Src/pid.c     **** volatile s32  g_Id_Array[CUR_ARRAY_NUM] = {0};			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  18:Src/pid.c     **** volatile s32 g_I_Array_Index = 0;
  19:Src/pid.c     **** volatile s32 g_I_Array_Index_Invalid = 0;
  20:Src/pid.c     **** volatile s32 g_Iq_sum = 0;
  21:Src/pid.c     **** volatile s32 g_Id_sum = 0;
  22:Src/pid.c     **** s32 g_Vq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹
  23:Src/pid.c     **** s32 g_Vd = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  24:Src/pid.c     **** s32 g_Vq_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  25:Src/pid.c     **** s32 g_Vd_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  26:Src/pid.c     **** s32 g_V_Alpha = 0;
  27:Src/pid.c     **** s32 g_V_Beta = 0;
  28:Src/pid.c     **** 
  29:Src/pid.c     **** s32 g_Sector = 0;		      // ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  30:Src/pid.c     **** float g_Spd_Icnt = 0;		    // ï¿½Ù¶ï¿½Iï¿½Û»ï¿½Öµ
  31:Src/pid.c     **** int64_t g_Pos_Icnt = 0;       // Î»ï¿½Ã»ï¿½Iï¿½Û»ï¿½Öµ
  32:Src/pid.c     **** float Speed_P_out = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 2


  33:Src/pid.c     **** float Speed_I_out = 0;
  34:Src/pid.c     **** s32 g_Pos_PID_16BIT = 0;  // Î»ï¿½Ã»ï¿½PIï¿½ï¿½
  35:Src/pid.c     **** s32 g_Pos_Spd = 0;        // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ
  36:Src/pid.c     **** volatile s32 V_AddReg = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿½ï
  37:Src/pid.c     **** volatile s32 V_SetTotal = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿
  38:Src/pid.c     **** 
  39:Src/pid.c     **** 
  40:Src/pid.c     **** s16 g_testAngle = 0;           //
  41:Src/pid.c     **** 
  42:Src/pid.c     **** 
  43:Src/pid.c     **** //u8 SpeedPID_Enable = 0;
  44:Src/pid.c     **** //u8 PostionPID_Enable = 0;
  45:Src/pid.c     **** s32 g_posPID_e = 0;
  46:Src/pid.c     **** u8 PosAtDead_Flag = 0;
  47:Src/pid.c     **** u8 PosAtDead_Flag_Last = 0;
  48:Src/pid.c     **** 
  49:Src/pid.c     **** volatile int time4_capture_ch1;
  50:Src/pid.c     **** extern int g_ElectricAngle_add ;
  51:Src/pid.c     **** extern float  pll_estimated_spd;
  52:Src/pid.c     **** extern float pll_estimated_phase ;
  53:Src/pid.c     **** 
  54:Src/pid.c     **** 
  55:Src/pid.c     **** s32 g_spd_error = 0;           //
  56:Src/pid.c     **** extern volatile int32_t SPI_X[9] ;
  57:Src/pid.c     **** extern volatile int32_t SPI_Y[9];
  58:Src/pid.c     **** extern volatile int16_t SPI_0_Array[250];
  59:Src/pid.c     **** s16 anlge_reg;
  60:Src/pid.c     **** s32 g_decLen = 0;
  61:Src/pid.c     **** s32 g_X, g_Y, g_Z;
  62:Src/pid.c     **** s16 Spd_RPM_CatchLimit = 0;//ï¿½Ð³ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½
  63:Src/pid.c     **** //ï¿½ï¿½ï¿½ï¿½ï¿½Õ¢ï¿½ß¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½ï¿½ï¿½
  64:Src/pid.c     **** volatile u8 Grriper_Ready = 0;
  65:Src/pid.c     **** volatile u8 Grriper_Run = 0,Grriper_Run_last = 0;
  66:Src/pid.c     **** volatile s32 Grriper_Run_on_delay_cnt = 0,Grriper_Run_off_delay_cnt = 0;
  67:Src/pid.c     **** volatile u8  Brake_rellease_delay = 0;
  68:Src/pid.c     **** volatile s32 Brake_rellease_delay_cnt = 0;
  69:Src/pid.c     **** volatile u8  Flag_Set_OpenLen = 0;
  70:Src/pid.c     **** volatile u8 Test_perm = 0;
  71:Src/pid.c     **** volatile s32 Test_dirt = 1;
  72:Src/pid.c     **** volatile s32 Test_dirt_last = 1;
  73:Src/pid.c     **** volatile s32 sin_wave_t_us = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê± us
  74:Src/pid.c     **** volatile s32 motor_para_identification_count_Tms = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  75:Src/pid.c     **** volatile s32 I_phase[3][100] = {0};//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  76:Src/pid.c     **** volatile s32 index_I_phase = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  77:Src/pid.c     **** volatile s32 Para_Identificaion = 0;
  78:Src/pid.c     **** double T_t = 0.0;
  79:Src/pid.c     **** double T_t_1 = 0.0;
  80:Src/pid.c     **** volatile s32 pos_error_to_target = 0;
  81:Src/pid.c     **** struct PID_TYPE pid_IQ,pid_ID,pid_force,pid_spd,pid_pos,pid_pll;
  82:Src/pid.c     **** 
  83:Src/pid.c     **** void hfi_update_angle(void);
  84:Src/pid.c     **** void PID_ini(struct PID_TYPE * p_pid,u32 freq)   //PID
  85:Src/pid.c     **** {
  86:Src/pid.c     **** 		p_pid->integral = 0;
  87:Src/pid.c     **** 		p_pid->error = 0;
  88:Src/pid.c     **** 		p_pid->error_last = 0;
  89:Src/pid.c     **** 		p_pid->out = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 3


  90:Src/pid.c     **** 		p_pid->frequency = freq;
  91:Src/pid.c     **** }
  92:Src/pid.c     **** void PID_control(s32 set,s32 act,struct PID_TYPE * p_pid)   //PID
  93:Src/pid.c     **** {
  94:Src/pid.c     **** 	s32 deriv=0;
  95:Src/pid.c     **** 	
  96:Src/pid.c     **** 	if(p_pid->enable == 0)
  97:Src/pid.c     **** 	{
  98:Src/pid.c     **** 		p_pid->integral = 0;
  99:Src/pid.c     **** 		p_pid->error = 0;
 100:Src/pid.c     **** 		p_pid->error_last = 0;
 101:Src/pid.c     **** 		p_pid->out = 0;
 102:Src/pid.c     **** 		p_pid->Part_P = 0;
 103:Src/pid.c     **** 		p_pid->Part_I = 0;
 104:Src/pid.c     **** 		p_pid->Part_D = 0;
 105:Src/pid.c     **** 		return;
 106:Src/pid.c     **** 	}
 107:Src/pid.c     **** 	p_pid->error = set - act; 
 108:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 109:Src/pid.c     **** 	{
 110:Src/pid.c     **** 		p_pid->is_at_dead_zone = 1;
 111:Src/pid.c     **** 		p_pid->error = 0;
 112:Src/pid.c     **** 	}	
 113:Src/pid.c     **** 	if ((p_pid->out < p_pid->Up_limit && p_pid->out > p_pid->Low_limit) ||
 114:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 115:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 116:Src/pid.c     **** 	{
 117:Src/pid.c     **** //		if(p_pid->Ki>1000)
 118:Src/pid.c     **** //		{
 119:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*(p_pid->Ki/100));
 120:Src/pid.c     **** //		}
 121:Src/pid.c     **** //		else
 122:Src/pid.c     **** //		{
 123:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*p_pid->Ki);
 124:Src/pid.c     **** //		}
 125:Src/pid.c     **** 		if(p_pid->Ki>1000)
 126:Src/pid.c     **** 		{
 127:Src/pid.c     **** 			p_pid->integral += (p_pid->error*(p_pid->Ki/100));
 128:Src/pid.c     **** 		}
 129:Src/pid.c     **** 		else
 130:Src/pid.c     **** 		{
 131:Src/pid.c     **** 			p_pid->integral += (p_pid->error*p_pid->Ki);
 132:Src/pid.c     **** 		}
 133:Src/pid.c     **** 	}
 134:Src/pid.c     **** 	p_pid->Part_P = p_pid->error * p_pid->Kp/100;
 135:Src/pid.c     **** 	
 136:Src/pid.c     **** 	
 137:Src/pid.c     **** //	if(p_pid->Ki>1000)
 138:Src/pid.c     **** //	{
 139:Src/pid.c     **** //		p_pid->Part_I = (s32)(100.0f*p_pid->integral/(float)p_pid->frequency);
 140:Src/pid.c     **** //	}
 141:Src/pid.c     **** //	else
 142:Src/pid.c     **** //	{
 143:Src/pid.c     **** //		p_pid->Part_I = (s32)(p_pid->integral/(float)p_pid->frequency);
 144:Src/pid.c     **** //	}
 145:Src/pid.c     **** 	if(p_pid->Ki>1000)
 146:Src/pid.c     **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 4


 147:Src/pid.c     **** 		p_pid->Part_I = (s32)(100*p_pid->integral/p_pid->frequency);
 148:Src/pid.c     **** 	}
 149:Src/pid.c     **** 	else
 150:Src/pid.c     **** 	{
 151:Src/pid.c     **** 		p_pid->Part_I = (s32)(p_pid->integral/p_pid->frequency);
 152:Src/pid.c     **** 	}	
 153:Src/pid.c     **** 	if(p_pid->Part_I>0x7FFFFFFF)
 154:Src/pid.c     **** 	{
 155:Src/pid.c     **** 		p_pid->Part_I = 0x7FFFFFFF;
 156:Src/pid.c     **** 	}
 157:Src/pid.c     **** 	else if(p_pid->Part_I<(-1*0x7FFFFFFF))
 158:Src/pid.c     **** 	{
 159:Src/pid.c     **** 		p_pid->Part_I = -1*0x7FFFFFFF;
 160:Src/pid.c     **** 	}
 161:Src/pid.c     **** 	deriv = p_pid->Part_D;
 162:Src/pid.c     **** 	p_pid->Part_D = p_pid->Kd * ( 9*deriv + 1*(p_pid->error-p_pid->error_last) )   /1000 ;
 163:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 164:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 165:Src/pid.c     **** 	{
 166:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 167:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 168:Src/pid.c     **** 	}
 169:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 170:Src/pid.c     **** 	{
 171:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 172:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 173:Src/pid.c     **** 	}	
 174:Src/pid.c     **** 	return;
 175:Src/pid.c     **** }
 176:Src/pid.c     **** //Force PID output
 177:Src/pid.c     **** void force_PID_out(s32 out,struct PID_TYPE * p_pid)   //PID
 178:Src/pid.c     **** {
 179:Src/pid.c     **** 	p_pid->out = out;
 180:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 181:Src/pid.c     **** 	{
 182:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 183:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 184:Src/pid.c     **** 	}
 185:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 186:Src/pid.c     **** 	{
 187:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 188:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 189:Src/pid.c     **** 	}	
 190:Src/pid.c     **** 	p_pid->error = 0;
 191:Src/pid.c     **** 	p_pid->error_last = 0;
 192:Src/pid.c     **** 	p_pid->Part_P = 0;
 193:Src/pid.c     **** 	p_pid->Part_I = out;
 194:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 195:Src/pid.c     **** 	p_pid->Part_D = 0;
 196:Src/pid.c     **** }
 197:Src/pid.c     **** static void ForcePID(void)
 198:Src/pid.c     **** {
 199:Src/pid.c     **** 	s16 error_force = 0;
 200:Src/pid.c     **** 	s16 error_force_abs = 0;
 201:Src/pid.c     **** //	static u8 flag_in_dead = 0;
 202:Src/pid.c     **** //	static u16 delayCnt_in_dead = 0;
 203:Src/pid.c     **** 	if(g_CmdMap[CMD_FORCE_DIR] == 0)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 5


 204:Src/pid.c     **** 	{
 205:Src/pid.c     **** 		force_set = g_CmdMap[CMD_FORCE_SET_PU];
 206:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 207:Src/pid.c     **** 	}
 208:Src/pid.c     **** 	else
 209:Src/pid.c     **** 	{
 210:Src/pid.c     **** 		force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 211:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 212:Src/pid.c     **** 	}
 213:Src/pid.c     **** ////	if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-819) && g_CmdMap[CMD_POS_ACT_PU]
 214:Src/pid.c     **** ////	{
 215:Src/pid.c     **** //				if(force_set>16)
 216:Src/pid.c     **** //				{
 217:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FORCE
 218:Src/pid.c     **** //					pid_force.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 219:Src/pid.c     **** //				}
 220:Src/pid.c     **** //				else if(force_set<-16)
 221:Src/pid.c     **** //				{
 222:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 223:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FOR
 224:Src/pid.c     **** //				}
 225:Src/pid.c     **** //				else
 226:Src/pid.c     **** //				{
 227:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>7)
 228:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]-(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>
 229:Src/pid.c     **** //				}
 230:Src/pid.c     **** //////	}
 231:Src/pid.c     **** ////	if(pid_force.Up_limit<g_CmdMap[SYS_RESISTANCE_CURPU])
 232:Src/pid.c     **** ////	{
 233:Src/pid.c     **** ////		pid_force.Up_limit=g_CmdMap[SYS_RESISTANCE_CURPU];
 234:Src/pid.c     **** ////	}
 235:Src/pid.c     **** ////	if(pid_force.Low_limit>(-1*g_CmdMap[SYS_RESISTANCE_CURPU]))
 236:Src/pid.c     **** ////	{
 237:Src/pid.c     **** ////		pid_force.Low_limit=-1*g_CmdMap[SYS_RESISTANCE_CURPU];
 238:Src/pid.c     **** ////	}
 239:Src/pid.c     **** 	pid_force.Up_limit = ((g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])>>0);
 240:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 241:Src/pid.c     **** 	
 242:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]>g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 243:Src/pid.c     **** 	{
 244:Src/pid.c     **** 		pid_force.Up_limit = 0;
 245:Src/pid.c     **** 		
 246:Src/pid.c     **** 	}
 247:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]>(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-409)&& g_CmdMap[CMD_CUR_SET_PU]
 248:Src/pid.c     **** 	{
 249:Src/pid.c     **** 		pid_force.Up_limit = 0;
 250:Src/pid.c     **** 		
 251:Src/pid.c     **** 	}
 252:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]<g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 253:Src/pid.c     **** 	{
 254:Src/pid.c     **** 		pid_force.Low_limit = 0;
 255:Src/pid.c     **** 		
 256:Src/pid.c     **** 	}	
 257:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_LOWER_LIMIT_PU]+409)  && g_CmdMap[CMD_CUR_SET_P
 258:Src/pid.c     **** 	{
 259:Src/pid.c     **** 		pid_force.Low_limit = 0;
 260:Src/pid.c     **** 		
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 6


 261:Src/pid.c     **** 	}
 262:Src/pid.c     **** 	
 263:Src/pid.c     **** 
 264:Src/pid.c     **** 	
 265:Src/pid.c     **** //	error_force = force_set - force_act;
 266:Src/pid.c     **** //	error_force_abs = ABS(error_force);
 267:Src/pid.c     **** //	if(error_force < (pid_force.dead_zone>>1))
 268:Src/pid.c     **** //	{
 269:Src/pid.c     **** //		if(delayCnt_in_dead<1000)
 270:Src/pid.c     **** //		{
 271:Src/pid.c     **** //			delayCnt_in_dead++;
 272:Src/pid.c     **** //		}
 273:Src/pid.c     **** //		else
 274:Src/pid.c     **** //		{
 275:Src/pid.c     **** //			flag_in_dead = 1;
 276:Src/pid.c     **** //		}
 277:Src/pid.c     **** //	}
 278:Src/pid.c     **** //	if(error_force_abs > pid_force.dead_zone)
 279:Src/pid.c     **** //	{
 280:Src/pid.c     **** //		delayCnt_in_dead = 0;
 281:Src/pid.c     **** //		flag_in_dead = 0;
 282:Src/pid.c     **** //	}
 283:Src/pid.c     **** //	if(flag_in_dead == 1)
 284:Src/pid.c     **** //	{
 285:Src/pid.c     **** //		force_PID_out(0,&pid_force);
 286:Src/pid.c     **** //	}
 287:Src/pid.c     **** //	else
 288:Src/pid.c     **** //	{
 289:Src/pid.c     **** 		PID_control(force_set,force_act,&pid_force);
 290:Src/pid.c     **** //	}
 291:Src/pid.c     **** 	//
 292:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_force.out;
 293:Src/pid.c     **** 	
 294:Src/pid.c     **** 	if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_4_FORCE || (g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MO
 295:Src/pid.c     **** 	{
 296:Src/pid.c     **** 		Flag_Profile_Enable = 0;
 297:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 298:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 299:Src/pid.c     **** 	}
 300:Src/pid.c     **** }
 301:Src/pid.c     **** 
 302:Src/pid.c     **** // SVPWMï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½
 303:Src/pid.c     **** static void Calculate_CCR_SVP(TIM_TypeDef* TIMx, int sector, int X, int Y, int Z)
 304:Src/pid.c     **** {
 305:Src/pid.c     ****   s32 t0, tk, tk_1;
 306:Src/pid.c     ****   s32 CCR1 = 0;
 307:Src/pid.c     ****   s32 CCR2 = 0;
 308:Src/pid.c     ****   s32 CCR3 = 0;
 309:Src/pid.c     ****   switch (sector)
 310:Src/pid.c     ****   {
 311:Src/pid.c     ****     case 1:
 312:Src/pid.c     **** 			tk_1 = Z;
 313:Src/pid.c     **** 			tk = Y;
 314:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 315:Src/pid.c     **** 			CCR3 = t0>>1;
 316:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 317:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 7


 318:Src/pid.c     **** 		break;		
 319:Src/pid.c     **** 		case 2:
 320:Src/pid.c     **** 			tk_1 = Y;
 321:Src/pid.c     **** 			tk = -X;
 322:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 323:Src/pid.c     **** 			CCR2 = t0>>1;
 324:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 325:Src/pid.c     **** 			CCR1 = CCR3 + tk_1;
 326:Src/pid.c     **** 		break;		
 327:Src/pid.c     **** 		case 3:
 328:Src/pid.c     **** 			tk_1 = X;
 329:Src/pid.c     **** 			tk = -Z;
 330:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 331:Src/pid.c     **** 			CCR3 = t0>>1;
 332:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 333:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 334:Src/pid.c     **** 		break;		
 335:Src/pid.c     **** 		case 4:
 336:Src/pid.c     **** 			tk_1 = -X;
 337:Src/pid.c     **** 			tk = Z;
 338:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 339:Src/pid.c     **** 			CCR1 = t0>>1;
 340:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 341:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 342:Src/pid.c     **** 		break;
 343:Src/pid.c     **** 		case 5:
 344:Src/pid.c     **** 			tk_1 = -Y;
 345:Src/pid.c     **** 			tk = X;
 346:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 347:Src/pid.c     **** 			CCR1 = t0>>1;
 348:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 349:Src/pid.c     **** 			CCR2 = CCR3 + tk;
 350:Src/pid.c     **** 		break;
 351:Src/pid.c     **** 		case 6:
 352:Src/pid.c     **** 			tk_1 = -Z;
 353:Src/pid.c     **** 			tk = -Y;
 354:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 355:Src/pid.c     **** 			CCR2 = t0>>1;
 356:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 357:Src/pid.c     **** 			CCR3 = CCR1 + tk;
 358:Src/pid.c     **** 		break;
 359:Src/pid.c     **** 		default:
 360:Src/pid.c     **** 			CCR1 = REAL_CCR >> 1;
 361:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 362:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 363:Src/pid.c     **** 		break;
 364:Src/pid.c     ****   }
 365:Src/pid.c     **** 	CCR1 = CCR1>N97_CCR?N97_CCR:(CCR1<0?0:CCR1);
 366:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 367:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 368:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 369:Src/pid.c     **** 	{
 370:Src/pid.c     **** 			motor_para_identification_count_Tms = 0;
 371:Src/pid.c     **** 			sin_wave_t_us = 0;
 372:Src/pid.c     **** 	}
 373:Src/pid.c     ****    // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½97%
 374:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¶ Step1:ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Step2ï¿½ï¿½ï¿½ï¿½ï¿½Ð²ï¿½ï¿½ï
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 8


 375:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4 || g_CmdMap[SYS_MOT_TEST] == 5)
 376:Src/pid.c     **** 	{
 377:Src/pid.c     **** 		sin_wave_t_us = sin_wave_t_us + 4;
 378:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 379:Src/pid.c     **** 		{
 380:Src/pid.c     **** 			sin_wave_t_us = 0;
 381:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 382:Src/pid.c     **** 		}
 383:Src/pid.c     **** 	}
 384:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4)
 385:Src/pid.c     **** 	{
 386:Src/pid.c     **** 		CCR1 = 1;
 387:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 388:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 389:Src/pid.c     **** 		Para_Identificaion++;
 390:Src/pid.c     **** 		if(Para_Identificaion>=0)
 391:Src/pid.c     **** 		{
 392:Src/pid.c     **** 			Para_Identificaion = 0;
 393:Src/pid.c     **** 			if(index_I_phase<100)
 394:Src/pid.c     **** 			{
 395:Src/pid.c     **** 				I_phase[0][index_I_phase] = -g_IA_Raw;
 396:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
 397:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 398:Src/pid.c     **** 			}
 399:Src/pid.c     **** 			index_I_phase++;
 400:Src/pid.c     **** 		}
 401:Src/pid.c     **** 		if(motor_para_identification_count_Tms > 200)//1sï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 402:Src/pid.c     **** 		{	
 403:Src/pid.c     **** 			T_t = 0.000040/(log(-1.0*(double)I_phase[0][99]/((double)(I_phase[0][2] - I_phase[0][99])))   );
 404:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 405:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 406:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 407:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
 408:Src/pid.c     **** 		}
 409:Src/pid.c     **** 	}	 
 410:Src/pid.c     ****   TIMx->CCR3 = CCR3;
 411:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 412:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 413:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 414:Src/pid.c     **** 	TIMx->CCER = (u16)PWM_OUTPUT_REG;
 415:Src/pid.c     **** }
 416:Src/pid.c     **** 
 417:Src/pid.c     **** extern volatile int g_high_fre_pulse;
 418:Src/pid.c     **** 
 419:Src/pid.c     **** // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½20KHz
 420:Src/pid.c     **** static void CurrentPID(void)
 421:Src/pid.c     **** {            
 422:Src/pid.c     ****   s32 temp32 = 0;       
 423:Src/pid.c     ****   s32 X, Y, Z;
 424:Src/pid.c     **** 	static u16 test = 0;
 425:Src/pid.c     **** 	s32 abs_g_Vq;
 426:Src/pid.c     **** 	s16 set_current = 0;
 427:Src/pid.c     **** 	static int inr_angle =0;
 428:Src/pid.c     **** 	
 429:Src/pid.c     **** 	if (g_CmdMap[TAG_WORK_MODE] != MODE_CURRENT)  // ï¿½ï¿½Ç°Ä£Ê½ï¿½ï¿½ï¿½Çµï¿½ï¿½ï¿½ï¿½ï¿½
 430:Src/pid.c     **** 	{
 431:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED || g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 9


 432:Src/pid.c     **** 		{
 433:Src/pid.c     **** 		//	g_CmdMap[CMD_CUR_FWD_PU] = 1*((s32)g_CmdMap[CMD_ACC_PRE_PU]*5)>>4;
 434:Src/pid.c     **** 			g_CmdMap[CMD_CUR_FWD_PU] = 1*(s32)g_CmdMap[CMD_ACC_PRE_PU];
 435:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 436:Src/pid.c     **** 		}
 437:Src/pid.c     **** 		else if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
 438:Src/pid.c     **** 		{
 439:Src/pid.c     **** //			g_CmdMap[CMD_CUR_SET_PU] = pid_force.out;
 440:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out ;
 441:Src/pid.c     **** 		
 442:Src/pid.c     **** 		}
 443:Src/pid.c     **** 		else
 444:Src/pid.c     **** 		{
 445:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 446:Src/pid.c     **** 		}	
 447:Src/pid.c     **** 	}
 448:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô£ï¿½ï¿½Ü²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ£ï¿½Ö»ï¿½ï¿½ï¿½ï¿½1msÎªï
 449:Src/pid.c     **** 	if(g_CmdMap[SYS_SELF_TUNING] == 1)//
 450:Src/pid.c     **** 	{
 451:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 452:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 453:Src/pid.c     **** 		if(test++ > (50))
 454:Src/pid.c     **** 		{
 455:Src/pid.c     **** 			test = 0;
 456:Src/pid.c     **** 		}
 457:Src/pid.c     **** 		if(test>(25))
 458:Src/pid.c     **** 		{
 459:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 16*200;
 460:Src/pid.c     **** 		}
 461:Src/pid.c     **** 		else
 462:Src/pid.c     **** 		{
 463:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = -16*200;		
 464:Src/pid.c     **** 		}	
 465:Src/pid.c     **** 	}
 466:Src/pid.c     **** 	else if(g_CmdMap[SYS_SELF_TUNING] == 3)//ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 467:Src/pid.c     **** 	{
 468:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 469:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 470:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 471:Src/pid.c     **** 		{
 472:Src/pid.c     **** 			state_Jtest = 0;
 473:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 474:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 475:Src/pid.c     **** 		}
 476:Src/pid.c     **** 		switch(state_Jtest)
 477:Src/pid.c     **** 		{
 478:Src/pid.c     **** 			case 0:
 479:Src/pid.c     **** 			{	
 480:Src/pid.c     **** 				flag_processing_Jtest = 1;
 481:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
 482:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 483:Src/pid.c     **** 				{
 484:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME1] = g_CmdMap[CMD_JTEST_TIME1] + SVPWM_PERIOD_US;					
 485:Src/pid.c     **** 				}
 486:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>(8192+819))
 487:Src/pid.c     **** 				{
 488:Src/pid.c     **** 					state_Jtest++;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 10


 489:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 490:Src/pid.c     **** 				}
 491:Src/pid.c     **** 				break;
 492:Src/pid.c     **** 			}
 493:Src/pid.c     **** 			case 1:
 494:Src/pid.c     **** 			{	
 495:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = -8192;
 496:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 497:Src/pid.c     **** 				{
 498:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = g_CmdMap[CMD_JTEST_TIME2] + SVPWM_PERIOD_US;					
 499:Src/pid.c     **** 				}
 500:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 501:Src/pid.c     **** 				{
 502:Src/pid.c     **** 					state_Jtest++;
 503:Src/pid.c     **** 				}
 504:Src/pid.c     **** 				break;
 505:Src/pid.c     **** 			}
 506:Src/pid.c     **** 			case 2:
 507:Src/pid.c     **** 			{	
 508:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 509:Src/pid.c     **** 				{
 510:Src/pid.c     **** 					state_Jtest++;
 511:Src/pid.c     **** 				}				
 512:Src/pid.c     **** 				break;
 513:Src/pid.c     **** 			}
 514:Src/pid.c     **** 			default:
 515:Src/pid.c     **** 			{	
 516:Src/pid.c     **** 				g_CmdMap[SYS_SELF_TUNING] = 0;
 517:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 518:Src/pid.c     **** 				flag_processing_Jtest = 0;
 519:Src/pid.c     **** 				break;
 520:Src/pid.c     **** 			}
 521:Src/pid.c     **** 		}
 522:Src/pid.c     **** 	}
 523:Src/pid.c     **** 		else if(g_CmdMap[SYS_SELF_TUNING] == 4)//
 524:Src/pid.c     **** 	{
 525:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 526:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 527:Src/pid.c     **** 
 528:Src/pid.c     **** 		
 529:Src/pid.c     **** 		test++;
 530:Src/pid.c     **** 		if(test < (10*10))
 531:Src/pid.c     **** 		{
 532:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 533:Src/pid.c     **** 		}
 534:Src/pid.c     **** 		else if(test < (10*60))
 535:Src/pid.c     **** 		{
 536:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 4096;
 537:Src/pid.c     **** 		}
 538:Src/pid.c     **** 		else if(test < (10*110))
 539:Src/pid.c     **** 		{
 540:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 541:Src/pid.c     **** 		}
 542:Src/pid.c     **** 		else if(test < (10*160))
 543:Src/pid.c     **** 		{
 544:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = -4096;
 545:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 11


 546:Src/pid.c     **** 		else if(test < (10*170))
 547:Src/pid.c     **** 		{
 548:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 549:Src/pid.c     **** 		}
 550:Src/pid.c     **** 		else
 551:Src/pid.c     **** 		{
 552:Src/pid.c     **** 			test = 0;
 553:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 554:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 555:Src/pid.c     **** 		}
 556:Src/pid.c     **** 	}
 557:Src/pid.c     **** 	else
 558:Src/pid.c     **** 	{
 559:Src/pid.c     **** 
 560:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]> g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 561:Src/pid.c     **** 		{
 562:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 563:Src/pid.c     **** 		}
 564:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]< g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 565:Src/pid.c     **** 		{
 566:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 567:Src/pid.c     **** 		}
 568:Src/pid.c     **** 	}
 569:Src/pid.c     **** 	
 570:Src/pid.c     **** 	pid_IQ.Up_limit = 16384;
 571:Src/pid.c     **** 	pid_IQ.Low_limit = -16384;
 572:Src/pid.c     **** 	
 573:Src/pid.c     **** //		pid_IQ.Up_limit = 2000;
 574:Src/pid.c     **** //	pid_IQ.Low_limit = -2000;
 575:Src/pid.c     **** 	
 576:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_CUR_SET_PU],g_CmdMap[CMD_CUR_ACT_PU],&pid_IQ);	
 577:Src/pid.c     **** 	
 578:Src/pid.c     **** 	
 579:Src/pid.c     **** 	g_Vq = pid_IQ.out*N97_CCR/PU_REFERENCE;
 580:Src/pid.c     **** 	
 581:Src/pid.c     **** 	pid_ID.Up_limit = 16384;
 582:Src/pid.c     **** 	pid_ID.Low_limit = -16384;	
 583:Src/pid.c     **** 	
 584:Src/pid.c     **** //	pid_ID.Up_limit = 4096;
 585:Src/pid.c     **** //	pid_ID.Low_limit = -4096;	
 586:Src/pid.c     **** 	
 587:Src/pid.c     **** 	PID_control(-0,g_CmdMap[CMD_CUR_D_ACT_PU],&pid_ID);	
 588:Src/pid.c     **** 	g_Vd = pid_ID.out*N97_CCR/PU_REFERENCE;	
 589:Src/pid.c     **** 	
 590:Src/pid.c     **** //	g_Vq = 100;//g_high_fre_pulse * 500;
 591:Src/pid.c     **** //	g_Vd = g_high_fre_pulse * 1000;
 592:Src/pid.c     **** 	
 593:Src/pid.c     **** 	g_high_fre_pulse = 0 - g_high_fre_pulse;
 594:Src/pid.c     **** 	
 595:Src/pid.c     **** //	inr_angle += 1;
 596:Src/pid.c     **** //	g_ElectricAngle = inr_angle;
 597:Src/pid.c     **** 	
 598:Src/pid.c     ****   // Parkï¿½ï¿½ï¿½ä»»
 599:Src/pid.c     **** //	
 600:Src/pid.c     **** //		g_ElectricAngle_add = (int)pll_estimated_spd /100000;
 601:Src/pid.c     **** //		g_ElectricAngle = g_ElectricAngle + g_ElectricAngle_add;// * 0.000025;
 602:Src/pid.c     **** 	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 12


 603:Src/pid.c     ****   X = Math_Sin_EN360( g_ElectricAngle  );
 604:Src/pid.c     ****   Y = Math_Cos_EN360( g_ElectricAngle );
 605:Src/pid.c     ****   g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä
 606:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 607:Src/pid.c     ****   // SVPWMÕ¼ï¿½Õ±È¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 608:Src/pid.c     ****   X = g_V_Beta;
 609:Src/pid.c     **** 	temp32 = Q16_MUL(g_V_Alpha,113512);
 610:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 611:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 612:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
 613:Src/pid.c     ****   temp32 = 0;
 614:Src/pid.c     **** 	/** ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ª**/	
 615:Src/pid.c     **** 	if (X > 0) temp32 = 1;
 616:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 617:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 618:Src/pid.c     **** 	g_Sector = temp32;
 619:Src/pid.c     **** 	g_Sector_test = g_Sector;
 620:Src/pid.c     **** 	g_X = X;
 621:Src/pid.c     **** 	g_Y = Y;
 622:Src/pid.c     **** 	g_Z = Z;
 623:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 624:Src/pid.c     **** 
 625:Src/pid.c     **** }
 626:Src/pid.c     **** static void SpeedPID(void)
 627:Src/pid.c     **** { 
 628:Src/pid.c     **** 	static s32 s_test_speed_t_count = 0;
 629:Src/pid.c     **** 	s16 spd_test = 0;
 630:Src/pid.c     **** 	
 631:Src/pid.c     ****   if (g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT ||g_CmdMap[TAG_WORK_MODE] == MODE_POSITION||g_CmdMap[
 632:Src/pid.c     ****   {
 633:Src/pid.c     **** 			g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_PROFILE_SPD_PU] + g_CmdMap[CMD_SPD_ADD_PU];
 634:Src/pid.c     ****   }
 635:Src/pid.c     **** 	else if( g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 636:Src/pid.c     **** 	{
 637:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_ADD_PU];
 638:Src/pid.c     **** 		
 639:Src/pid.c     **** 		pid_spd.enable =1;
 640:Src/pid.c     **** 	}
 641:Src/pid.c     ****   else if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED)
 642:Src/pid.c     ****   {
 643:Src/pid.c     **** 			if(status_Mode_POSITION_FORCE == 2) //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ÐµÄµï¿½ï¿½ï¿½ï¿½Ù
 644:Src/pid.c     **** 			{
 645:Src/pid.c     **** 				if(g_CmdMap[CMD_FORCE_DIR] == 0)
 646:Src/pid.c     **** 				{
 647:Src/pid.c     **** 					force_set = g_CmdMap[CMD_FORCE_SET_PU];
 648:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 649:Src/pid.c     **** 				}
 650:Src/pid.c     **** 				else
 651:Src/pid.c     **** 				{
 652:Src/pid.c     **** 					force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 653:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 654:Src/pid.c     **** 				}
 655:Src/pid.c     **** 				if(force_set >= 0 )
 656:Src/pid.c     **** 				{
 657:Src/pid.c     **** 					if(force_act>force_set || g_CmdMap[CMD_POS_ACT_PU] > g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 658:Src/pid.c     **** 					{
 659:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 13


 660:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;	
 661:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force);
 662:Src/pid.c     **** 					
 663:Src/pid.c     **** 					}
 664:Src/pid.c     **** 					else
 665:Src/pid.c     **** 					{
 666:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SOFT_SET_PU];
 667:Src/pid.c     **** 					}
 668:Src/pid.c     **** 				}
 669:Src/pid.c     **** 				else
 670:Src/pid.c     **** 				{
 671:Src/pid.c     **** 					if(force_act<force_set || g_CmdMap[CMD_POS_ACT_PU] < g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 672:Src/pid.c     **** 					{
 673:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
 674:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 675:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 676:Src/pid.c     ****  		
 677:Src/pid.c     **** 					}
 678:Src/pid.c     **** 					else
 679:Src/pid.c     **** 					{
 680:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = -1*g_CmdMap[CMD_SPD_SOFT_SET_PU];
 681:Src/pid.c     **** 					}
 682:Src/pid.c     **** 				}
 683:Src/pid.c     **** 			}
 684:Src/pid.c     **** 			else
 685:Src/pid.c     **** 			{
 686:Src/pid.c     **** 							if(g_CmdMap[SYS_SPEED_TEST] == 0)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 687:Src/pid.c     **** 							{
 688:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SET_PU];
 689:Src/pid.c     **** 							}
 690:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 1)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½ï
 691:Src/pid.c     **** 							{
 692:Src/pid.c     **** 								
 693:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ACT_PU] < 1638)
 694:Src/pid.c     **** 								{
 695:Src/pid.c     **** 									Test_dirt = 1;					
 696:Src/pid.c     **** 								}
 697:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ACT_PU] > (16384-1638))
 698:Src/pid.c     **** 								{
 699:Src/pid.c     **** 									Test_dirt = -1;					
 700:Src/pid.c     **** 								}
 701:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*g_CmdMap[CMD_SPD_SET_PU];
 702:Src/pid.c     **** 
 703:Src/pid.c     **** 							}	
 704:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 11)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½
 705:Src/pid.c     **** 							{
 706:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(0)])
 707:Src/pid.c     **** 								{
 708:Src/pid.c     **** 									Test_dirt = 1;
 709:Src/pid.c     **** 								}
 710:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ADC_12BIT] > g_CmdMap[POS_LINEARITY_ADC(30)])
 711:Src/pid.c     **** 								{
 712:Src/pid.c     **** 									Test_dirt = -1;
 713:Src/pid.c     **** 								}
 714:Src/pid.c     **** 								spd_test = ABS(g_CmdMap[CMD_SPD_SET_PU]);
 715:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 716:Src/pid.c     **** 								{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 14


 717:Src/pid.c     **** 									s_test_speed_t_count = 0;
 718:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 719:Src/pid.c     **** 									{
 720:Src/pid.c     **** 										Test_perm = 0;   //4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 721:Src/pid.c     **** 									}
 722:Src/pid.c     **** 									else
 723:Src/pid.c     **** 									{
 724:Src/pid.c     **** 										Test_perm = 1;//4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 725:Src/pid.c     **** 									}
 726:Src/pid.c     **** 									g_flag_monitor_from_host = 0;
 727:Src/pid.c     **** 								}
 728:Src/pid.c     **** 												if(Test_perm == 1)
 729:Src/pid.c     **** 								{
 730:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*spd_test;
 731:Src/pid.c     **** 								}
 732:Src/pid.c     **** 								else
 733:Src/pid.c     **** 								{
 734:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 735:Src/pid.c     **** 								}				
 736:Src/pid.c     **** 							}				
 737:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 12)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½Ð¡Î»ï
 738:Src/pid.c     **** 							{
 739:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] >g_CmdMap[POS_LINEARITY_ADC(0)])
 740:Src/pid.c     **** 								{
 741:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = -8192;
 742:Src/pid.c     **** 								}
 743:Src/pid.c     **** 								else
 744:Src/pid.c     **** 								{
 745:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 746:Src/pid.c     **** 								}
 747:Src/pid.c     **** 							}
 748:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 13)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½ï¿½Î»
 749:Src/pid.c     **** 							{
 750:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(30)])
 751:Src/pid.c     **** 								{
 752:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 8192;
 753:Src/pid.c     **** 								}
 754:Src/pid.c     **** 								else
 755:Src/pid.c     **** 								{
 756:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 757:Src/pid.c     **** 								}
 758:Src/pid.c     **** 							}
 759:Src/pid.c     **** 							else
 760:Src/pid.c     **** 							{
 761:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 762:Src/pid.c     **** 							}				
 763:Src/pid.c     **** 			}
 764:Src/pid.c     **** 	}
 765:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]> g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])
 766:Src/pid.c     **** 	{
 767:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_UPPER_LIMIT_PU];
 768:Src/pid.c     **** 	}
 769:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]< g_CmdMap[SYS_SPD_LOWER_LIMIT_PU])
 770:Src/pid.c     **** 	{
 771:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_LOWER_LIMIT_PU];
 772:Src/pid.c     **** 	}
 773:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 15


 774:Src/pid.c     **** 
 775:Src/pid.c     **** 	
 776:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] > g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 777:Src/pid.c     **** 	{
 778:Src/pid.c     **** 		g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 779:Src/pid.c     **** 	}
 780:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] < g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 781:Src/pid.c     **** 	{
 782:Src/pid.c     **** 		g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 783:Src/pid.c     **** 	}
 784:Src/pid.c     **** 	
 785:Src/pid.c     **** 	pid_spd.Up_limit = g_CmdMap[CMD_CUR_UPPER_LIMIT_PU];
 786:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[CMD_CUR_LOWER_LIMIT_PU];		
 787:Src/pid.c     **** 	
 788:Src/pid.c     **** 	
 789:Src/pid.c     **** 	
 790:Src/pid.c     **** 	
 791:Src/pid.c     **** 	
 792:Src/pid.c     **** //	
 793:Src/pid.c     **** //	pid_spd.Up_limit = 1000;
 794:Src/pid.c     **** //	pid_spd.Low_limit = -1000;		
 795:Src/pid.c     **** //	
 796:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_SPDREG_REF_PU],g_CmdMap[CMD_SPD_ACT_PU],&pid_spd);	
 797:Src/pid.c     **** }
 798:Src/pid.c     **** void PositionPID(void)   //ï¿½Å½ï¿½ï¿½ï¿½ï¿½ï¿½ Î»ï¿½Ãµï¿½ï¿½ï¿½ï¿½ï¿½Ï²ï¿½ï¿½Î·ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿
 799:Src/pid.c     **** {	
 800:Src/pid.c     **** 	static s16 delay_cnt = 0;
 801:Src/pid.c     **** 	pos_error_to_target = g_CmdMap[CMD_POS_SET_PU]-g_CmdMap[CMD_POS_ACT_PU];  // Æ«ï¿½ï¿½
 802:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 803:Src/pid.c     **** 	if(ABS(pos_error_to_target)<gPos_ds && Profile_moving == 0)
 804:Src/pid.c     **** 	{
 805:Src/pid.c     **** 		if(delay_cnt <50)
 806:Src/pid.c     **** 		{
 807:Src/pid.c     **** 			delay_cnt++;
 808:Src/pid.c     **** 		}
 809:Src/pid.c     **** 		else
 810:Src/pid.c     **** 		{
 811:Src/pid.c     **** 			PosAtDead_Flag = 1;
 812:Src/pid.c     **** 		}
 813:Src/pid.c     **** 	}
 814:Src/pid.c     **** 	if(ABS(pos_error_to_target)>2*gPos_ds || Profile_moving == 1)
 815:Src/pid.c     **** 	{
 816:Src/pid.c     **** 		PosAtDead_Flag = 0;
 817:Src/pid.c     **** 		delay_cnt = 0;
 818:Src/pid.c     **** 	}	
 819:Src/pid.c     **** 	PosAtDead_Flag_Last = PosAtDead_Flag;
 820:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 821:Src/pid.c     **** 	// ï¿½ï¿½ï¿½Ö¼ï¿½ï¿½ï¿½	
 822:Src/pid.c     **** 	if(flag_posReg_strengthen == 1)
 823:Src/pid.c     **** 	{
 824:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU];
 825:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 826:Src/pid.c     **** 	}
 827:Src/pid.c     **** 	else
 828:Src/pid.c     **** 	{
 829:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5;
 830:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 16


 831:Src/pid.c     **** 	}		
 832:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_PROFILE_POS_PU],g_CmdMap[CMD_POS_ACT_PU],&pid_pos);
 833:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_pos.out;
 834:Src/pid.c     **** }
 835:Src/pid.c     **** //int16_t Force_set_drop_detection = 0;
 836:Src/pid.c     **** //Î»ï¿½Ã¿ï¿½ï¿½ï¿½
 837:Src/pid.c     **** void Gripper_control(void)
 838:Src/pid.c     **** {
 839:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
 840:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 841:Src/pid.c     **** 	{
 842:Src/pid.c     **** 		Gripper_Move = 0x00;
 843:Src/pid.c     **** 		Grriper_Run = 0;
 844:Src/pid.c     **** 		Flag_contact = 0;
 845:Src/pid.c     **** 		Flag_grip_F_OK = 0;
 846:Src/pid.c     **** 		Flag_grip_P_OK = 0;
 847:Src/pid.c     **** 		Flag_rellease_P_OK = 0;
 848:Src/pid.c     **** 	}	
 849:Src/pid.c     **** 	else
 850:Src/pid.c     **** 	{
 851:Src/pid.c     **** 		
 852:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]>g_CmdMap[CMD_POS_UPPER_LIMIT_PU])
 853:Src/pid.c     **** //		{
 854:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] =g_CmdMap[CMD_POS_UPPER_LIMIT_PU];		
 855:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] > 16384)
 856:Src/pid.c     **** //			{
 857:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 16384;
 858:Src/pid.c     **** //			}
 859:Src/pid.c     **** //		}
 860:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]<g_CmdMap[CMD_POS_LOWER_LIMIT_PU])
 861:Src/pid.c     **** //		{
 862:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_LOWER_LIMIT_PU];
 863:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] < 0)
 864:Src/pid.c     **** //			{
 865:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 0;
 866:Src/pid.c     **** //			}
 867:Src/pid.c     **** //		}
 868:Src/pid.c     **** 		
 869:Src/pid.c     **** 		
 870:Src/pid.c     **** 		
 871:Src/pid.c     **** 		if(Flag_Set_OpenLen == 1  && (error_Pos>g_CmdMap[SEV_POSITION_DS]||error_Pos<-g_CmdMap[SEV_POSITI
 872:Src/pid.c     **** 		{
 873:Src/pid.c     **** 				Flag_Set_OpenLen = 0;
 874:Src/pid.c     **** 			
 875:Src/pid.c     **** 				if(g_CmdMap[CMD_E_STOP] == 0)
 876:Src/pid.c     **** 				{
 877:Src/pid.c     **** 				
 878:Src/pid.c     **** 				}
 879:Src/pid.c     **** 				
 880:Src/pid.c     **** 				g_CmdMap[TAG_WORK_MODE] = MODE_POSITION;	
 881:Src/pid.c     **** 				Profile_ParaSet();
 882:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 883:Src/pid.c     **** 				{
 884:Src/pid.c     **** 					tCnt_f = 0.0;
 885:Src/pid.c     **** 				}
 886:Src/pid.c     **** 				
 887:Src/pid.c     **** 				Flag_contact = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 17


 888:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 889:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 890:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 891:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 892:Src/pid.c     **** 				{
 893:Src/pid.c     **** 					Gripper_Move = 0x01;//ï¿½ï¿½È¡
 894:Src/pid.c     **** 					Grriper_Run = 1;
 895:Src/pid.c     **** 					pid_spd.enable = 1;
 896:Src/pid.c     **** 					pid_pos.enable = 1;
 897:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 898:Src/pid.c     **** 					{
 899:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 900:Src/pid.c     **** 					}
 901:Src/pid.c     **** 					//g_Flag_drop_detection = 1;   // 1-ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½ 0-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½
 902:Src/pid.c     **** 					Grriper_Run_last = 0;
 903:Src/pid.c     **** 				}
 904:Src/pid.c     **** 				else if(g_CmdMap[CMD_POS_SET_PU] > g_CmdMap[CMD_POS_ACT_PU])
 905:Src/pid.c     **** 				{
 906:Src/pid.c     **** 					Gripper_Move = 0x02;//ï¿½É¿ï¿½
 907:Src/pid.c     **** 					Grriper_Run = 1;
 908:Src/pid.c     **** 					pid_spd.enable = 1;
 909:Src/pid.c     **** 					pid_pos.enable = 1;
 910:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 911:Src/pid.c     **** 					{
 912:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 913:Src/pid.c     **** 					}
 914:Src/pid.c     **** 					Grriper_Run_last = 0;
 915:Src/pid.c     **** 				}
 916:Src/pid.c     **** 				else
 917:Src/pid.c     **** 				{
 918:Src/pid.c     **** 				}
 919:Src/pid.c     **** 		}
 920:Src/pid.c     **** 		g_pos_tag = g_CmdMap[CMD_POS_SET_PU];
 921:Src/pid.c     **** 
 922:Src/pid.c     **** 		if(Gripper_Move == 1)
 923:Src/pid.c     **** 		{
 924:Src/pid.c     **** 			Flag_grip_F_OK = 1;
 925:Src/pid.c     **** 		}
 926:Src/pid.c     **** 		if(Grriper_Run == 1 && g_CmdMap[TAG_MOTOR_ENABLE] == 1)
 927:Src/pid.c     **** 		{		
 928:Src/pid.c     **** 			Flag_Profile_Enable = 1;
 929:Src/pid.c     **** 		}
 930:Src/pid.c     **** 		else
 931:Src/pid.c     **** 		{
 932:Src/pid.c     **** 			Flag_Profile_Enable = 0;
 933:Src/pid.c     **** 		}
 934:Src/pid.c     **** 		//ï¿½ï¿½ï¿½Î·ï¿½ï¿½ï¿½
 935:Src/pid.c     **** 		Profile();
 936:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
 937:Src/pid.c     **** 		PositionPID();	
 938:Src/pid.c     **** 	}
 939:Src/pid.c     **** }
 940:Src/pid.c     **** 	float v = 11.84;
 941:Src/pid.c     **** 	float L,temp_L;
 942:Src/pid.c     **** 
 943:Src/pid.c     **** extern volatile  int delta_alpha;
 944:Src/pid.c     **** extern volatile  int delata_beta;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 18


 945:Src/pid.c     **** 
 946:Src/pid.c     **** int observer_ElectricAngle;
 947:Src/pid.c     **** int observer_speed;
 948:Src/pid.c     **** int integre_observer_ElectricAngle;
 949:Src/pid.c     **** 
 950:Src/pid.c     **** void hfi_update_angle(void)
 951:Src/pid.c     **** {
 952:Src/pid.c     **** 	int X,Y;
 953:Src/pid.c     **** 	int temp_x;
 954:Src/pid.c     **** 	int temp_y;
 955:Src/pid.c     **** 	int pll_intput;
 956:Src/pid.c     **** 	int temp_q,temp_d;
 957:Src/pid.c     **** 	static float inr_angle = 0;
 958:Src/pid.c     **** 	int  observer_ElectricAngle1;
 959:Src/pid.c     **** 	
 960:Src/pid.c     **** 	pid_pll.dead_zone = 0;
 961:Src/pid.c     **** 	pid_pll.Kp = 1000;
 962:Src/pid.c     **** 	pid_pll.Ki = 10;
 963:Src/pid.c     **** 	pid_pll.Kd = 0;
 964:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 965:Src/pid.c     **** 	pid_pll.enable =1;
 966:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 967:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 968:Src/pid.c     **** 	
 969:Src/pid.c     **** 	
 970:Src/pid.c     **** 	park_transform(delta_alpha, delata_beta, &temp_q, &temp_d,g_ElectricAngle);
 971:Src/pid.c     **** 	
 972:Src/pid.c     **** 	L = v *1.7321*500*1000 /(g_Iq * F_CUR_REGULATOR_HZ/1000 ) /3 /MAX_CCR*0.58*0.7; //0.7 Ïµï¿½ï¿½ï¿½ï
 973:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
 974:Src/pid.c     **** 	
 975:Src/pid.c     **** 	X = Math_Sin_EN360(observer_ElectricAngle);
 976:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 977:Src/pid.c     **** 	
 978:Src/pid.c     **** 	temp_x = Q15_MUL(delta_alpha,X);
 979:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 980:Src/pid.c     **** 	
 981:Src/pid.c     **** 	pll_intput = temp_x - temp_y;  //+ 90ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ x -y ? ,y -x ï¿½ï¿½
 982:Src/pid.c     **** 	
 983:Src/pid.c     **** 	PID_control(0,pll_intput,&pid_pll);
 984:Src/pid.c     **** 	observer_speed = pid_pll.out;
 985:Src/pid.c     **** 	
 986:Src/pid.c     **** 	integre_observer_ElectricAngle +=observer_speed; //update angle
 987:Src/pid.c     **** 	
 988:Src/pid.c     **** 	observer_ElectricAngle = integre_observer_ElectricAngle /100;
 989:Src/pid.c     **** 	
 990:Src/pid.c     **** 	observer_ElectricAngle  &= 0x7fff; 
 991:Src/pid.c     **** 	
 992:Src/pid.c     **** 	observer_ElectricAngle1= observer_ElectricAngle  + EN_90;// EN_90;//EN_90; 
 993:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 994:Src/pid.c     **** 	
 995:Src/pid.c     **** 	g_ElectricAngle = observer_ElectricAngle1;
 996:Src/pid.c     **** 	
 997:Src/pid.c     **** #if 0 	 //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½Å³ï¿½
 998:Src/pid.c     **** 	inr_angle  += 0.1;
 999:Src/pid.c     **** 	if(inr_angle  > 32768 )
1000:Src/pid.c     **** 		inr_angle = 0;
1001:Src/pid.c     **** 	g_ElectricAngle = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 19


1002:Src/pid.c     **** #endif
1003:Src/pid.c     **** 	
1004:Src/pid.c     **** }
1005:Src/pid.c     **** 
1006:Src/pid.c     **** 
1007:Src/pid.c     **** static void OpenLoop(void)
1008:Src/pid.c     **** {
  27              		.loc 1 1008 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 08B5     		push	{r3, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 8
  34              		.cfi_offset 3, -8
  35              		.cfi_offset 14, -4
1009:Src/pid.c     **** 	int X,Y;
1010:Src/pid.c     **** 	int temp_x;
1011:Src/pid.c     **** 	int temp_y;
1012:Src/pid.c     **** 	int pll_intput;
1013:Src/pid.c     **** 	
1014:Src/pid.c     ****   s16 temp32 = g_CmdMap[TAG_OPEN_PWM] * MAX_CCR / 100;  // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿
  36              		.loc 1 1014 0
  37 0002 264B     		ldr	r3, .L8
  38 0004 B3F86022 		ldrh	r2, [r3, #608]
  39 0008 13B2     		sxth	r3, r2
  40 000a 4FF43D62 		mov	r2, #3024
  41 000e 02FB03F2 		mul	r2, r2, r3
  42 0012 2349     		ldr	r1, .L8+4
  43 0014 81FB0231 		smull	r3, r1, r1, r2
  44 0018 D317     		asrs	r3, r2, #31
  45 001a C3EB6113 		rsb	r3, r3, r1, asr #5
  46 001e 1AB2     		sxth	r2, r3
  47              	.LVL0:
1015:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= MAX_CCR) ? temp32 : g_Timer1CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿
  48              		.loc 1 1015 0
  49 0020 03F53D63 		add	r3, r3, #3024
  50 0024 9BB2     		uxth	r3, r3
  51 0026 B3F5BD5F 		cmp	r3, #6048
  52 002a 25D8     		bhi	.L2
  53              		.loc 1 1015 0 is_stmt 0 discriminator 1
  54 002c 1346     		mov	r3, r2
  55              	.L3:
  56              		.loc 1 1015 0 discriminator 4
  57 002e 1D4A     		ldr	r2, .L8+8
  58              	.LVL1:
  59 0030 1360     		str	r3, [r2]
1016:Src/pid.c     **** 	
1017:Src/pid.c     **** 	g_Vq =  g_CmdMap[TAG_OPEN_PWM] * 16384 / 100;  
  60              		.loc 1 1017 0 is_stmt 1 discriminator 4
  61 0032 1A4B     		ldr	r3, .L8
  62 0034 B3F86032 		ldrh	r3, [r3, #608]
  63 0038 1BB2     		sxth	r3, r3
  64 003a 9B03     		lsls	r3, r3, #14
  65 003c 184A     		ldr	r2, .L8+4
  66 003e 82FB0312 		smull	r1, r2, r2, r3
  67 0042 DB17     		asrs	r3, r3, #31
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 20


  68 0044 C3EB6213 		rsb	r3, r3, r2, asr #5
  69 0048 174A     		ldr	r2, .L8+12
  70 004a 1360     		str	r3, [r2]
1018:Src/pid.c     **** 	g_Vd = 0;
  71              		.loc 1 1018 0 discriminator 4
  72 004c 174B     		ldr	r3, .L8+16
  73 004e 0022     		movs	r2, #0
  74 0050 1A60     		str	r2, [r3]
1019:Src/pid.c     **** 
1020:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1021:Src/pid.c     **** //	if(observer_speed < 0)
1022:Src/pid.c     **** //	{
1023:Src/pid.c     **** //		g_ElectricAngle = 0 - g_ElectricAngle;
1024:Src/pid.c     **** //	}
1025:Src/pid.c     **** //	g_ElectricAngle += 32768;
1026:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1027:Src/pid.c     **** 	anlge_reg = g_ElectricAngle;//observer_ElectricAngle;
  75              		.loc 1 1027 0 discriminator 4
  76 0052 174B     		ldr	r3, .L8+20
  77 0054 1B68     		ldr	r3, [r3]
  78 0056 1BB2     		sxth	r3, r3
  79 0058 164A     		ldr	r2, .L8+24
  80 005a 1380     		strh	r3, [r2]	@ movhi
1028:Src/pid.c     **** 	
1029:Src/pid.c     **** 	if(anlge_reg < EN_0)
  81              		.loc 1 1029 0 discriminator 4
  82 005c 164A     		ldr	r2, .L8+28
  83 005e B2F90020 		ldrsh	r2, [r2]
  84 0062 9342     		cmp	r3, r2
  85 0064 0BDB     		blt	.L7
1030:Src/pid.c     **** 	{
1031:Src/pid.c     **** 		anlge_reg = anlge_reg+EN_360;
1032:Src/pid.c     **** 	}
1033:Src/pid.c     **** 	else if(anlge_reg > EN_360)
  86              		.loc 1 1033 0
  87 0066 154A     		ldr	r2, .L8+32
  88 0068 B2F90020 		ldrsh	r2, [r2]
  89 006c 9342     		cmp	r3, r2
  90 006e 0BDD     		ble	.L5
1034:Src/pid.c     **** 	{
1035:Src/pid.c     **** 		anlge_reg = anlge_reg-EN_360;
  91              		.loc 1 1035 0
  92 0070 9B1A     		subs	r3, r3, r2
  93 0072 104A     		ldr	r2, .L8+24
  94 0074 1380     		strh	r3, [r2]	@ movhi
  95 0076 07E0     		b	.L5
  96              	.LVL2:
  97              	.L2:
1015:Src/pid.c     **** 	
  98              		.loc 1 1015 0 discriminator 2
  99 0078 0A4B     		ldr	r3, .L8+8
 100 007a 1B68     		ldr	r3, [r3]
 101 007c D7E7     		b	.L3
 102              	.LVL3:
 103              	.L7:
1031:Src/pid.c     **** 	}
 104              		.loc 1 1031 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 21


 105 007e 0F4A     		ldr	r2, .L8+32
 106 0080 1288     		ldrh	r2, [r2]
 107 0082 1344     		add	r3, r3, r2
 108 0084 0B4A     		ldr	r2, .L8+24
 109 0086 1380     		strh	r3, [r2]	@ movhi
 110              	.L5:
1036:Src/pid.c     **** 	}
1037:Src/pid.c     ****   PWM_OutPut_Open(TIM1, anlge_reg, g_Timer1CCR);
 111              		.loc 1 1037 0
 112 0088 064B     		ldr	r3, .L8+8
 113 008a 1A68     		ldr	r2, [r3]
 114 008c 094B     		ldr	r3, .L8+24
 115 008e B3F90010 		ldrsh	r1, [r3]
 116 0092 0B48     		ldr	r0, .L8+36
 117 0094 FFF7FEFF 		bl	PWM_OutPut_Open
 118              	.LVL4:
1038:Src/pid.c     **** }
 119              		.loc 1 1038 0
 120 0098 08BD     		pop	{r3, pc}
 121              	.L9:
 122 009a 00BF     		.align	2
 123              	.L8:
 124 009c 00000000 		.word	g_CmdMap
 125 00a0 1F85EB51 		.word	1374389535
 126 00a4 00000000 		.word	g_Timer1CCR
 127 00a8 00000000 		.word	.LANCHOR0
 128 00ac 00000000 		.word	.LANCHOR1
 129 00b0 00000000 		.word	g_ElectricAngle
 130 00b4 00000000 		.word	anlge_reg
 131 00b8 00000000 		.word	EN_0
 132 00bc 00000000 		.word	EN_360
 133 00c0 002C0140 		.word	1073818624
 134              		.cfi_endproc
 135              	.LFE343:
 137              		.global	__aeabi_i2d
 138              		.global	__aeabi_ddiv
 139              		.global	__aeabi_dmul
 140              		.global	__aeabi_d2uiz
 141              		.section	.text.Calculate_CCR_SVP,"ax",%progbits
 142              		.align	1
 143              		.syntax unified
 144              		.thumb
 145              		.thumb_func
 146              		.fpu fpv4-sp-d16
 148              	Calculate_CCR_SVP:
 149              	.LFB337:
 304:Src/pid.c     ****   s32 t0, tk, tk_1;
 150              		.loc 1 304 0
 151              		.cfi_startproc
 152              		@ args = 4, pretend = 0, frame = 0
 153              		@ frame_needed = 0, uses_anonymous_args = 0
 154              	.LVL5:
 155 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 156              	.LCFI1:
 157              		.cfi_def_cfa_offset 32
 158              		.cfi_offset 3, -32
 159              		.cfi_offset 4, -28
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 22


 160              		.cfi_offset 5, -24
 161              		.cfi_offset 6, -20
 162              		.cfi_offset 7, -16
 163              		.cfi_offset 8, -12
 164              		.cfi_offset 9, -8
 165              		.cfi_offset 14, -4
 166 0004 0446     		mov	r4, r0
 167 0006 0898     		ldr	r0, [sp, #32]
 168              	.LVL6:
 309:Src/pid.c     ****   {
 169              		.loc 1 309 0
 170 0008 0139     		subs	r1, r1, #1
 171              	.LVL7:
 172 000a 0529     		cmp	r1, #5
 173 000c 62D8     		bhi	.L28
 174 000e DFE801F0 		tbb	[pc, r1]
 175              	.L13:
 176 0012 03       		.byte	(.L12-.L13)/2
 177 0013 3E       		.byte	(.L14-.L13)/2
 178 0014 45       		.byte	(.L15-.L13)/2
 179 0015 4C       		.byte	(.L16-.L13)/2
 180 0016 53       		.byte	(.L17-.L13)/2
 181 0017 5A       		.byte	(.L18-.L13)/2
 182              		.p2align 1
 183              	.L12:
 184              	.LVL8:
 314:Src/pid.c     **** 			CCR3 = t0>>1;
 185              		.loc 1 314 0
 186 0018 C3F55261 		rsb	r1, r3, #3360
 187              	.LVL9:
 188 001c 091A     		subs	r1, r1, r0
 189              	.LVL10:
 315:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 190              		.loc 1 315 0
 191 001e 4910     		asrs	r1, r1, #1
 192              	.LVL11:
 316:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
 193              		.loc 1 316 0
 194 0020 5E18     		adds	r6, r3, r1
 195              	.LVL12:
 317:Src/pid.c     **** 		break;		
 196              		.loc 1 317 0
 197 0022 8519     		adds	r5, r0, r6
 198              	.LVL13:
 199              	.L11:
 365:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 200              		.loc 1 365 0
 201 0024 40F67533 		movw	r3, #2933
 202              	.LVL14:
 203 0028 9E42     		cmp	r6, r3
 204 002a 58DC     		bgt	.L29
 365:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 205              		.loc 1 365 0 is_stmt 0 discriminator 1
 206 002c 26EAE676 		bic	r6, r6, r6, asr #31
 207              	.LVL15:
 208              	.L19:
 366:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 23


 209              		.loc 1 366 0 is_stmt 1 discriminator 4
 210 0030 40F67533 		movw	r3, #2933
 211 0034 9D42     		cmp	r5, r3
 212 0036 55DC     		bgt	.L30
 366:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 213              		.loc 1 366 0 is_stmt 0 discriminator 1
 214 0038 25EAE575 		bic	r5, r5, r5, asr #31
 215              	.LVL16:
 216              	.L20:
 367:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 217              		.loc 1 367 0 is_stmt 1 discriminator 4
 218 003c 40F67533 		movw	r3, #2933
 219 0040 9942     		cmp	r1, r3
 220 0042 52DC     		bgt	.L31
 367:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 221              		.loc 1 367 0 is_stmt 0 discriminator 1
 222 0044 21EAE171 		bic	r1, r1, r1, asr #31
 223              	.LVL17:
 224              	.L21:
 368:Src/pid.c     **** 	{
 225              		.loc 1 368 0 is_stmt 1 discriminator 4
 226 0048 794B     		ldr	r3, .L36+8
 227 004a B3F81A32 		ldrh	r3, [r3, #538]
 228 004e 1BB2     		sxth	r3, r3
 229 0050 1BB9     		cbnz	r3, .L22
 370:Src/pid.c     **** 			sin_wave_t_us = 0;
 230              		.loc 1 370 0
 231 0052 784A     		ldr	r2, .L36+12
 232              	.LVL18:
 233 0054 1360     		str	r3, [r2]
 371:Src/pid.c     **** 	}
 234              		.loc 1 371 0
 235 0056 784A     		ldr	r2, .L36+16
 236 0058 1360     		str	r3, [r2]
 237              	.L22:
 375:Src/pid.c     **** 	{
 238              		.loc 1 375 0
 239 005a 754B     		ldr	r3, .L36+8
 240 005c B3F81A32 		ldrh	r3, [r3, #538]
 241 0060 1BB2     		sxth	r3, r3
 242 0062 042B     		cmp	r3, #4
 243 0064 44D0     		beq	.L23
 375:Src/pid.c     **** 	{
 244              		.loc 1 375 0 is_stmt 0 discriminator 1
 245 0066 724B     		ldr	r3, .L36+8
 246 0068 B3F81A32 		ldrh	r3, [r3, #538]
 247 006c 1BB2     		sxth	r3, r3
 248 006e 052B     		cmp	r3, #5
 249 0070 3ED0     		beq	.L23
 250              	.L24:
 384:Src/pid.c     **** 	{
 251              		.loc 1 384 0 is_stmt 1
 252 0072 6F4B     		ldr	r3, .L36+8
 253 0074 B3F81A32 		ldrh	r3, [r3, #538]
 254 0078 1BB2     		sxth	r3, r3
 255 007a 042B     		cmp	r3, #4
 256 007c 48D0     		beq	.L34
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 24


 257              	.LVL19:
 258              	.L25:
 410:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 259              		.loc 1 410 0
 260 007e E163     		str	r1, [r4, #60]
 411:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 261              		.loc 1 411 0
 262 0080 A563     		str	r5, [r4, #56]
 412:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 263              		.loc 1 412 0
 264 0082 6663     		str	r6, [r4, #52]
 414:Src/pid.c     **** }
 265              		.loc 1 414 0
 266 0084 45F25553 		movw	r3, #21845
 267 0088 2362     		str	r3, [r4, #32]
 415:Src/pid.c     **** 
 268              		.loc 1 415 0
 269 008a BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 270              	.LVL20:
 271              	.L14:
 322:Src/pid.c     **** 			CCR2 = t0>>1;
 272              		.loc 1 322 0
 273 008e 02F55265 		add	r5, r2, #3360
 274 0092 ED1A     		subs	r5, r5, r3
 275              	.LVL21:
 323:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 276              		.loc 1 323 0
 277 0094 6D10     		asrs	r5, r5, #1
 278              	.LVL22:
 279 0096 A91A     		subs	r1, r5, r2
 280              	.LVL23:
 325:Src/pid.c     **** 		break;		
 281              		.loc 1 325 0
 282 0098 5E18     		adds	r6, r3, r1
 283              	.LVL24:
 326:Src/pid.c     **** 		case 3:
 284              		.loc 1 326 0
 285 009a C3E7     		b	.L11
 286              	.LVL25:
 287              	.L15:
 330:Src/pid.c     **** 			CCR3 = t0>>1;
 288              		.loc 1 330 0
 289 009c 00F55261 		add	r1, r0, #3360
 290 00a0 891A     		subs	r1, r1, r2
 291              	.LVL26:
 331:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 292              		.loc 1 331 0
 293 00a2 4910     		asrs	r1, r1, #1
 294              	.LVL27:
 332:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 295              		.loc 1 332 0
 296 00a4 5518     		adds	r5, r2, r1
 297              	.LVL28:
 298 00a6 2E1A     		subs	r6, r5, r0
 299              	.LVL29:
 334:Src/pid.c     **** 		case 4:
 300              		.loc 1 334 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 25


 301 00a8 BCE7     		b	.L11
 302              	.LVL30:
 303              	.L16:
 338:Src/pid.c     **** 			CCR1 = t0>>1;
 304              		.loc 1 338 0
 305 00aa C0F55266 		rsb	r6, r0, #3360
 306 00ae 1644     		add	r6, r6, r2
 307              	.LVL31:
 339:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 308              		.loc 1 339 0
 309 00b0 7610     		asrs	r6, r6, #1
 310              	.LVL32:
 340:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 311              		.loc 1 340 0
 312 00b2 8519     		adds	r5, r0, r6
 313              	.LVL33:
 314 00b4 A91A     		subs	r1, r5, r2
 315              	.LVL34:
 342:Src/pid.c     **** 		case 5:
 316              		.loc 1 342 0
 317 00b6 B5E7     		b	.L11
 318              	.LVL35:
 319              	.L17:
 346:Src/pid.c     **** 			CCR1 = t0>>1;
 320              		.loc 1 346 0
 321 00b8 C2F55266 		rsb	r6, r2, #3360
 322 00bc 1E44     		add	r6, r6, r3
 323              	.LVL36:
 347:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 324              		.loc 1 347 0
 325 00be 7610     		asrs	r6, r6, #1
 326              	.LVL37:
 327 00c0 F11A     		subs	r1, r6, r3
 328              	.LVL38:
 349:Src/pid.c     **** 		break;
 329              		.loc 1 349 0
 330 00c2 8D18     		adds	r5, r1, r2
 331              	.LVL39:
 350:Src/pid.c     **** 		case 6:
 332              		.loc 1 350 0
 333 00c4 AEE7     		b	.L11
 334              	.LVL40:
 335              	.L18:
 354:Src/pid.c     **** 			CCR2 = t0>>1;
 336              		.loc 1 354 0
 337 00c6 03F55265 		add	r5, r3, #3360
 338 00ca 0544     		add	r5, r5, r0
 339              	.LVL41:
 355:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 340              		.loc 1 355 0
 341 00cc 6D10     		asrs	r5, r5, #1
 342              	.LVL42:
 343 00ce 2E1A     		subs	r6, r5, r0
 344              	.LVL43:
 345 00d0 F11A     		subs	r1, r6, r3
 346              	.LVL44:
 358:Src/pid.c     **** 		default:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 26


 347              		.loc 1 358 0
 348 00d2 A7E7     		b	.L11
 349              	.LVL45:
 350              	.L28:
 362:Src/pid.c     **** 		break;
 351              		.loc 1 362 0
 352 00d4 4FF4D261 		mov	r1, #1680
 361:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 353              		.loc 1 361 0
 354 00d8 0D46     		mov	r5, r1
 360:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 355              		.loc 1 360 0
 356 00da 0E46     		mov	r6, r1
 357 00dc A2E7     		b	.L11
 358              	.LVL46:
 359              	.L29:
 365:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 360              		.loc 1 365 0
 361 00de 40F67536 		movw	r6, #2933
 362              	.LVL47:
 363 00e2 A5E7     		b	.L19
 364              	.LVL48:
 365              	.L30:
 366:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 366              		.loc 1 366 0
 367 00e4 40F67535 		movw	r5, #2933
 368              	.LVL49:
 369 00e8 A8E7     		b	.L20
 370              	.LVL50:
 371              	.L31:
 367:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 372              		.loc 1 367 0
 373 00ea 40F67531 		movw	r1, #2933
 374              	.LVL51:
 375 00ee ABE7     		b	.L21
 376              	.LVL52:
 377              	.L23:
 377:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 378              		.loc 1 377 0
 379 00f0 514B     		ldr	r3, .L36+16
 380 00f2 1A68     		ldr	r2, [r3]
 381 00f4 0432     		adds	r2, r2, #4
 382 00f6 1A60     		str	r2, [r3]
 378:Src/pid.c     **** 		{
 383              		.loc 1 378 0
 384 00f8 1B68     		ldr	r3, [r3]
 385 00fa B3F57A7F 		cmp	r3, #1000
 386 00fe B8DD     		ble	.L24
 380:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 387              		.loc 1 380 0
 388 0100 4D4B     		ldr	r3, .L36+16
 389 0102 0022     		movs	r2, #0
 390 0104 1A60     		str	r2, [r3]
 381:Src/pid.c     **** 		}
 391              		.loc 1 381 0
 392 0106 4B4A     		ldr	r2, .L36+12
 393 0108 1368     		ldr	r3, [r2]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 27


 394 010a 0133     		adds	r3, r3, #1
 395 010c 1360     		str	r3, [r2]
 396 010e B0E7     		b	.L24
 397              	.L34:
 398              	.LVL53:
 389:Src/pid.c     **** 		if(Para_Identificaion>=0)
 399              		.loc 1 389 0
 400 0110 4A4B     		ldr	r3, .L36+20
 401 0112 1A68     		ldr	r2, [r3]
 402 0114 0132     		adds	r2, r2, #1
 403 0116 1A60     		str	r2, [r3]
 390:Src/pid.c     **** 		{
 404              		.loc 1 390 0
 405 0118 1B68     		ldr	r3, [r3]
 406 011a 002B     		cmp	r3, #0
 407 011c 23DB     		blt	.L26
 392:Src/pid.c     **** 			if(index_I_phase<100)
 408              		.loc 1 392 0
 409 011e 474B     		ldr	r3, .L36+20
 410 0120 0022     		movs	r2, #0
 411 0122 1A60     		str	r2, [r3]
 393:Src/pid.c     **** 			{
 412              		.loc 1 393 0
 413 0124 464B     		ldr	r3, .L36+24
 414 0126 1B68     		ldr	r3, [r3]
 415 0128 632B     		cmp	r3, #99
 416 012a 18DC     		bgt	.L27
 395:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
 417              		.loc 1 395 0
 418 012c 444A     		ldr	r2, .L36+24
 419 012e 1068     		ldr	r0, [r2]
 420 0130 444B     		ldr	r3, .L36+28
 421 0132 B3F90010 		ldrsh	r1, [r3]
 422 0136 4942     		negs	r1, r1
 423 0138 434B     		ldr	r3, .L36+32
 424 013a 43F82010 		str	r1, [r3, r0, lsl #2]
 396:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 425              		.loc 1 396 0
 426 013e 1168     		ldr	r1, [r2]
 427 0140 4248     		ldr	r0, .L36+36
 428 0142 B0F90000 		ldrsh	r0, [r0]
 429 0146 4042     		negs	r0, r0
 430 0148 6431     		adds	r1, r1, #100
 431 014a 43F82100 		str	r0, [r3, r1, lsl #2]
 397:Src/pid.c     **** 			}
 432              		.loc 1 397 0
 433 014e 1268     		ldr	r2, [r2]
 434 0150 3F49     		ldr	r1, .L36+40
 435 0152 B1F90010 		ldrsh	r1, [r1]
 436 0156 4942     		negs	r1, r1
 437 0158 C832     		adds	r2, r2, #200
 438 015a 43F82210 		str	r1, [r3, r2, lsl #2]
 439              	.L27:
 399:Src/pid.c     **** 		}
 440              		.loc 1 399 0
 441 015e 384A     		ldr	r2, .L36+24
 442 0160 1368     		ldr	r3, [r2]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 28


 443 0162 0133     		adds	r3, r3, #1
 444 0164 1360     		str	r3, [r2]
 445              	.L26:
 401:Src/pid.c     **** 		{	
 446              		.loc 1 401 0
 447 0166 334B     		ldr	r3, .L36+12
 448 0168 1B68     		ldr	r3, [r3]
 449 016a C82B     		cmp	r3, #200
 450 016c 04DC     		bgt	.L35
 388:Src/pid.c     **** 		Para_Identificaion++;
 451              		.loc 1 388 0
 452 016e 40F61F51 		movw	r1, #3359
 387:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 453              		.loc 1 387 0
 454 0172 0D46     		mov	r5, r1
 386:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 455              		.loc 1 386 0
 456 0174 0126     		movs	r6, #1
 457 0176 82E7     		b	.L25
 458              	.L35:
 403:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 459              		.loc 1 403 0
 460 0178 334E     		ldr	r6, .L36+32
 461 017a D6F88C01 		ldr	r0, [r6, #396]
 462 017e FFF7FEFF 		bl	__aeabi_i2d
 463              	.LVL54:
 464 0182 8046     		mov	r8, r0
 465 0184 01F10049 		add	r9, r1, #-2147483648
 466 0188 B068     		ldr	r0, [r6, #8]
 467 018a D6F88C31 		ldr	r3, [r6, #396]
 468 018e C01A     		subs	r0, r0, r3
 469 0190 FFF7FEFF 		bl	__aeabi_i2d
 470              	.LVL55:
 471 0194 0246     		mov	r2, r0
 472 0196 0B46     		mov	r3, r1
 473 0198 4046     		mov	r0, r8
 474 019a 4946     		mov	r1, r9
 475 019c FFF7FEFF 		bl	__aeabi_ddiv
 476              	.LVL56:
 477 01a0 41EC100B 		vmov	d0, r0, r1
 478 01a4 FFF7FEFF 		bl	log
 479              	.LVL57:
 480 01a8 53EC102B 		vmov	r2, r3, d0
 481 01ac 1EA1     		adr	r1, .L36
 482 01ae D1E90001 		ldrd	r0, [r1]
 483 01b2 FFF7FEFF 		bl	__aeabi_ddiv
 484              	.LVL58:
 485 01b6 8046     		mov	r8, r0
 486 01b8 8946     		mov	r9, r1
 487 01ba 264B     		ldr	r3, .L36+44
 488 01bc C3E90089 		strd	r8, [r3]
 404:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 489              		.loc 1 404 0
 490 01c0 0246     		mov	r2, r0
 491 01c2 0B46     		mov	r3, r1
 492 01c4 0020     		movs	r0, #0
 493 01c6 2449     		ldr	r1, .L36+48
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 29


 494 01c8 FFF7FEFF 		bl	__aeabi_ddiv
 495              	.LVL59:
 496 01cc 234B     		ldr	r3, .L36+52
 497 01ce C3E90001 		strd	r0, [r3]
 405:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 498              		.loc 1 405 0
 499 01d2 174D     		ldr	r5, .L36+8
 500 01d4 0023     		movs	r3, #0
 501 01d6 A5F81A32 		strh	r3, [r5, #538]	@ movhi
 406:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
 502              		.loc 1 406 0
 503 01da D6F88C21 		ldr	r2, [r6, #396]
 504 01de 02EB4202 		add	r2, r2, r2, lsl #1
 505 01e2 1F4B     		ldr	r3, .L36+56
 506 01e4 93FBF2F3 		sdiv	r3, r3, r2
 507 01e8 1BB2     		sxth	r3, r3
 508 01ea A5F84032 		strh	r3, [r5, #576]	@ movhi
 407:Src/pid.c     **** 		}
 509              		.loc 1 407 0
 510 01ee 0022     		movs	r2, #0
 511 01f0 1C4B     		ldr	r3, .L36+60
 512 01f2 4046     		mov	r0, r8
 513 01f4 4946     		mov	r1, r9
 514 01f6 FFF7FEFF 		bl	__aeabi_dmul
 515              	.LVL60:
 516 01fa 0646     		mov	r6, r0
 517 01fc 0F46     		mov	r7, r1
 518 01fe B5F84002 		ldrh	r0, [r5, #576]
 519 0202 00B2     		sxth	r0, r0
 520 0204 FFF7FEFF 		bl	__aeabi_i2d
 521              	.LVL61:
 522 0208 0246     		mov	r2, r0
 523 020a 0B46     		mov	r3, r1
 524 020c 3046     		mov	r0, r6
 525 020e 3946     		mov	r1, r7
 526 0210 FFF7FEFF 		bl	__aeabi_dmul
 527              	.LVL62:
 528 0214 FFF7FEFF 		bl	__aeabi_d2uiz
 529              	.LVL63:
 530 0218 00B2     		sxth	r0, r0
 531 021a A5F84202 		strh	r0, [r5, #578]	@ movhi
 388:Src/pid.c     **** 		Para_Identificaion++;
 532              		.loc 1 388 0
 533 021e 40F61F51 		movw	r1, #3359
 387:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 534              		.loc 1 387 0
 535 0222 0D46     		mov	r5, r1
 386:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 536              		.loc 1 386 0
 537 0224 0126     		movs	r6, #1
 538 0226 2AE7     		b	.L25
 539              	.L37:
 540              		.align	3
 541              	.L36:
 542 0228 F168E388 		.word	-1998362383
 543 022c B5F8043F 		.word	1057290421
 544 0230 00000000 		.word	g_CmdMap
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 30


 545 0234 00000000 		.word	.LANCHOR2
 546 0238 00000000 		.word	.LANCHOR3
 547 023c 00000000 		.word	.LANCHOR4
 548 0240 00000000 		.word	.LANCHOR5
 549 0244 00000000 		.word	.LANCHOR6
 550 0248 00000000 		.word	.LANCHOR7
 551 024c 00000000 		.word	.LANCHOR8
 552 0250 00000000 		.word	.LANCHOR9
 553 0254 00000000 		.word	.LANCHOR10
 554 0258 0000F0BF 		.word	-1074790400
 555 025c 00000000 		.word	.LANCHOR11
 556 0260 00366E01 		.word	24000000
 557 0264 00408F40 		.word	1083129856
 558              		.cfi_endproc
 559              	.LFE337:
 561              		.section	.text.PID_ini,"ax",%progbits
 562              		.align	1
 563              		.global	PID_ini
 564              		.syntax unified
 565              		.thumb
 566              		.thumb_func
 567              		.fpu fpv4-sp-d16
 569              	PID_ini:
 570              	.LFB333:
  85:Src/pid.c     **** 		p_pid->integral = 0;
 571              		.loc 1 85 0
 572              		.cfi_startproc
 573              		@ args = 0, pretend = 0, frame = 0
 574              		@ frame_needed = 0, uses_anonymous_args = 0
 575              		@ link register save eliminated.
 576              	.LVL64:
  86:Src/pid.c     **** 		p_pid->error = 0;
 577              		.loc 1 86 0
 578 0000 0023     		movs	r3, #0
 579 0002 4364     		str	r3, [r0, #68]
  87:Src/pid.c     **** 		p_pid->error_last = 0;
 580              		.loc 1 87 0
 581 0004 8361     		str	r3, [r0, #24]
  88:Src/pid.c     **** 		p_pid->out = 0;
 582              		.loc 1 88 0
 583 0006 C361     		str	r3, [r0, #28]
  89:Src/pid.c     **** 		p_pid->frequency = freq;
 584              		.loc 1 89 0
 585 0008 4363     		str	r3, [r0, #52]
  90:Src/pid.c     **** }
 586              		.loc 1 90 0
 587 000a 8163     		str	r1, [r0, #56]
  91:Src/pid.c     **** void PID_control(s32 set,s32 act,struct PID_TYPE * p_pid)   //PID
 588              		.loc 1 91 0
 589 000c 7047     		bx	lr
 590              		.cfi_endproc
 591              	.LFE333:
 593              		.section	.text.PID_control,"ax",%progbits
 594              		.align	1
 595              		.global	PID_control
 596              		.syntax unified
 597              		.thumb
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 31


 598              		.thumb_func
 599              		.fpu fpv4-sp-d16
 601              	PID_control:
 602              	.LFB334:
  93:Src/pid.c     **** 	s32 deriv=0;
 603              		.loc 1 93 0
 604              		.cfi_startproc
 605              		@ args = 0, pretend = 0, frame = 0
 606              		@ frame_needed = 0, uses_anonymous_args = 0
 607              		@ link register save eliminated.
 608              	.LVL65:
  96:Src/pid.c     **** 	{
 609              		.loc 1 96 0
 610 0000 1368     		ldr	r3, [r2]
 611 0002 002B     		cmp	r3, #0
 612 0004 72D0     		beq	.L56
  93:Src/pid.c     **** 	s32 deriv=0;
 613              		.loc 1 93 0
 614 0006 2DE9F003 		push	{r4, r5, r6, r7, r8, r9}
 615              	.LCFI2:
 616              		.cfi_def_cfa_offset 24
 617              		.cfi_offset 4, -24
 618              		.cfi_offset 5, -20
 619              		.cfi_offset 6, -16
 620              		.cfi_offset 7, -12
 621              		.cfi_offset 8, -8
 622              		.cfi_offset 9, -4
 107:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 623              		.loc 1 107 0
 624 000a 411A     		subs	r1, r0, r1
 625              	.LVL66:
 626 000c 9161     		str	r1, [r2, #24]
 108:Src/pid.c     **** 	{
 627              		.loc 1 108 0
 628 000e 5369     		ldr	r3, [r2, #20]
 629 0010 9942     		cmp	r1, r3
 630 0012 06DA     		bge	.L42
 108:Src/pid.c     **** 	{
 631              		.loc 1 108 0 is_stmt 0 discriminator 1
 632 0014 5B42     		negs	r3, r3
 633 0016 9942     		cmp	r1, r3
 634 0018 03DD     		ble	.L42
 110:Src/pid.c     **** 		p_pid->error = 0;
 635              		.loc 1 110 0 is_stmt 1
 636 001a 0123     		movs	r3, #1
 637 001c 5360     		str	r3, [r2, #4]
 111:Src/pid.c     **** 	}	
 638              		.loc 1 111 0
 639 001e 0023     		movs	r3, #0
 640 0020 9361     		str	r3, [r2, #24]
 641              	.L42:
 113:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 642              		.loc 1 113 0
 643 0022 536B     		ldr	r3, [r2, #52]
 644 0024 D66B     		ldr	r6, [r2, #60]
 645 0026 B342     		cmp	r3, r6
 646 0028 02DA     		bge	.L43
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 32


 113:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 647              		.loc 1 113 0 is_stmt 0 discriminator 1
 648 002a 116C     		ldr	r1, [r2, #64]
 649 002c 8B42     		cmp	r3, r1
 650 002e 0ADC     		bgt	.L44
 651              	.L43:
 113:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 652              		.loc 1 113 0 discriminator 3
 653 0030 B342     		cmp	r3, r6
 654 0032 02DB     		blt	.L45
 114:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 655              		.loc 1 114 0 is_stmt 1
 656 0034 9169     		ldr	r1, [r2, #24]
 657 0036 0029     		cmp	r1, #0
 658 0038 05DB     		blt	.L44
 659              	.L45:
 115:Src/pid.c     **** 	{
 660              		.loc 1 115 0 discriminator 1
 661 003a 116C     		ldr	r1, [r2, #64]
 114:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 662              		.loc 1 114 0 discriminator 1
 663 003c 8B42     		cmp	r3, r1
 664 003e 11DC     		bgt	.L46
 115:Src/pid.c     **** 	{
 665              		.loc 1 115 0
 666 0040 9369     		ldr	r3, [r2, #24]
 667 0042 002B     		cmp	r3, #0
 668 0044 0EDD     		ble	.L46
 669              	.L44:
 125:Src/pid.c     **** 		{
 670              		.loc 1 125 0
 671 0046 D368     		ldr	r3, [r2, #12]
 672 0048 B3F57A7F 		cmp	r3, #1000
 673 004c 59DD     		ble	.L47
 127:Src/pid.c     **** 		}
 674              		.loc 1 127 0
 675 004e 9169     		ldr	r1, [r2, #24]
 676 0050 3948     		ldr	r0, .L57
 677              	.LVL67:
 678 0052 80FB0340 		smull	r4, r0, r0, r3
 679 0056 DB17     		asrs	r3, r3, #31
 680 0058 C3EB6013 		rsb	r3, r3, r0, asr #5
 681 005c 506C     		ldr	r0, [r2, #68]
 682 005e 03FB0103 		mla	r3, r3, r1, r0
 683 0062 5364     		str	r3, [r2, #68]
 684              	.L46:
 134:Src/pid.c     **** 	
 685              		.loc 1 134 0
 686 0064 9769     		ldr	r7, [r2, #24]
 687 0066 9568     		ldr	r5, [r2, #8]
 688 0068 05FB07F5 		mul	r5, r5, r7
 689 006c 324B     		ldr	r3, .L57
 690 006e 83FB0513 		smull	r1, r3, r3, r5
 691 0072 EC17     		asrs	r4, r5, #31
 692 0074 C4EB6314 		rsb	r4, r4, r3, asr #5
 693 0078 1462     		str	r4, [r2, #32]
 145:Src/pid.c     **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 33


 694              		.loc 1 145 0
 695 007a D368     		ldr	r3, [r2, #12]
 696 007c B3F57A7F 		cmp	r3, #1000
 697 0080 45DD     		ble	.L48
 147:Src/pid.c     **** 	}
 698              		.loc 1 147 0
 699 0082 536C     		ldr	r3, [r2, #68]
 700 0084 6420     		movs	r0, #100
 701 0086 00FB03F0 		mul	r0, r0, r3
 702 008a 936B     		ldr	r3, [r2, #56]
 703 008c 90FBF3F0 		sdiv	r0, r0, r3
 704 0090 C117     		asrs	r1, r0, #31
 705 0092 C2E90A01 		strd	r0, [r2, #40]
 706              	.L49:
 153:Src/pid.c     **** 	{
 707              		.loc 1 153 0
 708 0096 D2E90A01 		ldrd	r0, [r2, #40]
 709 009a B0F1004F 		cmp	r0, #-2147483648
 710 009e 71F10003 		sbcs	r3, r1, #0
 711 00a2 3CDB     		blt	.L50
 155:Src/pid.c     **** 	}
 712              		.loc 1 155 0
 713 00a4 6FF00040 		mvn	r0, #-2147483648
 714 00a8 0021     		movs	r1, #0
 715 00aa C2E90A01 		strd	r0, [r2, #40]
 716              	.L51:
 161:Src/pid.c     **** 	p_pid->Part_D = p_pid->Kd * ( 9*deriv + 1*(p_pid->error-p_pid->error_last) )   /1000 ;
 717              		.loc 1 161 0
 718 00ae 106B     		ldr	r0, [r2, #48]
 719              	.LVL68:
 162:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 720              		.loc 1 162 0
 721 00b0 1369     		ldr	r3, [r2, #16]
 722 00b2 00EBC000 		add	r0, r0, r0, lsl #3
 723              	.LVL69:
 724 00b6 D169     		ldr	r1, [r2, #28]
 725 00b8 791A     		subs	r1, r7, r1
 726 00ba 0144     		add	r1, r1, r0
 727 00bc 01FB03F1 		mul	r1, r1, r3
 728 00c0 1E4B     		ldr	r3, .L57+4
 729 00c2 83FB0103 		smull	r0, r3, r3, r1
 730 00c6 C917     		asrs	r1, r1, #31
 731 00c8 C1EBA313 		rsb	r3, r1, r3, asr #6
 732 00cc 1363     		str	r3, [r2, #48]
 733              	.LVL70:
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 734              		.loc 1 163 0
 735 00ce 916A     		ldr	r1, [r2, #40]
 736 00d0 0C44     		add	r4, r4, r1
 737 00d2 2344     		add	r3, r3, r4
 738 00d4 5363     		str	r3, [r2, #52]
 164:Src/pid.c     **** 	{
 739              		.loc 1 164 0
 740 00d6 9E42     		cmp	r6, r3
 741 00d8 00DA     		bge	.L52
 166:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 742              		.loc 1 166 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 34


 743 00da 5663     		str	r6, [r2, #52]
 744              	.L52:
 169:Src/pid.c     **** 	{
 745              		.loc 1 169 0
 746 00dc 516B     		ldr	r1, [r2, #52]
 747 00de 136C     		ldr	r3, [r2, #64]
 748 00e0 9942     		cmp	r1, r3
 749 00e2 00DA     		bge	.L39
 171:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 750              		.loc 1 171 0
 751 00e4 5363     		str	r3, [r2, #52]
 752              	.L39:
 175:Src/pid.c     **** //Force PID output
 753              		.loc 1 175 0
 754 00e6 BDE8F003 		pop	{r4, r5, r6, r7, r8, r9}
 755              	.LCFI3:
 756              		.cfi_restore 9
 757              		.cfi_restore 8
 758              		.cfi_restore 7
 759              		.cfi_restore 6
 760              		.cfi_restore 5
 761              		.cfi_restore 4
 762              		.cfi_def_cfa_offset 0
 763 00ea 7047     		bx	lr
 764              	.LVL71:
 765              	.L56:
  98:Src/pid.c     **** 		p_pid->error = 0;
 766              		.loc 1 98 0
 767 00ec 5364     		str	r3, [r2, #68]
  99:Src/pid.c     **** 		p_pid->error_last = 0;
 768              		.loc 1 99 0
 769 00ee 9361     		str	r3, [r2, #24]
 100:Src/pid.c     **** 		p_pid->out = 0;
 770              		.loc 1 100 0
 771 00f0 D361     		str	r3, [r2, #28]
 101:Src/pid.c     **** 		p_pid->Part_P = 0;
 772              		.loc 1 101 0
 773 00f2 5363     		str	r3, [r2, #52]
 102:Src/pid.c     **** 		p_pid->Part_I = 0;
 774              		.loc 1 102 0
 775 00f4 1362     		str	r3, [r2, #32]
 103:Src/pid.c     **** 		p_pid->Part_D = 0;
 776              		.loc 1 103 0
 777 00f6 0020     		movs	r0, #0
 778              	.LVL72:
 779 00f8 0021     		movs	r1, #0
 780              	.LVL73:
 781 00fa C2E90A01 		strd	r0, [r2, #40]
 104:Src/pid.c     **** 		return;
 782              		.loc 1 104 0
 783 00fe 1363     		str	r3, [r2, #48]
 784 0100 7047     		bx	lr
 785              	.LVL74:
 786              	.L47:
 787              	.LCFI4:
 788              		.cfi_def_cfa_offset 24
 789              		.cfi_offset 4, -24
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 35


 790              		.cfi_offset 5, -20
 791              		.cfi_offset 6, -16
 792              		.cfi_offset 7, -12
 793              		.cfi_offset 8, -8
 794              		.cfi_offset 9, -4
 131:Src/pid.c     **** 		}
 795              		.loc 1 131 0
 796 0102 9069     		ldr	r0, [r2, #24]
 797              	.LVL75:
 798 0104 516C     		ldr	r1, [r2, #68]
 799 0106 00FB0313 		mla	r3, r0, r3, r1
 800 010a 5364     		str	r3, [r2, #68]
 801 010c AAE7     		b	.L46
 802              	.L48:
 151:Src/pid.c     **** 	}	
 803              		.loc 1 151 0
 804 010e 506C     		ldr	r0, [r2, #68]
 805 0110 936B     		ldr	r3, [r2, #56]
 806 0112 90FBF3F0 		sdiv	r0, r0, r3
 807 0116 C117     		asrs	r1, r0, #31
 808 0118 C2E90A01 		strd	r0, [r2, #40]
 809 011c BBE7     		b	.L49
 810              	.L50:
 157:Src/pid.c     **** 	{
 811              		.loc 1 157 0
 812 011e DFF82080 		ldr	r8, .L57+8
 813 0122 4FF0FF39 		mov	r9, #-1
 814 0126 4045     		cmp	r0, r8
 815 0128 71EB0903 		sbcs	r3, r1, r9
 816 012c BFDA     		bge	.L51
 159:Src/pid.c     **** 	}
 817              		.loc 1 159 0
 818 012e 4046     		mov	r0, r8
 819 0130 4946     		mov	r1, r9
 820 0132 C2E90A01 		strd	r0, [r2, #40]
 821 0136 BAE7     		b	.L51
 822              	.L58:
 823              		.align	2
 824              	.L57:
 825 0138 1F85EB51 		.word	1374389535
 826 013c D34D6210 		.word	274877907
 827 0140 01000080 		.word	-2147483647
 828              		.cfi_endproc
 829              	.LFE334:
 831              		.section	.text.CurrentPID,"ax",%progbits
 832              		.align	1
 833              		.syntax unified
 834              		.thumb
 835              		.thumb_func
 836              		.fpu fpv4-sp-d16
 838              	CurrentPID:
 839              	.LFB338:
 421:Src/pid.c     ****   s32 temp32 = 0;       
 840              		.loc 1 421 0
 841              		.cfi_startproc
 842              		@ args = 0, pretend = 0, frame = 0
 843              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 36


 844 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 845              	.LCFI5:
 846              		.cfi_def_cfa_offset 28
 847              		.cfi_offset 4, -28
 848              		.cfi_offset 5, -24
 849              		.cfi_offset 6, -20
 850              		.cfi_offset 7, -16
 851              		.cfi_offset 8, -12
 852              		.cfi_offset 9, -8
 853              		.cfi_offset 14, -4
 854 0004 83B0     		sub	sp, sp, #12
 855              	.LCFI6:
 856              		.cfi_def_cfa_offset 40
 857              	.LVL76:
 429:Src/pid.c     **** 	{
 858              		.loc 1 429 0
 859 0006 A74B     		ldr	r3, .L101
 860 0008 B3F80432 		ldrh	r3, [r3, #516]
 861 000c 1BB2     		sxth	r3, r3
 862 000e 012B     		cmp	r3, #1
 863 0010 23D0     		beq	.L60
 431:Src/pid.c     **** 		{
 864              		.loc 1 431 0
 865 0012 A44B     		ldr	r3, .L101
 866 0014 B3F80432 		ldrh	r3, [r3, #516]
 867 0018 1BB2     		sxth	r3, r3
 868 001a 022B     		cmp	r3, #2
 869 001c 10D0     		beq	.L61
 431:Src/pid.c     **** 		{
 870              		.loc 1 431 0 is_stmt 0 discriminator 1
 871 001e A14B     		ldr	r3, .L101
 872 0020 B3F80432 		ldrh	r3, [r3, #516]
 873 0024 1BB2     		sxth	r3, r3
 874 0026 032B     		cmp	r3, #3
 875 0028 0AD0     		beq	.L61
 437:Src/pid.c     **** 		{
 876              		.loc 1 437 0 is_stmt 1
 877 002a 9E4B     		ldr	r3, .L101
 878 002c B3F80432 		ldrh	r3, [r3, #516]
 879 0030 1BB2     		sxth	r3, r3
 880 0032 042B     		cmp	r3, #4
 881 0034 42D0     		beq	.L91
 445:Src/pid.c     **** 		}	
 882              		.loc 1 445 0
 883 0036 9B4B     		ldr	r3, .L101
 884 0038 0022     		movs	r2, #0
 885 003a A3F84220 		strh	r2, [r3, #66]	@ movhi
 886 003e 0CE0     		b	.L60
 887              	.L61:
 434:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 888              		.loc 1 434 0
 889 0040 984A     		ldr	r2, .L101
 890 0042 B2F87032 		ldrh	r3, [r2, #624]
 891 0046 A2F86E32 		strh	r3, [r2, #622]	@ movhi
 435:Src/pid.c     **** 		}
 892              		.loc 1 435 0
 893 004a 974B     		ldr	r3, .L101+4
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 37


 894 004c 5B6B     		ldr	r3, [r3, #52]
 895 004e B2F86E12 		ldrh	r1, [r2, #622]
 896 0052 0B44     		add	r3, r3, r1
 897 0054 1BB2     		sxth	r3, r3
 898 0056 A2F84230 		strh	r3, [r2, #66]	@ movhi
 899              	.L60:
 449:Src/pid.c     **** 	{
 900              		.loc 1 449 0
 901 005a 924B     		ldr	r3, .L101
 902 005c B3F85432 		ldrh	r3, [r3, #596]
 903 0060 1BB2     		sxth	r3, r3
 904 0062 012B     		cmp	r3, #1
 905 0064 31D0     		beq	.L92
 466:Src/pid.c     **** 	{
 906              		.loc 1 466 0
 907 0066 8F4B     		ldr	r3, .L101
 908 0068 B3F85432 		ldrh	r3, [r3, #596]
 909 006c 1BB2     		sxth	r3, r3
 910 006e 032B     		cmp	r3, #3
 911 0070 00F0CE80 		beq	.L93
 523:Src/pid.c     **** 	{
 912              		.loc 1 523 0
 913 0074 8B4B     		ldr	r3, .L101
 914 0076 B3F85432 		ldrh	r3, [r3, #596]
 915 007a 1BB2     		sxth	r3, r3
 916 007c 042B     		cmp	r3, #4
 917 007e 00F06A81 		beq	.L94
 560:Src/pid.c     **** 		{
 918              		.loc 1 560 0
 919 0082 884B     		ldr	r3, .L101
 920 0084 B3F84220 		ldrh	r2, [r3, #66]
 921 0088 12B2     		sxth	r2, r2
 922 008a B3F88032 		ldrh	r3, [r3, #640]
 923 008e 1BB2     		sxth	r3, r3
 924 0090 9A42     		cmp	r2, r3
 925 0092 04DD     		ble	.L82
 562:Src/pid.c     **** 		}
 926              		.loc 1 562 0
 927 0094 834B     		ldr	r3, .L101
 928 0096 B3F88022 		ldrh	r2, [r3, #640]
 929 009a A3F84220 		strh	r2, [r3, #66]	@ movhi
 930              	.L82:
 564:Src/pid.c     **** 		{
 931              		.loc 1 564 0
 932 009e 814B     		ldr	r3, .L101
 933 00a0 B3F84220 		ldrh	r2, [r3, #66]
 934 00a4 12B2     		sxth	r2, r2
 935 00a6 B3F88232 		ldrh	r3, [r3, #642]
 936 00aa 1BB2     		sxth	r3, r3
 937 00ac 9A42     		cmp	r2, r3
 938 00ae 25DA     		bge	.L67
 566:Src/pid.c     **** 		}
 939              		.loc 1 566 0
 940 00b0 7C4B     		ldr	r3, .L101
 941 00b2 B3F88222 		ldrh	r2, [r3, #642]
 942 00b6 A3F84220 		strh	r2, [r3, #66]	@ movhi
 943 00ba 1FE0     		b	.L67
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 38


 944              	.L91:
 440:Src/pid.c     **** 		
 945              		.loc 1 440 0
 946 00bc 7A4B     		ldr	r3, .L101+4
 947 00be B3F93420 		ldrsh	r2, [r3, #52]
 948 00c2 784B     		ldr	r3, .L101
 949 00c4 A3F84220 		strh	r2, [r3, #66]	@ movhi
 950 00c8 C7E7     		b	.L60
 951              	.L92:
 451:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 952              		.loc 1 451 0
 953 00ca 764B     		ldr	r3, .L101
 954 00cc 0122     		movs	r2, #1
 955 00ce A3F80222 		strh	r2, [r3, #514]	@ movhi
 452:Src/pid.c     **** 		if(test++ > (50))
 956              		.loc 1 452 0
 957 00d2 A3F80422 		strh	r2, [r3, #516]	@ movhi
 453:Src/pid.c     **** 		{
 958              		.loc 1 453 0
 959 00d6 754A     		ldr	r2, .L101+8
 960 00d8 1388     		ldrh	r3, [r2]
 961 00da 591C     		adds	r1, r3, #1
 962 00dc 1180     		strh	r1, [r2]	@ movhi
 963 00de 322B     		cmp	r3, #50
 964 00e0 02D9     		bls	.L65
 455:Src/pid.c     **** 		}
 965              		.loc 1 455 0
 966 00e2 1346     		mov	r3, r2
 967 00e4 0022     		movs	r2, #0
 968 00e6 1A80     		strh	r2, [r3]	@ movhi
 969              	.L65:
 457:Src/pid.c     **** 		{
 970              		.loc 1 457 0
 971 00e8 704B     		ldr	r3, .L101+8
 972 00ea 1B88     		ldrh	r3, [r3]
 973 00ec 192B     		cmp	r3, #25
 974 00ee 40F28980 		bls	.L66
 459:Src/pid.c     **** 		}
 975              		.loc 1 459 0
 976 00f2 6C4B     		ldr	r3, .L101
 977 00f4 4FF44862 		mov	r2, #3200
 978 00f8 A3F84220 		strh	r2, [r3, #66]	@ movhi
 979              	.L67:
 570:Src/pid.c     **** 	pid_IQ.Low_limit = -16384;
 980              		.loc 1 570 0
 981 00fc 6C4C     		ldr	r4, .L101+12
 982 00fe 4FF48043 		mov	r3, #16384
 983 0102 E363     		str	r3, [r4, #60]
 571:Src/pid.c     **** 	
 984              		.loc 1 571 0
 985 0104 A3F50043 		sub	r3, r3, #32768
 986 0108 2364     		str	r3, [r4, #64]
 576:Src/pid.c     **** 	
 987              		.loc 1 576 0
 988 010a 664B     		ldr	r3, .L101
 989 010c B3F84200 		ldrh	r0, [r3, #66]
 990 0110 B3F84E10 		ldrh	r1, [r3, #78]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 39


 991 0114 2246     		mov	r2, r4
 992 0116 09B2     		sxth	r1, r1
 993 0118 00B2     		sxth	r0, r0
 994 011a FFF7FEFF 		bl	PID_control
 995              	.LVL77:
 579:Src/pid.c     **** 	
 996              		.loc 1 579 0
 997 011e 626B     		ldr	r2, [r4, #52]
 998 0120 40F67533 		movw	r3, #2933
 999 0124 03FB02F3 		mul	r3, r3, r2
 1000 0128 002B     		cmp	r3, #0
 1001 012a C0F25481 		blt	.L95
 1002              	.L83:
 1003 012e 9B13     		asrs	r3, r3, #14
 1004 0130 604A     		ldr	r2, .L101+16
 1005 0132 1360     		str	r3, [r2]
 581:Src/pid.c     **** 	pid_ID.Low_limit = -16384;	
 1006              		.loc 1 581 0
 1007 0134 604C     		ldr	r4, .L101+20
 1008 0136 4FF48043 		mov	r3, #16384
 1009 013a E363     		str	r3, [r4, #60]
 582:Src/pid.c     **** 	
 1010              		.loc 1 582 0
 1011 013c A3F50043 		sub	r3, r3, #32768
 1012 0140 2364     		str	r3, [r4, #64]
 587:Src/pid.c     **** 	g_Vd = pid_ID.out*N97_CCR/PU_REFERENCE;	
 1013              		.loc 1 587 0
 1014 0142 584B     		ldr	r3, .L101
 1015 0144 B3F89412 		ldrh	r1, [r3, #660]
 1016 0148 2246     		mov	r2, r4
 1017 014a 09B2     		sxth	r1, r1
 1018 014c 0020     		movs	r0, #0
 1019 014e FFF7FEFF 		bl	PID_control
 1020              	.LVL78:
 588:Src/pid.c     **** 	
 1021              		.loc 1 588 0
 1022 0152 626B     		ldr	r2, [r4, #52]
 1023 0154 40F67533 		movw	r3, #2933
 1024 0158 03FB02F3 		mul	r3, r3, r2
 1025 015c 002B     		cmp	r3, #0
 1026 015e C0F23E81 		blt	.L96
 1027              	.L84:
 1028 0162 9B13     		asrs	r3, r3, #14
 1029 0164 554C     		ldr	r4, .L101+24
 1030 0166 2360     		str	r3, [r4]
 593:Src/pid.c     **** 	
 1031              		.loc 1 593 0
 1032 0168 554A     		ldr	r2, .L101+28
 1033 016a 1368     		ldr	r3, [r2]
 1034 016c 5B42     		negs	r3, r3
 1035 016e 1360     		str	r3, [r2]
 603:Src/pid.c     ****   Y = Math_Cos_EN360( g_ElectricAngle );
 1036              		.loc 1 603 0
 1037 0170 544D     		ldr	r5, .L101+32
 1038 0172 2868     		ldr	r0, [r5]
 1039 0174 80B2     		uxth	r0, r0
 1040 0176 FFF7FEFF 		bl	Math_Sin_EN360
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 40


 1041              	.LVL79:
 1042 017a 8046     		mov	r8, r0
 1043              	.LVL80:
 604:Src/pid.c     ****   g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä
 1044              		.loc 1 604 0
 1045 017c 2868     		ldr	r0, [r5]
 1046              	.LVL81:
 1047 017e 80B2     		uxth	r0, r0
 1048 0180 FFF7FEFF 		bl	Math_Cos_EN360
 1049              	.LVL82:
 1050 0184 8146     		mov	r9, r0
 1051              	.LVL83:
 605:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 1052              		.loc 1 605 0
 1053 0186 4146     		mov	r1, r8
 1054 0188 2068     		ldr	r0, [r4]
 1055              	.LVL84:
 1056 018a FFF7FEFF 		bl	Q15_MUL
 1057              	.LVL85:
 1058 018e 0546     		mov	r5, r0
 1059 0190 484F     		ldr	r7, .L101+16
 1060 0192 4946     		mov	r1, r9
 1061 0194 3868     		ldr	r0, [r7]
 1062 0196 FFF7FEFF 		bl	Q15_MUL
 1063              	.LVL86:
 1064 019a 2844     		add	r0, r0, r5
 1065 019c 4A4E     		ldr	r6, .L101+36
 1066 019e 3060     		str	r0, [r6]
 606:Src/pid.c     ****   // SVPWMÕ¼ï¿½Õ±È¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 1067              		.loc 1 606 0
 1068 01a0 2068     		ldr	r0, [r4]
 1069 01a2 4946     		mov	r1, r9
 1070 01a4 4042     		negs	r0, r0
 1071 01a6 FFF7FEFF 		bl	Q15_MUL
 1072              	.LVL87:
 1073 01aa 0446     		mov	r4, r0
 1074 01ac 4146     		mov	r1, r8
 1075 01ae 3868     		ldr	r0, [r7]
 1076 01b0 FFF7FEFF 		bl	Q15_MUL
 1077              	.LVL88:
 1078 01b4 0444     		add	r4, r4, r0
 1079 01b6 454D     		ldr	r5, .L101+40
 1080 01b8 2C60     		str	r4, [r5]
 1081              	.LVL89:
 609:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 1082              		.loc 1 609 0
 1083 01ba 4549     		ldr	r1, .L101+44
 1084 01bc 3068     		ldr	r0, [r6]
 1085 01be FFF7FEFF 		bl	Q16_MUL
 1086              	.LVL90:
 610:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 1087              		.loc 1 610 0
 1088 01c2 2A68     		ldr	r2, [r5]
 1089 01c4 1318     		adds	r3, r2, r0
 1090 01c6 5B10     		asrs	r3, r3, #1
 1091              	.LVL91:
 611:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 41


 1092              		.loc 1 611 0
 1093 01c8 121A     		subs	r2, r2, r0
 1094 01ca 5210     		asrs	r2, r2, #1
 1095              	.LVL92:
 615:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 1096              		.loc 1 615 0
 1097 01cc 002C     		cmp	r4, #0
 1098 01ce 40F30A81 		ble	.L97
 1099 01d2 0121     		movs	r1, #1
 1100              	.L85:
 1101              	.LVL93:
 616:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 1102              		.loc 1 616 0
 1103 01d4 002A     		cmp	r2, #0
 1104 01d6 C0F20881 		blt	.L98
 1105              	.L86:
 617:Src/pid.c     **** 	g_Sector = temp32;
 1106              		.loc 1 617 0
 1107 01da 002B     		cmp	r3, #0
 1108 01dc C0F20781 		blt	.L99
 1109              	.L87:
 618:Src/pid.c     **** 	g_Sector_test = g_Sector;
 1110              		.loc 1 618 0
 1111 01e0 3C48     		ldr	r0, .L101+48
 1112 01e2 0160     		str	r1, [r0]
 619:Src/pid.c     **** 	g_X = X;
 1113              		.loc 1 619 0
 1114 01e4 3C48     		ldr	r0, .L101+52
 1115 01e6 0180     		strh	r1, [r0]	@ movhi
 620:Src/pid.c     **** 	g_Y = Y;
 1116              		.loc 1 620 0
 1117 01e8 3C48     		ldr	r0, .L101+56
 1118 01ea 0460     		str	r4, [r0]
 621:Src/pid.c     **** 	g_Z = Z;
 1119              		.loc 1 621 0
 1120 01ec 3C48     		ldr	r0, .L101+60
 1121 01ee 0360     		str	r3, [r0]
 622:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 1122              		.loc 1 622 0
 1123 01f0 3C48     		ldr	r0, .L101+64
 1124 01f2 0260     		str	r2, [r0]
 623:Src/pid.c     **** 
 1125              		.loc 1 623 0
 1126 01f4 0092     		str	r2, [sp]
 1127 01f6 2246     		mov	r2, r4
 1128              	.LVL94:
 1129 01f8 3B48     		ldr	r0, .L101+68
 1130 01fa FFF7FEFF 		bl	Calculate_CCR_SVP
 1131              	.LVL95:
 625:Src/pid.c     **** static void SpeedPID(void)
 1132              		.loc 1 625 0
 1133 01fe 03B0     		add	sp, sp, #12
 1134              	.LCFI7:
 1135              		.cfi_remember_state
 1136              		.cfi_def_cfa_offset 28
 1137              		@ sp needed
 1138 0200 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 42


 1139              	.LVL96:
 1140              	.L66:
 1141              	.LCFI8:
 1142              		.cfi_restore_state
 463:Src/pid.c     **** 		}	
 1143              		.loc 1 463 0
 1144 0204 274B     		ldr	r3, .L101
 1145 0206 4FF28032 		movw	r2, #62336
 1146 020a A3F84220 		strh	r2, [r3, #66]	@ movhi
 1147 020e 75E7     		b	.L67
 1148              	.L93:
 468:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1149              		.loc 1 468 0
 1150 0210 244B     		ldr	r3, .L101
 1151 0212 0122     		movs	r2, #1
 1152 0214 A3F80222 		strh	r2, [r3, #514]	@ movhi
 469:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 1153              		.loc 1 469 0
 1154 0218 A3F80422 		strh	r2, [r3, #516]	@ movhi
 470:Src/pid.c     **** 		{
 1155              		.loc 1 470 0
 1156 021c 334B     		ldr	r3, .L101+72
 1157 021e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1158 0220 33B9     		cbnz	r3, .L69
 472:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 1159              		.loc 1 472 0
 1160 0222 334A     		ldr	r2, .L101+76
 1161 0224 1380     		strh	r3, [r2]	@ movhi
 473:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 1162              		.loc 1 473 0
 1163 0226 1F4A     		ldr	r2, .L101
 1164 0228 A2F8C030 		strh	r3, [r2, #192]	@ movhi
 474:Src/pid.c     **** 		}
 1165              		.loc 1 474 0
 1166 022c A2F8C230 		strh	r3, [r2, #194]	@ movhi
 1167              	.L69:
 476:Src/pid.c     **** 		{
 1168              		.loc 1 476 0
 1169 0230 2F4B     		ldr	r3, .L101+76
 1170 0232 1B88     		ldrh	r3, [r3]
 1171 0234 1BB2     		sxth	r3, r3
 1172 0236 012B     		cmp	r3, #1
 1173 0238 5CD0     		beq	.L71
 1174 023a 022B     		cmp	r3, #2
 1175 023c 7CD0     		beq	.L72
 1176 023e 43B1     		cbz	r3, .L100
 516:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 1177              		.loc 1 516 0
 1178 0240 184A     		ldr	r2, .L101
 1179 0242 0023     		movs	r3, #0
 1180 0244 A2F85432 		strh	r3, [r2, #596]	@ movhi
 517:Src/pid.c     **** 				flag_processing_Jtest = 0;
 1181              		.loc 1 517 0
 1182 0248 A2F84230 		strh	r3, [r2, #66]	@ movhi
 518:Src/pid.c     **** 				break;
 1183              		.loc 1 518 0
 1184 024c 274A     		ldr	r2, .L101+72
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 43


 1185 024e 1370     		strb	r3, [r2]
 519:Src/pid.c     **** 			}
 1186              		.loc 1 519 0
 1187 0250 54E7     		b	.L67
 1188              	.L100:
 480:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
 1189              		.loc 1 480 0
 1190 0252 264B     		ldr	r3, .L101+72
 1191 0254 0122     		movs	r2, #1
 1192 0256 1A70     		strb	r2, [r3]
 481:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 1193              		.loc 1 481 0
 1194 0258 124B     		ldr	r3, .L101
 1195 025a 4FF40052 		mov	r2, #8192
 1196 025e A3F84220 		strh	r2, [r3, #66]	@ movhi
 482:Src/pid.c     **** 				{
 1197              		.loc 1 482 0
 1198 0262 B3F85030 		ldrh	r3, [r3, #80]
 1199 0266 1BB2     		sxth	r3, r3
 1200 0268 B3F54D7F 		cmp	r3, #820
 1201 026c 06DB     		blt	.L74
 484:Src/pid.c     **** 				}
 1202              		.loc 1 484 0
 1203 026e 0D4A     		ldr	r2, .L101
 1204 0270 B2F8C030 		ldrh	r3, [r2, #192]
 1205 0274 2833     		adds	r3, r3, #40
 1206 0276 1BB2     		sxth	r3, r3
 1207 0278 A2F8C030 		strh	r3, [r2, #192]	@ movhi
 1208              	.L74:
 486:Src/pid.c     **** 				{
 1209              		.loc 1 486 0
 1210 027c 094B     		ldr	r3, .L101
 1211 027e B3F85030 		ldrh	r3, [r3, #80]
 1212 0282 1BB2     		sxth	r3, r3
 1213 0284 42F23332 		movw	r2, #9011
 1214 0288 9342     		cmp	r3, r2
 1215 028a 7FF737AF 		ble	.L67
 488:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 1216              		.loc 1 488 0
 1217 028e 184A     		ldr	r2, .L101+76
 1218 0290 1388     		ldrh	r3, [r2]
 1219 0292 0133     		adds	r3, r3, #1
 1220 0294 1BB2     		sxth	r3, r3
 1221 0296 1380     		strh	r3, [r2]	@ movhi
 489:Src/pid.c     **** 				}
 1222              		.loc 1 489 0
 1223 0298 024B     		ldr	r3, .L101
 1224 029a 0022     		movs	r2, #0
 1225 029c A3F8C220 		strh	r2, [r3, #194]	@ movhi
 1226 02a0 2CE7     		b	.L67
 1227              	.L102:
 1228 02a2 00BF     		.align	2
 1229              	.L101:
 1230 02a4 00000000 		.word	g_CmdMap
 1231 02a8 00000000 		.word	pid_spd
 1232 02ac 00000000 		.word	.LANCHOR12
 1233 02b0 00000000 		.word	pid_IQ
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 44


 1234 02b4 00000000 		.word	.LANCHOR0
 1235 02b8 00000000 		.word	pid_ID
 1236 02bc 00000000 		.word	.LANCHOR1
 1237 02c0 00000000 		.word	g_high_fre_pulse
 1238 02c4 00000000 		.word	g_ElectricAngle
 1239 02c8 00000000 		.word	.LANCHOR13
 1240 02cc 00000000 		.word	.LANCHOR14
 1241 02d0 68BB0100 		.word	113512
 1242 02d4 00000000 		.word	.LANCHOR15
 1243 02d8 00000000 		.word	g_Sector_test
 1244 02dc 00000000 		.word	g_X
 1245 02e0 00000000 		.word	g_Y
 1246 02e4 00000000 		.word	g_Z
 1247 02e8 002C0140 		.word	1073818624
 1248 02ec 00000000 		.word	flag_processing_Jtest
 1249 02f0 00000000 		.word	state_Jtest
 1250              	.L71:
 495:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 1251              		.loc 1 495 0
 1252 02f4 3F4B     		ldr	r3, .L103
 1253 02f6 4FF46042 		mov	r2, #57344
 1254 02fa A3F84220 		strh	r2, [r3, #66]	@ movhi
 496:Src/pid.c     **** 				{
 1255              		.loc 1 496 0
 1256 02fe B3F85030 		ldrh	r3, [r3, #80]
 1257 0302 1BB2     		sxth	r3, r3
 1258 0304 42F23232 		movw	r2, #9010
 1259 0308 9342     		cmp	r3, r2
 1260 030a 06DC     		bgt	.L75
 498:Src/pid.c     **** 				}
 1261              		.loc 1 498 0
 1262 030c 394A     		ldr	r2, .L103
 1263 030e B2F8C230 		ldrh	r3, [r2, #194]
 1264 0312 2833     		adds	r3, r3, #40
 1265 0314 1BB2     		sxth	r3, r3
 1266 0316 A2F8C230 		strh	r3, [r2, #194]	@ movhi
 1267              	.L75:
 500:Src/pid.c     **** 				{
 1268              		.loc 1 500 0
 1269 031a 364B     		ldr	r3, .L103
 1270 031c B3F85030 		ldrh	r3, [r3, #80]
 1271 0320 1BB2     		sxth	r3, r3
 1272 0322 40F23232 		movw	r2, #818
 1273 0326 9342     		cmp	r3, r2
 1274 0328 3FF7E8AE 		bgt	.L67
 502:Src/pid.c     **** 				}
 1275              		.loc 1 502 0
 1276 032c 324A     		ldr	r2, .L103+4
 1277 032e 1388     		ldrh	r3, [r2]
 1278 0330 0133     		adds	r3, r3, #1
 1279 0332 1BB2     		sxth	r3, r3
 1280 0334 1380     		strh	r3, [r2]	@ movhi
 1281 0336 E1E6     		b	.L67
 1282              	.L72:
 508:Src/pid.c     **** 				{
 1283              		.loc 1 508 0
 1284 0338 2E4B     		ldr	r3, .L103
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 45


 1285 033a B3F85030 		ldrh	r3, [r3, #80]
 1286 033e 1BB2     		sxth	r3, r3
 1287 0340 40F23232 		movw	r2, #818
 1288 0344 9342     		cmp	r3, r2
 1289 0346 3FF7D9AE 		bgt	.L67
 510:Src/pid.c     **** 				}				
 1290              		.loc 1 510 0
 1291 034a 2B4A     		ldr	r2, .L103+4
 1292 034c 1388     		ldrh	r3, [r2]
 1293 034e 0133     		adds	r3, r3, #1
 1294 0350 1BB2     		sxth	r3, r3
 1295 0352 1380     		strh	r3, [r2]	@ movhi
 1296 0354 D2E6     		b	.L67
 1297              	.L94:
 525:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 1298              		.loc 1 525 0
 1299 0356 274B     		ldr	r3, .L103
 1300 0358 0122     		movs	r2, #1
 1301 035a A3F80222 		strh	r2, [r3, #514]	@ movhi
 526:Src/pid.c     **** 
 1302              		.loc 1 526 0
 1303 035e 0222     		movs	r2, #2
 1304 0360 A3F80422 		strh	r2, [r3, #516]	@ movhi
 529:Src/pid.c     **** 		if(test < (10*10))
 1305              		.loc 1 529 0
 1306 0364 254A     		ldr	r2, .L103+8
 1307 0366 1388     		ldrh	r3, [r2]
 1308 0368 0133     		adds	r3, r3, #1
 1309 036a 9BB2     		uxth	r3, r3
 1310 036c 1380     		strh	r3, [r2]	@ movhi
 530:Src/pid.c     **** 		{
 1311              		.loc 1 530 0
 1312 036e 632B     		cmp	r3, #99
 1313 0370 04D8     		bhi	.L77
 532:Src/pid.c     **** 		}
 1314              		.loc 1 532 0
 1315 0372 204B     		ldr	r3, .L103
 1316 0374 0022     		movs	r2, #0
 1317 0376 A3F84620 		strh	r2, [r3, #70]	@ movhi
 1318 037a BFE6     		b	.L67
 1319              	.L77:
 534:Src/pid.c     **** 		{
 1320              		.loc 1 534 0
 1321 037c B3F5167F 		cmp	r3, #600
 1322 0380 05D2     		bcs	.L78
 536:Src/pid.c     **** 		}
 1323              		.loc 1 536 0
 1324 0382 1C4B     		ldr	r3, .L103
 1325 0384 4FF48052 		mov	r2, #4096
 1326 0388 A3F84620 		strh	r2, [r3, #70]	@ movhi
 1327 038c B6E6     		b	.L67
 1328              	.L78:
 538:Src/pid.c     **** 		{
 1329              		.loc 1 538 0
 1330 038e 40F24B42 		movw	r2, #1099
 1331 0392 9342     		cmp	r3, r2
 1332 0394 04D8     		bhi	.L79
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 46


 540:Src/pid.c     **** 		}
 1333              		.loc 1 540 0
 1334 0396 174B     		ldr	r3, .L103
 1335 0398 0022     		movs	r2, #0
 1336 039a A3F84620 		strh	r2, [r3, #70]	@ movhi
 1337 039e ADE6     		b	.L67
 1338              	.L79:
 542:Src/pid.c     **** 		{
 1339              		.loc 1 542 0
 1340 03a0 B3F5C86F 		cmp	r3, #1600
 1341 03a4 05D2     		bcs	.L80
 544:Src/pid.c     **** 		}
 1342              		.loc 1 544 0
 1343 03a6 134B     		ldr	r3, .L103
 1344 03a8 4FF47042 		mov	r2, #61440
 1345 03ac A3F84620 		strh	r2, [r3, #70]	@ movhi
 1346 03b0 A4E6     		b	.L67
 1347              	.L80:
 546:Src/pid.c     **** 		{
 1348              		.loc 1 546 0
 1349 03b2 40F2A362 		movw	r2, #1699
 1350 03b6 9342     		cmp	r3, r2
 1351 03b8 04D8     		bhi	.L81
 548:Src/pid.c     **** 		}
 1352              		.loc 1 548 0
 1353 03ba 0E4B     		ldr	r3, .L103
 1354 03bc 0022     		movs	r2, #0
 1355 03be A3F84620 		strh	r2, [r3, #70]	@ movhi
 1356 03c2 9BE6     		b	.L67
 1357              	.L81:
 552:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 1358              		.loc 1 552 0
 1359 03c4 0023     		movs	r3, #0
 1360 03c6 0D4A     		ldr	r2, .L103+8
 1361 03c8 1380     		strh	r3, [r2]	@ movhi
 553:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 1362              		.loc 1 553 0
 1363 03ca 0A4A     		ldr	r2, .L103
 1364 03cc A2F85432 		strh	r3, [r2, #596]	@ movhi
 554:Src/pid.c     **** 		}
 1365              		.loc 1 554 0
 1366 03d0 A2F84630 		strh	r3, [r2, #70]	@ movhi
 1367 03d4 92E6     		b	.L67
 1368              	.L95:
 579:Src/pid.c     **** 	
 1369              		.loc 1 579 0
 1370 03d6 03F57F53 		add	r3, r3, #16320
 1371 03da 3F33     		adds	r3, r3, #63
 1372 03dc A7E6     		b	.L83
 1373              	.L96:
 588:Src/pid.c     **** 	
 1374              		.loc 1 588 0
 1375 03de 03F57F53 		add	r3, r3, #16320
 1376 03e2 3F33     		adds	r3, r3, #63
 1377 03e4 BDE6     		b	.L84
 1378              	.LVL97:
 1379              	.L97:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 47


 613:Src/pid.c     **** 	/** ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ª**/	
 1380              		.loc 1 613 0
 1381 03e6 0021     		movs	r1, #0
 1382 03e8 F4E6     		b	.L85
 1383              	.LVL98:
 1384              	.L98:
 616:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 1385              		.loc 1 616 0 discriminator 1
 1386 03ea 0231     		adds	r1, r1, #2
 1387              	.LVL99:
 1388 03ec F5E6     		b	.L86
 1389              	.L99:
 617:Src/pid.c     **** 	g_Sector = temp32;
 1390              		.loc 1 617 0 discriminator 1
 1391 03ee 0431     		adds	r1, r1, #4
 1392              	.LVL100:
 1393 03f0 F6E6     		b	.L87
 1394              	.L104:
 1395 03f2 00BF     		.align	2
 1396              	.L103:
 1397 03f4 00000000 		.word	g_CmdMap
 1398 03f8 00000000 		.word	state_Jtest
 1399 03fc 00000000 		.word	.LANCHOR12
 1400              		.cfi_endproc
 1401              	.LFE338:
 1403              		.section	.text.ForcePID,"ax",%progbits
 1404              		.align	1
 1405              		.syntax unified
 1406              		.thumb
 1407              		.thumb_func
 1408              		.fpu fpv4-sp-d16
 1410              	ForcePID:
 1411              	.LFB336:
 198:Src/pid.c     **** 	s16 error_force = 0;
 1412              		.loc 1 198 0
 1413              		.cfi_startproc
 1414              		@ args = 0, pretend = 0, frame = 0
 1415              		@ frame_needed = 0, uses_anonymous_args = 0
 1416 0000 10B5     		push	{r4, lr}
 1417              	.LCFI9:
 1418              		.cfi_def_cfa_offset 8
 1419              		.cfi_offset 4, -8
 1420              		.cfi_offset 14, -4
 1421              	.LVL101:
 203:Src/pid.c     **** 	{
 1422              		.loc 1 203 0
 1423 0002 484B     		ldr	r3, .L115
 1424 0004 5B8D     		ldrh	r3, [r3, #42]
 1425 0006 1BB2     		sxth	r3, r3
 1426 0008 002B     		cmp	r3, #0
 1427 000a 53D1     		bne	.L106
 205:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 1428              		.loc 1 205 0
 1429 000c 454B     		ldr	r3, .L115
 1430 000e B3F84410 		ldrh	r1, [r3, #68]
 1431 0012 454A     		ldr	r2, .L115+4
 1432 0014 1180     		strh	r1, [r2]	@ movhi
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 48


 206:Src/pid.c     **** 	}
 1433              		.loc 1 206 0
 1434 0016 B3F85A20 		ldrh	r2, [r3, #90]
 1435 001a 444B     		ldr	r3, .L115+8
 1436 001c 1A80     		strh	r2, [r3]	@ movhi
 1437              	.L107:
 239:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 1438              		.loc 1 239 0
 1439 001e 414B     		ldr	r3, .L115
 1440 0020 B3F88422 		ldrh	r2, [r3, #644]
 1441 0024 12B2     		sxth	r2, r2
 1442 0026 4249     		ldr	r1, .L115+12
 1443 0028 CA63     		str	r2, [r1, #60]
 240:Src/pid.c     **** 	
 1444              		.loc 1 240 0
 1445 002a B3F88622 		ldrh	r2, [r3, #646]
 1446 002e 12B2     		sxth	r2, r2
 1447 0030 0A64     		str	r2, [r1, #64]
 242:Src/pid.c     **** 	{
 1448              		.loc 1 242 0
 1449 0032 B3F84C20 		ldrh	r2, [r3, #76]
 1450 0036 12B2     		sxth	r2, r2
 1451 0038 B3F88C32 		ldrh	r3, [r3, #652]
 1452 003c 1BB2     		sxth	r3, r3
 1453 003e 9A42     		cmp	r2, r3
 1454 0040 46DD     		ble	.L108
 244:Src/pid.c     **** 		
 1455              		.loc 1 244 0
 1456 0042 0022     		movs	r2, #0
 1457 0044 CA63     		str	r2, [r1, #60]
 1458              	.L109:
 252:Src/pid.c     **** 	{
 1459              		.loc 1 252 0
 1460 0046 374B     		ldr	r3, .L115
 1461 0048 B3F84C20 		ldrh	r2, [r3, #76]
 1462 004c 12B2     		sxth	r2, r2
 1463 004e B3F88E32 		ldrh	r3, [r3, #654]
 1464 0052 1BB2     		sxth	r3, r3
 1465 0054 9A42     		cmp	r2, r3
 1466 0056 50DA     		bge	.L110
 254:Src/pid.c     **** 		
 1467              		.loc 1 254 0
 1468 0058 354B     		ldr	r3, .L115+12
 1469 005a 0022     		movs	r2, #0
 1470 005c 1A64     		str	r2, [r3, #64]
 1471              	.L111:
 289:Src/pid.c     **** //	}
 1472              		.loc 1 289 0
 1473 005e 324B     		ldr	r3, .L115+4
 1474 0060 1888     		ldrh	r0, [r3]
 1475 0062 324B     		ldr	r3, .L115+8
 1476 0064 1988     		ldrh	r1, [r3]
 1477 0066 324C     		ldr	r4, .L115+12
 1478 0068 2246     		mov	r2, r4
 1479 006a 09B2     		sxth	r1, r1
 1480 006c 00B2     		sxth	r0, r0
 1481 006e FFF7FEFF 		bl	PID_control
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 49


 1482              	.LVL102:
 292:Src/pid.c     **** 	
 1483              		.loc 1 292 0
 1484 0072 B4F93420 		ldrsh	r2, [r4, #52]
 1485 0076 2B4B     		ldr	r3, .L115
 1486 0078 A3F85E20 		strh	r2, [r3, #94]	@ movhi
 294:Src/pid.c     **** 	{
 1487              		.loc 1 294 0
 1488 007c B3F84030 		ldrh	r3, [r3, #64]
 1489 0080 1BB2     		sxth	r3, r3
 1490 0082 042B     		cmp	r3, #4
 1491 0084 09D0     		beq	.L112
 294:Src/pid.c     **** 	{
 1492              		.loc 1 294 0 is_stmt 0 discriminator 1
 1493 0086 274B     		ldr	r3, .L115
 1494 0088 B3F84030 		ldrh	r3, [r3, #64]
 1495 008c 1BB2     		sxth	r3, r3
 1496 008e 052B     		cmp	r3, #5
 1497 0090 0FD1     		bne	.L105
 294:Src/pid.c     **** 	{
 1498              		.loc 1 294 0 discriminator 2
 1499 0092 284B     		ldr	r3, .L115+16
 1500 0094 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1501 0096 032B     		cmp	r3, #3
 1502 0098 0BD1     		bne	.L105
 1503              	.L112:
 296:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 1504              		.loc 1 296 0 is_stmt 1
 1505 009a 274B     		ldr	r3, .L115+20
 1506 009c 0022     		movs	r2, #0
 1507 009e 1A60     		str	r2, [r3]
 297:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 1508              		.loc 1 297 0
 1509 00a0 204B     		ldr	r3, .L115
 1510 00a2 B3F84C20 		ldrh	r2, [r3, #76]
 1511 00a6 A3F86020 		strh	r2, [r3, #96]	@ movhi
 298:Src/pid.c     **** 	}
 1512              		.loc 1 298 0
 1513 00aa B3F84C20 		ldrh	r2, [r3, #76]
 1514 00ae A3F84820 		strh	r2, [r3, #72]	@ movhi
 1515              	.L105:
 300:Src/pid.c     **** 
 1516              		.loc 1 300 0
 1517 00b2 10BD     		pop	{r4, pc}
 1518              	.L106:
 210:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 1519              		.loc 1 210 0
 1520 00b4 1B4A     		ldr	r2, .L115
 1521 00b6 B2F84430 		ldrh	r3, [r2, #68]
 1522 00ba 5B42     		negs	r3, r3
 1523 00bc 1BB2     		sxth	r3, r3
 1524 00be 1A49     		ldr	r1, .L115+4
 1525 00c0 0B80     		strh	r3, [r1]	@ movhi
 211:Src/pid.c     **** 	}
 1526              		.loc 1 211 0
 1527 00c2 B2F85A30 		ldrh	r3, [r2, #90]
 1528 00c6 5B42     		negs	r3, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 50


 1529 00c8 1BB2     		sxth	r3, r3
 1530 00ca 184A     		ldr	r2, .L115+8
 1531 00cc 1380     		strh	r3, [r2]	@ movhi
 1532 00ce A6E7     		b	.L107
 1533              	.L108:
 247:Src/pid.c     **** 	{
 1534              		.loc 1 247 0
 1535 00d0 144B     		ldr	r3, .L115
 1536 00d2 B3F84C20 		ldrh	r2, [r3, #76]
 1537 00d6 12B2     		sxth	r2, r2
 1538 00d8 B3F88C32 		ldrh	r3, [r3, #652]
 1539 00dc 1BB2     		sxth	r3, r3
 1540 00de A3F29913 		subw	r3, r3, #409
 1541 00e2 9A42     		cmp	r2, r3
 1542 00e4 AFDD     		ble	.L109
 247:Src/pid.c     **** 	{
 1543              		.loc 1 247 0 is_stmt 0 discriminator 1
 1544 00e6 0F4B     		ldr	r3, .L115
 1545 00e8 B3F84230 		ldrh	r3, [r3, #66]
 1546 00ec 1BB2     		sxth	r3, r3
 1547 00ee 002B     		cmp	r3, #0
 1548 00f0 A9DD     		ble	.L109
 249:Src/pid.c     **** 		
 1549              		.loc 1 249 0 is_stmt 1
 1550 00f2 0F4B     		ldr	r3, .L115+12
 1551 00f4 0022     		movs	r2, #0
 1552 00f6 DA63     		str	r2, [r3, #60]
 1553 00f8 A5E7     		b	.L109
 1554              	.L110:
 257:Src/pid.c     **** 	{
 1555              		.loc 1 257 0
 1556 00fa 0A4B     		ldr	r3, .L115
 1557 00fc B3F84C20 		ldrh	r2, [r3, #76]
 1558 0100 12B2     		sxth	r2, r2
 1559 0102 B3F88E32 		ldrh	r3, [r3, #654]
 1560 0106 1BB2     		sxth	r3, r3
 1561 0108 03F29913 		addw	r3, r3, #409
 1562 010c 9A42     		cmp	r2, r3
 1563 010e A6DA     		bge	.L111
 257:Src/pid.c     **** 	{
 1564              		.loc 1 257 0 is_stmt 0 discriminator 1
 1565 0110 044B     		ldr	r3, .L115
 1566 0112 B3F84230 		ldrh	r3, [r3, #66]
 1567 0116 13F4004F 		tst	r3, #32768
 1568 011a A0D0     		beq	.L111
 259:Src/pid.c     **** 		
 1569              		.loc 1 259 0 is_stmt 1
 1570 011c 044B     		ldr	r3, .L115+12
 1571 011e 0022     		movs	r2, #0
 1572 0120 1A64     		str	r2, [r3, #64]
 1573 0122 9CE7     		b	.L111
 1574              	.L116:
 1575              		.align	2
 1576              	.L115:
 1577 0124 00000000 		.word	g_CmdMap
 1578 0128 00000000 		.word	force_set
 1579 012c 00000000 		.word	force_act
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 51


 1580 0130 00000000 		.word	pid_force
 1581 0134 00000000 		.word	status_Mode_POSITION_FORCE
 1582 0138 00000000 		.word	Flag_Profile_Enable
 1583              		.cfi_endproc
 1584              	.LFE336:
 1586              		.section	.text.force_PID_out,"ax",%progbits
 1587              		.align	1
 1588              		.global	force_PID_out
 1589              		.syntax unified
 1590              		.thumb
 1591              		.thumb_func
 1592              		.fpu fpv4-sp-d16
 1594              	force_PID_out:
 1595              	.LFB335:
 178:Src/pid.c     **** 	p_pid->out = out;
 1596              		.loc 1 178 0
 1597              		.cfi_startproc
 1598              		@ args = 0, pretend = 0, frame = 0
 1599              		@ frame_needed = 0, uses_anonymous_args = 0
 1600              		@ link register save eliminated.
 1601              	.LVL103:
 1602 0000 30B4     		push	{r4, r5}
 1603              	.LCFI10:
 1604              		.cfi_def_cfa_offset 8
 1605              		.cfi_offset 4, -8
 1606              		.cfi_offset 5, -4
 179:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 1607              		.loc 1 179 0
 1608 0002 4863     		str	r0, [r1, #52]
 180:Src/pid.c     **** 	{
 1609              		.loc 1 180 0
 1610 0004 CB6B     		ldr	r3, [r1, #60]
 1611 0006 8342     		cmp	r3, r0
 1612 0008 00DA     		bge	.L118
 182:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 1613              		.loc 1 182 0
 1614 000a 4B63     		str	r3, [r1, #52]
 1615              	.L118:
 185:Src/pid.c     **** 	{
 1616              		.loc 1 185 0
 1617 000c 4A6B     		ldr	r2, [r1, #52]
 1618 000e 0B6C     		ldr	r3, [r1, #64]
 1619 0010 9A42     		cmp	r2, r3
 1620 0012 00DA     		bge	.L119
 187:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 1621              		.loc 1 187 0
 1622 0014 4B63     		str	r3, [r1, #52]
 1623              	.L119:
 190:Src/pid.c     **** 	p_pid->error_last = 0;
 1624              		.loc 1 190 0
 1625 0016 0023     		movs	r3, #0
 1626 0018 8B61     		str	r3, [r1, #24]
 191:Src/pid.c     **** 	p_pid->Part_P = 0;
 1627              		.loc 1 191 0
 1628 001a CB61     		str	r3, [r1, #28]
 192:Src/pid.c     **** 	p_pid->Part_I = out;
 1629              		.loc 1 192 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 52


 1630 001c 0B62     		str	r3, [r1, #32]
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 1631              		.loc 1 193 0
 1632 001e 0446     		mov	r4, r0
 1633 0020 C517     		asrs	r5, r0, #31
 1634 0022 C1E90A45 		strd	r4, [r1, #40]
 194:Src/pid.c     **** 	p_pid->Part_D = 0;
 1635              		.loc 1 194 0
 1636 0026 8A6B     		ldr	r2, [r1, #56]
 1637 0028 00FB02F0 		mul	r0, r0, r2
 1638              	.LVL104:
 1639 002c 4864     		str	r0, [r1, #68]
 195:Src/pid.c     **** }
 1640              		.loc 1 195 0
 1641 002e 0B63     		str	r3, [r1, #48]
 196:Src/pid.c     **** static void ForcePID(void)
 1642              		.loc 1 196 0
 1643 0030 30BC     		pop	{r4, r5}
 1644              	.LCFI11:
 1645              		.cfi_restore 5
 1646              		.cfi_restore 4
 1647              		.cfi_def_cfa_offset 0
 1648              	.LVL105:
 1649 0032 7047     		bx	lr
 1650              		.cfi_endproc
 1651              	.LFE335:
 1653              		.section	.text.SpeedPID,"ax",%progbits
 1654              		.align	1
 1655              		.syntax unified
 1656              		.thumb
 1657              		.thumb_func
 1658              		.fpu fpv4-sp-d16
 1660              	SpeedPID:
 1661              	.LFB339:
 627:Src/pid.c     **** 	static s32 s_test_speed_t_count = 0;
 1662              		.loc 1 627 0
 1663              		.cfi_startproc
 1664              		@ args = 0, pretend = 0, frame = 0
 1665              		@ frame_needed = 0, uses_anonymous_args = 0
 1666 0000 08B5     		push	{r3, lr}
 1667              	.LCFI12:
 1668              		.cfi_def_cfa_offset 8
 1669              		.cfi_offset 3, -8
 1670              		.cfi_offset 14, -4
 1671              	.LVL106:
 631:Src/pid.c     ****   {
 1672              		.loc 1 631 0
 1673 0002 9A4B     		ldr	r3, .L164
 1674 0004 B3F80432 		ldrh	r3, [r3, #516]
 1675 0008 1BB2     		sxth	r3, r3
 1676 000a 012B     		cmp	r3, #1
 1677 000c 28D0     		beq	.L122
 631:Src/pid.c     ****   {
 1678              		.loc 1 631 0 is_stmt 0 discriminator 1
 1679 000e 974B     		ldr	r3, .L164
 1680 0010 B3F80432 		ldrh	r3, [r3, #516]
 1681 0014 1BB2     		sxth	r3, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 53


 1682 0016 032B     		cmp	r3, #3
 1683 0018 22D0     		beq	.L122
 631:Src/pid.c     ****   {
 1684              		.loc 1 631 0 discriminator 2
 1685 001a 944B     		ldr	r3, .L164
 1686 001c B3F80432 		ldrh	r3, [r3, #516]
 1687 0020 1BB2     		sxth	r3, r3
 1688 0022 062B     		cmp	r3, #6
 1689 0024 1CD0     		beq	.L122
 635:Src/pid.c     **** 	{
 1690              		.loc 1 635 0 is_stmt 1
 1691 0026 914B     		ldr	r3, .L164
 1692 0028 B3F80432 		ldrh	r3, [r3, #516]
 1693 002c 1BB2     		sxth	r3, r3
 1694 002e 042B     		cmp	r3, #4
 1695 0030 64D0     		beq	.L156
 641:Src/pid.c     ****   {
 1696              		.loc 1 641 0
 1697 0032 8E4B     		ldr	r3, .L164
 1698 0034 B3F80432 		ldrh	r3, [r3, #516]
 1699 0038 1BB2     		sxth	r3, r3
 1700 003a 022B     		cmp	r3, #2
 1701 003c 19D1     		bne	.L124
 643:Src/pid.c     **** 			{
 1702              		.loc 1 643 0
 1703 003e 8C4B     		ldr	r3, .L164+4
 1704 0040 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1705 0042 022B     		cmp	r3, #2
 1706 0044 63D0     		beq	.L157
 686:Src/pid.c     **** 							{
 1707              		.loc 1 686 0
 1708 0046 894B     		ldr	r3, .L164
 1709 0048 B3F81C32 		ldrh	r3, [r3, #540]
 1710 004c 1BB2     		sxth	r3, r3
 1711 004e 002B     		cmp	r3, #0
 1712 0050 40F0CA80 		bne	.L134
 688:Src/pid.c     **** 							}
 1713              		.loc 1 688 0
 1714 0054 854B     		ldr	r3, .L164
 1715 0056 B3F84620 		ldrh	r2, [r3, #70]
 1716 005a A3F85C20 		strh	r2, [r3, #92]	@ movhi
 1717 005e 08E0     		b	.L124
 1718              	.L122:
 633:Src/pid.c     ****   }
 1719              		.loc 1 633 0
 1720 0060 824A     		ldr	r2, .L164
 1721 0062 B2F86210 		ldrh	r1, [r2, #98]
 1722 0066 B2F85E30 		ldrh	r3, [r2, #94]
 1723 006a 0B44     		add	r3, r3, r1
 1724 006c 1BB2     		sxth	r3, r3
 1725 006e A2F85C30 		strh	r3, [r2, #92]	@ movhi
 1726              	.LVL107:
 1727              	.L124:
 765:Src/pid.c     **** 	{
 1728              		.loc 1 765 0
 1729 0072 7E4B     		ldr	r3, .L164
 1730 0074 B3F85C20 		ldrh	r2, [r3, #92]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 54


 1731 0078 12B2     		sxth	r2, r2
 1732 007a B3F88432 		ldrh	r3, [r3, #644]
 1733 007e 1BB2     		sxth	r3, r3
 1734 0080 9A42     		cmp	r2, r3
 1735 0082 04DD     		ble	.L151
 767:Src/pid.c     **** 	}
 1736              		.loc 1 767 0
 1737 0084 794B     		ldr	r3, .L164
 1738 0086 B3F88422 		ldrh	r2, [r3, #644]
 1739 008a A3F85C20 		strh	r2, [r3, #92]	@ movhi
 1740              	.L151:
 769:Src/pid.c     **** 	{
 1741              		.loc 1 769 0
 1742 008e 774B     		ldr	r3, .L164
 1743 0090 B3F85C20 		ldrh	r2, [r3, #92]
 1744 0094 12B2     		sxth	r2, r2
 1745 0096 B3F88632 		ldrh	r3, [r3, #646]
 1746 009a 1BB2     		sxth	r3, r3
 1747 009c 9A42     		cmp	r2, r3
 1748 009e 04DA     		bge	.L152
 771:Src/pid.c     **** 	}
 1749              		.loc 1 771 0
 1750 00a0 724B     		ldr	r3, .L164
 1751 00a2 B3F88622 		ldrh	r2, [r3, #646]
 1752 00a6 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 1753              	.L152:
 776:Src/pid.c     **** 	{
 1754              		.loc 1 776 0
 1755 00aa 704B     		ldr	r3, .L164
 1756 00ac 5A8C     		ldrh	r2, [r3, #34]
 1757 00ae 12B2     		sxth	r2, r2
 1758 00b0 B3F88032 		ldrh	r3, [r3, #640]
 1759 00b4 1BB2     		sxth	r3, r3
 1760 00b6 9A42     		cmp	r2, r3
 1761 00b8 03DD     		ble	.L153
 778:Src/pid.c     **** 	}
 1762              		.loc 1 778 0
 1763 00ba 6C4B     		ldr	r3, .L164
 1764 00bc B3F88022 		ldrh	r2, [r3, #640]
 1765 00c0 5A84     		strh	r2, [r3, #34]	@ movhi
 1766              	.L153:
 780:Src/pid.c     **** 	{
 1767              		.loc 1 780 0
 1768 00c2 6A4B     		ldr	r3, .L164
 1769 00c4 9A8C     		ldrh	r2, [r3, #36]
 1770 00c6 12B2     		sxth	r2, r2
 1771 00c8 B3F88232 		ldrh	r3, [r3, #642]
 1772 00cc 1BB2     		sxth	r3, r3
 1773 00ce 9A42     		cmp	r2, r3
 1774 00d0 03DA     		bge	.L154
 782:Src/pid.c     **** 	}
 1775              		.loc 1 782 0
 1776 00d2 664B     		ldr	r3, .L164
 1777 00d4 B3F88222 		ldrh	r2, [r3, #642]
 1778 00d8 9A84     		strh	r2, [r3, #36]	@ movhi
 1779              	.L154:
 785:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[CMD_CUR_LOWER_LIMIT_PU];		
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 55


 1780              		.loc 1 785 0
 1781 00da 644B     		ldr	r3, .L164
 1782 00dc 598C     		ldrh	r1, [r3, #34]
 1783 00de 09B2     		sxth	r1, r1
 1784 00e0 644A     		ldr	r2, .L164+8
 1785 00e2 D163     		str	r1, [r2, #60]
 786:Src/pid.c     **** 	
 1786              		.loc 1 786 0
 1787 00e4 998C     		ldrh	r1, [r3, #36]
 1788 00e6 09B2     		sxth	r1, r1
 1789 00e8 1164     		str	r1, [r2, #64]
 796:Src/pid.c     **** }
 1790              		.loc 1 796 0
 1791 00ea B3F85C00 		ldrh	r0, [r3, #92]
 1792 00ee B3F85010 		ldrh	r1, [r3, #80]
 1793 00f2 09B2     		sxth	r1, r1
 1794 00f4 00B2     		sxth	r0, r0
 1795 00f6 FFF7FEFF 		bl	PID_control
 1796              	.LVL108:
 797:Src/pid.c     **** void PositionPID(void)   //ï¿½Å½ï¿½ï¿½ï¿½ï¿½ï¿½ Î»ï¿½Ãµï¿½ï¿½ï¿½ï¿½ï¿½Ï²ï¿½ï¿½Î·ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿
 1797              		.loc 1 797 0
 1798 00fa 08BD     		pop	{r3, pc}
 1799              	.LVL109:
 1800              	.L156:
 637:Src/pid.c     **** 		
 1801              		.loc 1 637 0
 1802 00fc 5B4B     		ldr	r3, .L164
 1803 00fe B3F85E20 		ldrh	r2, [r3, #94]
 1804 0102 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 639:Src/pid.c     **** 	}
 1805              		.loc 1 639 0
 1806 0106 5B4B     		ldr	r3, .L164+8
 1807 0108 0122     		movs	r2, #1
 1808 010a 1A60     		str	r2, [r3]
 1809 010c B1E7     		b	.L124
 1810              	.L157:
 645:Src/pid.c     **** 				{
 1811              		.loc 1 645 0
 1812 010e 574B     		ldr	r3, .L164
 1813 0110 5B8D     		ldrh	r3, [r3, #42]
 1814 0112 1BB2     		sxth	r3, r3
 1815 0114 002B     		cmp	r3, #0
 1816 0116 2CD1     		bne	.L127
 647:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 1817              		.loc 1 647 0
 1818 0118 544B     		ldr	r3, .L164
 1819 011a B3F84410 		ldrh	r1, [r3, #68]
 1820 011e 564A     		ldr	r2, .L164+12
 1821 0120 1180     		strh	r1, [r2]	@ movhi
 648:Src/pid.c     **** 				}
 1822              		.loc 1 648 0
 1823 0122 B3F85A20 		ldrh	r2, [r3, #90]
 1824 0126 554B     		ldr	r3, .L164+16
 1825 0128 1A80     		strh	r2, [r3]	@ movhi
 1826              	.L128:
 655:Src/pid.c     **** 				{
 1827              		.loc 1 655 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 56


 1828 012a 534B     		ldr	r3, .L164+12
 1829 012c 1B88     		ldrh	r3, [r3]
 1830 012e 13F4004F 		tst	r3, #32768
 1831 0132 32D1     		bne	.L129
 657:Src/pid.c     **** 					{
 1832              		.loc 1 657 0
 1833 0134 514B     		ldr	r3, .L164+16
 1834 0136 1A88     		ldrh	r2, [r3]
 1835 0138 12B2     		sxth	r2, r2
 1836 013a 4F4B     		ldr	r3, .L164+12
 1837 013c 1B88     		ldrh	r3, [r3]
 1838 013e 1BB2     		sxth	r3, r3
 1839 0140 9A42     		cmp	r2, r3
 1840 0142 08DC     		bgt	.L130
 657:Src/pid.c     **** 					{
 1841              		.loc 1 657 0 is_stmt 0 discriminator 1
 1842 0144 494B     		ldr	r3, .L164
 1843 0146 B3F84C20 		ldrh	r2, [r3, #76]
 1844 014a 12B2     		sxth	r2, r2
 1845 014c B3F88C32 		ldrh	r3, [r3, #652]
 1846 0150 1BB2     		sxth	r3, r3
 1847 0152 9A42     		cmp	r2, r3
 1848 0154 1BDD     		ble	.L131
 1849              	.L130:
 659:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;	
 1850              		.loc 1 659 0 is_stmt 1
 1851 0156 464B     		ldr	r3, .L164+4
 1852 0158 0322     		movs	r2, #3
 1853 015a 1A70     		strb	r2, [r3]
 660:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force);
 1854              		.loc 1 660 0
 1855 015c 434B     		ldr	r3, .L164
 1856 015e 0422     		movs	r2, #4
 1857 0160 A3F80422 		strh	r2, [r3, #516]	@ movhi
 661:Src/pid.c     **** 					
 1858              		.loc 1 661 0
 1859 0164 B3F84200 		ldrh	r0, [r3, #66]
 1860 0168 4549     		ldr	r1, .L164+20
 1861 016a 00B2     		sxth	r0, r0
 1862 016c FFF7FEFF 		bl	force_PID_out
 1863              	.LVL110:
 1864 0170 7FE7     		b	.L124
 1865              	.L127:
 652:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 1866              		.loc 1 652 0
 1867 0172 3E4A     		ldr	r2, .L164
 1868 0174 B2F84430 		ldrh	r3, [r2, #68]
 1869 0178 5B42     		negs	r3, r3
 1870 017a 1BB2     		sxth	r3, r3
 1871 017c 3E49     		ldr	r1, .L164+12
 1872 017e 0B80     		strh	r3, [r1]	@ movhi
 653:Src/pid.c     **** 				}
 1873              		.loc 1 653 0
 1874 0180 B2F85A30 		ldrh	r3, [r2, #90]
 1875 0184 5B42     		negs	r3, r3
 1876 0186 1BB2     		sxth	r3, r3
 1877 0188 3C4A     		ldr	r2, .L164+16
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 57


 1878 018a 1380     		strh	r3, [r2]	@ movhi
 1879 018c CDE7     		b	.L128
 1880              	.L131:
 666:Src/pid.c     **** 					}
 1881              		.loc 1 666 0
 1882 018e 374B     		ldr	r3, .L164
 1883 0190 B3F84A20 		ldrh	r2, [r3, #74]
 1884 0194 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 1885 0198 6BE7     		b	.L124
 1886              	.L129:
 671:Src/pid.c     **** 					{
 1887              		.loc 1 671 0
 1888 019a 384B     		ldr	r3, .L164+16
 1889 019c 1A88     		ldrh	r2, [r3]
 1890 019e 12B2     		sxth	r2, r2
 1891 01a0 354B     		ldr	r3, .L164+12
 1892 01a2 1B88     		ldrh	r3, [r3]
 1893 01a4 1BB2     		sxth	r3, r3
 1894 01a6 9A42     		cmp	r2, r3
 1895 01a8 08DB     		blt	.L132
 671:Src/pid.c     **** 					{
 1896              		.loc 1 671 0 is_stmt 0 discriminator 1
 1897 01aa 304B     		ldr	r3, .L164
 1898 01ac B3F84C20 		ldrh	r2, [r3, #76]
 1899 01b0 12B2     		sxth	r2, r2
 1900 01b2 B3F88E32 		ldrh	r3, [r3, #654]
 1901 01b6 1BB2     		sxth	r3, r3
 1902 01b8 9A42     		cmp	r2, r3
 1903 01ba 0DDA     		bge	.L133
 1904              	.L132:
 673:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 1905              		.loc 1 673 0 is_stmt 1
 1906 01bc 2C4B     		ldr	r3, .L164+4
 1907 01be 0322     		movs	r2, #3
 1908 01c0 1A70     		strb	r2, [r3]
 674:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 1909              		.loc 1 674 0
 1910 01c2 2A4B     		ldr	r3, .L164
 1911 01c4 0422     		movs	r2, #4
 1912 01c6 A3F80422 		strh	r2, [r3, #516]	@ movhi
 675:Src/pid.c     ****  		
 1913              		.loc 1 675 0
 1914 01ca B3F84200 		ldrh	r0, [r3, #66]
 1915 01ce 2C49     		ldr	r1, .L164+20
 1916 01d0 00B2     		sxth	r0, r0
 1917 01d2 FFF7FEFF 		bl	force_PID_out
 1918              	.LVL111:
 1919 01d6 4CE7     		b	.L124
 1920              	.L133:
 680:Src/pid.c     **** 					}
 1921              		.loc 1 680 0
 1922 01d8 244A     		ldr	r2, .L164
 1923 01da B2F84A30 		ldrh	r3, [r2, #74]
 1924 01de 5B42     		negs	r3, r3
 1925 01e0 1BB2     		sxth	r3, r3
 1926 01e2 A2F85C30 		strh	r3, [r2, #92]	@ movhi
 1927 01e6 44E7     		b	.L124
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 58


 1928              	.L134:
 690:Src/pid.c     **** 							{
 1929              		.loc 1 690 0
 1930 01e8 204B     		ldr	r3, .L164
 1931 01ea B3F81C32 		ldrh	r3, [r3, #540]
 1932 01ee 1BB2     		sxth	r3, r3
 1933 01f0 012B     		cmp	r3, #1
 1934 01f2 18D0     		beq	.L158
 704:Src/pid.c     **** 							{
 1935              		.loc 1 704 0
 1936 01f4 1D4B     		ldr	r3, .L164
 1937 01f6 B3F81C32 		ldrh	r3, [r3, #540]
 1938 01fa 1BB2     		sxth	r3, r3
 1939 01fc 0B2B     		cmp	r3, #11
 1940 01fe 43D0     		beq	.L159
 737:Src/pid.c     **** 							{
 1941              		.loc 1 737 0
 1942 0200 1A4B     		ldr	r3, .L164
 1943 0202 B3F81C32 		ldrh	r3, [r3, #540]
 1944 0206 1BB2     		sxth	r3, r3
 1945 0208 0C2B     		cmp	r3, #12
 1946 020a 00F09080 		beq	.L160
 748:Src/pid.c     **** 							{
 1947              		.loc 1 748 0
 1948 020e 174B     		ldr	r3, .L164
 1949 0210 B3F81C32 		ldrh	r3, [r3, #540]
 1950 0214 1BB2     		sxth	r3, r3
 1951 0216 0D2B     		cmp	r3, #13
 1952 0218 00F09D80 		beq	.L161
 761:Src/pid.c     **** 							}				
 1953              		.loc 1 761 0
 1954 021c 134B     		ldr	r3, .L164
 1955 021e 0022     		movs	r2, #0
 1956 0220 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 1957 0224 25E7     		b	.L124
 1958              	.L158:
 693:Src/pid.c     **** 								{
 1959              		.loc 1 693 0
 1960 0226 114B     		ldr	r3, .L164
 1961 0228 B3F84C30 		ldrh	r3, [r3, #76]
 1962 022c 1BB2     		sxth	r3, r3
 1963 022e 40F26562 		movw	r2, #1637
 1964 0232 9342     		cmp	r3, r2
 1965 0234 0DDC     		bgt	.L136
 695:Src/pid.c     **** 								}
 1966              		.loc 1 695 0
 1967 0236 134B     		ldr	r3, .L164+24
 1968 0238 0122     		movs	r2, #1
 1969 023a 1A60     		str	r2, [r3]
 1970              	.L137:
 701:Src/pid.c     **** 
 1971              		.loc 1 701 0
 1972 023c 0B4A     		ldr	r2, .L164
 1973 023e B2F84630 		ldrh	r3, [r2, #70]
 1974 0242 1049     		ldr	r1, .L164+24
 1975 0244 0968     		ldr	r1, [r1]
 1976 0246 13FB01F3 		smulbb	r3, r3, r1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 59


 1977 024a 1BB2     		sxth	r3, r3
 1978 024c A2F85C30 		strh	r3, [r2, #92]	@ movhi
 1979 0250 0FE7     		b	.L124
 1980              	.L136:
 697:Src/pid.c     **** 								{
 1981              		.loc 1 697 0
 1982 0252 064B     		ldr	r3, .L164
 1983 0254 B3F84C30 		ldrh	r3, [r3, #76]
 1984 0258 1BB2     		sxth	r3, r3
 1985 025a 43F69A12 		movw	r2, #14746
 1986 025e 9342     		cmp	r3, r2
 1987 0260 ECDD     		ble	.L137
 699:Src/pid.c     **** 								}
 1988              		.loc 1 699 0
 1989 0262 084B     		ldr	r3, .L164+24
 1990 0264 4FF0FF32 		mov	r2, #-1
 1991 0268 1A60     		str	r2, [r3]
 1992 026a E7E7     		b	.L137
 1993              	.L165:
 1994              		.align	2
 1995              	.L164:
 1996 026c 00000000 		.word	g_CmdMap
 1997 0270 00000000 		.word	status_Mode_POSITION_FORCE
 1998 0274 00000000 		.word	pid_spd
 1999 0278 00000000 		.word	force_set
 2000 027c 00000000 		.word	force_act
 2001 0280 00000000 		.word	pid_force
 2002 0284 00000000 		.word	.LANCHOR16
 2003              	.L159:
 706:Src/pid.c     **** 								{
 2004              		.loc 1 706 0
 2005 0288 3D4B     		ldr	r3, .L166
 2006 028a B3F86420 		ldrh	r2, [r3, #100]
 2007 028e 12B2     		sxth	r2, r2
 2008 0290 B3F8E032 		ldrh	r3, [r3, #736]
 2009 0294 1BB2     		sxth	r3, r3
 2010 0296 9A42     		cmp	r2, r3
 2011 0298 28DA     		bge	.L139
 708:Src/pid.c     **** 								}
 2012              		.loc 1 708 0
 2013 029a 3A4B     		ldr	r3, .L166+4
 2014 029c 0122     		movs	r2, #1
 2015 029e 1A60     		str	r2, [r3]
 2016              	.L140:
 714:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 2017              		.loc 1 714 0
 2018 02a0 374B     		ldr	r3, .L166
 2019 02a2 B3F84630 		ldrh	r3, [r3, #70]
 2020 02a6 13F4004F 		tst	r3, #32768
 2021 02aa 2DD1     		bne	.L162
 714:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 2022              		.loc 1 714 0 is_stmt 0 discriminator 2
 2023 02ac 344B     		ldr	r3, .L166
 2024 02ae B3F84630 		ldrh	r3, [r3, #70]
 2025 02b2 18B2     		sxth	r0, r3
 2026              	.L142:
 2027              	.LVL112:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 60


 715:Src/pid.c     **** 								{
 2028              		.loc 1 715 0 is_stmt 1 discriminator 4
 2029 02b4 344A     		ldr	r2, .L166+8
 2030 02b6 1368     		ldr	r3, [r2]
 2031 02b8 591C     		adds	r1, r3, #1
 2032 02ba 1160     		str	r1, [r2]
 2033 02bc B3F57A6F 		cmp	r3, #4000
 2034 02c0 0ADD     		ble	.L143
 717:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 2035              		.loc 1 717 0
 2036 02c2 1346     		mov	r3, r2
 2037 02c4 0022     		movs	r2, #0
 2038 02c6 1A60     		str	r2, [r3]
 718:Src/pid.c     **** 									{
 2039              		.loc 1 718 0
 2040 02c8 304B     		ldr	r3, .L166+12
 2041 02ca 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2042 02cc 13BB     		cbnz	r3, .L144
 720:Src/pid.c     **** 									}
 2043              		.loc 1 720 0
 2044 02ce 304B     		ldr	r3, .L166+16
 2045 02d0 1A70     		strb	r2, [r3]
 2046              	.L145:
 726:Src/pid.c     **** 								}
 2047              		.loc 1 726 0
 2048 02d2 2E4B     		ldr	r3, .L166+12
 2049 02d4 0022     		movs	r2, #0
 2050 02d6 1A70     		strb	r2, [r3]
 2051              	.L143:
 728:Src/pid.c     **** 								{
 2052              		.loc 1 728 0
 2053 02d8 2D4B     		ldr	r3, .L166+16
 2054 02da 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2055 02dc DBB2     		uxtb	r3, r3
 2056 02de 012B     		cmp	r3, #1
 2057 02e0 1CD0     		beq	.L163
 734:Src/pid.c     **** 								}				
 2058              		.loc 1 734 0
 2059 02e2 274B     		ldr	r3, .L166
 2060 02e4 0022     		movs	r2, #0
 2061 02e6 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 2062 02ea C2E6     		b	.L124
 2063              	.LVL113:
 2064              	.L139:
 710:Src/pid.c     **** 								{
 2065              		.loc 1 710 0
 2066 02ec 244B     		ldr	r3, .L166
 2067 02ee B3F86420 		ldrh	r2, [r3, #100]
 2068 02f2 12B2     		sxth	r2, r2
 2069 02f4 B3F85833 		ldrh	r3, [r3, #856]
 2070 02f8 1BB2     		sxth	r3, r3
 2071 02fa 9A42     		cmp	r2, r3
 2072 02fc D0DD     		ble	.L140
 712:Src/pid.c     **** 								}
 2073              		.loc 1 712 0
 2074 02fe 214B     		ldr	r3, .L166+4
 2075 0300 4FF0FF32 		mov	r2, #-1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 61


 2076 0304 1A60     		str	r2, [r3]
 2077 0306 CBE7     		b	.L140
 2078              	.L162:
 714:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 2079              		.loc 1 714 0 discriminator 1
 2080 0308 1D4B     		ldr	r3, .L166
 2081 030a B3F84630 		ldrh	r3, [r3, #70]
 2082 030e 5B42     		negs	r3, r3
 2083 0310 18B2     		sxth	r0, r3
 2084 0312 CFE7     		b	.L142
 2085              	.LVL114:
 2086              	.L144:
 724:Src/pid.c     **** 									}
 2087              		.loc 1 724 0
 2088 0314 1E4B     		ldr	r3, .L166+16
 2089 0316 0122     		movs	r2, #1
 2090 0318 1A70     		strb	r2, [r3]
 2091 031a DAE7     		b	.L145
 2092              	.L163:
 730:Src/pid.c     **** 								}
 2093              		.loc 1 730 0
 2094 031c 194B     		ldr	r3, .L166+4
 2095 031e 1B68     		ldr	r3, [r3]
 2096 0320 13FB00F3 		smulbb	r3, r3, r0
 2097 0324 1BB2     		sxth	r3, r3
 2098 0326 164A     		ldr	r2, .L166
 2099 0328 A2F85C30 		strh	r3, [r2, #92]	@ movhi
 2100 032c A1E6     		b	.L124
 2101              	.LVL115:
 2102              	.L160:
 739:Src/pid.c     **** 								{
 2103              		.loc 1 739 0
 2104 032e 144B     		ldr	r3, .L166
 2105 0330 B3F86420 		ldrh	r2, [r3, #100]
 2106 0334 12B2     		sxth	r2, r2
 2107 0336 B3F8E032 		ldrh	r3, [r3, #736]
 2108 033a 1BB2     		sxth	r3, r3
 2109 033c 9A42     		cmp	r2, r3
 2110 033e 05DD     		ble	.L148
 741:Src/pid.c     **** 								}
 2111              		.loc 1 741 0
 2112 0340 0F4B     		ldr	r3, .L166
 2113 0342 4FF46042 		mov	r2, #57344
 2114 0346 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 2115 034a 92E6     		b	.L124
 2116              	.L148:
 745:Src/pid.c     **** 								}
 2117              		.loc 1 745 0
 2118 034c 0C4B     		ldr	r3, .L166
 2119 034e 0022     		movs	r2, #0
 2120 0350 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 2121 0354 8DE6     		b	.L124
 2122              	.L161:
 750:Src/pid.c     **** 								{
 2123              		.loc 1 750 0
 2124 0356 0A4B     		ldr	r3, .L166
 2125 0358 B3F86420 		ldrh	r2, [r3, #100]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 62


 2126 035c 12B2     		sxth	r2, r2
 2127 035e B3F85833 		ldrh	r3, [r3, #856]
 2128 0362 1BB2     		sxth	r3, r3
 2129 0364 9A42     		cmp	r2, r3
 2130 0366 05DA     		bge	.L150
 752:Src/pid.c     **** 								}
 2131              		.loc 1 752 0
 2132 0368 054B     		ldr	r3, .L166
 2133 036a 4FF40052 		mov	r2, #8192
 2134 036e A3F85C20 		strh	r2, [r3, #92]	@ movhi
 2135 0372 7EE6     		b	.L124
 2136              	.L150:
 756:Src/pid.c     **** 								}
 2137              		.loc 1 756 0
 2138 0374 024B     		ldr	r3, .L166
 2139 0376 0022     		movs	r2, #0
 2140 0378 A3F85C20 		strh	r2, [r3, #92]	@ movhi
 2141 037c 79E6     		b	.L124
 2142              	.L167:
 2143 037e 00BF     		.align	2
 2144              	.L166:
 2145 0380 00000000 		.word	g_CmdMap
 2146 0384 00000000 		.word	.LANCHOR16
 2147 0388 00000000 		.word	.LANCHOR17
 2148 038c 00000000 		.word	g_flag_monitor_from_host
 2149 0390 00000000 		.word	.LANCHOR18
 2150              		.cfi_endproc
 2151              	.LFE339:
 2153              		.section	.text.PositionPID,"ax",%progbits
 2154              		.align	1
 2155              		.global	PositionPID
 2156              		.syntax unified
 2157              		.thumb
 2158              		.thumb_func
 2159              		.fpu fpv4-sp-d16
 2161              	PositionPID:
 2162              	.LFB340:
 799:Src/pid.c     **** 	static s16 delay_cnt = 0;
 2163              		.loc 1 799 0
 2164              		.cfi_startproc
 2165              		@ args = 0, pretend = 0, frame = 0
 2166              		@ frame_needed = 0, uses_anonymous_args = 0
 2167 0000 38B5     		push	{r3, r4, r5, lr}
 2168              	.LCFI13:
 2169              		.cfi_def_cfa_offset 16
 2170              		.cfi_offset 3, -16
 2171              		.cfi_offset 4, -12
 2172              		.cfi_offset 5, -8
 2173              		.cfi_offset 14, -4
 801:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 2174              		.loc 1 801 0
 2175 0002 364A     		ldr	r2, .L183
 2176 0004 B2F84830 		ldrh	r3, [r2, #72]
 2177 0008 1BB2     		sxth	r3, r3
 2178 000a B2F84C20 		ldrh	r2, [r2, #76]
 2179 000e 12B2     		sxth	r2, r2
 2180 0010 9B1A     		subs	r3, r3, r2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 63


 2181 0012 334A     		ldr	r2, .L183+4
 2182 0014 1360     		str	r3, [r2]
 803:Src/pid.c     **** 	{
 2183              		.loc 1 803 0
 2184 0016 1368     		ldr	r3, [r2]
 2185 0018 002B     		cmp	r3, #0
 2186 001a 48DB     		blt	.L180
 803:Src/pid.c     **** 	{
 2187              		.loc 1 803 0 is_stmt 0 discriminator 2
 2188 001c 304B     		ldr	r3, .L183+4
 2189 001e 1A68     		ldr	r2, [r3]
 2190              	.L170:
 803:Src/pid.c     **** 	{
 2191              		.loc 1 803 0 discriminator 4
 2192 0020 304B     		ldr	r3, .L183+8
 2193 0022 1B68     		ldr	r3, [r3]
 2194 0024 9342     		cmp	r3, r2
 2195 0026 0ADD     		ble	.L171
 803:Src/pid.c     **** 	{
 2196              		.loc 1 803 0 discriminator 5
 2197 0028 2F4A     		ldr	r2, .L183+12
 2198 002a 1268     		ldr	r2, [r2]
 2199 002c 3AB9     		cbnz	r2, .L171
 805:Src/pid.c     **** 		{
 2200              		.loc 1 805 0 is_stmt 1
 2201 002e 2F4A     		ldr	r2, .L183+16
 2202 0030 B2F90020 		ldrsh	r2, [r2]
 2203 0034 312A     		cmp	r2, #49
 2204 0036 3DDC     		bgt	.L172
 807:Src/pid.c     **** 		}
 2205              		.loc 1 807 0
 2206 0038 0132     		adds	r2, r2, #1
 2207 003a 2C49     		ldr	r1, .L183+16
 2208 003c 0A80     		strh	r2, [r1]	@ movhi
 2209              	.L171:
 814:Src/pid.c     **** 	{
 2210              		.loc 1 814 0
 2211 003e 284A     		ldr	r2, .L183+4
 2212 0040 1268     		ldr	r2, [r2]
 2213 0042 002A     		cmp	r2, #0
 2214 0044 3ADB     		blt	.L181
 814:Src/pid.c     **** 	{
 2215              		.loc 1 814 0 is_stmt 0 discriminator 2
 2216 0046 264A     		ldr	r2, .L183+4
 2217 0048 1268     		ldr	r2, [r2]
 2218              	.L174:
 814:Src/pid.c     **** 	{
 2219              		.loc 1 814 0 discriminator 4
 2220 004a B2EB430F 		cmp	r2, r3, lsl #1
 2221 004e 03DC     		bgt	.L175
 814:Src/pid.c     **** 	{
 2222              		.loc 1 814 0 discriminator 5
 2223 0050 254B     		ldr	r3, .L183+12
 2224 0052 1B68     		ldr	r3, [r3]
 2225 0054 012B     		cmp	r3, #1
 2226 0056 04D1     		bne	.L176
 2227              	.L175:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 64


 816:Src/pid.c     **** 		delay_cnt = 0;
 2228              		.loc 1 816 0 is_stmt 1
 2229 0058 0023     		movs	r3, #0
 2230 005a 254A     		ldr	r2, .L183+20
 2231 005c 1370     		strb	r3, [r2]
 817:Src/pid.c     **** 	}	
 2232              		.loc 1 817 0
 2233 005e 234A     		ldr	r2, .L183+16
 2234 0060 1380     		strh	r3, [r2]	@ movhi
 2235              	.L176:
 819:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 2236              		.loc 1 819 0
 2237 0062 234B     		ldr	r3, .L183+20
 2238 0064 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 2239 0066 234B     		ldr	r3, .L183+24
 2240 0068 1A70     		strb	r2, [r3]
 822:Src/pid.c     **** 	{
 2241              		.loc 1 822 0
 2242 006a 234B     		ldr	r3, .L183+28
 2243 006c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2244 006e DBB2     		uxtb	r3, r3
 2245 0070 012B     		cmp	r3, #1
 2246 0072 27D0     		beq	.L182
 829:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 2247              		.loc 1 829 0
 2248 0074 1949     		ldr	r1, .L183
 2249 0076 B1F89232 		ldrh	r3, [r1, #658]
 2250 007a 43F34A13 		sbfx	r3, r3, #5, #11
 2251 007e 1F4A     		ldr	r2, .L183+32
 2252 0080 D363     		str	r3, [r2, #60]
 830:Src/pid.c     **** 	}		
 2253              		.loc 1 830 0
 2254 0082 B1F89232 		ldrh	r3, [r1, #658]
 2255 0086 43F34A13 		sbfx	r3, r3, #5, #11
 2256 008a 5B42     		negs	r3, r3
 2257 008c 1364     		str	r3, [r2, #64]
 2258              	.L178:
 832:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_pos.out;
 2259              		.loc 1 832 0
 2260 008e 134C     		ldr	r4, .L183
 2261 0090 B4F86000 		ldrh	r0, [r4, #96]
 2262 0094 B4F84C10 		ldrh	r1, [r4, #76]
 2263 0098 184D     		ldr	r5, .L183+32
 2264 009a 2A46     		mov	r2, r5
 2265 009c 09B2     		sxth	r1, r1
 2266 009e 00B2     		sxth	r0, r0
 2267 00a0 FFF7FEFF 		bl	PID_control
 2268              	.LVL116:
 833:Src/pid.c     **** }
 2269              		.loc 1 833 0
 2270 00a4 B5F93430 		ldrsh	r3, [r5, #52]
 2271 00a8 A4F85E30 		strh	r3, [r4, #94]	@ movhi
 834:Src/pid.c     **** //int16_t Force_set_drop_detection = 0;
 2272              		.loc 1 834 0
 2273 00ac 38BD     		pop	{r3, r4, r5, pc}
 2274              	.L180:
 803:Src/pid.c     **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 65


 2275              		.loc 1 803 0 discriminator 1
 2276 00ae 1268     		ldr	r2, [r2]
 2277 00b0 5242     		negs	r2, r2
 2278 00b2 B5E7     		b	.L170
 2279              	.L172:
 811:Src/pid.c     **** 		}
 2280              		.loc 1 811 0
 2281 00b4 0E4A     		ldr	r2, .L183+20
 2282 00b6 0121     		movs	r1, #1
 2283 00b8 1170     		strb	r1, [r2]
 2284 00ba C0E7     		b	.L171
 2285              	.L181:
 814:Src/pid.c     **** 	{
 2286              		.loc 1 814 0 discriminator 1
 2287 00bc 084A     		ldr	r2, .L183+4
 2288 00be 1268     		ldr	r2, [r2]
 2289 00c0 5242     		negs	r2, r2
 2290 00c2 C2E7     		b	.L174
 2291              	.L182:
 824:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 2292              		.loc 1 824 0
 2293 00c4 0549     		ldr	r1, .L183
 2294 00c6 B1F89232 		ldrh	r3, [r1, #658]
 2295 00ca 1BB2     		sxth	r3, r3
 2296 00cc 0B4A     		ldr	r2, .L183+32
 2297 00ce D363     		str	r3, [r2, #60]
 825:Src/pid.c     **** 	}
 2298              		.loc 1 825 0
 2299 00d0 B1F89232 		ldrh	r3, [r1, #658]
 2300 00d4 1BB2     		sxth	r3, r3
 2301 00d6 5B42     		negs	r3, r3
 2302 00d8 1364     		str	r3, [r2, #64]
 2303 00da D8E7     		b	.L178
 2304              	.L184:
 2305              		.align	2
 2306              	.L183:
 2307 00dc 00000000 		.word	g_CmdMap
 2308 00e0 00000000 		.word	.LANCHOR19
 2309 00e4 00000000 		.word	gPos_ds
 2310 00e8 00000000 		.word	Profile_moving
 2311 00ec 00000000 		.word	.LANCHOR20
 2312 00f0 00000000 		.word	.LANCHOR21
 2313 00f4 00000000 		.word	.LANCHOR22
 2314 00f8 00000000 		.word	flag_posReg_strengthen
 2315 00fc 00000000 		.word	pid_pos
 2316              		.cfi_endproc
 2317              	.LFE340:
 2319              		.section	.text.Gripper_control,"ax",%progbits
 2320              		.align	1
 2321              		.global	Gripper_control
 2322              		.syntax unified
 2323              		.thumb
 2324              		.thumb_func
 2325              		.fpu fpv4-sp-d16
 2327              	Gripper_control:
 2328              	.LFB341:
 838:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 66


 2329              		.loc 1 838 0
 2330              		.cfi_startproc
 2331              		@ args = 0, pretend = 0, frame = 0
 2332              		@ frame_needed = 0, uses_anonymous_args = 0
 839:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 2333              		.loc 1 839 0
 2334 0000 5F4B     		ldr	r3, .L206
 2335 0002 B3F84810 		ldrh	r1, [r3, #72]
 2336 0006 09B2     		sxth	r1, r1
 2337 0008 B3F84C20 		ldrh	r2, [r3, #76]
 2338 000c 12B2     		sxth	r2, r2
 2339 000e 8A1A     		subs	r2, r1, r2
 2340              	.LVL117:
 840:Src/pid.c     **** 	{
 2341              		.loc 1 840 0
 2342 0010 B3F80432 		ldrh	r3, [r3, #516]
 2343 0014 1BB2     		sxth	r3, r3
 2344 0016 032B     		cmp	r3, #3
 2345 0018 0DD0     		beq	.L201
 2346              	.L186:
 842:Src/pid.c     **** 		Grriper_Run = 0;
 2347              		.loc 1 842 0
 2348 001a 0023     		movs	r3, #0
 2349 001c 594A     		ldr	r2, .L206+4
 2350              	.LVL118:
 2351 001e 1380     		strh	r3, [r2]	@ movhi
 843:Src/pid.c     **** 		Flag_contact = 0;
 2352              		.loc 1 843 0
 2353 0020 594A     		ldr	r2, .L206+8
 2354 0022 1370     		strb	r3, [r2]
 844:Src/pid.c     **** 		Flag_grip_F_OK = 0;
 2355              		.loc 1 844 0
 2356 0024 594A     		ldr	r2, .L206+12
 2357 0026 1370     		strb	r3, [r2]
 845:Src/pid.c     **** 		Flag_grip_P_OK = 0;
 2358              		.loc 1 845 0
 2359 0028 594A     		ldr	r2, .L206+16
 2360 002a 1370     		strb	r3, [r2]
 846:Src/pid.c     **** 		Flag_rellease_P_OK = 0;
 2361              		.loc 1 846 0
 2362 002c 594A     		ldr	r2, .L206+20
 2363 002e 1370     		strb	r3, [r2]
 847:Src/pid.c     **** 	}	
 2364              		.loc 1 847 0
 2365 0030 594A     		ldr	r2, .L206+24
 2366 0032 1370     		strb	r3, [r2]
 2367 0034 7047     		bx	lr
 2368              	.LVL119:
 2369              	.L201:
 840:Src/pid.c     **** 	{
 2370              		.loc 1 840 0 discriminator 1
 2371 0036 594B     		ldr	r3, .L206+28
 2372 0038 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2373 003a DBB2     		uxtb	r3, r3
 2374 003c 012B     		cmp	r3, #1
 2375 003e ECD0     		beq	.L186
 838:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 67


 2376              		.loc 1 838 0
 2377 0040 10B5     		push	{r4, lr}
 2378              	.LCFI14:
 2379              		.cfi_def_cfa_offset 8
 2380              		.cfi_offset 4, -8
 2381              		.cfi_offset 14, -4
 871:Src/pid.c     **** 		{
 2382              		.loc 1 871 0
 2383 0042 574B     		ldr	r3, .L206+32
 2384 0044 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2385 0046 DBB2     		uxtb	r3, r3
 2386 0048 012B     		cmp	r3, #1
 2387 004a 17D0     		beq	.L202
 2388              	.LVL120:
 2389              	.L189:
 920:Src/pid.c     **** 
 2390              		.loc 1 920 0
 2391 004c 4C4B     		ldr	r3, .L206
 2392 004e B3F84830 		ldrh	r3, [r3, #72]
 2393 0052 1BB2     		sxth	r3, r3
 2394 0054 534A     		ldr	r2, .L206+36
 2395 0056 1360     		str	r3, [r2]
 922:Src/pid.c     **** 		{
 2396              		.loc 1 922 0
 2397 0058 4A4B     		ldr	r3, .L206+4
 2398 005a B3F90030 		ldrsh	r3, [r3]
 2399 005e 012B     		cmp	r3, #1
 2400 0060 7ED0     		beq	.L203
 2401              	.L195:
 926:Src/pid.c     **** 		{		
 2402              		.loc 1 926 0
 2403 0062 494B     		ldr	r3, .L206+8
 2404 0064 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2405 0066 DBB2     		uxtb	r3, r3
 2406 0068 012B     		cmp	r3, #1
 2407 006a 7DD0     		beq	.L204
 2408              	.L196:
 932:Src/pid.c     **** 		}
 2409              		.loc 1 932 0
 2410 006c 4E4B     		ldr	r3, .L206+40
 2411 006e 0022     		movs	r2, #0
 2412 0070 1A60     		str	r2, [r3]
 2413              	.L197:
 935:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
 2414              		.loc 1 935 0
 2415 0072 FFF7FEFF 		bl	Profile
 2416              	.LVL121:
 937:Src/pid.c     **** 	}
 2417              		.loc 1 937 0
 2418 0076 FFF7FEFF 		bl	PositionPID
 2419              	.LVL122:
 939:Src/pid.c     **** 	float v = 11.84;
 2420              		.loc 1 939 0
 2421 007a 10BD     		pop	{r4, pc}
 2422              	.LVL123:
 2423              	.L202:
 871:Src/pid.c     **** 		{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 68


 2424              		.loc 1 871 0 discriminator 1
 2425 007c 404B     		ldr	r3, .L206
 2426 007e B3F8B632 		ldrh	r3, [r3, #694]
 2427 0082 1BB2     		sxth	r3, r3
 2428 0084 9342     		cmp	r3, r2
 2429 0086 06DB     		blt	.L190
 871:Src/pid.c     **** 		{
 2430              		.loc 1 871 0 is_stmt 0 discriminator 2
 2431 0088 3D4B     		ldr	r3, .L206
 2432 008a B3F8B632 		ldrh	r3, [r3, #694]
 2433 008e 1BB2     		sxth	r3, r3
 2434 0090 5B42     		negs	r3, r3
 2435 0092 9342     		cmp	r3, r2
 2436 0094 DADD     		ble	.L189
 2437              	.L190:
 873:Src/pid.c     **** 			
 2438              		.loc 1 873 0 is_stmt 1
 2439 0096 424B     		ldr	r3, .L206+32
 2440 0098 0022     		movs	r2, #0
 2441              	.LVL124:
 2442 009a 1A70     		strb	r2, [r3]
 875:Src/pid.c     **** 				{
 2443              		.loc 1 875 0
 2444 009c 384C     		ldr	r4, .L206
 2445 009e 638A     		ldrh	r3, [r4, #18]
 880:Src/pid.c     **** 				Profile_ParaSet();
 2446              		.loc 1 880 0
 2447 00a0 0323     		movs	r3, #3
 2448 00a2 A4F80432 		strh	r3, [r4, #516]	@ movhi
 881:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 2449              		.loc 1 881 0
 2450 00a6 FFF7FEFF 		bl	Profile_ParaSet
 2451              	.LVL125:
 882:Src/pid.c     **** 				{
 2452              		.loc 1 882 0
 2453 00aa B4F84030 		ldrh	r3, [r4, #64]
 2454 00ae 1BB2     		sxth	r3, r3
 2455 00b0 012B     		cmp	r3, #1
 2456 00b2 2CD0     		beq	.L205
 2457              	.L191:
 887:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 2458              		.loc 1 887 0
 2459 00b4 0023     		movs	r3, #0
 2460 00b6 354A     		ldr	r2, .L206+12
 2461 00b8 1370     		strb	r3, [r2]
 888:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 2462              		.loc 1 888 0
 2463 00ba 354A     		ldr	r2, .L206+16
 2464 00bc 1370     		strb	r3, [r2]
 889:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 2465              		.loc 1 889 0
 2466 00be 354A     		ldr	r2, .L206+20
 2467 00c0 1370     		strb	r3, [r2]
 890:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 2468              		.loc 1 890 0
 2469 00c2 354A     		ldr	r2, .L206+24
 2470 00c4 1370     		strb	r3, [r2]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 69


 891:Src/pid.c     **** 				{
 2471              		.loc 1 891 0
 2472 00c6 2E4B     		ldr	r3, .L206
 2473 00c8 B3F84820 		ldrh	r2, [r3, #72]
 2474 00cc 12B2     		sxth	r2, r2
 2475 00ce B3F84C30 		ldrh	r3, [r3, #76]
 2476 00d2 1BB2     		sxth	r3, r3
 2477 00d4 9A42     		cmp	r2, r3
 2478 00d6 1EDA     		bge	.L192
 893:Src/pid.c     **** 					Grriper_Run = 1;
 2479              		.loc 1 893 0
 2480 00d8 0123     		movs	r3, #1
 2481 00da 2A4A     		ldr	r2, .L206+4
 2482 00dc 1380     		strh	r3, [r2]	@ movhi
 894:Src/pid.c     **** 					pid_spd.enable = 1;
 2483              		.loc 1 894 0
 2484 00de 2A4A     		ldr	r2, .L206+8
 2485 00e0 1370     		strb	r3, [r2]
 895:Src/pid.c     **** 					pid_pos.enable = 1;
 2486              		.loc 1 895 0
 2487 00e2 324A     		ldr	r2, .L206+44
 2488 00e4 1360     		str	r3, [r2]
 896:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 2489              		.loc 1 896 0
 2490 00e6 324A     		ldr	r2, .L206+48
 2491 00e8 1360     		str	r3, [r2]
 897:Src/pid.c     **** 					{
 2492              		.loc 1 897 0
 2493 00ea 254B     		ldr	r3, .L206
 2494 00ec 5B8A     		ldrh	r3, [r3, #18]
 2495 00ee 1BB2     		sxth	r3, r3
 2496 00f0 4BB9     		cbnz	r3, .L193
 897:Src/pid.c     **** 					{
 2497              		.loc 1 897 0 is_stmt 0 discriminator 1
 2498 00f2 234B     		ldr	r3, .L206
 2499 00f4 B3F85430 		ldrh	r3, [r3, #84]
 2500 00f8 C3F30B03 		ubfx	r3, r3, #0, #12
 2501 00fc 1BB9     		cbnz	r3, .L193
 899:Src/pid.c     **** 					}
 2502              		.loc 1 899 0 is_stmt 1
 2503 00fe 204B     		ldr	r3, .L206
 2504 0100 0122     		movs	r2, #1
 2505 0102 A3F80222 		strh	r2, [r3, #514]	@ movhi
 2506              	.L193:
 902:Src/pid.c     **** 				}
 2507              		.loc 1 902 0
 2508 0106 2B4B     		ldr	r3, .L206+52
 2509 0108 0022     		movs	r2, #0
 2510 010a 1A70     		strb	r2, [r3]
 2511 010c 9EE7     		b	.L189
 2512              	.L205:
 884:Src/pid.c     **** 				}
 2513              		.loc 1 884 0
 2514 010e 2A4B     		ldr	r3, .L206+56
 2515 0110 0022     		movs	r2, #0
 2516 0112 1A60     		str	r2, [r3]	@ float
 2517 0114 CEE7     		b	.L191
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 70


 2518              	.L192:
 904:Src/pid.c     **** 				{
 2519              		.loc 1 904 0
 2520 0116 1A4B     		ldr	r3, .L206
 2521 0118 B3F84820 		ldrh	r2, [r3, #72]
 2522 011c 12B2     		sxth	r2, r2
 2523 011e B3F84C30 		ldrh	r3, [r3, #76]
 2524 0122 1BB2     		sxth	r3, r3
 2525 0124 9A42     		cmp	r2, r3
 2526 0126 91DD     		ble	.L189
 906:Src/pid.c     **** 					Grriper_Run = 1;
 2527              		.loc 1 906 0
 2528 0128 164B     		ldr	r3, .L206+4
 2529 012a 0222     		movs	r2, #2
 2530 012c 1A80     		strh	r2, [r3]	@ movhi
 907:Src/pid.c     **** 					pid_spd.enable = 1;
 2531              		.loc 1 907 0
 2532 012e 0123     		movs	r3, #1
 2533 0130 154A     		ldr	r2, .L206+8
 2534 0132 1370     		strb	r3, [r2]
 908:Src/pid.c     **** 					pid_pos.enable = 1;
 2535              		.loc 1 908 0
 2536 0134 1D4A     		ldr	r2, .L206+44
 2537 0136 1360     		str	r3, [r2]
 909:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 2538              		.loc 1 909 0
 2539 0138 1D4A     		ldr	r2, .L206+48
 2540 013a 1360     		str	r3, [r2]
 910:Src/pid.c     **** 					{
 2541              		.loc 1 910 0
 2542 013c 104B     		ldr	r3, .L206
 2543 013e 5B8A     		ldrh	r3, [r3, #18]
 2544 0140 1BB2     		sxth	r3, r3
 2545 0142 4BB9     		cbnz	r3, .L194
 910:Src/pid.c     **** 					{
 2546              		.loc 1 910 0 is_stmt 0 discriminator 1
 2547 0144 0E4B     		ldr	r3, .L206
 2548 0146 B3F85430 		ldrh	r3, [r3, #84]
 2549 014a C3F30B03 		ubfx	r3, r3, #0, #12
 2550 014e 1BB9     		cbnz	r3, .L194
 912:Src/pid.c     **** 					}
 2551              		.loc 1 912 0 is_stmt 1
 2552 0150 0B4B     		ldr	r3, .L206
 2553 0152 0122     		movs	r2, #1
 2554 0154 A3F80222 		strh	r2, [r3, #514]	@ movhi
 2555              	.L194:
 914:Src/pid.c     **** 				}
 2556              		.loc 1 914 0
 2557 0158 164B     		ldr	r3, .L206+52
 2558 015a 0022     		movs	r2, #0
 2559 015c 1A70     		strb	r2, [r3]
 2560 015e 75E7     		b	.L189
 2561              	.L203:
 924:Src/pid.c     **** 		}
 2562              		.loc 1 924 0
 2563 0160 0B4B     		ldr	r3, .L206+16
 2564 0162 0122     		movs	r2, #1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 71


 2565 0164 1A70     		strb	r2, [r3]
 2566 0166 7CE7     		b	.L195
 2567              	.L204:
 926:Src/pid.c     **** 		{		
 2568              		.loc 1 926 0 discriminator 1
 2569 0168 054B     		ldr	r3, .L206
 2570 016a B3F80232 		ldrh	r3, [r3, #514]
 2571 016e 1BB2     		sxth	r3, r3
 2572 0170 012B     		cmp	r3, #1
 2573 0172 7FF47BAF 		bne	.L196
 928:Src/pid.c     **** 		}
 2574              		.loc 1 928 0
 2575 0176 0C4B     		ldr	r3, .L206+40
 2576 0178 0122     		movs	r2, #1
 2577 017a 1A60     		str	r2, [r3]
 2578 017c 79E7     		b	.L197
 2579              	.L207:
 2580 017e 00BF     		.align	2
 2581              	.L206:
 2582 0180 00000000 		.word	g_CmdMap
 2583 0184 00000000 		.word	Gripper_Move
 2584 0188 00000000 		.word	.LANCHOR23
 2585 018c 00000000 		.word	Flag_contact
 2586 0190 00000000 		.word	Flag_grip_F_OK
 2587 0194 00000000 		.word	Flag_grip_P_OK
 2588 0198 00000000 		.word	Flag_rellease_P_OK
 2589 019c 00000000 		.word	Motor_forbidden
 2590 01a0 00000000 		.word	.LANCHOR24
 2591 01a4 00000000 		.word	g_pos_tag
 2592 01a8 00000000 		.word	Flag_Profile_Enable
 2593 01ac 00000000 		.word	pid_spd
 2594 01b0 00000000 		.word	pid_pos
 2595 01b4 00000000 		.word	.LANCHOR25
 2596 01b8 00000000 		.word	tCnt_f
 2597              		.cfi_endproc
 2598              	.LFE341:
 2600              		.section	.text.phase_current_from_adcval,"ax",%progbits
 2601              		.align	1
 2602              		.global	phase_current_from_adcval
 2603              		.syntax unified
 2604              		.thumb
 2605              		.thumb_func
 2606              		.fpu fpv4-sp-d16
 2608              	phase_current_from_adcval:
 2609              	.LFB345:
1039:Src/pid.c     **** // ï¿½Õ»ï¿½Ä£Ê½ï¿½ï¿½ï¿½
1040:Src/pid.c     **** //static void CheckModeChange(void)
1041:Src/pid.c     **** //{
1042:Src/pid.c     **** //  static s32 s_OldMode = 0;
1043:Src/pid.c     **** //  if (s_OldMode != g_CmdMap[TAG_WORK_MODE])
1044:Src/pid.c     **** //  {
1045:Src/pid.c     **** //    if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1046:Src/pid.c     **** //		{
1047:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 16384;
1048:Src/pid.c     **** //		}
1049:Src/pid.c     **** //		else
1050:Src/pid.c     **** //		{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 72


1051:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 0;
1052:Src/pid.c     **** //		}
1053:Src/pid.c     **** //    g_CmdMap[CMD_CUR_SET_PU] = 0;
1054:Src/pid.c     **** //  }
1055:Src/pid.c     **** //  s_OldMode = g_CmdMap[TAG_WORK_MODE];
1056:Src/pid.c     **** //}
1057:Src/pid.c     **** 
1058:Src/pid.c     ****  volatile s32 s_Disable_Delay = 0;
1059:Src/pid.c     **** 
1060:Src/pid.c     **** static void Pos_Spd_PID(void)
1061:Src/pid.c     **** {
1062:Src/pid.c     **** 	static s32 s_count = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1063:Src/pid.c     ****   static s32 s_Enable_Delay = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1064:Src/pid.c     ****  GPIOA->BRR  |= (uint32_t)GPIO_PIN_4;
1065:Src/pid.c     **** 	//CheckModeChange();
1066:Src/pid.c     **** 	MTPro();
1067:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
1068:Src/pid.c     **** 	{
1069:Src/pid.c     **** 		g_servo_cmd_period_cnt++; //ï¿½ï¿½ÆµÎ»ï¿½ï¿½ï¿½Å·ï¿½ï¿½Â£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½Ê±
1070:Src/pid.c     **** 	}
1071:Src/pid.c     **** 	get_average_force_data();	
1072:Src/pid.c     **** 	
1073:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
1074:Src/pid.c     **** 	{
1075:Src/pid.c     **** 		ForcePID();
1076:Src/pid.c     **** 	}
1077:Src/pid.c     **** 	
1078:Src/pid.c     **** 	
1079:Src/pid.c     **** 	Loop3_EnableManage();
1080:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
1081:Src/pid.c     **** 	{
1082:Src/pid.c     **** 		s_count = 0;
1083:Src/pid.c     **** 		Flag_1ms = 1;
1084:Src/pid.c     **** 		if(++s_count_50ms>50)
1085:Src/pid.c     **** 		{
1086:Src/pid.c     **** 			s_count_50ms = 0;
1087:Src/pid.c     **** 			Flag_50ms = 1;
1088:Src/pid.c     **** 		}
1089:Src/pid.c     **** 		
1090:Src/pid.c     **** 		
1091:Src/pid.c     **** 		
1092:Src/pid.c     **** 		Get_Pos_Rod();
1093:Src/pid.c     **** 		Stroke_protection();
1094:Src/pid.c     **** 		
1095:Src/pid.c     **** //		if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1096:Src/pid.c     **** 		{
1097:Src/pid.c     **** 			Gripper_control();	
1098:Src/pid.c     **** 		}
1099:Src/pid.c     **** 	}
1100:Src/pid.c     **** 	
1101:Src/pid.c     **** 	icmu_sdtransmission_test();
1102:Src/pid.c     **** 	
1103:Src/pid.c     **** 	
1104:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION || g_CmdMap[TAG_WORK_MODE] == MODE_SPEED  ||  g_CmdMap
1105:Src/pid.c     **** 	{
1106:Src/pid.c     **** 		SpeedPID();
1107:Src/pid.c     **** 	}	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 73


1108:Src/pid.c     ****   // Hï¿½Å´Ó½ï¿½ï¿½Üµï¿½Ê¹ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½ï¿½È´ï¿½ï¿½Ìµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿
1109:Src/pid.c     ****   if(g_CmdMap[TAG_MOTOR_ENABLE] == 0 || Motor_forbidden == 1 || Motor_emergercy_stop == 1 || Motor_
1110:Src/pid.c     **** 	{
1111:Src/pid.c     **** 		s_Enable_Delay = 0;
1112:Src/pid.c     **** 		Motor_forbidden = 0;
1113:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1114:Src/pid.c     **** 		{
1115:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
1116:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
1117:Src/pid.c     **** 		}
1118:Src/pid.c     **** 		if(g_CmdMap[CMD_ERROR] != 0)
1119:Src/pid.c     **** 		{	
1120:Src/pid.c     **** 			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
1121:Src/pid.c     **** 		}			
1122:Src/pid.c     **** //		if(s_Disable_Delay <= 1) s_Disable_Delay ++;
1123:Src/pid.c     **** //		if (s_Disable_Delay == 1) // ï¿½ï¿½Ê¹ï¿½Ü±ï¿½Îªï¿½ï¿½ï¿½ï¿½ 50ms
1124:Src/pid.c     **** 		{
1125:Src/pid.c     **** //			s_Disable_Delay = 0;
1126:Src/pid.c     **** 			g_Timer1CCR = 0;
1127:Src/pid.c     ****       Motor_emergercy_stop =0;
1128:Src/pid.c     **** 			Motor_pause_flag = 0;
1129:Src/pid.c     **** 			PWM_Disable();
1130:Src/pid.c     **** 		}
1131:Src/pid.c     **** //		if (s_Disable_Delay > 1)
1132:Src/pid.c     **** //		{
1133:Src/pid.c     **** //			s_Disable_Delay =2;
1134:Src/pid.c     **** //		}
1135:Src/pid.c     **** 		g_Vq = 0;
1136:Src/pid.c     **** 		return;
1137:Src/pid.c     **** 	}
1138:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && Motor_forbidden == 0)
1139:Src/pid.c     **** 	{
1140:Src/pid.c     **** 		if(s_Enable_Delay <= 2) s_Enable_Delay ++;
1141:Src/pid.c     **** 		s_Disable_Delay = 0;
1142:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
1143:Src/pid.c     **** 		{
1144:Src/pid.c     **** 			if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1145:Src/pid.c     **** 			{
1146:Src/pid.c     **** 				g_CmdMap[CMD_SPD_SET_PU] = 0;
1147:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
1148:Src/pid.c     **** 			}
1149:Src/pid.c     **** 			g_Timer1CCR = 0;		
1150:Src/pid.c     **** 			PWM_Enable();			
1151:Src/pid.c     **** 		}
1152:Src/pid.c     **** 		return;
1153:Src/pid.c     **** 	}  
1154:Src/pid.c     **** }
1155:Src/pid.c     **** s32 I_Alpha, I_Beta; 
1156:Src/pid.c     **** extern 	volatile  int hall_ture_value;
1157:Src/pid.c     **** extern 	volatile  int last_hall_ture_value;
1158:Src/pid.c     **** extern volatile  s32 sample_invered;
1159:Src/pid.c     **** 
1160:Src/pid.c     **** volatile  int delta_alpha;
1161:Src/pid.c     **** volatile  int delata_beta;
1162:Src/pid.c     **** int last_alpha = 0;
1163:Src/pid.c     **** int last_beta = 0;
1164:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 74


1165:Src/pid.c     **** float phase_current_rev_gain_ = 1.0f/33.0f;
1166:Src/pid.c     **** float shunt_conductance = 1.0f/0.01f;
1167:Src/pid.c     **** float phase_current_from_adcval(s32 adcval_bal)
1168:Src/pid.c     **** {
 2610              		.loc 1 1168 0
 2611              		.cfi_startproc
 2612              		@ args = 0, pretend = 0, frame = 0
 2613              		@ frame_needed = 0, uses_anonymous_args = 0
 2614              		@ link register save eliminated.
 2615              	.LVL126:
1169:Src/pid.c     ****   float amp_out_volt = (3.3f / (float)(1 << 12)) * (float)adcval_bal;
 2616              		.loc 1 1169 0
 2617 0000 07EE900A 		vmov	s15, r0	@ int
 2618 0004 B8EEE70A 		vcvt.f32.s32	s0, s15
 2619 0008 DFED077A 		vldr.32	s15, .L209
 2620 000c 20EE270A 		vmul.f32	s0, s0, s15
 2621              	.LVL127:
1170:Src/pid.c     ****   float shunt_volt = amp_out_volt * phase_current_rev_gain_;
 2622              		.loc 1 1170 0
 2623 0010 064B     		ldr	r3, .L209+4
 2624 0012 D3ED007A 		vldr.32	s15, [r3]
 2625 0016 67EE807A 		vmul.f32	s15, s15, s0
 2626              	.LVL128:
1171:Src/pid.c     ****   float current = shunt_volt * shunt_conductance;
 2627              		.loc 1 1171 0
 2628 001a 054B     		ldr	r3, .L209+8
 2629 001c 93ED000A 		vldr.32	s0, [r3]
 2630              	.LVL129:
1172:Src/pid.c     ****   return current ;
1173:Src/pid.c     **** }
 2631              		.loc 1 1173 0
 2632 0020 20EE270A 		vmul.f32	s0, s0, s15
 2633              	.LVL130:
 2634 0024 7047     		bx	lr
 2635              	.L210:
 2636 0026 00BF     		.align	2
 2637              	.L209:
 2638 0028 3333533A 		.word	978531123
 2639 002c 00000000 		.word	.LANCHOR26
 2640 0030 00000000 		.word	.LANCHOR27
 2641              		.cfi_endproc
 2642              	.LFE345:
 2644              		.section	.text.GetCurrent,"ax",%progbits
 2645              		.align	1
 2646              		.global	GetCurrent
 2647              		.syntax unified
 2648              		.thumb
 2649              		.thumb_func
 2650              		.fpu fpv4-sp-d16
 2652              	GetCurrent:
 2653              	.LFB346:
1174:Src/pid.c     **** void GetCurrent(void)
1175:Src/pid.c     **** {
 2654              		.loc 1 1175 0
 2655              		.cfi_startproc
 2656              		@ args = 0, pretend = 0, frame = 0
 2657              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 75


 2658 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2659              	.LCFI15:
 2660              		.cfi_def_cfa_offset 24
 2661              		.cfi_offset 4, -24
 2662              		.cfi_offset 5, -20
 2663              		.cfi_offset 6, -16
 2664              		.cfi_offset 7, -12
 2665              		.cfi_offset 8, -8
 2666              		.cfi_offset 14, -4
 2667 0004 2DED028B 		vpush.64	{d8}
 2668              	.LCFI16:
 2669              		.cfi_def_cfa_offset 32
 2670              		.cfi_offset 80, -32
 2671              		.cfi_offset 81, -28
 2672              	.LVL131:
1176:Src/pid.c     ****   s32 i=0, j=0,I_B1 = 0,I_C1 = 0;
1177:Src/pid.c     **** 
1178:Src/pid.c     **** //	g_ZeroCur_MotorA =0x800;
1179:Src/pid.c     **** //	g_ZeroCur_MotorB =0x7e9;
1180:Src/pid.c     **** //	g_ZeroCur_MotorC =0x802;
1181:Src/pid.c     **** 	
1182:Src/pid.c     **** 	
1183:Src/pid.c     **** //		g_ZeroCur_MotorA =0x077d;
1184:Src/pid.c     **** //	g_ZeroCur_MotorB =0x077d;
1185:Src/pid.c     **** //	g_ZeroCur_MotorC =0x0779;
1186:Src/pid.c     **** 	
1187:Src/pid.c     **** 	g_IC_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorC)*1000.0f); // mA	
 2673              		.loc 1 1187 0
 2674 0008 4FF0A045 		mov	r5, #1342177280
 2675 000c D5F88000 		ldr	r0, [r5, #128]
 2676 0010 574B     		ldr	r3, .L218
 2677 0012 1B68     		ldr	r3, [r3]
 2678 0014 C01A     		subs	r0, r0, r3
 2679 0016 FFF7FEFF 		bl	phase_current_from_adcval
 2680              	.LVL132:
 2681 001a 9FED568A 		vldr.32	s16, .L218+4
 2682 001e 20EE480A 		vnmul.f32	s0, s0, s16
 2683 0022 BDEEC00A 		vcvt.s32.f32	s0, s0
 2684 0026 544B     		ldr	r3, .L218+8
 2685 0028 10EE102A 		vmov	r2, s0	@ int
 2686 002c 1A80     		strh	r2, [r3]	@ movhi
1188:Src/pid.c     **** 	g_IB_Raw = (s16)(-phase_current_from_adcval(ADC2->JDR1-g_ZeroCur_MotorB)*1000.0f); // mA
 2687              		.loc 1 1188 0
 2688 002e 534B     		ldr	r3, .L218+12
 2689 0030 D3F88000 		ldr	r0, [r3, #128]
 2690 0034 524B     		ldr	r3, .L218+16
 2691 0036 1B68     		ldr	r3, [r3]
 2692 0038 C01A     		subs	r0, r0, r3
 2693 003a FFF7FEFF 		bl	phase_current_from_adcval
 2694              	.LVL133:
 2695 003e 20EE480A 		vnmul.f32	s0, s0, s16
 2696 0042 BDEEC00A 		vcvt.s32.f32	s0, s0
 2697 0046 10EE103A 		vmov	r3, s0	@ int
 2698 004a 1CB2     		sxth	r4, r3
 2699 004c 4D4B     		ldr	r3, .L218+20
 2700 004e 1C80     		strh	r4, [r3]	@ movhi
1189:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*1000.0f); // mA	;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 76


 2701              		.loc 1 1189 0
 2702 0050 D5F88000 		ldr	r0, [r5, #128]
 2703 0054 4C4B     		ldr	r3, .L218+24
 2704 0056 1B68     		ldr	r3, [r3]
 2705 0058 C01A     		subs	r0, r0, r3
 2706 005a FFF7FEFF 		bl	phase_current_from_adcval
 2707              	.LVL134:
 2708 005e 20EE480A 		vnmul.f32	s0, s0, s16
 2709 0062 BDEEC00A 		vcvt.s32.f32	s0, s0
 2710 0066 10EE103A 		vmov	r3, s0	@ int
 2711 006a 18B2     		sxth	r0, r3
 2712 006c 474B     		ldr	r3, .L218+28
 2713 006e 1880     		strh	r0, [r3]	@ movhi
1190:Src/pid.c     **** 	
1191:Src/pid.c     **** 
1192:Src/pid.c     **** 	if(g_Sector_test == 2 ||g_Sector_test == 1)
1193:Src/pid.c     **** 	{
1194:Src/pid.c     **** 		g_IB = g_IB_Raw;		
1195:Src/pid.c     **** 		g_IC = g_IC_Raw;
1196:Src/pid.c     **** 		g_IA = 0 - g_IC -g_IB;
1197:Src/pid.c     **** 	}
1198:Src/pid.c     **** 	if(g_Sector_test == 3 ||g_Sector_test == 4)
1199:Src/pid.c     **** 	{
1200:Src/pid.c     **** 		g_IB = g_IB_Raw;		
1201:Src/pid.c     **** 		g_IA = g_IA_Raw;
1202:Src/pid.c     **** 		g_IC = 0 - g_IB -g_IA;
1203:Src/pid.c     **** 	}
1204:Src/pid.c     **** 	if(g_Sector_test == 5 ||g_Sector_test == 6)
1205:Src/pid.c     **** 	{
1206:Src/pid.c     **** 		g_IC = g_IC_Raw;		
1207:Src/pid.c     **** 		g_IA = g_IA_Raw;
1208:Src/pid.c     **** 		g_IB = 0 - g_IA -g_IC;	
1209:Src/pid.c     **** 	}
1210:Src/pid.c     **** 	
1211:Src/pid.c     **** 	g_IA = g_IA_Raw;
 2714              		.loc 1 1211 0
 2715 0070 474B     		ldr	r3, .L218+32
 2716 0072 1880     		strh	r0, [r3]	@ movhi
1212:Src/pid.c     **** 	g_IB = g_IB_Raw;
 2717              		.loc 1 1212 0
 2718 0074 474B     		ldr	r3, .L218+36
 2719 0076 1C80     		strh	r4, [r3]	@ movhi
1213:Src/pid.c     **** 	g_IC = 0 - g_IA_Raw -g_IB_Raw;
 2720              		.loc 1 1213 0
 2721 0078 4042     		negs	r0, r0
 2722 007a 001B     		subs	r0, r0, r4
 2723 007c 00B2     		sxth	r0, r0
 2724 007e 464B     		ldr	r3, .L218+40
 2725 0080 1880     		strh	r0, [r3]	@ movhi
1214:Src/pid.c     **** 	
1215:Src/pid.c     **** 	
1216:Src/pid.c     **** 
1217:Src/pid.c     **** 	I_Alpha = -(g_IB + g_IC);             // ï¿½È·ï¿½Clark:I_Alpha = (2/3)*(I_a - 0.5*I_b - 0.5*I_c)= 
 2726              		.loc 1 1217 0
 2727 0082 2318     		adds	r3, r4, r0
 2728 0084 5B42     		negs	r3, r3
 2729 0086 454D     		ldr	r5, .L218+44
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 77


 2730 0088 2B60     		str	r3, [r5]
1218:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 2731              		.loc 1 1218 0
 2732 008a 44F6E711 		movw	r1, #18919
 2733 008e 201A     		subs	r0, r4, r0
 2734 0090 FFF7FEFF 		bl	Q15_MUL
 2735              	.LVL135:
 2736 0094 424C     		ldr	r4, .L218+48
 2737 0096 2060     		str	r0, [r4]
1219:Src/pid.c     **** 	
1220:Src/pid.c     **** 	delta_alpha = I_Alpha - last_alpha;
 2738              		.loc 1 1220 0
 2739 0098 2F68     		ldr	r7, [r5]
 2740 009a 424E     		ldr	r6, .L218+52
 2741 009c 3368     		ldr	r3, [r6]
 2742 009e FB1A     		subs	r3, r7, r3
 2743 00a0 414A     		ldr	r2, .L218+56
 2744 00a2 1360     		str	r3, [r2]
1221:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 2745              		.loc 1 1221 0
 2746 00a4 DFF824C1 		ldr	ip, .L218+92
 2747 00a8 DCF80030 		ldr	r3, [ip]
 2748 00ac C11A     		subs	r1, r0, r3
 2749 00ae 3F4B     		ldr	r3, .L218+60
 2750 00b0 1960     		str	r1, [r3]
1222:Src/pid.c     **** 	
1223:Src/pid.c     **** 	delta_alpha *= g_high_fre_pulse;
 2751              		.loc 1 1223 0
 2752 00b2 DFF81CE1 		ldr	lr, .L218+96
 2753 00b6 DEF80010 		ldr	r1, [lr]
 2754 00ba D2F80080 		ldr	r8, [r2]
 2755 00be 01FB08F1 		mul	r1, r1, r8
 2756 00c2 1160     		str	r1, [r2]
1224:Src/pid.c     **** 	delata_beta *= g_high_fre_pulse;
 2757              		.loc 1 1224 0
 2758 00c4 DEF80020 		ldr	r2, [lr]
 2759 00c8 1968     		ldr	r1, [r3]
 2760 00ca 02FB01F2 		mul	r2, r2, r1
 2761 00ce 1A60     		str	r2, [r3]
1225:Src/pid.c     **** 	
1226:Src/pid.c     **** 	last_alpha = I_Alpha;
 2762              		.loc 1 1226 0
 2763 00d0 3760     		str	r7, [r6]
1227:Src/pid.c     **** 	last_beta = I_Beta;
 2764              		.loc 1 1227 0
 2765 00d2 CCF80000 		str	r0, [ip]
1228:Src/pid.c     **** 	
1229:Src/pid.c     **** 	i = Math_Sin_EN360(g_ElectricAngle );
 2766              		.loc 1 1229 0
 2767 00d6 364E     		ldr	r6, .L218+64
 2768 00d8 3068     		ldr	r0, [r6]
 2769 00da 80B2     		uxth	r0, r0
 2770 00dc FFF7FEFF 		bl	Math_Sin_EN360
 2771              	.LVL136:
 2772 00e0 0746     		mov	r7, r0
 2773              	.LVL137:
1230:Src/pid.c     **** 	j = Math_Cos_EN360(g_ElectricAngle );
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 78


 2774              		.loc 1 1230 0
 2775 00e2 3068     		ldr	r0, [r6]
 2776              	.LVL138:
 2777 00e4 80B2     		uxth	r0, r0
 2778 00e6 FFF7FEFF 		bl	Math_Cos_EN360
 2779              	.LVL139:
 2780 00ea 8046     		mov	r8, r0
 2781              	.LVL140:
1231:Src/pid.c     **** 	I_B1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 2782              		.loc 1 1231 0
 2783 00ec 2968     		ldr	r1, [r5]
 2784 00ee FFF7FEFF 		bl	Q15_MUL
 2785              	.LVL141:
 2786 00f2 0646     		mov	r6, r0
 2787 00f4 2168     		ldr	r1, [r4]
 2788 00f6 3846     		mov	r0, r7
 2789 00f8 FFF7FEFF 		bl	Q15_MUL
 2790              	.LVL142:
 2791 00fc 0644     		add	r6, r6, r0
 2792              	.LVL143:
1232:Src/pid.c     **** 	I_C1 = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 2793              		.loc 1 1232 0
 2794 00fe 2968     		ldr	r1, [r5]
 2795 0100 3846     		mov	r0, r7
 2796 0102 FFF7FEFF 		bl	Q15_MUL
 2797              	.LVL144:
 2798 0106 0546     		mov	r5, r0
 2799 0108 2168     		ldr	r1, [r4]
 2800 010a 4046     		mov	r0, r8
 2801 010c FFF7FEFF 		bl	Q15_MUL
 2802              	.LVL145:
 2803 0110 281A     		subs	r0, r5, r0
 2804              	.LVL146:
1233:Src/pid.c     **** //		I_B1 = (I_B1>>3)<<3;
1234:Src/pid.c     **** //		I_C1 = (I_C1>>3)<<3;
1235:Src/pid.c     **** 
1236:Src/pid.c     ****   if (g_bEnableHB != 0 && (pid_IQ.enable == 1||g_CmdMap[TAG_WORK_MODE] == MODE_OPEN))
 2805              		.loc 1 1236 0
 2806 0112 284B     		ldr	r3, .L218+68
 2807 0114 1B88     		ldrh	r3, [r3]
 2808 0116 1BB2     		sxth	r3, r3
 2809 0118 43B1     		cbz	r3, .L214
 2810              		.loc 1 1236 0 is_stmt 0 discriminator 1
 2811 011a 274B     		ldr	r3, .L218+72
 2812 011c 1B68     		ldr	r3, [r3]
 2813 011e 012B     		cmp	r3, #1
 2814 0120 21D0     		beq	.L215
 2815              		.loc 1 1236 0 discriminator 2
 2816 0122 264B     		ldr	r3, .L218+76
 2817 0124 B3F80432 		ldrh	r3, [r3, #516]
 2818 0128 1BB2     		sxth	r3, r3
 2819 012a E3B1     		cbz	r3, .L215
 2820              	.L214:
1237:Src/pid.c     ****   {
1238:Src/pid.c     **** 		g_Iq = I_B1;
1239:Src/pid.c     **** 		g_Id = I_C1;	
1240:Src/pid.c     **** 	}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 79


1241:Src/pid.c     **** 	else
1242:Src/pid.c     **** 	{
1243:Src/pid.c     **** 		g_Iq = I_B1;
 2821              		.loc 1 1243 0 is_stmt 1
 2822 012c 244B     		ldr	r3, .L218+80
 2823 012e 1E60     		str	r6, [r3]
1244:Src/pid.c     **** 		g_Id = I_C1;	
 2824              		.loc 1 1244 0
 2825 0130 244B     		ldr	r3, .L218+84
 2826 0132 1860     		str	r0, [r3]
 2827              	.L216:
1245:Src/pid.c     **** 	}
1246:Src/pid.c     **** 	g_CmdMap[CMD_CUR_D_ACT_PU] = g_Id*PU_REFERENCE/(*g_pCur_ref_base_mA);
 2828              		.loc 1 1246 0
 2829 0134 234B     		ldr	r3, .L218+84
 2830 0136 1B68     		ldr	r3, [r3]
 2831 0138 9B03     		lsls	r3, r3, #14
 2832 013a 234A     		ldr	r2, .L218+88
 2833 013c 1168     		ldr	r1, [r2]
 2834 013e 0A68     		ldr	r2, [r1]
 2835 0140 93FBF2F3 		sdiv	r3, r3, r2
 2836 0144 1BB2     		sxth	r3, r3
 2837 0146 1D4A     		ldr	r2, .L218+76
 2838 0148 A2F89432 		strh	r3, [r2, #660]	@ movhi
1247:Src/pid.c     **** 	g_CmdMap[CMD_CUR_ACT_PU] = g_Iq*PU_REFERENCE/(*g_pCur_ref_base_mA);
 2839              		.loc 1 1247 0
 2840 014c 1C4B     		ldr	r3, .L218+80
 2841 014e 1B68     		ldr	r3, [r3]
 2842 0150 9B03     		lsls	r3, r3, #14
 2843 0152 0968     		ldr	r1, [r1]
 2844 0154 93FBF1F3 		sdiv	r3, r3, r1
 2845 0158 1BB2     		sxth	r3, r3
 2846 015a A2F84E30 		strh	r3, [r2, #78]	@ movhi
1248:Src/pid.c     **** 	
1249:Src/pid.c     **** 	
1250:Src/pid.c     **** }
 2847              		.loc 1 1250 0
 2848 015e BDEC028B 		vldm	sp!, {d8}
 2849              	.LCFI17:
 2850              		.cfi_remember_state
 2851              		.cfi_restore 80
 2852              		.cfi_restore 81
 2853              		.cfi_def_cfa_offset 24
 2854 0162 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2855              	.LVL147:
 2856              	.L215:
 2857              	.LCFI18:
 2858              		.cfi_restore_state
1238:Src/pid.c     **** 		g_Id = I_C1;	
 2859              		.loc 1 1238 0
 2860 0166 164B     		ldr	r3, .L218+80
 2861 0168 1E60     		str	r6, [r3]
1239:Src/pid.c     **** 	}
 2862              		.loc 1 1239 0
 2863 016a 164B     		ldr	r3, .L218+84
 2864 016c 1860     		str	r0, [r3]
 2865 016e E1E7     		b	.L216
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 80


 2866              	.L219:
 2867              		.align	2
 2868              	.L218:
 2869 0170 00000000 		.word	g_ZeroCur_MotorC
 2870 0174 00007A44 		.word	1148846080
 2871 0178 00000000 		.word	.LANCHOR9
 2872 017c 00010050 		.word	1342177536
 2873 0180 00000000 		.word	g_ZeroCur_MotorB
 2874 0184 00000000 		.word	.LANCHOR8
 2875 0188 00000000 		.word	g_ZeroCur_MotorA
 2876 018c 00000000 		.word	.LANCHOR6
 2877 0190 00000000 		.word	.LANCHOR30
 2878 0194 00000000 		.word	.LANCHOR28
 2879 0198 00000000 		.word	.LANCHOR29
 2880 019c 00000000 		.word	I_Alpha
 2881 01a0 00000000 		.word	I_Beta
 2882 01a4 00000000 		.word	.LANCHOR31
 2883 01a8 00000000 		.word	delta_alpha
 2884 01ac 00000000 		.word	delata_beta
 2885 01b0 00000000 		.word	g_ElectricAngle
 2886 01b4 00000000 		.word	g_bEnableHB
 2887 01b8 00000000 		.word	pid_IQ
 2888 01bc 00000000 		.word	g_CmdMap
 2889 01c0 00000000 		.word	.LANCHOR33
 2890 01c4 00000000 		.word	.LANCHOR34
 2891 01c8 00000000 		.word	g_pCur_ref_base_mA
 2892 01cc 00000000 		.word	.LANCHOR32
 2893 01d0 00000000 		.word	g_high_fre_pulse
 2894              		.cfi_endproc
 2895              	.LFE346:
 2897              		.section	.text.park_transform,"ax",%progbits
 2898              		.align	1
 2899              		.global	park_transform
 2900              		.syntax unified
 2901              		.thumb
 2902              		.thumb_func
 2903              		.fpu fpv4-sp-d16
 2905              	park_transform:
 2906              	.LFB347:
1251:Src/pid.c     **** 
1252:Src/pid.c     **** 
1253:Src/pid.c     **** void park_transform(int alpha, int beta, int*q, int*d,int ElectricAngle )
1254:Src/pid.c     **** {
 2907              		.loc 1 1254 0
 2908              		.cfi_startproc
 2909              		@ args = 4, pretend = 0, frame = 0
 2910              		@ frame_needed = 0, uses_anonymous_args = 0
 2911              	.LVL148:
 2912 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 2913              	.LCFI19:
 2914              		.cfi_def_cfa_offset 32
 2915              		.cfi_offset 4, -32
 2916              		.cfi_offset 5, -28
 2917              		.cfi_offset 6, -24
 2918              		.cfi_offset 7, -20
 2919              		.cfi_offset 8, -16
 2920              		.cfi_offset 9, -12
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 81


 2921              		.cfi_offset 10, -8
 2922              		.cfi_offset 14, -4
 2923 0004 9246     		mov	r10, r2
 2924 0006 9846     		mov	r8, r3
1255:Src/pid.c     **** 	int i,j;
1256:Src/pid.c     **** 	
1257:Src/pid.c     **** 	i = Math_Sin_EN360(ElectricAngle);
 2925              		.loc 1 1257 0
 2926 0008 BDF82040 		ldrh	r4, [sp, #32]
 2927 000c 2046     		mov	r0, r4
 2928              	.LVL149:
 2929 000e FFF7FEFF 		bl	Math_Sin_EN360
 2930              	.LVL150:
 2931 0012 0646     		mov	r6, r0
 2932              	.LVL151:
1258:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 2933              		.loc 1 1258 0
 2934 0014 2046     		mov	r0, r4
 2935              	.LVL152:
 2936 0016 FFF7FEFF 		bl	Math_Cos_EN360
 2937              	.LVL153:
 2938 001a 8146     		mov	r9, r0
 2939              	.LVL154:
1259:Src/pid.c     **** 	*q = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 2940              		.loc 1 1259 0
 2941 001c 0D4F     		ldr	r7, .L222
 2942 001e 3968     		ldr	r1, [r7]
 2943 0020 FFF7FEFF 		bl	Q15_MUL
 2944              	.LVL155:
 2945 0024 0446     		mov	r4, r0
 2946 0026 0C4D     		ldr	r5, .L222+4
 2947 0028 2968     		ldr	r1, [r5]
 2948 002a 3046     		mov	r0, r6
 2949 002c FFF7FEFF 		bl	Q15_MUL
 2950              	.LVL156:
 2951 0030 2044     		add	r0, r0, r4
 2952 0032 CAF80000 		str	r0, [r10]
1260:Src/pid.c     **** 	*d = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 2953              		.loc 1 1260 0
 2954 0036 3968     		ldr	r1, [r7]
 2955 0038 3046     		mov	r0, r6
 2956 003a FFF7FEFF 		bl	Q15_MUL
 2957              	.LVL157:
 2958 003e 0446     		mov	r4, r0
 2959 0040 2968     		ldr	r1, [r5]
 2960 0042 4846     		mov	r0, r9
 2961 0044 FFF7FEFF 		bl	Q15_MUL
 2962              	.LVL158:
 2963 0048 201A     		subs	r0, r4, r0
 2964 004a C8F80000 		str	r0, [r8]
1261:Src/pid.c     **** }
 2965              		.loc 1 1261 0
 2966 004e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 2967              	.LVL159:
 2968              	.L223:
 2969 0052 00BF     		.align	2
 2970              	.L222:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 82


 2971 0054 00000000 		.word	I_Alpha
 2972 0058 00000000 		.word	I_Beta
 2973              		.cfi_endproc
 2974              	.LFE347:
 2976              		.global	__aeabi_f2d
 2977              		.global	__aeabi_d2f
 2978              		.section	.text.hfi_update_angle,"ax",%progbits
 2979              		.align	1
 2980              		.global	hfi_update_angle
 2981              		.syntax unified
 2982              		.thumb
 2983              		.thumb_func
 2984              		.fpu fpv4-sp-d16
 2986              	hfi_update_angle:
 2987              	.LFB342:
 951:Src/pid.c     **** 	int X,Y;
 2988              		.loc 1 951 0
 2989              		.cfi_startproc
 2990              		@ args = 0, pretend = 0, frame = 16
 2991              		@ frame_needed = 0, uses_anonymous_args = 0
 2992 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 2993              	.LCFI20:
 2994              		.cfi_def_cfa_offset 36
 2995              		.cfi_offset 4, -36
 2996              		.cfi_offset 5, -32
 2997              		.cfi_offset 6, -28
 2998              		.cfi_offset 7, -24
 2999              		.cfi_offset 8, -20
 3000              		.cfi_offset 9, -16
 3001              		.cfi_offset 10, -12
 3002              		.cfi_offset 11, -8
 3003              		.cfi_offset 14, -4
 3004 0004 87B0     		sub	sp, sp, #28
 3005              	.LCFI21:
 3006              		.cfi_def_cfa_offset 64
 960:Src/pid.c     **** 	pid_pll.Kp = 1000;
 3007              		.loc 1 960 0
 3008 0006 664C     		ldr	r4, .L226+32
 3009 0008 0027     		movs	r7, #0
 3010 000a 6761     		str	r7, [r4, #20]
 961:Src/pid.c     **** 	pid_pll.Ki = 10;
 3011              		.loc 1 961 0
 3012 000c 4FF47A73 		mov	r3, #1000
 3013 0010 A360     		str	r3, [r4, #8]
 962:Src/pid.c     **** 	pid_pll.Kd = 0;
 3014              		.loc 1 962 0
 3015 0012 0A23     		movs	r3, #10
 3016 0014 E360     		str	r3, [r4, #12]
 963:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 3017              		.loc 1 963 0
 3018 0016 2761     		str	r7, [r4, #16]
 964:Src/pid.c     **** 	pid_pll.enable =1;
 3019              		.loc 1 964 0
 3020 0018 46F2A815 		movw	r5, #25000
 3021 001c A563     		str	r5, [r4, #56]
 965:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 3022              		.loc 1 965 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 83


 3023 001e 0123     		movs	r3, #1
 3024 0020 2360     		str	r3, [r4]
 966:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 3025              		.loc 1 966 0
 3026 0022 6FF00043 		mvn	r3, #-2147483648
 3027 0026 E363     		str	r3, [r4, #60]
 967:Src/pid.c     **** 	
 3028              		.loc 1 967 0
 3029 0028 0233     		adds	r3, r3, #2
 3030 002a 2364     		str	r3, [r4, #64]
 970:Src/pid.c     **** 	
 3031              		.loc 1 970 0
 3032 002c DFF8A8A1 		ldr	r10, .L226+88
 3033 0030 DAF80000 		ldr	r0, [r10]
 3034 0034 DFF8A491 		ldr	r9, .L226+92
 3035 0038 D9F80010 		ldr	r1, [r9]
 3036 003c DFF8A081 		ldr	r8, .L226+96
 3037 0040 D8F80030 		ldr	r3, [r8]
 3038 0044 0093     		str	r3, [sp]
 3039 0046 04AB     		add	r3, sp, #16
 3040 0048 05AA     		add	r2, sp, #20
 3041 004a FFF7FEFF 		bl	park_transform
 3042              	.LVL160:
 972:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
 3043              		.loc 1 972 0
 3044 004e 554B     		ldr	r3, .L226+36
 3045 0050 1868     		ldr	r0, [r3]	@ float
 3046 0052 FFF7FEFF 		bl	__aeabi_f2d
 3047              	.LVL161:
 3048 0056 4AA3     		adr	r3, .L226
 3049 0058 D3E90023 		ldrd	r2, [r3]
 3050 005c FFF7FEFF 		bl	__aeabi_dmul
 3051              	.LVL162:
 3052 0060 0022     		movs	r2, #0
 3053 0062 514B     		ldr	r3, .L226+40
 3054 0064 FFF7FEFF 		bl	__aeabi_dmul
 3055              	.LVL163:
 3056 0068 0022     		movs	r2, #0
 3057 006a 504B     		ldr	r3, .L226+44
 3058 006c FFF7FEFF 		bl	__aeabi_dmul
 3059              	.LVL164:
 3060 0070 CDE90201 		strd	r0, [sp, #8]
 3061 0074 4E4B     		ldr	r3, .L226+48
 3062 0076 1B68     		ldr	r3, [r3]
 3063 0078 05FB03F3 		mul	r3, r5, r3
 3064 007c 4D4E     		ldr	r6, .L226+52
 3065 007e 86FB0320 		smull	r2, r0, r6, r3
 3066 0082 DB17     		asrs	r3, r3, #31
 3067 0084 C3EBA010 		rsb	r0, r3, r0, asr #6
 3068 0088 FFF7FEFF 		bl	__aeabi_i2d
 3069              	.LVL165:
 3070 008c 0246     		mov	r2, r0
 3071 008e 0B46     		mov	r3, r1
 3072 0090 DDE90201 		ldrd	r0, [sp, #8]
 3073 0094 FFF7FEFF 		bl	__aeabi_ddiv
 3074              	.LVL166:
 3075 0098 0022     		movs	r2, #0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 84


 3076 009a 474B     		ldr	r3, .L226+56
 3077 009c FFF7FEFF 		bl	__aeabi_ddiv
 3078              	.LVL167:
 3079 00a0 39A3     		adr	r3, .L226+8
 3080 00a2 D3E90023 		ldrd	r2, [r3]
 3081 00a6 FFF7FEFF 		bl	__aeabi_ddiv
 3082              	.LVL168:
 3083 00aa 39A3     		adr	r3, .L226+16
 3084 00ac D3E90023 		ldrd	r2, [r3]
 3085 00b0 FFF7FEFF 		bl	__aeabi_dmul
 3086              	.LVL169:
 3087 00b4 38A3     		adr	r3, .L226+24
 3088 00b6 D3E90023 		ldrd	r2, [r3]
 3089 00ba FFF7FEFF 		bl	__aeabi_dmul
 3090              	.LVL170:
 3091 00be FFF7FEFF 		bl	__aeabi_d2f
 3092              	.LVL171:
 3093 00c2 3E4B     		ldr	r3, .L226+60
 3094 00c4 1860     		str	r0, [r3]	@ float
 973:Src/pid.c     **** 	
 3095              		.loc 1 973 0
 3096 00c6 0498     		ldr	r0, [sp, #16]
 3097 00c8 05FB00F5 		mul	r5, r5, r0
 3098 00cc 86FB0530 		smull	r3, r0, r6, r5
 3099 00d0 ED17     		asrs	r5, r5, #31
 3100 00d2 C5EBA010 		rsb	r0, r5, r0, asr #6
 3101 00d6 FFF7FEFF 		bl	__aeabi_i2d
 3102              	.LVL172:
 3103 00da 0246     		mov	r2, r0
 3104 00dc 0B46     		mov	r3, r1
 3105 00de DDE90201 		ldrd	r0, [sp, #8]
 3106 00e2 FFF7FEFF 		bl	__aeabi_ddiv
 3107              	.LVL173:
 3108 00e6 0022     		movs	r2, #0
 3109 00e8 334B     		ldr	r3, .L226+56
 3110 00ea FFF7FEFF 		bl	__aeabi_ddiv
 3111              	.LVL174:
 3112 00ee 26A3     		adr	r3, .L226+8
 3113 00f0 D3E90023 		ldrd	r2, [r3]
 3114 00f4 FFF7FEFF 		bl	__aeabi_ddiv
 3115              	.LVL175:
 3116 00f8 25A3     		adr	r3, .L226+16
 3117 00fa D3E90023 		ldrd	r2, [r3]
 3118 00fe FFF7FEFF 		bl	__aeabi_dmul
 3119              	.LVL176:
 3120 0102 25A3     		adr	r3, .L226+24
 3121 0104 D3E90023 		ldrd	r2, [r3]
 3122 0108 FFF7FEFF 		bl	__aeabi_dmul
 3123              	.LVL177:
 3124 010c FFF7FEFF 		bl	__aeabi_d2f
 3125              	.LVL178:
 3126 0110 2B4B     		ldr	r3, .L226+64
 3127 0112 1860     		str	r0, [r3]	@ float
 975:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 3128              		.loc 1 975 0
 3129 0114 2B4D     		ldr	r5, .L226+68
 3130 0116 2888     		ldrh	r0, [r5]
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 85


 3131 0118 FFF7FEFF 		bl	Math_Sin_EN360
 3132              	.LVL179:
 3133 011c 0646     		mov	r6, r0
 3134              	.LVL180:
 976:Src/pid.c     **** 	
 3135              		.loc 1 976 0
 3136 011e 2888     		ldrh	r0, [r5]
 3137              	.LVL181:
 3138 0120 FFF7FEFF 		bl	Math_Cos_EN360
 3139              	.LVL182:
 3140 0124 8346     		mov	fp, r0
 3141              	.LVL183:
 978:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 3142              		.loc 1 978 0
 3143 0126 DAF80000 		ldr	r0, [r10]
 3144              	.LVL184:
 3145 012a 3146     		mov	r1, r6
 3146 012c FFF7FEFF 		bl	Q15_MUL
 3147              	.LVL185:
 3148 0130 0646     		mov	r6, r0
 3149              	.LVL186:
 979:Src/pid.c     **** 	
 3150              		.loc 1 979 0
 3151 0132 D9F80000 		ldr	r0, [r9]
 3152              	.LVL187:
 3153 0136 5946     		mov	r1, fp
 3154 0138 FFF7FEFF 		bl	Q15_MUL
 3155              	.LVL188:
 983:Src/pid.c     **** 	observer_speed = pid_pll.out;
 3156              		.loc 1 983 0
 3157 013c 2246     		mov	r2, r4
 3158 013e 311A     		subs	r1, r6, r0
 3159              	.LVL189:
 3160 0140 3846     		mov	r0, r7
 3161              	.LVL190:
 3162 0142 FFF7FEFF 		bl	PID_control
 3163              	.LVL191:
 984:Src/pid.c     **** 	
 3164              		.loc 1 984 0
 3165 0146 636B     		ldr	r3, [r4, #52]
 3166 0148 1F4A     		ldr	r2, .L226+72
 3167 014a 1360     		str	r3, [r2]
 986:Src/pid.c     **** 	
 3168              		.loc 1 986 0
 3169 014c 1F4A     		ldr	r2, .L226+76
 3170 014e 1168     		ldr	r1, [r2]
 3171 0150 0B44     		add	r3, r3, r1
 3172 0152 1360     		str	r3, [r2]
 988:Src/pid.c     **** 	
 3173              		.loc 1 988 0
 3174 0154 1E4A     		ldr	r2, .L226+80
 3175 0156 82FB0312 		smull	r1, r2, r2, r3
 3176 015a DB17     		asrs	r3, r3, #31
 3177 015c C3EB6213 		rsb	r3, r3, r2, asr #5
 990:Src/pid.c     **** 	
 3178              		.loc 1 990 0
 3179 0160 C3F30E03 		ubfx	r3, r3, #0, #15
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 86


 3180 0164 2B60     		str	r3, [r5]
 992:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 3181              		.loc 1 992 0
 3182 0166 1B4A     		ldr	r2, .L226+84
 3183 0168 B2F90020 		ldrsh	r2, [r2]
 3184 016c 1344     		add	r3, r3, r2
 3185              	.LVL192:
 993:Src/pid.c     **** 	
 3186              		.loc 1 993 0
 3187 016e C3F30E03 		ubfx	r3, r3, #0, #15
 3188              	.LVL193:
 995:Src/pid.c     **** 	
 3189              		.loc 1 995 0
 3190 0172 C8F80030 		str	r3, [r8]
1004:Src/pid.c     **** 
 3191              		.loc 1 1004 0
 3192 0176 07B0     		add	sp, sp, #28
 3193              	.LCFI22:
 3194              		.cfi_def_cfa_offset 36
 3195              		@ sp needed
 3196 0178 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3197              	.LVL194:
 3198              	.L227:
 3199 017c AFF30080 		.align	3
 3200              	.L226:
 3201 0180 F46C567D 		.word	2102815988
 3202 0184 AEB6FB3F 		.word	1073460910
 3203 0188 00000000 		.word	0
 3204 018c 00A0A740 		.word	1084727296
 3205 0190 8FC2F528 		.word	687194767
 3206 0194 5C8FE23F 		.word	1071812444
 3207 0198 66666666 		.word	1717986918
 3208 019c 6666E63F 		.word	1072064102
 3209 01a0 00000000 		.word	pid_pll
 3210 01a4 00000000 		.word	.LANCHOR35
 3211 01a8 00407F40 		.word	1082081280
 3212 01ac 00408F40 		.word	1083129856
 3213 01b0 00000000 		.word	.LANCHOR33
 3214 01b4 D34D6210 		.word	274877907
 3215 01b8 00000840 		.word	1074266112
 3216 01bc 00000000 		.word	L
 3217 01c0 00000000 		.word	temp_L
 3218 01c4 00000000 		.word	observer_ElectricAngle
 3219 01c8 00000000 		.word	observer_speed
 3220 01cc 00000000 		.word	integre_observer_ElectricAngle
 3221 01d0 1F85EB51 		.word	1374389535
 3222 01d4 00000000 		.word	EN_90
 3223 01d8 00000000 		.word	delta_alpha
 3224 01dc 00000000 		.word	delata_beta
 3225 01e0 00000000 		.word	g_ElectricAngle
 3226              		.cfi_endproc
 3227              	.LFE342:
 3229              		.section	.text.ServoPro_Fast,"ax",%progbits
 3230              		.align	1
 3231              		.global	ServoPro_Fast
 3232              		.syntax unified
 3233              		.thumb
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 87


 3234              		.thumb_func
 3235              		.fpu fpv4-sp-d16
 3237              	ServoPro_Fast:
 3238              	.LFB348:
1262:Src/pid.c     **** 
1263:Src/pid.c     **** s32 ServoPro_En_count = 0;
1264:Src/pid.c     **** extern volatile s32 Encoder_Inc;   							// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1265:Src/pid.c     **** extern volatile s32 s_SpeedTimeAdd1;   					// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1266:Src/pid.c     **** extern volatile s32 start_speed_sample;
1267:Src/pid.c     ****  volatile  int pid_hall_ture_value1;
1268:Src/pid.c     ****   volatile  int pid_last_hall_ture_value1;
1269:Src/pid.c     ****  volatile int last_hall_sample_time = 0;
1270:Src/pid.c     ****  volatile int speed1,speed2,speed3;
1271:Src/pid.c     **** 
1272:Src/pid.c     **** extern volatile int time4_capture_ch1;
1273:Src/pid.c     **** 
1274:Src/pid.c     **** int pid_hall_sample_time_point[10];
1275:Src/pid.c     **** int pid_hall_sample_time_index = 0;
1276:Src/pid.c     **** volatile int last_time4_capture_ch1 = 0;
1277:Src/pid.c     **** 
1278:Src/pid.c     **** volatile int hall_speed_sample_timeout_cnt=0; //ï¿½ï¿½ï¿½ãµ½30ms
1279:Src/pid.c     **** volatile int  hall_speed_sample_cnt = 0;
1280:Src/pid.c     **** volatile int hall_speed_sample_timeout =0;
1281:Src/pid.c     **** volatile int hall_cnt = 0;
1282:Src/pid.c     **** 
1283:Src/pid.c     **** volatile int hall_now_time = 0;
1284:Src/pid.c     **** volatile int hall_previous_1_time = 0;
1285:Src/pid.c     **** volatile int hall_previous_2_time = 0;
1286:Src/pid.c     **** volatile int hall_previous_3_time = 0;
1287:Src/pid.c     **** int64_t hall_total_time;
1288:Src/pid.c     **** 
1289:Src/pid.c     **** volatile int64_t Vel_PPS_raw1 =0;
1290:Src/pid.c     **** 
1291:Src/pid.c     **** void ServoPro_Fast(void)
1292:Src/pid.c     **** {
 3239              		.loc 1 1292 0
 3240              		.cfi_startproc
 3241              		@ args = 0, pretend = 0, frame = 8
 3242              		@ frame_needed = 0, uses_anonymous_args = 0
 3243 0000 00B5     		push	{lr}
 3244              	.LCFI23:
 3245              		.cfi_def_cfa_offset 4
 3246              		.cfi_offset 14, -4
 3247 0002 83B0     		sub	sp, sp, #12
 3248              	.LCFI24:
 3249              		.cfi_def_cfa_offset 16
 3250              	.LVL195:
1293:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
1294:Src/pid.c     **** 
1295:Src/pid.c     **** 	
1296:Src/pid.c     **** 	int64_t speed;
1297:Src/pid.c     **** 	int hall_a1=0;
1298:Src/pid.c     **** 	int hall_b1=0;
1299:Src/pid.c     **** 	int hall_c1=0;
1300:Src/pid.c     **** 	
1301:Src/pid.c     **** 	static u8 PlusPosition_flag = 0;
1302:Src/pid.c     ****   static s32 s_count = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 88


1303:Src/pid.c     ****   static int s_hal_cnt=0;
1304:Src/pid.c     **** 	EXTI_HandleTypeDef EXTI_Handle;
1305:Src/pid.c     **** 	
1306:Src/pid.c     **** GPIOA->BSRR  |= (uint32_t)GPIO_PIN_15;
 3251              		.loc 1 1306 0
 3252 0004 4FF09042 		mov	r2, #1207959552
 3253 0008 9369     		ldr	r3, [r2, #24]
 3254 000a 43F40043 		orr	r3, r3, #32768
 3255 000e 9361     		str	r3, [r2, #24]
1307:Src/pid.c     **** 	
1308:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X01);
1309:Src/pid.c     **** 	//---------------------------------ï¿½ï¿½ï¿½Â´ï¿½ï¿½ï¿½20KHz(50us)Ö´ï¿½ï¿½-----------------
1310:Src/pid.c     **** //	if(g_BeginPIDFlag == 1)
1311:Src/pid.c     **** 	{
1312:Src/pid.c     **** 		GetElectricAngle();//ï¿½ï¿½È¡ï¿½ï¿½Ç¶ï¿½
 3256              		.loc 1 1312 0
 3257 0010 FFF7FEFF 		bl	GetElectricAngle
 3258              	.LVL196:
1313:Src/pid.c     **** 		GetCurrent();   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 	
 3259              		.loc 1 1313 0
 3260 0014 FFF7FEFF 		bl	GetCurrent
 3261              	.LVL197:
1314:Src/pid.c     **** 		
1315:Src/pid.c     **** //		hfi_update_angle();
1316:Src/pid.c     **** 		
1317:Src/pid.c     **** 	}
1318:Src/pid.c     **** 	
1319:Src/pid.c     **** 
1320:Src/pid.c     **** 	measure_R();
 3262              		.loc 1 1320 0
 3263 0018 FFF7FEFF 		bl	measure_R
 3264              	.LVL198:
1321:Src/pid.c     **** 	if(g_bEnableHB) 																											// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ or ï¿½ï¿½ï¿½ï¿½
 3265              		.loc 1 1321 0
 3266 001c 1F4B     		ldr	r3, .L235
 3267 001e 1B88     		ldrh	r3, [r3]
 3268 0020 1BB2     		sxth	r3, r3
 3269 0022 43B1     		cbz	r3, .L229
 3270              	.LBB2:
1322:Src/pid.c     **** 	{
1323:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_OPEN)
 3271              		.loc 1 1323 0
 3272 0024 1E4B     		ldr	r3, .L235+4
 3273 0026 B3F80432 		ldrh	r3, [r3, #516]
 3274 002a 1BB2     		sxth	r3, r3
 3275 002c 0BBB     		cbnz	r3, .L230
1324:Src/pid.c     **** 		{
1325:Src/pid.c     **** 			OpenLoop();
 3276              		.loc 1 1325 0
 3277 002e FFF7FEFF 		bl	OpenLoop
 3278              	.LVL199:
 3279              	.L231:
1326:Src/pid.c     **** 		}
1327:Src/pid.c     **** 		else
1328:Src/pid.c     **** 		{
1329:Src/pid.c     **** 			CurrentPID();
1330:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 89


1331:Src/pid.c     **** 		motor_fault_check(); //Â¼Ã¬Â²Ã©ÂµÃ§Â»ÃºÃÃÂ·Ã±ÃÃÃÃ½Â³Â£Â¹Â¤ÃÃ·
 3280              		.loc 1 1331 0
 3281 0032 FFF7FEFF 		bl	motor_fault_check
 3282              	.LVL200:
 3283              	.L229:
 3284              	.LBE2:
1332:Src/pid.c     **** 	}
1333:Src/pid.c     **** 	
1334:Src/pid.c     **** //	
1335:Src/pid.c     **** 	GPIOA->BRR |= (uint32_t)GPIO_PIN_15;
 3285              		.loc 1 1335 0
 3286 0036 4FF09042 		mov	r2, #1207959552
 3287 003a 936A     		ldr	r3, [r2, #40]
 3288 003c 43F40043 		orr	r3, r3, #32768
 3289 0040 9362     		str	r3, [r2, #40]
1336:Src/pid.c     **** 	Pll_phase(  ( (s16)g_ElectricAngle_15bit  ), &pll_estimated_phase,    &pll_estimated_spd  );
 3290              		.loc 1 1336 0
 3291 0042 184B     		ldr	r3, .L235+8
 3292 0044 1868     		ldr	r0, [r3]
 3293 0046 184A     		ldr	r2, .L235+12
 3294 0048 1849     		ldr	r1, .L235+16
 3295 004a 00B2     		sxth	r0, r0
 3296 004c FFF7FEFF 		bl	Pll_phase
 3297              	.LVL201:
1337:Src/pid.c     **** 	#if 0
1338:Src/pid.c     **** 
1339:Src/pid.c     **** 	
1340:Src/pid.c     **** 	hall_a1 = (GPIOA->IDR & GPIO_PIN_5);
1341:Src/pid.c     **** 	hall_b1 = (GPIOB->IDR & GPIO_PIN_3);
1342:Src/pid.c     **** 	hall_c1 = (GPIOB->IDR & GPIO_PIN_10);
1343:Src/pid.c     **** 
1344:Src/pid.c     **** 	if(hall_a1)  hall_a1 =1;
1345:Src/pid.c     **** 	if(hall_b1)  hall_b1 =1;
1346:Src/pid.c     **** 	if(hall_c1)  hall_c1 =1;
1347:Src/pid.c     **** 
1348:Src/pid.c     **** 
1349:Src/pid.c     **** 	pid_hall_ture_value1 =  hall_c1*4 + hall_b1*2 + hall_a1;	
1350:Src/pid.c     **** 	
1351:Src/pid.c     **** 	
1352:Src/pid.c     **** 	hall_speed_sample_timeout_cnt++;
1353:Src/pid.c     **** 	if(hall_speed_sample_timeout_cnt < 200)
1354:Src/pid.c     **** 	{
1355:Src/pid.c     **** 		time4_capture_ch1 = HAL_TIM_ReadCapturedValue(&htim2,TIM_CHANNEL_1);
1356:Src/pid.c     **** 		
1357:Src/pid.c     **** 		if(last_hall_sample_time != time4_capture_ch1)		
1358:Src/pid.c     **** 		{
1359:Src/pid.c     **** 			
1360:Src/pid.c     **** 				 hall_speed_sample_timeout_cnt = 0;
1361:Src/pid.c     **** 			
1362:Src/pid.c     **** 				 pid_hall_sample_time_index++;
1363:Src/pid.c     **** 				if(pid_hall_sample_time_index > 9)
1364:Src/pid.c     **** 				{
1365:Src/pid.c     **** 					pid_hall_sample_time_index =0;
1366:Src/pid.c     **** 				}
1367:Src/pid.c     **** 			//	TIM_ClearFlag(TIM4,TIM_FLAG_CC1);
1368:Src/pid.c     **** 				
1369:Src/pid.c     **** 				pid_hall_sample_time_point[pid_hall_sample_time_index] = time4_capture_ch1;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 90


1370:Src/pid.c     **** 				
1371:Src/pid.c     **** 		//		s_SpeedTimeAdd11 = time4_capture_ch1  - last_hall_sample_time;
1372:Src/pid.c     **** 				
1373:Src/pid.c     **** 				
1374:Src/pid.c     **** 				last_hall_sample_time = time4_capture_ch1;
1375:Src/pid.c     **** 				if(s_SpeedTimeAdd11 < 0)
1376:Src/pid.c     **** 				{
1377:Src/pid.c     **** 					s_SpeedTimeAdd11 += 65535;
1378:Src/pid.c     **** 				}
1379:Src/pid.c     **** 				
1380:Src/pid.c     **** 				hall_previous_3_time = hall_previous_2_time;
1381:Src/pid.c     **** 				hall_previous_2_time = hall_previous_1_time;
1382:Src/pid.c     **** 				hall_previous_1_time  = hall_now_time;
1383:Src/pid.c     **** 				hall_now_time = time4_capture_ch1;
1384:Src/pid.c     **** 				
1385:Src/pid.c     **** 						
1386:Src/pid.c     **** 				if(pid_last_hall_ture_value1 == 5)
1387:Src/pid.c     **** 				{
1388:Src/pid.c     **** 					if(pid_hall_ture_value1 == 1)
1389:Src/pid.c     **** 					{
1390:Src/pid.c     **** 						s_hal_cnt--;
1391:Src/pid.c     **** 					}
1392:Src/pid.c     **** 					else
1393:Src/pid.c     **** 					{
1394:Src/pid.c     **** 						s_hal_cnt++;
1395:Src/pid.c     **** 					}
1396:Src/pid.c     **** 				}
1397:Src/pid.c     **** 				else if(pid_last_hall_ture_value1 == 1)
1398:Src/pid.c     **** 				{
1399:Src/pid.c     **** 					if(pid_hall_ture_value1 == 3)
1400:Src/pid.c     **** 					{
1401:Src/pid.c     **** 						s_hal_cnt--;
1402:Src/pid.c     **** 					}
1403:Src/pid.c     **** 					else
1404:Src/pid.c     **** 					{
1405:Src/pid.c     **** 						s_hal_cnt++;
1406:Src/pid.c     **** 					}
1407:Src/pid.c     **** 				}
1408:Src/pid.c     **** 				else if(pid_last_hall_ture_value1 == 3)
1409:Src/pid.c     **** 				{
1410:Src/pid.c     **** 					if(pid_hall_ture_value1 == 2)
1411:Src/pid.c     **** 					{
1412:Src/pid.c     **** 						s_hal_cnt--;
1413:Src/pid.c     **** 					}
1414:Src/pid.c     **** 					else
1415:Src/pid.c     **** 					{
1416:Src/pid.c     **** 						s_hal_cnt++;
1417:Src/pid.c     **** 					}
1418:Src/pid.c     **** 				}
1419:Src/pid.c     **** 				else if(pid_last_hall_ture_value1 == 2)
1420:Src/pid.c     **** 				{
1421:Src/pid.c     **** 					if(pid_hall_ture_value1 == 6)
1422:Src/pid.c     **** 					{
1423:Src/pid.c     **** 						s_hal_cnt--;
1424:Src/pid.c     **** 					}
1425:Src/pid.c     **** 					else
1426:Src/pid.c     **** 					{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 91


1427:Src/pid.c     **** 						s_hal_cnt++;
1428:Src/pid.c     **** 					}
1429:Src/pid.c     **** 				}
1430:Src/pid.c     **** 				else if(pid_last_hall_ture_value1 == 6)
1431:Src/pid.c     **** 				{
1432:Src/pid.c     **** 					if(pid_hall_ture_value1 == 4)
1433:Src/pid.c     **** 					{
1434:Src/pid.c     **** 						s_hal_cnt--;
1435:Src/pid.c     **** 					}
1436:Src/pid.c     **** 					else
1437:Src/pid.c     **** 					{
1438:Src/pid.c     **** 						s_hal_cnt++;
1439:Src/pid.c     **** 					}
1440:Src/pid.c     **** 				}
1441:Src/pid.c     **** 				else if(pid_last_hall_ture_value1 == 4)
1442:Src/pid.c     **** 				{
1443:Src/pid.c     **** 					if(pid_hall_ture_value1 == 5)
1444:Src/pid.c     **** 					{
1445:Src/pid.c     **** 						s_hal_cnt--;
1446:Src/pid.c     **** 					}
1447:Src/pid.c     **** 					else
1448:Src/pid.c     **** 					{
1449:Src/pid.c     **** 						s_hal_cnt++;
1450:Src/pid.c     **** 					}
1451:Src/pid.c     **** 				}
1452:Src/pid.c     **** 				pid_last_hall_ture_value1 = pid_hall_ture_value1;
1453:Src/pid.c     **** 				
1454:Src/pid.c     **** 				hall_speed_sample_cnt++;
1455:Src/pid.c     **** 				if(hall_speed_sample_cnt > 1)
1456:Src/pid.c     **** 				{
1457:Src/pid.c     **** 					hall_cnt = s_hal_cnt;
1458:Src/pid.c     **** 					s_hal_cnt = 0;
1459:Src/pid.c     **** 					hall_speed_sample_cnt =0;
1460:Src/pid.c     **** 					hall_speed_sample_timeout = 1;
1461:Src/pid.c     **** 				}
1462:Src/pid.c     **** 				
1463:Src/pid.c     **** 		}
1464:Src/pid.c     **** 	}
1465:Src/pid.c     **** 	else
1466:Src/pid.c     **** 	{
1467:Src/pid.c     **** 		hall_speed_sample_timeout_cnt = 200;
1468:Src/pid.c     **** 		hall_speed_sample_timeout = 1;
1469:Src/pid.c     **** 		
1470:Src/pid.c     **** 		hall_cnt = s_hal_cnt;
1471:Src/pid.c     **** 		s_hal_cnt = 0;
1472:Src/pid.c     **** 		hall_speed_sample_cnt =0;
1473:Src/pid.c     **** 	}
1474:Src/pid.c     **** 	
1475:Src/pid.c     **** 	if(hall_speed_sample_timeout == 1)
1476:Src/pid.c     **** 	{
1477:Src/pid.c     **** 		
1478:Src/pid.c     **** 		
1479:Src/pid.c     **** 		if(ABS(hall_cnt) > 2)
1480:Src/pid.c     **** 		{
1481:Src/pid.c     **** 			hall_total_time  = (hall_now_time -hall_previous_3_time);
1482:Src/pid.c     **** 			if( hall_total_time < 0 )
1483:Src/pid.c     **** 			{
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 92


1484:Src/pid.c     **** 				hall_total_time = hall_total_time + 65535;
1485:Src/pid.c     **** 			}
1486:Src/pid.c     **** 			hall_total_time = hall_total_time / hall_cnt;
1487:Src/pid.c     **** 		}
1488:Src/pid.c     **** 		else if(ABS(hall_cnt) > 1)
1489:Src/pid.c     **** 		{
1490:Src/pid.c     **** 			hall_total_time  = (hall_now_time -hall_previous_2_time);
1491:Src/pid.c     **** 			if( hall_total_time < 0 )
1492:Src/pid.c     **** 			{
1493:Src/pid.c     **** 				hall_total_time = hall_total_time + 65535;
1494:Src/pid.c     **** 			}
1495:Src/pid.c     **** 			hall_total_time = hall_total_time / hall_cnt;
1496:Src/pid.c     **** 		}
1497:Src/pid.c     **** 		else if(ABS(hall_cnt) > 0)
1498:Src/pid.c     **** 		{
1499:Src/pid.c     **** 			hall_total_time  = (hall_now_time -hall_previous_1_time);  //10000000;
1500:Src/pid.c     **** 			if( hall_total_time < 0 )
1501:Src/pid.c     **** 			{
1502:Src/pid.c     **** 				hall_total_time = hall_total_time + 65535;
1503:Src/pid.c     **** 			}
1504:Src/pid.c     **** 			if(hall_total_time<8000)
1505:Src/pid.c     **** 			{
1506:Src/pid.c     **** 				hall_total_time =10000;
1507:Src/pid.c     **** 			}
1508:Src/pid.c     **** 			hall_total_time = hall_total_time / hall_cnt;
1509:Src/pid.c     **** 		}
1510:Src/pid.c     **** 		else
1511:Src/pid.c     **** 		{
1512:Src/pid.c     **** 			hall_total_time = 10000000;
1513:Src/pid.c     **** 		}
1514:Src/pid.c     **** 		
1515:Src/pid.c     **** 		
1516:Src/pid.c     **** 		
1517:Src/pid.c     **** 		if( hall_cnt == 0) 
1518:Src/pid.c     **** 		{
1519:Src/pid.c     **** 			Vel_PPS_raw1 = 0;
1520:Src/pid.c     **** 		}
1521:Src/pid.c     **** 		else 
1522:Src/pid.c     **** 		{
1523:Src/pid.c     **** 			Vel_PPS_raw1 =1000000/hall_total_time;
1524:Src/pid.c     **** 		}
1525:Src/pid.c     **** 		
1526:Src/pid.c     **** 		if(Vel_PPS_raw1 > 1)
1527:Src/pid.c     **** 		{
1528:Src/pid.c     **** 			speed1++;
1529:Src/pid.c     **** 		}
1530:Src/pid.c     **** 		hall_speed_sample_timeout = 0;
1531:Src/pid.c     **** 		hall_speed_sample_timeout_cnt = 0;
1532:Src/pid.c     **** 		hall_cnt = 0;
1533:Src/pid.c     **** 	}
1534:Src/pid.c     **** 
1535:Src/pid.c     **** 			#endif
1536:Src/pid.c     **** 			
1537:Src/pid.c     **** 	 
1538:Src/pid.c     **** 	
1539:Src/pid.c     **** 	
1540:Src/pid.c     **** 	
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 93


1541:Src/pid.c     **** //	if(g_CmdMap[SYS_SELF_TUNING] == 1)
1542:Src/pid.c     **** //	{
1543:Src/pid.c     **** //		struct_hFrame.internal_us = 40;
1544:Src/pid.c     **** //		UART_PushFrame_HighFreqData(&struct_hFrame,g_CmdMap[CMD_CUR_SET_PU],g_CmdMap[CMD_CUR_ACT_PU]);
1545:Src/pid.c     **** //	}
1546:Src/pid.c     **** //	if(g_CmdMap[SYS_SELF_TUNING] == 3)
1547:Src/pid.c     **** //	{
1548:Src/pid.c     **** //		struct_hFrame.internal_us = 40;
1549:Src/pid.c     **** //		UART_PushFrame_HighFreqData(&struct_hFrame,g_CmdMap[CMD_CUR_ACT_PU],g_CmdMap[CMD_SPD_ACT_PU]);
1550:Src/pid.c     **** //	}
1551:Src/pid.c     **** //	if(g_CmdMap[SYS_SELF_TUNING] == 4)
1552:Src/pid.c     **** //	{
1553:Src/pid.c     **** //		struct_hFrame.internal_us = SVPWM_PERIOD_US;
1554:Src/pid.c     **** //		UART_PushFrame_HighFreqData(&struct_hFrame,g_CmdMap[CMD_SPD_SET_PU],g_CmdMap[CMD_SPD_ACT_PU]);
1555:Src/pid.c     **** //	}
1556:Src/pid.c     **** //	if(struct_hFrame.num_frame > 0)
1557:Src/pid.c     **** //	{ 	
1558:Src/pid.c     **** //		UART_SendFrame_HighFreqData(&struct_hFrame);
1559:Src/pid.c     **** //	}
1560:Src/pid.c     **** //	
1561:Src/pid.c     **** 
1562:Src/pid.c     **** 	
1563:Src/pid.c     **** 	
1564:Src/pid.c     **** //	CurrentPID();
1565:Src/pid.c     **** 	//---------------------------------ï¿½ï¿½ï¿½Â´ï¿½ï¿½ï¿½10KHz(100us)Ö´ï¿½ï¿½-----------------
1566:Src/pid.c     **** 	PlusPosition_flag ^= 0x1;
 3298              		.loc 1 1566 0
 3299 0050 174A     		ldr	r2, .L235+20
 3300 0052 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 3301 0054 83F00103 		eor	r3, r3, #1
 3302 0058 1370     		strb	r3, [r2]
1567:Src/pid.c     **** //	if((PlusPosition_flag) && (g_BeginPIDFlag)) 													// 10KHz
1568:Src/pid.c     **** //	{			   							  																				// MTï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
1569:Src/pid.c     **** //		ShortCurrentCheck();																								// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½	
1570:Src/pid.c     **** //	}  	
1571:Src/pid.c     **** 
1572:Src/pid.c     **** 	
1573:Src/pid.c     **** 	
1574:Src/pid.c     **** 	
1575:Src/pid.c     **** 	/**********
1576:Src/pid.c     **** * hall_ture_value
1577:Src/pid.c     **** * hall_ture_value = 5     B 
1578:Src/pid.c     **** * hall_ture_value = 1     C 
1579:Src/pid.c     ****  hall_ture_value = 3     C 
1580:Src/pid.c     ****  hall_ture_value = 2     A 
1581:Src/pid.c     ****  hall_ture_value = 6     A 
1582:Src/pid.c     ****  hall_ture_value = 4     B 
1583:Src/pid.c     **** 
1584:Src/pid.c     **** *********/
1585:Src/pid.c     **** 
1586:Src/pid.c     **** //	s_SpeedTimeAdd1++;
1587:Src/pid.c     **** //	if(hall_ture_value != last_hall_ture_value)
1588:Src/pid.c     **** //	{
1589:Src/pid.c     **** //		if(start_speed_sample == 1)
1590:Src/pid.c     **** //		{
1591:Src/pid.c     **** //			start_speed_sample = 0;
1592:Src/pid.c     **** //			s_SpeedTimeAdd1 = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 94


1593:Src/pid.c     **** //		}
1594:Src/pid.c     **** //		
1595:Src/pid.c     **** //		if(last_hall_ture_value == 5)
1596:Src/pid.c     **** //		{
1597:Src/pid.c     **** //			if(hall_ture_value == 1)
1598:Src/pid.c     **** //			{
1599:Src/pid.c     **** //				Encoder_Inc++;
1600:Src/pid.c     **** //			}
1601:Src/pid.c     **** //			else
1602:Src/pid.c     **** //			{
1603:Src/pid.c     **** //				Encoder_Inc--;
1604:Src/pid.c     **** //			}
1605:Src/pid.c     **** //		}
1606:Src/pid.c     **** //		else if(last_hall_ture_value == 1)
1607:Src/pid.c     **** //		{
1608:Src/pid.c     **** //			if(hall_ture_value == 3)
1609:Src/pid.c     **** //			{
1610:Src/pid.c     **** //				Encoder_Inc++;
1611:Src/pid.c     **** //			}
1612:Src/pid.c     **** //			else
1613:Src/pid.c     **** //			{
1614:Src/pid.c     **** //				Encoder_Inc--;
1615:Src/pid.c     **** //			}
1616:Src/pid.c     **** //		}
1617:Src/pid.c     **** //		else if(last_hall_ture_value == 3)
1618:Src/pid.c     **** //		{
1619:Src/pid.c     **** //			if(hall_ture_value == 2)
1620:Src/pid.c     **** //			{
1621:Src/pid.c     **** //				Encoder_Inc++;
1622:Src/pid.c     **** //			}
1623:Src/pid.c     **** //			else
1624:Src/pid.c     **** //			{
1625:Src/pid.c     **** //				Encoder_Inc--;
1626:Src/pid.c     **** //			}
1627:Src/pid.c     **** //		}
1628:Src/pid.c     **** //		else if(last_hall_ture_value == 2)
1629:Src/pid.c     **** //		{
1630:Src/pid.c     **** //			if(hall_ture_value == 6)
1631:Src/pid.c     **** //			{
1632:Src/pid.c     **** //				Encoder_Inc++;
1633:Src/pid.c     **** //			}
1634:Src/pid.c     **** //			else
1635:Src/pid.c     **** //			{
1636:Src/pid.c     **** //				Encoder_Inc--;
1637:Src/pid.c     **** //			}
1638:Src/pid.c     **** //		}
1639:Src/pid.c     **** //		else if(last_hall_ture_value == 6)
1640:Src/pid.c     **** //		{
1641:Src/pid.c     **** //			if(hall_ture_value == 4)
1642:Src/pid.c     **** //			{
1643:Src/pid.c     **** //				Encoder_Inc++;
1644:Src/pid.c     **** //			}
1645:Src/pid.c     **** //			else
1646:Src/pid.c     **** //			{
1647:Src/pid.c     **** //				Encoder_Inc--;
1648:Src/pid.c     **** //			}
1649:Src/pid.c     **** //		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 95


1650:Src/pid.c     **** //		else if(last_hall_ture_value == 4)
1651:Src/pid.c     **** //		{
1652:Src/pid.c     **** //			if(hall_ture_value == 5)
1653:Src/pid.c     **** //			{
1654:Src/pid.c     **** //				Encoder_Inc++;
1655:Src/pid.c     **** //			}
1656:Src/pid.c     **** //			else
1657:Src/pid.c     **** //			{
1658:Src/pid.c     **** //				Encoder_Inc--;
1659:Src/pid.c     **** //			}
1660:Src/pid.c     **** //		}
1661:Src/pid.c     **** //		
1662:Src/pid.c     **** //		
1663:Src/pid.c     **** //		last_hall_ture_value = hall_ture_value;
1664:Src/pid.c     **** //	}
1665:Src/pid.c     **** 
1666:Src/pid.c     **** 		s_count ++;
 3303              		.loc 1 1666 0
 3304 005a 164A     		ldr	r2, .L235+24
 3305 005c 1368     		ldr	r3, [r2]
 3306 005e 0133     		adds	r3, r3, #1
 3307 0060 1360     		str	r3, [r2]
1667:Src/pid.c     **** 	
1668:Src/pid.c     **** 	if(s_count >= (F_CUR_REGULATOR_HZ/F_SPD_REGULATOR_HZ))
 3308              		.loc 1 1668 0
 3309 0062 052B     		cmp	r3, #5
 3310 0064 08DC     		bgt	.L234
 3311              	.L232:
1669:Src/pid.c     **** 	{	
1670:Src/pid.c     **** 		s_count = 0;
1671:Src/pid.c     **** //		tim3_cnt = TIM3->CNT;
1672:Src/pid.c     **** //		tim4_cnt = TIM4->CNT;
1673:Src/pid.c     **** //		TIM3->CNT = 0;
1674:Src/pid.c     **** 	//	EXTI_GenerateSWInterrupt(EXTI_Line3); // ï¿½ï¿½ï¿½ï¿½ï¿½Ð¶ï¿½EXTI3ï¿½Ð´ï¿½ï¿½ï¿½Î»ï¿½Ã»ï¿½ï¿½ï¿
1675:Src/pid.c     **** 		EXTI->SWIER1 |= 0x08;
1676:Src/pid.c     **** 		EXTI_Handle.Line = 3;
1677:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
1678:Src/pid.c     **** 	} 
1679:Src/pid.c     **** 
1680:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1681:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1682:Src/pid.c     **** 	
1683:Src/pid.c     **** 	SPI3->DR =0X0000;
 3312              		.loc 1 1683 0
 3313 0066 144B     		ldr	r3, .L235+28
 3314 0068 0022     		movs	r2, #0
 3315 006a DA60     		str	r2, [r3, #12]
1684:Src/pid.c     **** 	
1685:Src/pid.c     **** }
 3316              		.loc 1 1685 0
 3317 006c 03B0     		add	sp, sp, #12
 3318              	.LCFI25:
 3319              		.cfi_remember_state
 3320              		.cfi_def_cfa_offset 4
 3321              		@ sp needed
 3322 006e 5DF804FB 		ldr	pc, [sp], #4
 3323              	.L230:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 96


 3324              	.LCFI26:
 3325              		.cfi_restore_state
 3326              	.LBB3:
1329:Src/pid.c     **** 		}
 3327              		.loc 1 1329 0
 3328 0072 FFF7FEFF 		bl	CurrentPID
 3329              	.LVL202:
 3330 0076 DCE7     		b	.L231
 3331              	.L234:
 3332              	.LBE3:
1670:Src/pid.c     **** //		tim3_cnt = TIM3->CNT;
 3333              		.loc 1 1670 0
 3334 0078 1346     		mov	r3, r2
 3335 007a 0022     		movs	r2, #0
 3336 007c 1A60     		str	r2, [r3]
1675:Src/pid.c     **** 		EXTI_Handle.Line = 3;
 3337              		.loc 1 1675 0
 3338 007e 02F18042 		add	r2, r2, #1073741824
 3339 0082 02F58232 		add	r2, r2, #66560
 3340 0086 1369     		ldr	r3, [r2, #16]
 3341 0088 43F00803 		orr	r3, r3, #8
 3342 008c 1361     		str	r3, [r2, #16]
1676:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
 3343              		.loc 1 1676 0
 3344 008e 02A8     		add	r0, sp, #8
 3345 0090 0323     		movs	r3, #3
 3346 0092 40F8083D 		str	r3, [r0, #-8]!
1677:Src/pid.c     **** 	} 
 3347              		.loc 1 1677 0
 3348 0096 FFF7FEFF 		bl	HAL_EXTI_GenerateSWI
 3349              	.LVL203:
 3350 009a E4E7     		b	.L232
 3351              	.L236:
 3352              		.align	2
 3353              	.L235:
 3354 009c 00000000 		.word	g_bEnableHB
 3355 00a0 00000000 		.word	g_CmdMap
 3356 00a4 00000000 		.word	g_ElectricAngle_15bit
 3357 00a8 00000000 		.word	pll_estimated_spd
 3358 00ac 00000000 		.word	pll_estimated_phase
 3359 00b0 00000000 		.word	.LANCHOR36
 3360 00b4 00000000 		.word	.LANCHOR37
 3361 00b8 003C0040 		.word	1073757184
 3362              		.cfi_endproc
 3363              	.LFE348:
 3365              		.section	.text.Loop3_EnableManage,"ax",%progbits
 3366              		.align	1
 3367              		.global	Loop3_EnableManage
 3368              		.syntax unified
 3369              		.thumb
 3370              		.thumb_func
 3371              		.fpu fpv4-sp-d16
 3373              	Loop3_EnableManage:
 3374              	.LFB349:
1686:Src/pid.c     **** void Loop3_EnableManage(void)   //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æµï¿½Ê¹ï¿½Ü¹ï¿½ï¿½ï¿½
1687:Src/pid.c     **** {
 3375              		.loc 1 1687 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 97


 3376              		.cfi_startproc
 3377              		@ args = 0, pretend = 0, frame = 0
 3378              		@ frame_needed = 0, uses_anonymous_args = 0
 3379              		@ link register save eliminated.
1688:Src/pid.c     **** 	//Ç¿ï¿½Ã¹Ø±ï¿½ï¿½Ù¶ï¿½
1689:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 3380              		.loc 1 1689 0
 3381 0000 3A4B     		ldr	r3, .L252
 3382 0002 B3F80232 		ldrh	r3, [r3, #514]
 3383 0006 1BB2     		sxth	r3, r3
 3384 0008 012B     		cmp	r3, #1
 3385 000a 20D0     		beq	.L248
 3386              	.L238:
1690:Src/pid.c     **** 			&& 	(	g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT	  //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
1691:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_FORCE 	//ï¿½ï¿½ï¿½Ø»ï¿½				
1692:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
1693:Src/pid.c     **** 						|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿
1694:Src/pid.c     **** 					)
1695:Src/pid.c     **** 		)
1696:Src/pid.c     **** 	{	
1697:Src/pid.c     **** 		pid_IQ.enable = 1;
1698:Src/pid.c     **** 		pid_ID.enable = 1;
1699:Src/pid.c     **** 	}
1700:Src/pid.c     **** 	else
1701:Src/pid.c     **** 	{
1702:Src/pid.c     **** 		pid_IQ.enable = 0;
 3387              		.loc 1 1702 0
 3388 000c 0023     		movs	r3, #0
 3389 000e 384A     		ldr	r2, .L252+4
 3390 0010 1360     		str	r3, [r2]
1703:Src/pid.c     **** 		pid_ID.enable = 0;
 3391              		.loc 1 1703 0
 3392 0012 384A     		ldr	r2, .L252+8
 3393 0014 1360     		str	r3, [r2]
 3394              	.L240:
1704:Src/pid.c     **** 	}
1705:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 3395              		.loc 1 1705 0
 3396 0016 354B     		ldr	r3, .L252
 3397 0018 B3F80232 		ldrh	r3, [r3, #514]
 3398 001c 1BB2     		sxth	r3, r3
 3399 001e 012B     		cmp	r3, #1
 3400 0020 37D0     		beq	.L249
 3401              	.L241:
1706:Src/pid.c     **** 	{	
1707:Src/pid.c     **** 		pid_force.enable = 1;
1708:Src/pid.c     **** 	}
1709:Src/pid.c     **** 	else
1710:Src/pid.c     **** 	{
1711:Src/pid.c     **** 		pid_force.enable = 0;
 3402              		.loc 1 1711 0
 3403 0022 354B     		ldr	r3, .L252+12
 3404 0024 0022     		movs	r2, #0
 3405 0026 1A60     		str	r2, [r3]
 3406              	.L242:
1712:Src/pid.c     **** 	}	
1713:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 98


 3407              		.loc 1 1713 0
 3408 0028 304B     		ldr	r3, .L252
 3409 002a B3F80232 		ldrh	r3, [r3, #514]
 3410 002e 1BB2     		sxth	r3, r3
 3411 0030 012B     		cmp	r3, #1
 3412 0032 38D0     		beq	.L250
 3413              	.L243:
1714:Src/pid.c     **** 			&& ( g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
1715:Src/pid.c     **** 					|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½
1716:Src/pid.c     **** 					)
1717:Src/pid.c     **** 		)
1718:Src/pid.c     **** 	{	
1719:Src/pid.c     **** 		pid_spd.enable = 1;
1720:Src/pid.c     **** 	}
1721:Src/pid.c     **** 	else
1722:Src/pid.c     **** 	{
1723:Src/pid.c     **** 		pid_spd.enable = 0;
 3414              		.loc 1 1723 0
 3415 0034 314B     		ldr	r3, .L252+16
 3416 0036 0022     		movs	r2, #0
 3417 0038 1A60     		str	r2, [r3]
 3418              	.L245:
1724:Src/pid.c     **** 	}
1725:Src/pid.c     **** 	if(	g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 3419              		.loc 1 1725 0
 3420 003a 2C4B     		ldr	r3, .L252
 3421 003c B3F80232 		ldrh	r3, [r3, #514]
 3422 0040 1BB2     		sxth	r3, r3
 3423 0042 012B     		cmp	r3, #1
 3424 0044 43D0     		beq	.L251
 3425              	.L246:
1726:Src/pid.c     **** 			&& (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0) //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½ï¿½
1727:Src/pid.c     **** 		)
1728:Src/pid.c     **** 	{	
1729:Src/pid.c     **** 		pid_pos.enable = 1;
1730:Src/pid.c     **** 	}
1731:Src/pid.c     **** 	else
1732:Src/pid.c     **** 	{
1733:Src/pid.c     **** 		pid_pos.enable = 0;
 3426              		.loc 1 1733 0
 3427 0046 2E4B     		ldr	r3, .L252+20
 3428 0048 0022     		movs	r2, #0
 3429 004a 1A60     		str	r2, [r3]
1734:Src/pid.c     **** 	}
1735:Src/pid.c     **** }
 3430              		.loc 1 1735 0
 3431 004c 7047     		bx	lr
 3432              	.L248:
1690:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_FORCE 	//ï¿½ï¿½ï¿½Ø»ï¿½				
 3433              		.loc 1 1690 0
 3434 004e 274B     		ldr	r3, .L252
 3435 0050 B3F80432 		ldrh	r3, [r3, #516]
 3436 0054 1BB2     		sxth	r3, r3
 3437 0056 012B     		cmp	r3, #1
 3438 0058 15D0     		beq	.L239
1691:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
 3439              		.loc 1 1691 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 99


 3440 005a 244B     		ldr	r3, .L252
 3441 005c B3F80432 		ldrh	r3, [r3, #516]
 3442 0060 1BB2     		sxth	r3, r3
 3443 0062 042B     		cmp	r3, #4
 3444 0064 0FD0     		beq	.L239
1692:Src/pid.c     **** 						|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿
 3445              		.loc 1 1692 0
 3446 0066 214B     		ldr	r3, .L252
 3447 0068 B3F80432 		ldrh	r3, [r3, #516]
 3448 006c 1BB2     		sxth	r3, r3
 3449 006e 022B     		cmp	r3, #2
 3450 0070 09D0     		beq	.L239
1693:Src/pid.c     **** 					)
 3451              		.loc 1 1693 0
 3452 0072 1E4B     		ldr	r3, .L252
 3453 0074 B3F80432 		ldrh	r3, [r3, #516]
 3454 0078 1BB2     		sxth	r3, r3
 3455 007a 032B     		cmp	r3, #3
 3456 007c C6D1     		bne	.L238
1693:Src/pid.c     **** 					)
 3457              		.loc 1 1693 0 is_stmt 0 discriminator 1
 3458 007e 214B     		ldr	r3, .L252+24
 3459 0080 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3460 0082 002B     		cmp	r3, #0
 3461 0084 C2D1     		bne	.L238
 3462              	.L239:
1697:Src/pid.c     **** 		pid_ID.enable = 1;
 3463              		.loc 1 1697 0 is_stmt 1
 3464 0086 0123     		movs	r3, #1
 3465 0088 194A     		ldr	r2, .L252+4
 3466 008a 1360     		str	r3, [r2]
1698:Src/pid.c     **** 	}
 3467              		.loc 1 1698 0
 3468 008c 194A     		ldr	r2, .L252+8
 3469 008e 1360     		str	r3, [r2]
 3470 0090 C1E7     		b	.L240
 3471              	.L249:
1705:Src/pid.c     **** 	{	
 3472              		.loc 1 1705 0 discriminator 1
 3473 0092 164B     		ldr	r3, .L252
 3474 0094 B3F80432 		ldrh	r3, [r3, #516]
 3475 0098 1BB2     		sxth	r3, r3
 3476 009a 042B     		cmp	r3, #4
 3477 009c C1D1     		bne	.L241
1707:Src/pid.c     **** 	}
 3478              		.loc 1 1707 0
 3479 009e 164B     		ldr	r3, .L252+12
 3480 00a0 0122     		movs	r2, #1
 3481 00a2 1A60     		str	r2, [r3]
 3482 00a4 C0E7     		b	.L242
 3483              	.L250:
1714:Src/pid.c     **** 					|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½
 3484              		.loc 1 1714 0
 3485 00a6 114B     		ldr	r3, .L252
 3486 00a8 B3F80432 		ldrh	r3, [r3, #516]
 3487 00ac 1BB2     		sxth	r3, r3
 3488 00ae 022B     		cmp	r3, #2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 100


 3489 00b0 09D0     		beq	.L244
1715:Src/pid.c     **** 					)
 3490              		.loc 1 1715 0
 3491 00b2 0E4B     		ldr	r3, .L252
 3492 00b4 B3F80432 		ldrh	r3, [r3, #516]
 3493 00b8 1BB2     		sxth	r3, r3
 3494 00ba 032B     		cmp	r3, #3
 3495 00bc BAD1     		bne	.L243
1715:Src/pid.c     **** 					)
 3496              		.loc 1 1715 0 is_stmt 0 discriminator 1
 3497 00be 114B     		ldr	r3, .L252+24
 3498 00c0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3499 00c2 002B     		cmp	r3, #0
 3500 00c4 B6D1     		bne	.L243
 3501              	.L244:
1719:Src/pid.c     **** 	}
 3502              		.loc 1 1719 0 is_stmt 1
 3503 00c6 0D4B     		ldr	r3, .L252+16
 3504 00c8 0122     		movs	r2, #1
 3505 00ca 1A60     		str	r2, [r3]
 3506 00cc B5E7     		b	.L245
 3507              	.L251:
1726:Src/pid.c     **** 		)
 3508              		.loc 1 1726 0
 3509 00ce 074B     		ldr	r3, .L252
 3510 00d0 B3F80432 		ldrh	r3, [r3, #516]
 3511 00d4 1BB2     		sxth	r3, r3
 3512 00d6 032B     		cmp	r3, #3
 3513 00d8 B5D1     		bne	.L246
1726:Src/pid.c     **** 		)
 3514              		.loc 1 1726 0 is_stmt 0 discriminator 1
 3515 00da 0A4B     		ldr	r3, .L252+24
 3516 00dc 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3517 00de 002B     		cmp	r3, #0
 3518 00e0 B1D1     		bne	.L246
1729:Src/pid.c     **** 	}
 3519              		.loc 1 1729 0 is_stmt 1
 3520 00e2 074B     		ldr	r3, .L252+20
 3521 00e4 0122     		movs	r2, #1
 3522 00e6 1A60     		str	r2, [r3]
 3523 00e8 7047     		bx	lr
 3524              	.L253:
 3525 00ea 00BF     		.align	2
 3526              	.L252:
 3527 00ec 00000000 		.word	g_CmdMap
 3528 00f0 00000000 		.word	pid_IQ
 3529 00f4 00000000 		.word	pid_ID
 3530 00f8 00000000 		.word	pid_force
 3531 00fc 00000000 		.word	pid_spd
 3532 0100 00000000 		.word	pid_pos
 3533 0104 00000000 		.word	.LANCHOR21
 3534              		.cfi_endproc
 3535              	.LFE349:
 3537              		.section	.text.Pos_Spd_PID,"ax",%progbits
 3538              		.align	1
 3539              		.syntax unified
 3540              		.thumb
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 101


 3541              		.thumb_func
 3542              		.fpu fpv4-sp-d16
 3544              	Pos_Spd_PID:
 3545              	.LFB344:
1061:Src/pid.c     **** 	static s32 s_count = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
 3546              		.loc 1 1061 0
 3547              		.cfi_startproc
 3548              		@ args = 0, pretend = 0, frame = 0
 3549              		@ frame_needed = 0, uses_anonymous_args = 0
 3550 0000 10B5     		push	{r4, lr}
 3551              	.LCFI27:
 3552              		.cfi_def_cfa_offset 8
 3553              		.cfi_offset 4, -8
 3554              		.cfi_offset 14, -4
1064:Src/pid.c     **** 	//CheckModeChange();
 3555              		.loc 1 1064 0
 3556 0002 4FF09042 		mov	r2, #1207959552
 3557 0006 936A     		ldr	r3, [r2, #40]
 3558 0008 43F01003 		orr	r3, r3, #16
 3559 000c 9362     		str	r3, [r2, #40]
1066:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
 3560              		.loc 1 1066 0
 3561 000e FFF7FEFF 		bl	MTPro
 3562              	.LVL204:
1067:Src/pid.c     **** 	{
 3563              		.loc 1 1067 0
 3564 0012 5E4B     		ldr	r3, .L272
 3565 0014 1B68     		ldr	r3, [r3]
 3566 0016 B3F5FA6F 		cmp	r3, #2000
 3567 001a 02DA     		bge	.L255
1069:Src/pid.c     **** 	}
 3568              		.loc 1 1069 0
 3569 001c 0133     		adds	r3, r3, #1
 3570 001e 5B4A     		ldr	r2, .L272
 3571 0020 1360     		str	r3, [r2]
 3572              	.L255:
1071:Src/pid.c     **** 	
 3573              		.loc 1 1071 0
 3574 0022 FFF7FEFF 		bl	get_average_force_data
 3575              	.LVL205:
1073:Src/pid.c     **** 	{
 3576              		.loc 1 1073 0
 3577 0026 5A4B     		ldr	r3, .L272+4
 3578 0028 B3F80432 		ldrh	r3, [r3, #516]
 3579 002c 1BB2     		sxth	r3, r3
 3580 002e 042B     		cmp	r3, #4
 3581 0030 7BD0     		beq	.L271
 3582              	.L256:
1079:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
 3583              		.loc 1 1079 0
 3584 0032 FFF7FEFF 		bl	Loop3_EnableManage
 3585              	.LVL206:
1080:Src/pid.c     **** 	{
 3586              		.loc 1 1080 0
 3587 0036 574A     		ldr	r2, .L272+8
 3588 0038 1368     		ldr	r3, [r2]
 3589 003a 0133     		adds	r3, r3, #1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 102


 3590 003c 1360     		str	r3, [r2]
 3591 003e 002B     		cmp	r3, #0
 3592 0040 18DD     		ble	.L257
1082:Src/pid.c     **** 		Flag_1ms = 1;
 3593              		.loc 1 1082 0
 3594 0042 1346     		mov	r3, r2
 3595 0044 0022     		movs	r2, #0
 3596 0046 1A60     		str	r2, [r3]
1083:Src/pid.c     **** 		if(++s_count_50ms>50)
 3597              		.loc 1 1083 0
 3598 0048 534B     		ldr	r3, .L272+12
 3599 004a 0122     		movs	r2, #1
 3600 004c 1A70     		strb	r2, [r3]
1084:Src/pid.c     **** 		{
 3601              		.loc 1 1084 0
 3602 004e 534A     		ldr	r2, .L272+16
 3603 0050 1388     		ldrh	r3, [r2]
 3604 0052 0133     		adds	r3, r3, #1
 3605 0054 1BB2     		sxth	r3, r3
 3606 0056 1380     		strh	r3, [r2]	@ movhi
 3607 0058 322B     		cmp	r3, #50
 3608 005a 05DD     		ble	.L258
1086:Src/pid.c     **** 			Flag_50ms = 1;
 3609              		.loc 1 1086 0
 3610 005c 1346     		mov	r3, r2
 3611 005e 0022     		movs	r2, #0
 3612 0060 1A80     		strh	r2, [r3]	@ movhi
1087:Src/pid.c     **** 		}
 3613              		.loc 1 1087 0
 3614 0062 4F4B     		ldr	r3, .L272+20
 3615 0064 0122     		movs	r2, #1
 3616 0066 1A70     		strb	r2, [r3]
 3617              	.L258:
1092:Src/pid.c     **** 		Stroke_protection();
 3618              		.loc 1 1092 0
 3619 0068 FFF7FEFF 		bl	Get_Pos_Rod
 3620              	.LVL207:
1093:Src/pid.c     **** 		
 3621              		.loc 1 1093 0
 3622 006c FFF7FEFF 		bl	Stroke_protection
 3623              	.LVL208:
1097:Src/pid.c     **** 		}
 3624              		.loc 1 1097 0
 3625 0070 FFF7FEFF 		bl	Gripper_control
 3626              	.LVL209:
 3627              	.L257:
1101:Src/pid.c     **** 	
 3628              		.loc 1 1101 0
 3629 0074 FFF7FEFF 		bl	icmu_sdtransmission_test
 3630              	.LVL210:
1104:Src/pid.c     **** 	{
 3631              		.loc 1 1104 0
 3632 0078 454B     		ldr	r3, .L272+4
 3633 007a B3F80432 		ldrh	r3, [r3, #516]
 3634 007e 1BB2     		sxth	r3, r3
 3635 0080 032B     		cmp	r3, #3
 3636 0082 0BD0     		beq	.L259
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 103


1104:Src/pid.c     **** 	{
 3637              		.loc 1 1104 0 is_stmt 0 discriminator 1
 3638 0084 424B     		ldr	r3, .L272+4
 3639 0086 B3F80432 		ldrh	r3, [r3, #516]
 3640 008a 1BB2     		sxth	r3, r3
 3641 008c 022B     		cmp	r3, #2
 3642 008e 05D0     		beq	.L259
1104:Src/pid.c     **** 	{
 3643              		.loc 1 1104 0 discriminator 2
 3644 0090 3F4B     		ldr	r3, .L272+4
 3645 0092 B3F80432 		ldrh	r3, [r3, #516]
 3646 0096 1BB2     		sxth	r3, r3
 3647 0098 042B     		cmp	r3, #4
 3648 009a 01D1     		bne	.L260
 3649              	.L259:
1106:Src/pid.c     **** 	}	
 3650              		.loc 1 1106 0 is_stmt 1
 3651 009c FFF7FEFF 		bl	SpeedPID
 3652              	.LVL211:
 3653              	.L260:
1109:Src/pid.c     **** 	{
 3654              		.loc 1 1109 0
 3655 00a0 3B4B     		ldr	r3, .L272+4
 3656 00a2 B3F80232 		ldrh	r3, [r3, #514]
 3657 00a6 1BB2     		sxth	r3, r3
 3658 00a8 002B     		cmp	r3, #0
 3659 00aa 41D0     		beq	.L261
1109:Src/pid.c     **** 	{
 3660              		.loc 1 1109 0 is_stmt 0 discriminator 1
 3661 00ac 3D4B     		ldr	r3, .L272+24
 3662 00ae 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3663 00b0 DBB2     		uxtb	r3, r3
 3664 00b2 012B     		cmp	r3, #1
 3665 00b4 3CD0     		beq	.L261
1109:Src/pid.c     **** 	{
 3666              		.loc 1 1109 0 discriminator 2
 3667 00b6 3C4B     		ldr	r3, .L272+28
 3668 00b8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3669 00ba DBB2     		uxtb	r3, r3
 3670 00bc 012B     		cmp	r3, #1
 3671 00be 37D0     		beq	.L261
1109:Src/pid.c     **** 	{
 3672              		.loc 1 1109 0 discriminator 3
 3673 00c0 3A4B     		ldr	r3, .L272+32
 3674 00c2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3675 00c4 DBB2     		uxtb	r3, r3
 3676 00c6 012B     		cmp	r3, #1
 3677 00c8 32D0     		beq	.L261
1138:Src/pid.c     **** 	{
 3678              		.loc 1 1138 0 is_stmt 1
 3679 00ca 314B     		ldr	r3, .L272+4
 3680 00cc B3F80232 		ldrh	r3, [r3, #514]
 3681 00d0 1BB2     		sxth	r3, r3
 3682 00d2 012B     		cmp	r3, #1
 3683 00d4 58D1     		bne	.L254
1138:Src/pid.c     **** 	{
 3684              		.loc 1 1138 0 is_stmt 0 discriminator 1
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 104


 3685 00d6 334B     		ldr	r3, .L272+24
 3686 00d8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3687 00da 002B     		cmp	r3, #0
 3688 00dc 54D1     		bne	.L254
1140:Src/pid.c     **** 		s_Disable_Delay = 0;
 3689              		.loc 1 1140 0 is_stmt 1
 3690 00de 344B     		ldr	r3, .L272+36
 3691 00e0 1B68     		ldr	r3, [r3]
 3692 00e2 022B     		cmp	r3, #2
 3693 00e4 02DC     		bgt	.L267
1140:Src/pid.c     **** 		s_Disable_Delay = 0;
 3694              		.loc 1 1140 0 is_stmt 0 discriminator 1
 3695 00e6 0133     		adds	r3, r3, #1
 3696 00e8 314A     		ldr	r2, .L272+36
 3697 00ea 1360     		str	r3, [r2]
 3698              	.L267:
1141:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
 3699              		.loc 1 1141 0 is_stmt 1
 3700 00ec 314B     		ldr	r3, .L272+40
 3701 00ee 0022     		movs	r2, #0
 3702 00f0 1A60     		str	r2, [r3]
1142:Src/pid.c     **** 		{
 3703              		.loc 1 1142 0
 3704 00f2 2F4B     		ldr	r3, .L272+36
 3705 00f4 1B68     		ldr	r3, [r3]
 3706 00f6 012B     		cmp	r3, #1
 3707 00f8 46D1     		bne	.L254
1144:Src/pid.c     **** 			{
 3708              		.loc 1 1144 0
 3709 00fa 254B     		ldr	r3, .L272+4
 3710 00fc B3F80432 		ldrh	r3, [r3, #516]
 3711 0100 1BB2     		sxth	r3, r3
 3712 0102 022B     		cmp	r3, #2
 3713 0104 05D0     		beq	.L268
1144:Src/pid.c     **** 			{
 3714              		.loc 1 1144 0 is_stmt 0 discriminator 1
 3715 0106 224B     		ldr	r3, .L272+4
 3716 0108 B3F80432 		ldrh	r3, [r3, #516]
 3717 010c 1BB2     		sxth	r3, r3
 3718 010e 012B     		cmp	r3, #1
 3719 0110 05D1     		bne	.L269
 3720              	.L268:
1146:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 3721              		.loc 1 1146 0 is_stmt 1
 3722 0112 1F4B     		ldr	r3, .L272+4
 3723 0114 0022     		movs	r2, #0
 3724 0116 A3F84620 		strh	r2, [r3, #70]	@ movhi
1147:Src/pid.c     **** 			}
 3725              		.loc 1 1147 0
 3726 011a A3F84220 		strh	r2, [r3, #66]	@ movhi
 3727              	.L269:
1149:Src/pid.c     **** 			PWM_Enable();			
 3728              		.loc 1 1149 0
 3729 011e 264B     		ldr	r3, .L272+44
 3730 0120 0022     		movs	r2, #0
 3731 0122 1A60     		str	r2, [r3]
1150:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 105


 3732              		.loc 1 1150 0
 3733 0124 FFF7FEFF 		bl	PWM_Enable
 3734              	.LVL212:
 3735 0128 2EE0     		b	.L254
 3736              	.L271:
1075:Src/pid.c     **** 	}
 3737              		.loc 1 1075 0
 3738 012a FFF7FEFF 		bl	ForcePID
 3739              	.LVL213:
 3740 012e 80E7     		b	.L256
 3741              	.L261:
1111:Src/pid.c     **** 		Motor_forbidden = 0;
 3742              		.loc 1 1111 0
 3743 0130 0023     		movs	r3, #0
 3744 0132 1F4A     		ldr	r2, .L272+36
 3745 0134 1360     		str	r3, [r2]
1112:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
 3746              		.loc 1 1112 0
 3747 0136 1B4A     		ldr	r2, .L272+24
 3748 0138 1370     		strb	r3, [r2]
1113:Src/pid.c     **** 		{
 3749              		.loc 1 1113 0
 3750 013a 154B     		ldr	r3, .L272+4
 3751 013c B3F80432 		ldrh	r3, [r3, #516]
 3752 0140 1BB2     		sxth	r3, r3
 3753 0142 022B     		cmp	r3, #2
 3754 0144 05D0     		beq	.L263
1113:Src/pid.c     **** 		{
 3755              		.loc 1 1113 0 is_stmt 0 discriminator 1
 3756 0146 124B     		ldr	r3, .L272+4
 3757 0148 B3F80432 		ldrh	r3, [r3, #516]
 3758 014c 1BB2     		sxth	r3, r3
 3759 014e 012B     		cmp	r3, #1
 3760 0150 05D1     		bne	.L264
 3761              	.L263:
1115:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 3762              		.loc 1 1115 0 is_stmt 1
 3763 0152 0F4B     		ldr	r3, .L272+4
 3764 0154 0022     		movs	r2, #0
 3765 0156 A3F84620 		strh	r2, [r3, #70]	@ movhi
1116:Src/pid.c     **** 		}
 3766              		.loc 1 1116 0
 3767 015a A3F84220 		strh	r2, [r3, #66]	@ movhi
 3768              	.L264:
1118:Src/pid.c     **** 		{	
 3769              		.loc 1 1118 0
 3770 015e 0C4B     		ldr	r3, .L272+4
 3771 0160 B3F85430 		ldrh	r3, [r3, #84]
 3772 0164 1BB2     		sxth	r3, r3
 3773 0166 23B1     		cbz	r3, .L265
1120:Src/pid.c     **** 		}			
 3774              		.loc 1 1120 0
 3775 0168 094B     		ldr	r3, .L272+4
 3776 016a B3F84C20 		ldrh	r2, [r3, #76]
 3777 016e A3F84820 		strh	r2, [r3, #72]	@ movhi
 3778              	.L265:
1126:Src/pid.c     ****       Motor_emergercy_stop =0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 106


 3779              		.loc 1 1126 0
 3780 0172 0024     		movs	r4, #0
 3781 0174 104B     		ldr	r3, .L272+44
 3782 0176 1C60     		str	r4, [r3]
1127:Src/pid.c     **** 			Motor_pause_flag = 0;
 3783              		.loc 1 1127 0
 3784 0178 0B4B     		ldr	r3, .L272+28
 3785 017a 1C70     		strb	r4, [r3]
1128:Src/pid.c     **** 			PWM_Disable();
 3786              		.loc 1 1128 0
 3787 017c 0B4B     		ldr	r3, .L272+32
 3788 017e 1C70     		strb	r4, [r3]
1129:Src/pid.c     **** 		}
 3789              		.loc 1 1129 0
 3790 0180 FFF7FEFF 		bl	PWM_Disable
 3791              	.LVL214:
1135:Src/pid.c     **** 		return;
 3792              		.loc 1 1135 0
 3793 0184 0D4B     		ldr	r3, .L272+48
 3794 0186 1C60     		str	r4, [r3]
 3795              	.L254:
1154:Src/pid.c     **** s32 I_Alpha, I_Beta; 
 3796              		.loc 1 1154 0
 3797 0188 10BD     		pop	{r4, pc}
 3798              	.L273:
 3799 018a 00BF     		.align	2
 3800              	.L272:
 3801 018c 00000000 		.word	g_servo_cmd_period_cnt
 3802 0190 00000000 		.word	g_CmdMap
 3803 0194 00000000 		.word	.LANCHOR38
 3804 0198 00000000 		.word	Flag_1ms
 3805 019c 00000000 		.word	s_count_50ms
 3806 01a0 00000000 		.word	Flag_50ms
 3807 01a4 00000000 		.word	Motor_forbidden
 3808 01a8 00000000 		.word	Motor_emergercy_stop
 3809 01ac 00000000 		.word	Motor_pause_flag
 3810 01b0 00000000 		.word	.LANCHOR39
 3811 01b4 00000000 		.word	.LANCHOR40
 3812 01b8 00000000 		.word	g_Timer1CCR
 3813 01bc 00000000 		.word	.LANCHOR0
 3814              		.cfi_endproc
 3815              	.LFE344:
 3817              		.section	.text.work_var_updata,"ax",%progbits
 3818              		.align	1
 3819              		.global	work_var_updata
 3820              		.syntax unified
 3821              		.thumb
 3822              		.thumb_func
 3823              		.fpu fpv4-sp-d16
 3825              	work_var_updata:
 3826              	.LFB350:
1736:Src/pid.c     **** // ï¿½ï¿½ï¿½Â¿ï¿½ï¿½Æ²ï¿½ï¿½ï¿½
1737:Src/pid.c     **** void work_var_updata(void)
1738:Src/pid.c     **** {
 3827              		.loc 1 1738 0
 3828              		.cfi_startproc
 3829              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 107


 3830              		@ frame_needed = 0, uses_anonymous_args = 0
 3831              		@ link register save eliminated.
 3832 0000 70B4     		push	{r4, r5, r6}
 3833              	.LCFI28:
 3834              		.cfi_def_cfa_offset 12
 3835              		.cfi_offset 4, -12
 3836              		.cfi_offset 5, -8
 3837              		.cfi_offset 6, -4
1739:Src/pid.c     ****   /************************************************************************************************
1740:Src/pid.c     **** 	g_Encode_offset = (int)g_CmdMap[MOT_EANGLE_OFFSET];
 3838              		.loc 1 1740 0
 3839 0002 474A     		ldr	r2, .L279
 3840 0004 B2F84C32 		ldrh	r3, [r2, #588]
 3841 0008 1BB2     		sxth	r3, r3
 3842 000a 4649     		ldr	r1, .L279+4
 3843 000c 0B60     		str	r3, [r1]
1741:Src/pid.c     **** 	if (g_CmdMap[SEV_PARAME_LOCKED] != 0)	 	// ï¿½Ç·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 3844              		.loc 1 1741 0
 3845 000e B2F8A032 		ldrh	r3, [r2, #672]
 3846 0012 1BB2     		sxth	r3, r3
 3847 0014 002B     		cmp	r3, #0
 3848 0016 4CD1     		bne	.L278
1742:Src/pid.c     **** 	{
1743:Src/pid.c     **** 		pid_pos.Kp = g_ThreeLoopParaBefLock[(SEV_POSITION_P)&0x0F];
1744:Src/pid.c     **** 		pid_pos.Ki = g_ThreeLoopParaBefLock[(SEV_POSITION_I)&0x0F];
1745:Src/pid.c     **** 		pid_pos.Kd = 0;
1746:Src/pid.c     **** 		pid_pos.dead_zone = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
1747:Src/pid.c     **** 		
1748:Src/pid.c     **** 		pid_spd.Kp = g_ThreeLoopParaBefLock[(SEV_SPEED_P)&0x0F];
1749:Src/pid.c     **** 		pid_spd.Ki = g_ThreeLoopParaBefLock[(SEV_SPEED_I)&0x0F];
1750:Src/pid.c     **** 		pid_spd.Kd = 0;
1751:Src/pid.c     **** 		pid_spd.dead_zone = g_ThreeLoopParaBefLock[(SEV_SPEED_DS)&0x0F];
1752:Src/pid.c     **** 
1753:Src/pid.c     **** 		pid_IQ.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
1754:Src/pid.c     **** 		pid_IQ.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
1755:Src/pid.c     **** 		pid_IQ.Kd = 0;
1756:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
1757:Src/pid.c     **** 
1758:Src/pid.c     **** 		pid_ID.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
1759:Src/pid.c     **** 		pid_ID.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
1760:Src/pid.c     **** 		pid_ID.Kd = 0;
1761:Src/pid.c     **** 		pid_ID.dead_zone = 4;	
1762:Src/pid.c     **** 
1763:Src/pid.c     **** 		pid_force.Kp = g_ThreeLoopParaBefLock[(SEV_FORCE_P)&0x0F];
1764:Src/pid.c     **** 		pid_force.Ki = g_ThreeLoopParaBefLock[(SEV_FORCE_I)&0x0F];
1765:Src/pid.c     **** 		pid_force.Kd = g_ThreeLoopParaBefLock[(SEV_FORCE_D)&0x0F];
1766:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
1767:Src/pid.c     **** 		gPos_ds = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
1768:Src/pid.c     **** 	}
1769:Src/pid.c     **** 	else
1770:Src/pid.c     **** 	{
1771:Src/pid.c     **** 		pid_pos.Kp = g_CmdMap[SEV_POSITION_P];
 3849              		.loc 1 1771 0
 3850 0018 414B     		ldr	r3, .L279
 3851 001a B3F8B012 		ldrh	r1, [r3, #688]
 3852 001e 09B2     		sxth	r1, r1
 3853 0020 414A     		ldr	r2, .L279+8
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 108


 3854 0022 9160     		str	r1, [r2, #8]
1772:Src/pid.c     **** 		pid_pos.Ki = g_CmdMap[SEV_POSITION_I];
 3855              		.loc 1 1772 0
 3856 0024 B3F8B212 		ldrh	r1, [r3, #690]
 3857 0028 09B2     		sxth	r1, r1
 3858 002a D160     		str	r1, [r2, #12]
1773:Src/pid.c     **** 		pid_pos.Kd = 0;
 3859              		.loc 1 1773 0
 3860 002c 0021     		movs	r1, #0
 3861 002e 1161     		str	r1, [r2, #16]
1774:Src/pid.c     **** 		pid_pos.dead_zone = g_CmdMap[SEV_POSITION_DS];
 3862              		.loc 1 1774 0
 3863 0030 B3F8B602 		ldrh	r0, [r3, #694]
 3864 0034 00B2     		sxth	r0, r0
 3865 0036 5061     		str	r0, [r2, #20]
1775:Src/pid.c     **** 		
1776:Src/pid.c     **** 		pid_spd.Kp = g_CmdMap[SEV_SPEED_P];
 3866              		.loc 1 1776 0
 3867 0038 B3F8A802 		ldrh	r0, [r3, #680]
 3868 003c 00B2     		sxth	r0, r0
 3869 003e 3B4A     		ldr	r2, .L279+12
 3870 0040 9060     		str	r0, [r2, #8]
1777:Src/pid.c     **** 		pid_spd.Ki = g_CmdMap[SEV_SPEED_I];
 3871              		.loc 1 1777 0
 3872 0042 B3F8AA02 		ldrh	r0, [r3, #682]
 3873 0046 00B2     		sxth	r0, r0
 3874 0048 D060     		str	r0, [r2, #12]
1778:Src/pid.c     **** 		pid_spd.Kd = 0;
 3875              		.loc 1 1778 0
 3876 004a 1161     		str	r1, [r2, #16]
1779:Src/pid.c     **** 		pid_spd.dead_zone = g_CmdMap[SEV_SPEED_DS];
 3877              		.loc 1 1779 0
 3878 004c B3F8AE02 		ldrh	r0, [r3, #686]
 3879 0050 00B2     		sxth	r0, r0
 3880 0052 5061     		str	r0, [r2, #20]
1780:Src/pid.c     **** 
1781:Src/pid.c     **** 		pid_IQ.Kp = g_CmdMap[SEV_CURRENT_P];
 3881              		.loc 1 1781 0
 3882 0054 B3F8A202 		ldrh	r0, [r3, #674]
 3883 0058 00B2     		sxth	r0, r0
 3884 005a 354A     		ldr	r2, .L279+16
 3885 005c 9060     		str	r0, [r2, #8]
1782:Src/pid.c     **** 		pid_IQ.Ki = g_CmdMap[SEV_CURRENT_I];
 3886              		.loc 1 1782 0
 3887 005e B3F8A402 		ldrh	r0, [r3, #676]
 3888 0062 00B2     		sxth	r0, r0
 3889 0064 D060     		str	r0, [r2, #12]
1783:Src/pid.c     **** 		pid_IQ.Kd = 0;
 3890              		.loc 1 1783 0
 3891 0066 1161     		str	r1, [r2, #16]
1784:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 3892              		.loc 1 1784 0
 3893 0068 0424     		movs	r4, #4
 3894 006a 5461     		str	r4, [r2, #20]
1785:Src/pid.c     **** 
1786:Src/pid.c     **** 		pid_ID.Kp = g_CmdMap[SEV_CURRENT_P];
 3895              		.loc 1 1786 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 109


 3896 006c B3F8A202 		ldrh	r0, [r3, #674]
 3897 0070 00B2     		sxth	r0, r0
 3898 0072 304A     		ldr	r2, .L279+20
 3899 0074 9060     		str	r0, [r2, #8]
1787:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
 3900              		.loc 1 1787 0
 3901 0076 B3F8A402 		ldrh	r0, [r3, #676]
 3902 007a 00B2     		sxth	r0, r0
 3903 007c D060     		str	r0, [r2, #12]
1788:Src/pid.c     **** 		pid_ID.Kd = 0;
 3904              		.loc 1 1788 0
 3905 007e 1161     		str	r1, [r2, #16]
1789:Src/pid.c     **** 		pid_ID.dead_zone = 4;
 3906              		.loc 1 1789 0
 3907 0080 5461     		str	r4, [r2, #20]
1790:Src/pid.c     **** 		
1791:Src/pid.c     **** 		pid_force.Kp = g_CmdMap[SEV_FORCE_P];
 3908              		.loc 1 1791 0
 3909 0082 B3F8B812 		ldrh	r1, [r3, #696]
 3910 0086 09B2     		sxth	r1, r1
 3911 0088 2B4A     		ldr	r2, .L279+24
 3912 008a 9160     		str	r1, [r2, #8]
1792:Src/pid.c     **** 		pid_force.Ki = g_CmdMap[SEV_FORCE_I];
 3913              		.loc 1 1792 0
 3914 008c B3F8BA12 		ldrh	r1, [r3, #698]
 3915 0090 09B2     		sxth	r1, r1
 3916 0092 D160     		str	r1, [r2, #12]
1793:Src/pid.c     **** 		pid_force.Kd = g_CmdMap[SEV_FORCE_D];
 3917              		.loc 1 1793 0
 3918 0094 B3F8BC12 		ldrh	r1, [r3, #700]
 3919 0098 09B2     		sxth	r1, r1
 3920 009a 1161     		str	r1, [r2, #16]
1794:Src/pid.c     **** 		pid_force.dead_zone = g_CmdMap[SEV_FORCE_DS];
 3921              		.loc 1 1794 0
 3922 009c B3F8BE12 		ldrh	r1, [r3, #702]
 3923 00a0 09B2     		sxth	r1, r1
 3924 00a2 5161     		str	r1, [r2, #20]
1795:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 3925              		.loc 1 1795 0
 3926 00a4 B3F8B632 		ldrh	r3, [r3, #694]
 3927 00a8 1BB2     		sxth	r3, r3
 3928 00aa 244A     		ldr	r2, .L279+28
 3929 00ac 1360     		str	r3, [r2]
 3930              	.L274:
1796:Src/pid.c     **** 	}
1797:Src/pid.c     ****   /**************************************************************************/	
1798:Src/pid.c     **** }
 3931              		.loc 1 1798 0
 3932 00ae 70BC     		pop	{r4, r5, r6}
 3933              	.LCFI29:
 3934              		.cfi_remember_state
 3935              		.cfi_restore 6
 3936              		.cfi_restore 5
 3937              		.cfi_restore 4
 3938              		.cfi_def_cfa_offset 0
 3939 00b0 7047     		bx	lr
 3940              	.L278:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 110


 3941              	.LCFI30:
 3942              		.cfi_restore_state
1743:Src/pid.c     **** 		pid_pos.Ki = g_ThreeLoopParaBefLock[(SEV_POSITION_I)&0x0F];
 3943              		.loc 1 1743 0
 3944 00b2 234B     		ldr	r3, .L279+32
 3945 00b4 B3F91010 		ldrsh	r1, [r3, #16]
 3946 00b8 1B4A     		ldr	r2, .L279+8
 3947 00ba 9160     		str	r1, [r2, #8]
1744:Src/pid.c     **** 		pid_pos.Kd = 0;
 3948              		.loc 1 1744 0
 3949 00bc B3F91210 		ldrsh	r1, [r3, #18]
 3950 00c0 D160     		str	r1, [r2, #12]
1745:Src/pid.c     **** 		pid_pos.dead_zone = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 3951              		.loc 1 1745 0
 3952 00c2 0021     		movs	r1, #0
 3953 00c4 1161     		str	r1, [r2, #16]
1746:Src/pid.c     **** 		
 3954              		.loc 1 1746 0
 3955 00c6 B3F91600 		ldrsh	r0, [r3, #22]
 3956 00ca 5061     		str	r0, [r2, #20]
1748:Src/pid.c     **** 		pid_spd.Ki = g_ThreeLoopParaBefLock[(SEV_SPEED_I)&0x0F];
 3957              		.loc 1 1748 0
 3958 00cc B3F90840 		ldrsh	r4, [r3, #8]
 3959 00d0 164A     		ldr	r2, .L279+12
 3960 00d2 9460     		str	r4, [r2, #8]
1749:Src/pid.c     **** 		pid_spd.Kd = 0;
 3961              		.loc 1 1749 0
 3962 00d4 B3F90A40 		ldrsh	r4, [r3, #10]
 3963 00d8 D460     		str	r4, [r2, #12]
1750:Src/pid.c     **** 		pid_spd.dead_zone = g_ThreeLoopParaBefLock[(SEV_SPEED_DS)&0x0F];
 3964              		.loc 1 1750 0
 3965 00da 1161     		str	r1, [r2, #16]
1751:Src/pid.c     **** 
 3966              		.loc 1 1751 0
 3967 00dc B3F90E40 		ldrsh	r4, [r3, #14]
 3968 00e0 5461     		str	r4, [r2, #20]
1753:Src/pid.c     **** 		pid_IQ.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 3969              		.loc 1 1753 0
 3970 00e2 B3F90260 		ldrsh	r6, [r3, #2]
 3971 00e6 124A     		ldr	r2, .L279+16
 3972 00e8 9660     		str	r6, [r2, #8]
1754:Src/pid.c     **** 		pid_IQ.Kd = 0;
 3973              		.loc 1 1754 0
 3974 00ea B3F90450 		ldrsh	r5, [r3, #4]
 3975 00ee D560     		str	r5, [r2, #12]
1755:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 3976              		.loc 1 1755 0
 3977 00f0 1161     		str	r1, [r2, #16]
1756:Src/pid.c     **** 
 3978              		.loc 1 1756 0
 3979 00f2 0424     		movs	r4, #4
 3980 00f4 5461     		str	r4, [r2, #20]
1758:Src/pid.c     **** 		pid_ID.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 3981              		.loc 1 1758 0
 3982 00f6 0F4A     		ldr	r2, .L279+20
 3983 00f8 9660     		str	r6, [r2, #8]
1759:Src/pid.c     **** 		pid_ID.Kd = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 111


 3984              		.loc 1 1759 0
 3985 00fa D560     		str	r5, [r2, #12]
1760:Src/pid.c     **** 		pid_ID.dead_zone = 4;	
 3986              		.loc 1 1760 0
 3987 00fc 1161     		str	r1, [r2, #16]
1761:Src/pid.c     **** 
 3988              		.loc 1 1761 0
 3989 00fe 5461     		str	r4, [r2, #20]
1763:Src/pid.c     **** 		pid_force.Ki = g_ThreeLoopParaBefLock[(SEV_FORCE_I)&0x0F];
 3990              		.loc 1 1763 0
 3991 0100 B3F91810 		ldrsh	r1, [r3, #24]
 3992 0104 0C4A     		ldr	r2, .L279+24
 3993 0106 9160     		str	r1, [r2, #8]
1764:Src/pid.c     **** 		pid_force.Kd = g_ThreeLoopParaBefLock[(SEV_FORCE_D)&0x0F];
 3994              		.loc 1 1764 0
 3995 0108 B3F91A10 		ldrsh	r1, [r3, #26]
 3996 010c D160     		str	r1, [r2, #12]
1765:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
 3997              		.loc 1 1765 0
 3998 010e B3F91C10 		ldrsh	r1, [r3, #28]
 3999 0112 1161     		str	r1, [r2, #16]
1766:Src/pid.c     **** 		gPos_ds = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 4000              		.loc 1 1766 0
 4001 0114 B3F91E30 		ldrsh	r3, [r3, #30]
 4002 0118 5361     		str	r3, [r2, #20]
1767:Src/pid.c     **** 	}
 4003              		.loc 1 1767 0
 4004 011a 084B     		ldr	r3, .L279+28
 4005 011c 1860     		str	r0, [r3]
 4006 011e C6E7     		b	.L274
 4007              	.L280:
 4008              		.align	2
 4009              	.L279:
 4010 0120 00000000 		.word	g_CmdMap
 4011 0124 00000000 		.word	g_Encode_offset
 4012 0128 00000000 		.word	pid_pos
 4013 012c 00000000 		.word	pid_spd
 4014 0130 00000000 		.word	pid_IQ
 4015 0134 00000000 		.word	pid_ID
 4016 0138 00000000 		.word	pid_force
 4017 013c 00000000 		.word	gPos_ds
 4018 0140 00000000 		.word	g_ThreeLoopParaBefLock
 4019              		.cfi_endproc
 4020              	.LFE350:
 4022              		.section	.text.EXTI3_IRQHandler,"ax",%progbits
 4023              		.align	1
 4024              		.global	EXTI3_IRQHandler
 4025              		.syntax unified
 4026              		.thumb
 4027              		.thumb_func
 4028              		.fpu fpv4-sp-d16
 4030              	EXTI3_IRQHandler:
 4031              	.LFB351:
1799:Src/pid.c     **** 
1800:Src/pid.c     **** 
1801:Src/pid.c     **** // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½ï¿½ï¿½ï¿½Ð¶ï¿½ 2KHz
1802:Src/pid.c     **** void EXTI3_IRQHandler(void)
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 112


1803:Src/pid.c     **** {
 4032              		.loc 1 1803 0
 4033              		.cfi_startproc
 4034              		@ args = 0, pretend = 0, frame = 0
 4035              		@ frame_needed = 0, uses_anonymous_args = 0
 4036 0000 08B5     		push	{r3, lr}
 4037              	.LCFI31:
 4038              		.cfi_def_cfa_offset 8
 4039              		.cfi_offset 3, -8
 4040              		.cfi_offset 14, -4
1804:Src/pid.c     ****  // if(EXTI_GetITStatus(EXTI_Line3) != RESET)
1805:Src/pid.c     ****   {
1806:Src/pid.c     **** 		//LED2_TOOGLE();
1807:Src/pid.c     **** 		EXTI->PR1 |= 0x0008;		// ï¿½ï¿½ï¿½ï¿½ï¿½Ö¾
 4041              		.loc 1 1807 0
 4042 0002 044A     		ldr	r2, .L283
 4043 0004 5369     		ldr	r3, [r2, #20]
 4044 0006 43F00803 		orr	r3, r3, #8
 4045 000a 5361     		str	r3, [r2, #20]
1808:Src/pid.c     ****     Pos_Spd_PID();  // ï¿½ï¿½ï¿½ï¿½Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½				
 4046              		.loc 1 1808 0
 4047 000c FFF7FEFF 		bl	Pos_Spd_PID
 4048              	.LVL215:
1809:Src/pid.c     **** 		//UpdateErrorStateLED(); 		
1810:Src/pid.c     ****   }
1811:Src/pid.c     **** }
 4049              		.loc 1 1811 0
 4050 0010 08BD     		pop	{r3, pc}
 4051              	.L284:
 4052 0012 00BF     		.align	2
 4053              	.L283:
 4054 0014 00040140 		.word	1073808384
 4055              		.cfi_endproc
 4056              	.LFE351:
 4058              		.global	Vel_PPS_raw1
 4059              		.comm	hall_total_time,8,8
 4060              		.global	hall_previous_3_time
 4061              		.global	hall_previous_2_time
 4062              		.global	hall_previous_1_time
 4063              		.global	hall_now_time
 4064              		.global	hall_cnt
 4065              		.global	hall_speed_sample_timeout
 4066              		.global	hall_speed_sample_cnt
 4067              		.global	hall_speed_sample_timeout_cnt
 4068              		.global	last_time4_capture_ch1
 4069              		.global	pid_hall_sample_time_index
 4070              		.comm	pid_hall_sample_time_point,40,4
 4071              		.comm	speed3,4,4
 4072              		.comm	speed2,4,4
 4073              		.comm	speed1,4,4
 4074              		.global	last_hall_sample_time
 4075              		.comm	pid_last_hall_ture_value1,4,4
 4076              		.comm	pid_hall_ture_value1,4,4
 4077              		.global	ServoPro_En_count
 4078              		.global	shunt_conductance
 4079              		.global	phase_current_rev_gain_
 4080              		.global	last_beta
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 113


 4081              		.global	last_alpha
 4082              		.comm	delata_beta,4,4
 4083              		.comm	delta_alpha,4,4
 4084              		.comm	I_Beta,4,4
 4085              		.comm	I_Alpha,4,4
 4086              		.global	s_Disable_Delay
 4087              		.comm	integre_observer_ElectricAngle,4,4
 4088              		.comm	observer_speed,4,4
 4089              		.comm	observer_ElectricAngle,4,4
 4090              		.comm	temp_L,4,4
 4091              		.comm	L,4,4
 4092              		.global	v
 4093              		.comm	pid_pll,72,8
 4094              		.comm	pid_pos,72,8
 4095              		.comm	pid_spd,72,8
 4096              		.comm	pid_force,72,8
 4097              		.comm	pid_ID,72,8
 4098              		.comm	pid_IQ,72,8
 4099              		.global	pos_error_to_target
 4100              		.global	T_t_1
 4101              		.global	T_t
 4102              		.global	Para_Identificaion
 4103              		.global	index_I_phase
 4104              		.global	I_phase
 4105              		.global	motor_para_identification_count_Tms
 4106              		.global	sin_wave_t_us
 4107              		.global	Test_dirt_last
 4108              		.global	Test_dirt
 4109              		.global	Test_perm
 4110              		.global	Flag_Set_OpenLen
 4111              		.global	Brake_rellease_delay_cnt
 4112              		.global	Brake_rellease_delay
 4113              		.global	Grriper_Run_off_delay_cnt
 4114              		.global	Grriper_Run_on_delay_cnt
 4115              		.global	Grriper_Run_last
 4116              		.global	Grriper_Run
 4117              		.global	Grriper_Ready
 4118              		.global	Spd_RPM_CatchLimit
 4119              		.comm	g_Z,4,4
 4120              		.comm	g_Y,4,4
 4121              		.comm	g_X,4,4
 4122              		.global	g_decLen
 4123              		.comm	anlge_reg,2,2
 4124              		.global	g_spd_error
 4125              		.comm	time4_capture_ch1,4,4
 4126              		.global	PosAtDead_Flag_Last
 4127              		.global	PosAtDead_Flag
 4128              		.global	g_posPID_e
 4129              		.global	g_testAngle
 4130              		.global	V_SetTotal
 4131              		.global	V_AddReg
 4132              		.global	g_Pos_Spd
 4133              		.global	g_Pos_PID_16BIT
 4134              		.global	Speed_I_out
 4135              		.global	Speed_P_out
 4136              		.global	g_Pos_Icnt
 4137              		.global	g_Spd_Icnt
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 114


 4138              		.global	g_Sector
 4139              		.global	g_V_Beta
 4140              		.global	g_V_Alpha
 4141              		.global	g_Vd_Pu
 4142              		.global	g_Vq_Pu
 4143              		.global	g_Vd
 4144              		.global	g_Vq
 4145              		.global	g_Id_sum
 4146              		.global	g_Iq_sum
 4147              		.global	g_I_Array_Index_Invalid
 4148              		.global	g_I_Array_Index
 4149              		.global	g_Id_Array
 4150              		.global	g_Iq_Array
 4151              		.comm	g_Id_filter,4,4
 4152              		.comm	g_Iq_filter,4,4
 4153              		.global	g_Id
 4154              		.global	g_Iq
 4155              		.global	g_Sum_ABC
 4156              		.global	g_IC_Raw
 4157              		.global	g_IC
 4158              		.global	g_IB_Raw
 4159              		.global	g_IB
 4160              		.global	g_IA_Raw
 4161              		.global	g_IA
 4162              		.section	.bss.Brake_rellease_delay,"aw",%nobits
 4165              	Brake_rellease_delay:
 4166 0000 00       		.space	1
 4167              		.section	.bss.Brake_rellease_delay_cnt,"aw",%nobits
 4168              		.align	2
 4171              	Brake_rellease_delay_cnt:
 4172 0000 00000000 		.space	4
 4173              		.section	.bss.Flag_Set_OpenLen,"aw",%nobits
 4174              		.set	.LANCHOR24,. + 0
 4177              	Flag_Set_OpenLen:
 4178 0000 00       		.space	1
 4179              		.section	.bss.Grriper_Ready,"aw",%nobits
 4182              	Grriper_Ready:
 4183 0000 00       		.space	1
 4184              		.section	.bss.Grriper_Run,"aw",%nobits
 4185              		.set	.LANCHOR23,. + 0
 4188              	Grriper_Run:
 4189 0000 00       		.space	1
 4190              		.section	.bss.Grriper_Run_last,"aw",%nobits
 4191              		.set	.LANCHOR25,. + 0
 4194              	Grriper_Run_last:
 4195 0000 00       		.space	1
 4196              		.section	.bss.Grriper_Run_off_delay_cnt,"aw",%nobits
 4197              		.align	2
 4200              	Grriper_Run_off_delay_cnt:
 4201 0000 00000000 		.space	4
 4202              		.section	.bss.Grriper_Run_on_delay_cnt,"aw",%nobits
 4203              		.align	2
 4206              	Grriper_Run_on_delay_cnt:
 4207 0000 00000000 		.space	4
 4208              		.section	.bss.I_phase,"aw",%nobits
 4209              		.align	2
 4210              		.set	.LANCHOR7,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 115


 4213              	I_phase:
 4214 0000 00000000 		.space	1200
 4214      00000000 
 4214      00000000 
 4214      00000000 
 4214      00000000 
 4215              		.section	.bss.Para_Identificaion,"aw",%nobits
 4216              		.align	2
 4217              		.set	.LANCHOR4,. + 0
 4220              	Para_Identificaion:
 4221 0000 00000000 		.space	4
 4222              		.section	.bss.PlusPosition_flag.12079,"aw",%nobits
 4223              		.set	.LANCHOR36,. + 0
 4226              	PlusPosition_flag.12079:
 4227 0000 00       		.space	1
 4228              		.section	.bss.PosAtDead_Flag,"aw",%nobits
 4229              		.set	.LANCHOR21,. + 0
 4232              	PosAtDead_Flag:
 4233 0000 00       		.space	1
 4234              		.section	.bss.PosAtDead_Flag_Last,"aw",%nobits
 4235              		.set	.LANCHOR22,. + 0
 4238              	PosAtDead_Flag_Last:
 4239 0000 00       		.space	1
 4240              		.section	.bss.ServoPro_En_count,"aw",%nobits
 4241              		.align	2
 4244              	ServoPro_En_count:
 4245 0000 00000000 		.space	4
 4246              		.section	.bss.Spd_RPM_CatchLimit,"aw",%nobits
 4247              		.align	1
 4250              	Spd_RPM_CatchLimit:
 4251 0000 0000     		.space	2
 4252              		.section	.bss.Speed_I_out,"aw",%nobits
 4253              		.align	2
 4256              	Speed_I_out:
 4257 0000 00000000 		.space	4
 4258              		.section	.bss.Speed_P_out,"aw",%nobits
 4259              		.align	2
 4262              	Speed_P_out:
 4263 0000 00000000 		.space	4
 4264              		.section	.bss.T_t,"aw",%nobits
 4265              		.align	3
 4266              		.set	.LANCHOR10,. + 0
 4269              	T_t:
 4270 0000 00000000 		.space	8
 4270      00000000 
 4271              		.section	.bss.T_t_1,"aw",%nobits
 4272              		.align	3
 4273              		.set	.LANCHOR11,. + 0
 4276              	T_t_1:
 4277 0000 00000000 		.space	8
 4277      00000000 
 4278              		.section	.bss.Test_perm,"aw",%nobits
 4279              		.set	.LANCHOR18,. + 0
 4282              	Test_perm:
 4283 0000 00       		.space	1
 4284              		.section	.bss.V_AddReg,"aw",%nobits
 4285              		.align	2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 116


 4288              	V_AddReg:
 4289 0000 00000000 		.space	4
 4290              		.section	.bss.V_SetTotal,"aw",%nobits
 4291              		.align	2
 4294              	V_SetTotal:
 4295 0000 00000000 		.space	4
 4296              		.section	.bss.Vel_PPS_raw1,"aw",%nobits
 4297              		.align	3
 4300              	Vel_PPS_raw1:
 4301 0000 00000000 		.space	8
 4301      00000000 
 4302              		.section	.bss.delay_cnt.11974,"aw",%nobits
 4303              		.align	1
 4304              		.set	.LANCHOR20,. + 0
 4307              	delay_cnt.11974:
 4308 0000 0000     		.space	2
 4309              		.section	.bss.g_IA,"aw",%nobits
 4310              		.align	1
 4311              		.set	.LANCHOR30,. + 0
 4314              	g_IA:
 4315 0000 0000     		.space	2
 4316              		.section	.bss.g_IA_Raw,"aw",%nobits
 4317              		.align	1
 4318              		.set	.LANCHOR6,. + 0
 4321              	g_IA_Raw:
 4322 0000 0000     		.space	2
 4323              		.section	.bss.g_IB,"aw",%nobits
 4324              		.align	1
 4325              		.set	.LANCHOR28,. + 0
 4328              	g_IB:
 4329 0000 0000     		.space	2
 4330              		.section	.bss.g_IB_Raw,"aw",%nobits
 4331              		.align	1
 4332              		.set	.LANCHOR8,. + 0
 4335              	g_IB_Raw:
 4336 0000 0000     		.space	2
 4337              		.section	.bss.g_IC,"aw",%nobits
 4338              		.align	1
 4339              		.set	.LANCHOR29,. + 0
 4342              	g_IC:
 4343 0000 0000     		.space	2
 4344              		.section	.bss.g_IC_Raw,"aw",%nobits
 4345              		.align	1
 4346              		.set	.LANCHOR9,. + 0
 4349              	g_IC_Raw:
 4350 0000 0000     		.space	2
 4351              		.section	.bss.g_I_Array_Index,"aw",%nobits
 4352              		.align	2
 4355              	g_I_Array_Index:
 4356 0000 00000000 		.space	4
 4357              		.section	.bss.g_I_Array_Index_Invalid,"aw",%nobits
 4358              		.align	2
 4361              	g_I_Array_Index_Invalid:
 4362 0000 00000000 		.space	4
 4363              		.section	.bss.g_Id,"aw",%nobits
 4364              		.align	2
 4365              		.set	.LANCHOR34,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 117


 4368              	g_Id:
 4369 0000 00000000 		.space	4
 4370              		.section	.bss.g_Id_Array,"aw",%nobits
 4371              		.align	2
 4374              	g_Id_Array:
 4375 0000 00000000 		.space	2048
 4375      00000000 
 4375      00000000 
 4375      00000000 
 4375      00000000 
 4376              		.section	.bss.g_Id_sum,"aw",%nobits
 4377              		.align	2
 4380              	g_Id_sum:
 4381 0000 00000000 		.space	4
 4382              		.section	.bss.g_Iq,"aw",%nobits
 4383              		.align	2
 4384              		.set	.LANCHOR33,. + 0
 4387              	g_Iq:
 4388 0000 00000000 		.space	4
 4389              		.section	.bss.g_Iq_Array,"aw",%nobits
 4390              		.align	2
 4393              	g_Iq_Array:
 4394 0000 00000000 		.space	2048
 4394      00000000 
 4394      00000000 
 4394      00000000 
 4394      00000000 
 4395              		.section	.bss.g_Iq_sum,"aw",%nobits
 4396              		.align	2
 4399              	g_Iq_sum:
 4400 0000 00000000 		.space	4
 4401              		.section	.bss.g_Pos_Icnt,"aw",%nobits
 4402              		.align	3
 4405              	g_Pos_Icnt:
 4406 0000 00000000 		.space	8
 4406      00000000 
 4407              		.section	.bss.g_Pos_PID_16BIT,"aw",%nobits
 4408              		.align	2
 4411              	g_Pos_PID_16BIT:
 4412 0000 00000000 		.space	4
 4413              		.section	.bss.g_Pos_Spd,"aw",%nobits
 4414              		.align	2
 4417              	g_Pos_Spd:
 4418 0000 00000000 		.space	4
 4419              		.section	.bss.g_Sector,"aw",%nobits
 4420              		.align	2
 4421              		.set	.LANCHOR15,. + 0
 4424              	g_Sector:
 4425 0000 00000000 		.space	4
 4426              		.section	.bss.g_Spd_Icnt,"aw",%nobits
 4427              		.align	2
 4430              	g_Spd_Icnt:
 4431 0000 00000000 		.space	4
 4432              		.section	.bss.g_Sum_ABC,"aw",%nobits
 4433              		.align	1
 4436              	g_Sum_ABC:
 4437 0000 0000     		.space	2
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 118


 4438              		.section	.bss.g_V_Alpha,"aw",%nobits
 4439              		.align	2
 4440              		.set	.LANCHOR13,. + 0
 4443              	g_V_Alpha:
 4444 0000 00000000 		.space	4
 4445              		.section	.bss.g_V_Beta,"aw",%nobits
 4446              		.align	2
 4447              		.set	.LANCHOR14,. + 0
 4450              	g_V_Beta:
 4451 0000 00000000 		.space	4
 4452              		.section	.bss.g_Vd,"aw",%nobits
 4453              		.align	2
 4454              		.set	.LANCHOR1,. + 0
 4457              	g_Vd:
 4458 0000 00000000 		.space	4
 4459              		.section	.bss.g_Vd_Pu,"aw",%nobits
 4460              		.align	2
 4463              	g_Vd_Pu:
 4464 0000 00000000 		.space	4
 4465              		.section	.bss.g_Vq,"aw",%nobits
 4466              		.align	2
 4467              		.set	.LANCHOR0,. + 0
 4470              	g_Vq:
 4471 0000 00000000 		.space	4
 4472              		.section	.bss.g_Vq_Pu,"aw",%nobits
 4473              		.align	2
 4476              	g_Vq_Pu:
 4477 0000 00000000 		.space	4
 4478              		.section	.bss.g_decLen,"aw",%nobits
 4479              		.align	2
 4482              	g_decLen:
 4483 0000 00000000 		.space	4
 4484              		.section	.bss.g_posPID_e,"aw",%nobits
 4485              		.align	2
 4488              	g_posPID_e:
 4489 0000 00000000 		.space	4
 4490              		.section	.bss.g_spd_error,"aw",%nobits
 4491              		.align	2
 4494              	g_spd_error:
 4495 0000 00000000 		.space	4
 4496              		.section	.bss.g_testAngle,"aw",%nobits
 4497              		.align	1
 4500              	g_testAngle:
 4501 0000 0000     		.space	2
 4502              		.section	.bss.hall_cnt,"aw",%nobits
 4503              		.align	2
 4506              	hall_cnt:
 4507 0000 00000000 		.space	4
 4508              		.section	.bss.hall_now_time,"aw",%nobits
 4509              		.align	2
 4512              	hall_now_time:
 4513 0000 00000000 		.space	4
 4514              		.section	.bss.hall_previous_1_time,"aw",%nobits
 4515              		.align	2
 4518              	hall_previous_1_time:
 4519 0000 00000000 		.space	4
 4520              		.section	.bss.hall_previous_2_time,"aw",%nobits
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 119


 4521              		.align	2
 4524              	hall_previous_2_time:
 4525 0000 00000000 		.space	4
 4526              		.section	.bss.hall_previous_3_time,"aw",%nobits
 4527              		.align	2
 4530              	hall_previous_3_time:
 4531 0000 00000000 		.space	4
 4532              		.section	.bss.hall_speed_sample_cnt,"aw",%nobits
 4533              		.align	2
 4536              	hall_speed_sample_cnt:
 4537 0000 00000000 		.space	4
 4538              		.section	.bss.hall_speed_sample_timeout,"aw",%nobits
 4539              		.align	2
 4542              	hall_speed_sample_timeout:
 4543 0000 00000000 		.space	4
 4544              		.section	.bss.hall_speed_sample_timeout_cnt,"aw",%nobits
 4545              		.align	2
 4548              	hall_speed_sample_timeout_cnt:
 4549 0000 00000000 		.space	4
 4550              		.section	.bss.index_I_phase,"aw",%nobits
 4551              		.align	2
 4552              		.set	.LANCHOR5,. + 0
 4555              	index_I_phase:
 4556 0000 00000000 		.space	4
 4557              		.section	.bss.last_alpha,"aw",%nobits
 4558              		.align	2
 4559              		.set	.LANCHOR31,. + 0
 4562              	last_alpha:
 4563 0000 00000000 		.space	4
 4564              		.section	.bss.last_beta,"aw",%nobits
 4565              		.align	2
 4566              		.set	.LANCHOR32,. + 0
 4569              	last_beta:
 4570 0000 00000000 		.space	4
 4571              		.section	.bss.last_hall_sample_time,"aw",%nobits
 4572              		.align	2
 4575              	last_hall_sample_time:
 4576 0000 00000000 		.space	4
 4577              		.section	.bss.last_time4_capture_ch1,"aw",%nobits
 4578              		.align	2
 4581              	last_time4_capture_ch1:
 4582 0000 00000000 		.space	4
 4583              		.section	.bss.motor_para_identification_count_Tms,"aw",%nobits
 4584              		.align	2
 4585              		.set	.LANCHOR2,. + 0
 4588              	motor_para_identification_count_Tms:
 4589 0000 00000000 		.space	4
 4590              		.section	.bss.pid_hall_sample_time_index,"aw",%nobits
 4591              		.align	2
 4594              	pid_hall_sample_time_index:
 4595 0000 00000000 		.space	4
 4596              		.section	.bss.pos_error_to_target,"aw",%nobits
 4597              		.align	2
 4598              		.set	.LANCHOR19,. + 0
 4601              	pos_error_to_target:
 4602 0000 00000000 		.space	4
 4603              		.section	.bss.s_Disable_Delay,"aw",%nobits
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 120


 4604              		.align	2
 4605              		.set	.LANCHOR40,. + 0
 4608              	s_Disable_Delay:
 4609 0000 00000000 		.space	4
 4610              		.section	.bss.s_Enable_Delay.12013,"aw",%nobits
 4611              		.align	2
 4612              		.set	.LANCHOR39,. + 0
 4615              	s_Enable_Delay.12013:
 4616 0000 00000000 		.space	4
 4617              		.section	.bss.s_count.12012,"aw",%nobits
 4618              		.align	2
 4619              		.set	.LANCHOR38,. + 0
 4622              	s_count.12012:
 4623 0000 00000000 		.space	4
 4624              		.section	.bss.s_count.12080,"aw",%nobits
 4625              		.align	2
 4626              		.set	.LANCHOR37,. + 0
 4629              	s_count.12080:
 4630 0000 00000000 		.space	4
 4631              		.section	.bss.s_test_speed_t_count.11969,"aw",%nobits
 4632              		.align	2
 4633              		.set	.LANCHOR17,. + 0
 4636              	s_test_speed_t_count.11969:
 4637 0000 00000000 		.space	4
 4638              		.section	.bss.sin_wave_t_us,"aw",%nobits
 4639              		.align	2
 4640              		.set	.LANCHOR3,. + 0
 4643              	sin_wave_t_us:
 4644 0000 00000000 		.space	4
 4645              		.section	.bss.test.11957,"aw",%nobits
 4646              		.align	1
 4647              		.set	.LANCHOR12,. + 0
 4650              	test.11957:
 4651 0000 0000     		.space	2
 4652              		.section	.data.Test_dirt,"aw",%progbits
 4653              		.align	2
 4654              		.set	.LANCHOR16,. + 0
 4657              	Test_dirt:
 4658 0000 01000000 		.word	1
 4659              		.section	.data.Test_dirt_last,"aw",%progbits
 4660              		.align	2
 4663              	Test_dirt_last:
 4664 0000 01000000 		.word	1
 4665              		.section	.data.phase_current_rev_gain_,"aw",%progbits
 4666              		.align	2
 4667              		.set	.LANCHOR26,. + 0
 4670              	phase_current_rev_gain_:
 4671 0000 103EF83C 		.word	1022901776
 4672              		.section	.data.shunt_conductance,"aw",%progbits
 4673              		.align	2
 4674              		.set	.LANCHOR27,. + 0
 4677              	shunt_conductance:
 4678 0000 0000C842 		.word	1120403456
 4679              		.section	.data.v,"aw",%progbits
 4680              		.align	2
 4681              		.set	.LANCHOR35,. + 0
 4684              	v:
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 121


 4685 0000 A4703D41 		.word	1094545572
 4686              		.text
 4687              	.Letext0:
 4688              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4689              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4690              		.file 4 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 4691              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 4692              		.file 6 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/system_stm32g4xx.h"
 4693              		.file 7 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 4694              		.file 8 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g4xx.h"
 4695              		.file 9 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 4696              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 4697              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc.h"
 4698              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_exti.h"
 4699              		.file 13 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_flash.h"
 4700              		.file 14 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 4701              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim.h"
 4702              		.file 16 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 4703              		.file 17 "Inc/pid.h"
 4704              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4705              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4706              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 4707              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4708              		.file 22 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4709              		.file 23 "Inc/uart.h"
 4710              		.file 24 "Inc/pwm.h"
 4711              		.file 25 "Inc/spi_MEncoder.h"
 4712              		.file 26 "Inc/adc.h"
 4713              		.file 27 "Inc/stm32_math_sin.h"
 4714              		.file 28 "Inc/profile_joint.h"
 4715              		.file 29 "Inc/icmu.h"
 4716              		.file 30 "Inc/performance_test.h"
 4717              		.file 31 "Inc/global.h"
 4718              		.file 32 "Inc/parameter_identification.h"
 4719              		.file 33 "Inc/stm32_math.h"
 4720              		.file 34 "Inc/security.h"
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 122


DEFINED SYMBOLS
                            *ABS*:00000000 pid.c
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:18     .text.OpenLoop:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:24     .text.OpenLoop:00000000 OpenLoop
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:124    .text.OpenLoop:0000009c $d
                            *COM*:00000002 anlge_reg
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:142    .text.Calculate_CCR_SVP:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:148    .text.Calculate_CCR_SVP:00000000 Calculate_CCR_SVP
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:176    .text.Calculate_CCR_SVP:00000012 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:182    .text.Calculate_CCR_SVP:00000018 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:542    .text.Calculate_CCR_SVP:00000228 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:562    .text.PID_ini:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:569    .text.PID_ini:00000000 PID_ini
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:594    .text.PID_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:601    .text.PID_control:00000000 PID_control
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:825    .text.PID_control:00000138 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:832    .text.CurrentPID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:838    .text.CurrentPID:00000000 CurrentPID
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1230   .text.CurrentPID:000002a4 $d
                            *COM*:00000048 pid_spd
                            *COM*:00000048 pid_IQ
                            *COM*:00000048 pid_ID
                            *COM*:00000004 g_X
                            *COM*:00000004 g_Y
                            *COM*:00000004 g_Z
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1252   .text.CurrentPID:000002f4 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1397   .text.CurrentPID:000003f4 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1404   .text.ForcePID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1410   .text.ForcePID:00000000 ForcePID
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1577   .text.ForcePID:00000124 $d
                            *COM*:00000048 pid_force
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1587   .text.force_PID_out:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1594   .text.force_PID_out:00000000 force_PID_out
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1654   .text.SpeedPID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1660   .text.SpeedPID:00000000 SpeedPID
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:1996   .text.SpeedPID:0000026c $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2005   .text.SpeedPID:00000288 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2145   .text.SpeedPID:00000380 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2154   .text.PositionPID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2161   .text.PositionPID:00000000 PositionPID
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2307   .text.PositionPID:000000dc $d
                            *COM*:00000048 pid_pos
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2320   .text.Gripper_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2327   .text.Gripper_control:00000000 Gripper_control
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2582   .text.Gripper_control:00000180 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2601   .text.phase_current_from_adcval:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2608   .text.phase_current_from_adcval:00000000 phase_current_from_adcval
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2638   .text.phase_current_from_adcval:00000028 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2645   .text.GetCurrent:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2652   .text.GetCurrent:00000000 GetCurrent
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2869   .text.GetCurrent:00000170 $d
                            *COM*:00000004 I_Alpha
                            *COM*:00000004 I_Beta
                            *COM*:00000004 delta_alpha
                            *COM*:00000004 delata_beta
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2898   .text.park_transform:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2905   .text.park_transform:00000000 park_transform
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 123


C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2971   .text.park_transform:00000054 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2979   .text.hfi_update_angle:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:2986   .text.hfi_update_angle:00000000 hfi_update_angle
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3201   .text.hfi_update_angle:00000180 $d
                            *COM*:00000048 pid_pll
                            *COM*:00000004 L
                            *COM*:00000004 temp_L
                            *COM*:00000004 observer_ElectricAngle
                            *COM*:00000004 observer_speed
                            *COM*:00000004 integre_observer_ElectricAngle
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3230   .text.ServoPro_Fast:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3237   .text.ServoPro_Fast:00000000 ServoPro_Fast
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3354   .text.ServoPro_Fast:0000009c $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3366   .text.Loop3_EnableManage:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3373   .text.Loop3_EnableManage:00000000 Loop3_EnableManage
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3527   .text.Loop3_EnableManage:000000ec $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3538   .text.Pos_Spd_PID:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3544   .text.Pos_Spd_PID:00000000 Pos_Spd_PID
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3801   .text.Pos_Spd_PID:0000018c $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3818   .text.work_var_updata:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:3825   .text.work_var_updata:00000000 work_var_updata
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4010   .text.work_var_updata:00000120 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4023   .text.EXTI3_IRQHandler:00000000 $t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4030   .text.EXTI3_IRQHandler:00000000 EXTI3_IRQHandler
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4054   .text.EXTI3_IRQHandler:00000014 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4300   .bss.Vel_PPS_raw1:00000000 Vel_PPS_raw1
                            *COM*:00000008 hall_total_time
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4530   .bss.hall_previous_3_time:00000000 hall_previous_3_time
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4524   .bss.hall_previous_2_time:00000000 hall_previous_2_time
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4518   .bss.hall_previous_1_time:00000000 hall_previous_1_time
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4512   .bss.hall_now_time:00000000 hall_now_time
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4506   .bss.hall_cnt:00000000 hall_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4542   .bss.hall_speed_sample_timeout:00000000 hall_speed_sample_timeout
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4536   .bss.hall_speed_sample_cnt:00000000 hall_speed_sample_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4548   .bss.hall_speed_sample_timeout_cnt:00000000 hall_speed_sample_timeout_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4581   .bss.last_time4_capture_ch1:00000000 last_time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4594   .bss.pid_hall_sample_time_index:00000000 pid_hall_sample_time_index
                            *COM*:00000028 pid_hall_sample_time_point
                            *COM*:00000004 speed3
                            *COM*:00000004 speed2
                            *COM*:00000004 speed1
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4575   .bss.last_hall_sample_time:00000000 last_hall_sample_time
                            *COM*:00000004 pid_last_hall_ture_value1
                            *COM*:00000004 pid_hall_ture_value1
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4244   .bss.ServoPro_En_count:00000000 ServoPro_En_count
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4677   .data.shunt_conductance:00000000 shunt_conductance
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4670   .data.phase_current_rev_gain_:00000000 phase_current_rev_gain_
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4569   .bss.last_beta:00000000 last_beta
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4562   .bss.last_alpha:00000000 last_alpha
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4608   .bss.s_Disable_Delay:00000000 s_Disable_Delay
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4684   .data.v:00000000 v
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4601   .bss.pos_error_to_target:00000000 pos_error_to_target
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4276   .bss.T_t_1:00000000 T_t_1
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4269   .bss.T_t:00000000 T_t
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4220   .bss.Para_Identificaion:00000000 Para_Identificaion
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4555   .bss.index_I_phase:00000000 index_I_phase
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4213   .bss.I_phase:00000000 I_phase
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 124


C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4588   .bss.motor_para_identification_count_Tms:00000000 motor_para_identification_count_Tms
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4643   .bss.sin_wave_t_us:00000000 sin_wave_t_us
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4663   .data.Test_dirt_last:00000000 Test_dirt_last
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4657   .data.Test_dirt:00000000 Test_dirt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4282   .bss.Test_perm:00000000 Test_perm
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4177   .bss.Flag_Set_OpenLen:00000000 Flag_Set_OpenLen
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4171   .bss.Brake_rellease_delay_cnt:00000000 Brake_rellease_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4165   .bss.Brake_rellease_delay:00000000 Brake_rellease_delay
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4200   .bss.Grriper_Run_off_delay_cnt:00000000 Grriper_Run_off_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4206   .bss.Grriper_Run_on_delay_cnt:00000000 Grriper_Run_on_delay_cnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4194   .bss.Grriper_Run_last:00000000 Grriper_Run_last
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4188   .bss.Grriper_Run:00000000 Grriper_Run
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4182   .bss.Grriper_Ready:00000000 Grriper_Ready
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4250   .bss.Spd_RPM_CatchLimit:00000000 Spd_RPM_CatchLimit
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4482   .bss.g_decLen:00000000 g_decLen
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4494   .bss.g_spd_error:00000000 g_spd_error
                            *COM*:00000004 time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4238   .bss.PosAtDead_Flag_Last:00000000 PosAtDead_Flag_Last
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4232   .bss.PosAtDead_Flag:00000000 PosAtDead_Flag
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4488   .bss.g_posPID_e:00000000 g_posPID_e
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4500   .bss.g_testAngle:00000000 g_testAngle
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4294   .bss.V_SetTotal:00000000 V_SetTotal
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4288   .bss.V_AddReg:00000000 V_AddReg
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4417   .bss.g_Pos_Spd:00000000 g_Pos_Spd
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4411   .bss.g_Pos_PID_16BIT:00000000 g_Pos_PID_16BIT
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4256   .bss.Speed_I_out:00000000 Speed_I_out
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4262   .bss.Speed_P_out:00000000 Speed_P_out
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4405   .bss.g_Pos_Icnt:00000000 g_Pos_Icnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4430   .bss.g_Spd_Icnt:00000000 g_Spd_Icnt
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4424   .bss.g_Sector:00000000 g_Sector
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4450   .bss.g_V_Beta:00000000 g_V_Beta
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4443   .bss.g_V_Alpha:00000000 g_V_Alpha
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4463   .bss.g_Vd_Pu:00000000 g_Vd_Pu
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4476   .bss.g_Vq_Pu:00000000 g_Vq_Pu
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4457   .bss.g_Vd:00000000 g_Vd
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4470   .bss.g_Vq:00000000 g_Vq
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4380   .bss.g_Id_sum:00000000 g_Id_sum
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4399   .bss.g_Iq_sum:00000000 g_Iq_sum
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4361   .bss.g_I_Array_Index_Invalid:00000000 g_I_Array_Index_Invalid
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4355   .bss.g_I_Array_Index:00000000 g_I_Array_Index
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4374   .bss.g_Id_Array:00000000 g_Id_Array
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4393   .bss.g_Iq_Array:00000000 g_Iq_Array
                            *COM*:00000004 g_Id_filter
                            *COM*:00000004 g_Iq_filter
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4368   .bss.g_Id:00000000 g_Id
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4387   .bss.g_Iq:00000000 g_Iq
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4436   .bss.g_Sum_ABC:00000000 g_Sum_ABC
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4349   .bss.g_IC_Raw:00000000 g_IC_Raw
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4342   .bss.g_IC:00000000 g_IC
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4335   .bss.g_IB_Raw:00000000 g_IB_Raw
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4328   .bss.g_IB:00000000 g_IB
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4321   .bss.g_IA_Raw:00000000 g_IA_Raw
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4314   .bss.g_IA:00000000 g_IA
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4166   .bss.Brake_rellease_delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4168   .bss.Brake_rellease_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4178   .bss.Flag_Set_OpenLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4183   .bss.Grriper_Ready:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 125


C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4189   .bss.Grriper_Run:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4195   .bss.Grriper_Run_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4197   .bss.Grriper_Run_off_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4203   .bss.Grriper_Run_on_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4209   .bss.I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4216   .bss.Para_Identificaion:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4226   .bss.PlusPosition_flag.12079:00000000 PlusPosition_flag.12079
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4227   .bss.PlusPosition_flag.12079:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4233   .bss.PosAtDead_Flag:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4239   .bss.PosAtDead_Flag_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4241   .bss.ServoPro_En_count:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4247   .bss.Spd_RPM_CatchLimit:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4253   .bss.Speed_I_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4259   .bss.Speed_P_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4265   .bss.T_t:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4272   .bss.T_t_1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4283   .bss.Test_perm:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4285   .bss.V_AddReg:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4291   .bss.V_SetTotal:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4297   .bss.Vel_PPS_raw1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4303   .bss.delay_cnt.11974:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4307   .bss.delay_cnt.11974:00000000 delay_cnt.11974
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4310   .bss.g_IA:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4317   .bss.g_IA_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4324   .bss.g_IB:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4331   .bss.g_IB_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4338   .bss.g_IC:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4345   .bss.g_IC_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4352   .bss.g_I_Array_Index:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4358   .bss.g_I_Array_Index_Invalid:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4364   .bss.g_Id:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4371   .bss.g_Id_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4377   .bss.g_Id_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4383   .bss.g_Iq:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4390   .bss.g_Iq_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4396   .bss.g_Iq_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4402   .bss.g_Pos_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4408   .bss.g_Pos_PID_16BIT:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4414   .bss.g_Pos_Spd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4420   .bss.g_Sector:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4427   .bss.g_Spd_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4433   .bss.g_Sum_ABC:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4439   .bss.g_V_Alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4446   .bss.g_V_Beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4453   .bss.g_Vd:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4460   .bss.g_Vd_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4466   .bss.g_Vq:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4473   .bss.g_Vq_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4479   .bss.g_decLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4485   .bss.g_posPID_e:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4491   .bss.g_spd_error:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4497   .bss.g_testAngle:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4503   .bss.hall_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4509   .bss.hall_now_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4515   .bss.hall_previous_1_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4521   .bss.hall_previous_2_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4527   .bss.hall_previous_3_time:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 126


C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4533   .bss.hall_speed_sample_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4539   .bss.hall_speed_sample_timeout:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4545   .bss.hall_speed_sample_timeout_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4551   .bss.index_I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4558   .bss.last_alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4565   .bss.last_beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4572   .bss.last_hall_sample_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4578   .bss.last_time4_capture_ch1:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4584   .bss.motor_para_identification_count_Tms:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4591   .bss.pid_hall_sample_time_index:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4597   .bss.pos_error_to_target:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4604   .bss.s_Disable_Delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4611   .bss.s_Enable_Delay.12013:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4615   .bss.s_Enable_Delay.12013:00000000 s_Enable_Delay.12013
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4618   .bss.s_count.12012:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4622   .bss.s_count.12012:00000000 s_count.12012
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4625   .bss.s_count.12080:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4629   .bss.s_count.12080:00000000 s_count.12080
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4632   .bss.s_test_speed_t_count.11969:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4636   .bss.s_test_speed_t_count.11969:00000000 s_test_speed_t_count.11969
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4639   .bss.sin_wave_t_us:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4646   .bss.test.11957:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4650   .bss.test.11957:00000000 test.11957
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4653   .data.Test_dirt:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4660   .data.Test_dirt_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4666   .data.phase_current_rev_gain_:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4673   .data.shunt_conductance:00000000 $d
C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s:4680   .data.v:00000000 $d

UNDEFINED SYMBOLS
PWM_OutPut_Open
g_CmdMap
g_Timer1CCR
g_ElectricAngle
EN_0
EN_360
__aeabi_i2d
__aeabi_ddiv
__aeabi_dmul
__aeabi_d2uiz
log
Math_Sin_EN360
Math_Cos_EN360
Q15_MUL
Q16_MUL
g_high_fre_pulse
g_Sector_test
flag_processing_Jtest
state_Jtest
force_set
force_act
status_Mode_POSITION_FORCE
Flag_Profile_Enable
g_flag_monitor_from_host
gPos_ds
Profile_moving
flag_posReg_strengthen
ARM GAS  C:\Users\82057\AppData\Local\Temp\ccAIwPcN.s 			page 127


Profile
Profile_ParaSet
Gripper_Move
Flag_contact
Flag_grip_F_OK
Flag_grip_P_OK
Flag_rellease_P_OK
Motor_forbidden
g_pos_tag
tCnt_f
g_ZeroCur_MotorC
g_ZeroCur_MotorB
g_ZeroCur_MotorA
g_bEnableHB
g_pCur_ref_base_mA
__aeabi_f2d
__aeabi_d2f
EN_90
GetElectricAngle
measure_R
motor_fault_check
Pll_phase
HAL_EXTI_GenerateSWI
g_ElectricAngle_15bit
pll_estimated_spd
pll_estimated_phase
MTPro
get_average_force_data
Get_Pos_Rod
Stroke_protection
icmu_sdtransmission_test
PWM_Enable
PWM_Disable
g_servo_cmd_period_cnt
Flag_1ms
s_count_50ms
Flag_50ms
Motor_emergercy_stop
Motor_pause_flag
g_Encode_offset
g_ThreeLoopParaBefLock
