ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pid.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.PID_ini,"ax",%progbits
  18              		.align	1
  19              		.global	PID_ini
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	PID_ini:
  26              	.LFB333:
  27              		.file 1 "Src/pid.c"
   1:Src/pid.c     **** #include "pid.h"
   2:Src/pid.c     **** #include "global.h"
   3:Src/pid.c     **** #include "icmu.h"
   4:Src/pid.c     **** #include "parameter_identification.h"
   5:Src/pid.c     **** #include "sensorless.h"
   6:Src/pid.c     **** //#include "ouj_cmd.h"
   7:Src/pid.c     **** //3ï¿½Õ»ï¿½ï¿½Å·ï¿½ï¿½ï¿½Ø²ï¿½ï¿½ï¿½
   8:Src/pid.c     **** s16 g_IA = 0,g_IA_Raw = 0;			        
   9:Src/pid.c     **** s16 g_IB = 0,g_IB_Raw = 0;			        
  10:Src/pid.c     **** s16 g_IC = 0,g_IC_Raw = 0;
  11:Src/pid.c     **** s16 g_Sum_ABC = 0;
  12:Src/pid.c     **** volatile s32  g_Iq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  13:Src/pid.c     **** volatile s32  g_Id = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  14:Src/pid.c     **** volatile s32 g_Iq_filter;			// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  15:Src/pid.c     **** volatile s32 g_Id_filter;			// Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  16:Src/pid.c     **** volatile s32  g_Iq_Array[CUR_ARRAY_NUM] = {0};			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  17:Src/pid.c     **** volatile s32  g_Id_Array[CUR_ARRAY_NUM] = {0};			        // Ö±ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mA
  18:Src/pid.c     **** volatile s32 g_I_Array_Index = 0;
  19:Src/pid.c     **** volatile s32 g_I_Array_Index_Invalid = 0;
  20:Src/pid.c     **** volatile s32 g_Iq_sum = 0;
  21:Src/pid.c     **** volatile s32 g_Id_sum = 0;
  22:Src/pid.c     **** s32 g_Vq = 0;			        // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹
  23:Src/pid.c     **** s32 g_Vd = 0;			        // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  24:Src/pid.c     **** s32 g_Vq_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  25:Src/pid.c     **** s32 g_Vd_Pu = 0;			    // Ö±ï¿½ï¿½ï¿½ï¿½Ñ¹
  26:Src/pid.c     **** s32 g_V_Alpha = 0;
  27:Src/pid.c     **** s32 g_V_Beta = 0;
  28:Src/pid.c     **** 
  29:Src/pid.c     **** s32 g_Sector = 0;		      // ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  30:Src/pid.c     **** float g_Spd_Icnt = 0;		    // ï¿½Ù¶ï¿½Iï¿½Û»ï¿½Öµ
  31:Src/pid.c     **** int64_t g_Pos_Icnt = 0;       // Î»ï¿½Ã»ï¿½Iï¿½Û»ï¿½Öµ
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 2


  32:Src/pid.c     **** float Speed_P_out = 0;
  33:Src/pid.c     **** float Speed_I_out = 0;
  34:Src/pid.c     **** s32 g_Pos_PID_16BIT = 0;  // Î»ï¿½Ã»ï¿½PIï¿½ï¿½
  35:Src/pid.c     **** s32 g_Pos_Spd = 0;        // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ
  36:Src/pid.c     **** volatile s32 V_AddReg = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿½ï
  37:Src/pid.c     **** volatile s32 V_SetTotal = 0;     // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Öµ ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶Èµï¿½ï¿½ï¿
  38:Src/pid.c     **** 
  39:Src/pid.c     **** 
  40:Src/pid.c     **** s16 g_testAngle = 0;           //
  41:Src/pid.c     **** 
  42:Src/pid.c     **** 
  43:Src/pid.c     **** //u8 SpeedPID_Enable = 0;
  44:Src/pid.c     **** //u8 PostionPID_Enable = 0;
  45:Src/pid.c     **** s32 g_posPID_e = 0;
  46:Src/pid.c     **** u8 PosAtDead_Flag = 0;
  47:Src/pid.c     **** u8 PosAtDead_Flag_Last = 0;
  48:Src/pid.c     **** 
  49:Src/pid.c     **** volatile int time4_capture_ch1;
  50:Src/pid.c     **** extern int g_ElectricAngle_add ;
  51:Src/pid.c     **** extern float  pll_estimated_spd;
  52:Src/pid.c     **** extern float pll_estimated_phase ;
  53:Src/pid.c     **** 
  54:Src/pid.c     **** 
  55:Src/pid.c     **** s32 g_spd_error = 0;           //
  56:Src/pid.c     **** extern volatile int32_t SPI_X[9] ;
  57:Src/pid.c     **** extern volatile int32_t SPI_Y[9];
  58:Src/pid.c     **** extern volatile int16_t SPI_0_Array[250];
  59:Src/pid.c     **** s16 anlge_reg;
  60:Src/pid.c     **** s32 g_decLen = 0;
  61:Src/pid.c     **** s32 g_X, g_Y, g_Z;
  62:Src/pid.c     **** s16 Spd_RPM_CatchLimit = 0;//ï¿½Ð³ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½
  63:Src/pid.c     **** //ï¿½ï¿½ï¿½ï¿½ï¿½Õ¢ï¿½ß¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½ï¿½ï¿½
  64:Src/pid.c     **** volatile u8 Grriper_Ready = 0;
  65:Src/pid.c     **** volatile u8 Grriper_Run = 0,Grriper_Run_last = 0;
  66:Src/pid.c     **** volatile s32 Grriper_Run_on_delay_cnt = 0,Grriper_Run_off_delay_cnt = 0;
  67:Src/pid.c     **** volatile u8  Brake_rellease_delay = 0;
  68:Src/pid.c     **** volatile s32 Brake_rellease_delay_cnt = 0;
  69:Src/pid.c     **** volatile u8  Flag_Set_OpenLen = 0;
  70:Src/pid.c     **** volatile u8 Test_perm = 0;
  71:Src/pid.c     **** volatile s32 Test_dirt = 1;
  72:Src/pid.c     **** volatile s32 Test_dirt_last = 1;
  73:Src/pid.c     **** volatile s32 sin_wave_t_us = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê± us
  74:Src/pid.c     **** volatile s32 motor_para_identification_count_Tms = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  75:Src/pid.c     **** volatile s32 I_phase[3][100] = {0};//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  76:Src/pid.c     **** volatile s32 index_I_phase = 0;//ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½Ê±ms
  77:Src/pid.c     **** volatile s32 Para_Identificaion = 0;
  78:Src/pid.c     **** double T_t = 0.0;
  79:Src/pid.c     **** double T_t_1 = 0.0;
  80:Src/pid.c     **** volatile s32 pos_error_to_target = 0;
  81:Src/pid.c     **** struct PID_TYPE pid_IQ,pid_ID,pid_force,pid_spd,pid_pos,pid_pll;
  82:Src/pid.c     **** 
  83:Src/pid.c     **** void hfi_update_angle(void);
  84:Src/pid.c     **** void PID_ini(struct PID_TYPE * p_pid,u32 freq)   //PID
  85:Src/pid.c     **** {
  28              		.loc 1 85 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 3


  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              	.LVL0:
  86:Src/pid.c     **** 		p_pid->integral = 0;
  34              		.loc 1 86 0
  35 0000 0023     		movs	r3, #0
  36 0002 4364     		str	r3, [r0, #68]
  87:Src/pid.c     **** 		p_pid->error = 0;
  88:Src/pid.c     **** 		p_pid->error_last = 0;
  37              		.loc 1 88 0
  38 0004 C0E90633 		strd	r3, r3, [r0, #24]
  89:Src/pid.c     **** 		p_pid->out = 0;
  90:Src/pid.c     **** 		p_pid->frequency = freq;
  39              		.loc 1 90 0
  40 0008 C0E90D31 		strd	r3, r1, [r0, #52]
  91:Src/pid.c     **** }
  41              		.loc 1 91 0
  42 000c 7047     		bx	lr
  43              		.cfi_endproc
  44              	.LFE333:
  46              		.section	.text.PID_control,"ax",%progbits
  47              		.align	1
  48              		.global	PID_control
  49              		.syntax unified
  50              		.thumb
  51              		.thumb_func
  52              		.fpu fpv4-sp-d16
  54              	PID_control:
  55              	.LFB334:
  92:Src/pid.c     **** void PID_control(s32 set,s32 act,struct PID_TYPE * p_pid)   //PID
  93:Src/pid.c     **** {
  56              		.loc 1 93 0
  57              		.cfi_startproc
  58              		@ args = 0, pretend = 0, frame = 0
  59              		@ frame_needed = 0, uses_anonymous_args = 0
  60              	.LVL1:
  94:Src/pid.c     **** 	s32 deriv=0;
  95:Src/pid.c     **** 	
  96:Src/pid.c     **** 	if(p_pid->enable == 0)
  61              		.loc 1 96 0
  62 0000 1368     		ldr	r3, [r2]
  93:Src/pid.c     **** 	s32 deriv=0;
  63              		.loc 1 93 0
  64 0002 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
  65              	.LCFI0:
  66              		.cfi_def_cfa_offset 24
  67              		.cfi_offset 4, -24
  68              		.cfi_offset 5, -20
  69              		.cfi_offset 6, -16
  70              		.cfi_offset 7, -12
  71              		.cfi_offset 8, -8
  72              		.cfi_offset 14, -4
  73              		.loc 1 96 0
  74 0006 5BB9     		cbnz	r3, .L3
  97:Src/pid.c     **** 	{
  98:Src/pid.c     **** 		p_pid->integral = 0;
  99:Src/pid.c     **** 		p_pid->error = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 4


 100:Src/pid.c     **** 		p_pid->error_last = 0;
 101:Src/pid.c     **** 		p_pid->out = 0;
 102:Src/pid.c     **** 		p_pid->Part_P = 0;
 103:Src/pid.c     **** 		p_pid->Part_I = 0;
  75              		.loc 1 103 0
  76 0008 0020     		movs	r0, #0
  77              	.LVL2:
  78 000a 0021     		movs	r1, #0
  79              	.LVL3:
 100:Src/pid.c     **** 		p_pid->out = 0;
  80              		.loc 1 100 0
  81 000c C2E90633 		strd	r3, r3, [r2, #24]
  82              		.loc 1 103 0
  83 0010 C2E90A01 		strd	r0, [r2, #40]
  98:Src/pid.c     **** 		p_pid->error = 0;
  84              		.loc 1 98 0
  85 0014 5364     		str	r3, [r2, #68]
 101:Src/pid.c     **** 		p_pid->Part_P = 0;
  86              		.loc 1 101 0
  87 0016 5363     		str	r3, [r2, #52]
 102:Src/pid.c     **** 		p_pid->Part_I = 0;
  88              		.loc 1 102 0
  89 0018 1362     		str	r3, [r2, #32]
 104:Src/pid.c     **** 		p_pid->Part_D = 0;
  90              		.loc 1 104 0
  91 001a 1363     		str	r3, [r2, #48]
  92              	.L2:
 105:Src/pid.c     **** 		return;
 106:Src/pid.c     **** 	}
 107:Src/pid.c     **** 	p_pid->error = set - act; 
 108:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 109:Src/pid.c     **** 	{
 110:Src/pid.c     **** 		p_pid->is_at_dead_zone = 1;
 111:Src/pid.c     **** 		p_pid->error = 0;
 112:Src/pid.c     **** 	}	
 113:Src/pid.c     **** 	if ((p_pid->out < p_pid->Up_limit && p_pid->out > p_pid->Low_limit) ||
 114:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 115:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 116:Src/pid.c     **** 	{
 117:Src/pid.c     **** //		if(p_pid->Ki>1000)
 118:Src/pid.c     **** //		{
 119:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*(p_pid->Ki/100));
 120:Src/pid.c     **** //		}
 121:Src/pid.c     **** //		else
 122:Src/pid.c     **** //		{
 123:Src/pid.c     **** //			p_pid->integral += (float)(p_pid->error*p_pid->Ki);
 124:Src/pid.c     **** //		}
 125:Src/pid.c     **** 		if(p_pid->Ki>1000)
 126:Src/pid.c     **** 		{
 127:Src/pid.c     **** 			p_pid->integral += (p_pid->error*(p_pid->Ki/100));
 128:Src/pid.c     **** 		}
 129:Src/pid.c     **** 		else
 130:Src/pid.c     **** 		{
 131:Src/pid.c     **** 			p_pid->integral += (p_pid->error*p_pid->Ki);
 132:Src/pid.c     **** 		}
 133:Src/pid.c     **** 	}
 134:Src/pid.c     **** 	p_pid->Part_P = p_pid->error * p_pid->Kp/100;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 5


 135:Src/pid.c     **** 	
 136:Src/pid.c     **** 	
 137:Src/pid.c     **** //	if(p_pid->Ki>1000)
 138:Src/pid.c     **** //	{
 139:Src/pid.c     **** //		p_pid->Part_I = (s32)(100.0f*p_pid->integral/(float)p_pid->frequency);
 140:Src/pid.c     **** //	}
 141:Src/pid.c     **** //	else
 142:Src/pid.c     **** //	{
 143:Src/pid.c     **** //		p_pid->Part_I = (s32)(p_pid->integral/(float)p_pid->frequency);
 144:Src/pid.c     **** //	}
 145:Src/pid.c     **** 	if(p_pid->Ki>1000)
 146:Src/pid.c     **** 	{
 147:Src/pid.c     **** 		p_pid->Part_I = (s32)(100*p_pid->integral/p_pid->frequency);
 148:Src/pid.c     **** 	}
 149:Src/pid.c     **** 	else
 150:Src/pid.c     **** 	{
 151:Src/pid.c     **** 		p_pid->Part_I = (s32)(p_pid->integral/p_pid->frequency);
 152:Src/pid.c     **** 	}	
 153:Src/pid.c     **** 	if(p_pid->Part_I>0x7FFFFFFF)
 154:Src/pid.c     **** 	{
 155:Src/pid.c     **** 		p_pid->Part_I = 0x7FFFFFFF;
 156:Src/pid.c     **** 	}
 157:Src/pid.c     **** 	else if(p_pid->Part_I<(-1*0x7FFFFFFF))
 158:Src/pid.c     **** 	{
 159:Src/pid.c     **** 		p_pid->Part_I = -1*0x7FFFFFFF;
 160:Src/pid.c     **** 	}
 161:Src/pid.c     **** 	deriv = p_pid->Part_D;
 162:Src/pid.c     **** 	p_pid->Part_D = p_pid->Kd * ( 9*deriv + 1*(p_pid->error-p_pid->error_last) )   /1000 ;
 163:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 164:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 165:Src/pid.c     **** 	{
 166:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 167:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 168:Src/pid.c     **** 	}
 169:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 170:Src/pid.c     **** 	{
 171:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 172:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 173:Src/pid.c     **** 	}	
 174:Src/pid.c     **** 	return;
 175:Src/pid.c     **** }
  93              		.loc 1 175 0
  94 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
  95              	.LVL4:
  96              	.L3:
  97              	.LBB4:
  98              	.LBB5:
 108:Src/pid.c     **** 	{
  99              		.loc 1 108 0
 100 0020 5369     		ldr	r3, [r2, #20]
 107:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 101              		.loc 1 107 0
 102 0022 411A     		subs	r1, r0, r1
 103              	.LVL5:
 108:Src/pid.c     **** 	{
 104              		.loc 1 108 0
 105 0024 9942     		cmp	r1, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 6


 107:Src/pid.c     **** 	if((p_pid->error<p_pid->dead_zone && p_pid->error>-1*p_pid->dead_zone))
 106              		.loc 1 107 0
 107 0026 9161     		str	r1, [r2, #24]
 108:Src/pid.c     **** 	{
 108              		.loc 1 108 0
 109 0028 06DA     		bge	.L5
 110 002a 5B42     		negs	r3, r3
 111 002c 9942     		cmp	r1, r3
 110:Src/pid.c     **** 		p_pid->error = 0;
 112              		.loc 1 110 0
 113 002e C1BF     		itttt	gt
 114 0030 0123     		movgt	r3, #1
 115 0032 5360     		strgt	r3, [r2, #4]
 111:Src/pid.c     **** 	}	
 116              		.loc 1 111 0
 117 0034 0023     		movgt	r3, #0
 118 0036 9361     		strgt	r3, [r2, #24]
 119              	.L5:
 120 0038 D2E90F5C 		ldrd	r5, ip, [r2, #60]
 113:Src/pid.c     **** 			(p_pid->out >= p_pid->Up_limit && p_pid->error < 0) ||
 121              		.loc 1 113 0
 122 003c 516B     		ldr	r1, [r2, #52]
 123 003e 9369     		ldr	r3, [r2, #24]
 124 0040 D668     		ldr	r6, [r2, #12]
 125 0042 A942     		cmp	r1, r5
 126 0044 12DA     		bge	.L6
 127 0046 6145     		cmp	r1, ip
 128 0048 01DC     		bgt	.L7
 129              	.L8:
 115:Src/pid.c     **** 	{
 130              		.loc 1 115 0
 131 004a 002B     		cmp	r3, #0
 132 004c 12DD     		ble	.L9
 133              	.L7:
 125:Src/pid.c     **** 		{
 134              		.loc 1 125 0
 135 004e B6F57A7F 		cmp	r6, #1000
 136 0052 506C     		ldr	r0, [r2, #68]
 137              	.LVL6:
 127:Src/pid.c     **** 		}
 138              		.loc 1 127 0
 139 0054 C9BF     		itett	gt
 140 0056 6421     		movgt	r1, #100
 131:Src/pid.c     **** 		}
 141              		.loc 1 131 0
 142 0058 03FB0600 		mlale	r0, r3, r6, r0
 127:Src/pid.c     **** 		}
 143              		.loc 1 127 0
 144 005c 96FBF1F1 		sdivgt	r1, r6, r1
 145 0060 03FB0101 		mlagt	r1, r3, r1, r0
 146 0064 CCBF     		ite	gt
 147 0066 5164     		strgt	r1, [r2, #68]
 131:Src/pid.c     **** 		}
 148              		.loc 1 131 0
 149 0068 5064     		strle	r0, [r2, #68]
 150 006a 03E0     		b	.L9
 151              	.LVL7:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 7


 152              	.L6:
 114:Src/pid.c     **** 			(p_pid->out <= p_pid->Low_limit && p_pid->error > 0))
 153              		.loc 1 114 0
 154 006c 002B     		cmp	r3, #0
 155 006e EEDB     		blt	.L7
 156 0070 6145     		cmp	r1, ip
 157 0072 EADD     		ble	.L8
 158              	.LVL8:
 159              	.L9:
 134:Src/pid.c     **** 	
 160              		.loc 1 134 0
 161 0074 9168     		ldr	r1, [r2, #8]
 162 0076 506C     		ldr	r0, [r2, #68]
 163 0078 946B     		ldr	r4, [r2, #56]
 145:Src/pid.c     **** 	{
 164              		.loc 1 145 0
 165 007a B6F57A7F 		cmp	r6, #1000
 134:Src/pid.c     **** 	
 166              		.loc 1 134 0
 167 007e 01FB03FE 		mul	lr, r1, r3
 168 0082 4FF06401 		mov	r1, #100
 147:Src/pid.c     **** 	}
 169              		.loc 1 147 0
 170 0086 C8BF     		it	gt
 171 0088 4843     		mulgt	r0, r1, r0
 134:Src/pid.c     **** 	
 172              		.loc 1 134 0
 173 008a 9EFBF1FE 		sdiv	lr, lr, r1
 151:Src/pid.c     **** 	}	
 174              		.loc 1 151 0
 175 008e 90FBF4F0 		sdiv	r0, r0, r4
 176 0092 C117     		asrs	r1, r0, #31
 177 0094 C2E90A01 		strd	r0, [r2, #40]
 153:Src/pid.c     **** 	{
 178              		.loc 1 153 0
 179 0098 D2E90A67 		ldrd	r6, [r2, #40]
 180 009c 6FF00040 		mvn	r0, #-2147483648
 181 00a0 0021     		movs	r1, #0
 182 00a2 B042     		cmp	r0, r6
 183 00a4 71EB0708 		sbcs	r8, r1, r7
 134:Src/pid.c     **** 	
 184              		.loc 1 134 0
 185 00a8 C2F820E0 		str	lr, [r2, #32]
 153:Src/pid.c     **** 	{
 186              		.loc 1 153 0
 187 00ac 02DA     		bge	.L13
 188              	.L17:
 159:Src/pid.c     **** 	}
 189              		.loc 1 159 0
 190 00ae C2E90A01 		strd	r0, [r2, #40]
 191 00b2 06E0     		b	.L14
 192              	.L13:
 157:Src/pid.c     **** 	{
 193              		.loc 1 157 0
 194 00b4 1348     		ldr	r0, .L18
 195 00b6 4FF0FF31 		mov	r1, #-1
 196 00ba 8642     		cmp	r6, r0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 8


 197 00bc 77EB0106 		sbcs	r6, r7, r1
 198 00c0 F5DB     		blt	.L17
 199              	.L14:
 200              	.LVL9:
 162:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 201              		.loc 1 162 0
 202 00c2 116B     		ldr	r1, [r2, #48]
 203 00c4 D069     		ldr	r0, [r2, #28]
 204 00c6 01EBC101 		add	r1, r1, r1, lsl #3
 205 00ca 1B1A     		subs	r3, r3, r0
 206 00cc 0B44     		add	r3, r3, r1
 207 00ce 1169     		ldr	r1, [r2, #16]
 208 00d0 4B43     		muls	r3, r1, r3
 209 00d2 4FF47A71 		mov	r1, #1000
 210 00d6 93FBF1F3 		sdiv	r3, r3, r1
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 211              		.loc 1 163 0
 212 00da 916A     		ldr	r1, [r2, #40]
 162:Src/pid.c     **** 	p_pid->out = p_pid->Part_P+p_pid->Part_I+p_pid->Part_D;
 213              		.loc 1 162 0
 214 00dc 1363     		str	r3, [r2, #48]
 215              	.LVL10:
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 216              		.loc 1 163 0
 217 00de 8E44     		add	lr, lr, r1
 218 00e0 7344     		add	r3, r3, lr
 164:Src/pid.c     **** 	{
 219              		.loc 1 164 0
 220 00e2 9D42     		cmp	r5, r3
 166:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 221              		.loc 1 166 0
 222 00e4 B4BF     		ite	lt
 223 00e6 5563     		strlt	r5, [r2, #52]
 163:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 224              		.loc 1 163 0
 225 00e8 5363     		strge	r3, [r2, #52]
 169:Src/pid.c     **** 	{
 226              		.loc 1 169 0
 227 00ea 536B     		ldr	r3, [r2, #52]
 167:Src/pid.c     **** 	}
 228              		.loc 1 167 0
 229 00ec BCBF     		itt	lt
 230 00ee 6543     		mullt	r5, r4, r5
 231 00f0 5564     		strlt	r5, [r2, #68]
 169:Src/pid.c     **** 	{
 232              		.loc 1 169 0
 233 00f2 6345     		cmp	r3, ip
 172:Src/pid.c     **** 	}	
 234              		.loc 1 172 0
 235 00f4 BEBF     		ittt	lt
 236 00f6 04FB0CF4 		mullt	r4, r4, ip
 171:Src/pid.c     **** 		p_pid->integral = (p_pid->out)*p_pid->frequency;
 237              		.loc 1 171 0
 238 00fa C2F834C0 		strlt	ip, [r2, #52]
 172:Src/pid.c     **** 	}	
 239              		.loc 1 172 0
 240 00fe 5464     		strlt	r4, [r2, #68]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 9


 241 0100 8CE7     		b	.L2
 242              	.L19:
 243 0102 00BF     		.align	2
 244              	.L18:
 245 0104 01000080 		.word	-2147483647
 246              	.LBE5:
 247              	.LBE4:
 248              		.cfi_endproc
 249              	.LFE334:
 251              		.section	.text.force_PID_out,"ax",%progbits
 252              		.align	1
 253              		.global	force_PID_out
 254              		.syntax unified
 255              		.thumb
 256              		.thumb_func
 257              		.fpu fpv4-sp-d16
 259              	force_PID_out:
 260              	.LFB335:
 176:Src/pid.c     **** //Force PID output
 177:Src/pid.c     **** void force_PID_out(s32 out,struct PID_TYPE * p_pid)   //PID
 178:Src/pid.c     **** {
 261              		.loc 1 178 0
 262              		.cfi_startproc
 263              		@ args = 0, pretend = 0, frame = 0
 264              		@ frame_needed = 0, uses_anonymous_args = 0
 265              	.LVL11:
 179:Src/pid.c     **** 	p_pid->out = out;
 180:Src/pid.c     **** 	if(p_pid->out >p_pid->Up_limit)
 266              		.loc 1 180 0
 267 0000 CB6B     		ldr	r3, [r1, #60]
 179:Src/pid.c     **** 	p_pid->out = out;
 268              		.loc 1 179 0
 269 0002 4863     		str	r0, [r1, #52]
 270              		.loc 1 180 0
 271 0004 8342     		cmp	r3, r0
 181:Src/pid.c     **** 	{
 182:Src/pid.c     **** 		p_pid->out = p_pid->Up_limit;
 272              		.loc 1 182 0
 273 0006 B8BF     		it	lt
 274 0008 4B63     		strlt	r3, [r1, #52]
 183:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 184:Src/pid.c     **** 	}
 185:Src/pid.c     **** 	if(p_pid->out <p_pid->Low_limit)
 275              		.loc 1 185 0
 276 000a 4A6B     		ldr	r2, [r1, #52]
 277 000c 0B6C     		ldr	r3, [r1, #64]
 178:Src/pid.c     **** 	p_pid->out = out;
 278              		.loc 1 178 0
 279 000e 30B5     		push	{r4, r5, lr}
 280              	.LCFI1:
 281              		.cfi_def_cfa_offset 12
 282              		.cfi_offset 4, -12
 283              		.cfi_offset 5, -8
 284              		.cfi_offset 14, -4
 285              		.loc 1 185 0
 286 0010 9A42     		cmp	r2, r3
 186:Src/pid.c     **** 	{
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 10


 187:Src/pid.c     **** 		p_pid->out = p_pid->Low_limit;
 188:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 189:Src/pid.c     **** 	}	
 190:Src/pid.c     **** 	p_pid->error = 0;
 191:Src/pid.c     **** 	p_pid->error_last = 0;
 192:Src/pid.c     **** 	p_pid->Part_P = 0;
 193:Src/pid.c     **** 	p_pid->Part_I = out;
 194:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 287              		.loc 1 194 0
 288 0012 8A6B     		ldr	r2, [r1, #56]
 187:Src/pid.c     **** 		//p_pid->integral = (p_pid->out-p_pid->Part_P - p_pid->Part_D)*p_pid->frequency;
 289              		.loc 1 187 0
 290 0014 B8BF     		it	lt
 291 0016 4B63     		strlt	r3, [r1, #52]
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 292              		.loc 1 193 0
 293 0018 0446     		mov	r4, r0
 190:Src/pid.c     **** 	p_pid->error_last = 0;
 294              		.loc 1 190 0
 295 001a 0023     		movs	r3, #0
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 296              		.loc 1 193 0
 297 001c C517     		asrs	r5, r0, #31
 298              		.loc 1 194 0
 299 001e 5043     		muls	r0, r2, r0
 300              	.LVL12:
 191:Src/pid.c     **** 	p_pid->Part_P = 0;
 301              		.loc 1 191 0
 302 0020 C1E90633 		strd	r3, r3, [r1, #24]
 192:Src/pid.c     **** 	p_pid->Part_I = out;
 303              		.loc 1 192 0
 304 0024 0B62     		str	r3, [r1, #32]
 193:Src/pid.c     **** 	p_pid->integral = p_pid->Part_I*p_pid->frequency;
 305              		.loc 1 193 0
 306 0026 C1E90A45 		strd	r4, [r1, #40]
 307              		.loc 1 194 0
 308 002a 4864     		str	r0, [r1, #68]
 195:Src/pid.c     **** 	p_pid->Part_D = 0;
 309              		.loc 1 195 0
 310 002c 0B63     		str	r3, [r1, #48]
 196:Src/pid.c     **** }
 311              		.loc 1 196 0
 312 002e 30BD     		pop	{r4, r5, pc}
 313              		.cfi_endproc
 314              	.LFE335:
 316              		.section	.text.PositionPID,"ax",%progbits
 317              		.align	1
 318              		.global	PositionPID
 319              		.syntax unified
 320              		.thumb
 321              		.thumb_func
 322              		.fpu fpv4-sp-d16
 324              	PositionPID:
 325              	.LFB340:
 197:Src/pid.c     **** static void ForcePID(void)
 198:Src/pid.c     **** {
 199:Src/pid.c     **** 	s16 error_force = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 11


 200:Src/pid.c     **** 	s16 error_force_abs = 0;
 201:Src/pid.c     **** //	static u8 flag_in_dead = 0;
 202:Src/pid.c     **** //	static u16 delayCnt_in_dead = 0;
 203:Src/pid.c     **** 	if(g_CmdMap[CMD_FORCE_DIR] == 0)
 204:Src/pid.c     **** 	{
 205:Src/pid.c     **** 		force_set = g_CmdMap[CMD_FORCE_SET_PU];
 206:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 207:Src/pid.c     **** 	}
 208:Src/pid.c     **** 	else
 209:Src/pid.c     **** 	{
 210:Src/pid.c     **** 		force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 211:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 212:Src/pid.c     **** 	}
 213:Src/pid.c     **** ////	if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-819) && g_CmdMap[CMD_POS_ACT_PU]
 214:Src/pid.c     **** ////	{
 215:Src/pid.c     **** //				if(force_set>16)
 216:Src/pid.c     **** //				{
 217:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FORCE
 218:Src/pid.c     **** //					pid_force.Low_limit = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 219:Src/pid.c     **** //				}
 220:Src/pid.c     **** //				else if(force_set<-16)
 221:Src/pid.c     **** //				{
 222:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 223:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]+((force_set*g_CmdMap[SYS_K_PERCENT_FOR
 224:Src/pid.c     **** //				}
 225:Src/pid.c     **** //				else
 226:Src/pid.c     **** //				{
 227:Src/pid.c     **** //					pid_force.Up_limit = g_CmdMap[SYS_RESISTANCE_CURPU]+(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>7)
 228:Src/pid.c     **** //					pid_force.Low_limit = -g_CmdMap[SYS_RESISTANCE_CURPU]-(g_CmdMap[SYS_K_PERCENT_FORCE_CURPU]>>
 229:Src/pid.c     **** //				}
 230:Src/pid.c     **** //////	}
 231:Src/pid.c     **** ////	if(pid_force.Up_limit<g_CmdMap[SYS_RESISTANCE_CURPU])
 232:Src/pid.c     **** ////	{
 233:Src/pid.c     **** ////		pid_force.Up_limit=g_CmdMap[SYS_RESISTANCE_CURPU];
 234:Src/pid.c     **** ////	}
 235:Src/pid.c     **** ////	if(pid_force.Low_limit>(-1*g_CmdMap[SYS_RESISTANCE_CURPU]))
 236:Src/pid.c     **** ////	{
 237:Src/pid.c     **** ////		pid_force.Low_limit=-1*g_CmdMap[SYS_RESISTANCE_CURPU];
 238:Src/pid.c     **** ////	}
 239:Src/pid.c     **** 	pid_force.Up_limit = ((g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])>>0);
 240:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 241:Src/pid.c     **** 	
 242:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]>g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 243:Src/pid.c     **** 	{
 244:Src/pid.c     **** 		pid_force.Up_limit = 0;
 245:Src/pid.c     **** 		
 246:Src/pid.c     **** 	}
 247:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]>(g_CmdMap[SYS_POS_UPPER_LIMIT_PU]-409)&& g_CmdMap[CMD_CUR_SET_PU]
 248:Src/pid.c     **** 	{
 249:Src/pid.c     **** 		pid_force.Up_limit = 0;
 250:Src/pid.c     **** 		
 251:Src/pid.c     **** 	}
 252:Src/pid.c     **** 	if(g_CmdMap[CMD_POS_ACT_PU]<g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 253:Src/pid.c     **** 	{
 254:Src/pid.c     **** 		pid_force.Low_limit = 0;
 255:Src/pid.c     **** 		
 256:Src/pid.c     **** 	}	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 12


 257:Src/pid.c     **** 	else if(g_CmdMap[CMD_POS_ACT_PU]<(g_CmdMap[SYS_POS_LOWER_LIMIT_PU]+409)  && g_CmdMap[CMD_CUR_SET_P
 258:Src/pid.c     **** 	{
 259:Src/pid.c     **** 		pid_force.Low_limit = 0;
 260:Src/pid.c     **** 		
 261:Src/pid.c     **** 	}
 262:Src/pid.c     **** 	
 263:Src/pid.c     **** 
 264:Src/pid.c     **** 	
 265:Src/pid.c     **** //	error_force = force_set - force_act;
 266:Src/pid.c     **** //	error_force_abs = ABS(error_force);
 267:Src/pid.c     **** //	if(error_force < (pid_force.dead_zone>>1))
 268:Src/pid.c     **** //	{
 269:Src/pid.c     **** //		if(delayCnt_in_dead<1000)
 270:Src/pid.c     **** //		{
 271:Src/pid.c     **** //			delayCnt_in_dead++;
 272:Src/pid.c     **** //		}
 273:Src/pid.c     **** //		else
 274:Src/pid.c     **** //		{
 275:Src/pid.c     **** //			flag_in_dead = 1;
 276:Src/pid.c     **** //		}
 277:Src/pid.c     **** //	}
 278:Src/pid.c     **** //	if(error_force_abs > pid_force.dead_zone)
 279:Src/pid.c     **** //	{
 280:Src/pid.c     **** //		delayCnt_in_dead = 0;
 281:Src/pid.c     **** //		flag_in_dead = 0;
 282:Src/pid.c     **** //	}
 283:Src/pid.c     **** //	if(flag_in_dead == 1)
 284:Src/pid.c     **** //	{
 285:Src/pid.c     **** //		force_PID_out(0,&pid_force);
 286:Src/pid.c     **** //	}
 287:Src/pid.c     **** //	else
 288:Src/pid.c     **** //	{
 289:Src/pid.c     **** 		PID_control(force_set,force_act,&pid_force);
 290:Src/pid.c     **** //	}
 291:Src/pid.c     **** 	//
 292:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_force.out;
 293:Src/pid.c     **** 	
 294:Src/pid.c     **** 	if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_4_FORCE || (g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MO
 295:Src/pid.c     **** 	{
 296:Src/pid.c     **** 		Flag_Profile_Enable = 0;
 297:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 298:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 299:Src/pid.c     **** 	}
 300:Src/pid.c     **** }
 301:Src/pid.c     **** 
 302:Src/pid.c     **** // SVPWMï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½
 303:Src/pid.c     **** static void Calculate_CCR_SVP(TIM_TypeDef* TIMx, int sector, int X, int Y, int Z)
 304:Src/pid.c     **** {
 305:Src/pid.c     ****   s32 t0, tk, tk_1;
 306:Src/pid.c     ****   s32 CCR1 = 0;
 307:Src/pid.c     ****   s32 CCR2 = 0;
 308:Src/pid.c     ****   s32 CCR3 = 0;
 309:Src/pid.c     ****   switch (sector)
 310:Src/pid.c     ****   {
 311:Src/pid.c     ****     case 1:
 312:Src/pid.c     **** 			tk_1 = Z;
 313:Src/pid.c     **** 			tk = Y;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 13


 314:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 315:Src/pid.c     **** 			CCR3 = t0>>1;
 316:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 317:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
 318:Src/pid.c     **** 		break;		
 319:Src/pid.c     **** 		case 2:
 320:Src/pid.c     **** 			tk_1 = Y;
 321:Src/pid.c     **** 			tk = -X;
 322:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 323:Src/pid.c     **** 			CCR2 = t0>>1;
 324:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 325:Src/pid.c     **** 			CCR1 = CCR3 + tk_1;
 326:Src/pid.c     **** 		break;		
 327:Src/pid.c     **** 		case 3:
 328:Src/pid.c     **** 			tk_1 = X;
 329:Src/pid.c     **** 			tk = -Z;
 330:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 331:Src/pid.c     **** 			CCR3 = t0>>1;
 332:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 333:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 334:Src/pid.c     **** 		break;		
 335:Src/pid.c     **** 		case 4:
 336:Src/pid.c     **** 			tk_1 = -X;
 337:Src/pid.c     **** 			tk = Z;
 338:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 339:Src/pid.c     **** 			CCR1 = t0>>1;
 340:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 341:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 342:Src/pid.c     **** 		break;
 343:Src/pid.c     **** 		case 5:
 344:Src/pid.c     **** 			tk_1 = -Y;
 345:Src/pid.c     **** 			tk = X;
 346:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 347:Src/pid.c     **** 			CCR1 = t0>>1;
 348:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 349:Src/pid.c     **** 			CCR2 = CCR3 + tk;
 350:Src/pid.c     **** 		break;
 351:Src/pid.c     **** 		case 6:
 352:Src/pid.c     **** 			tk_1 = -Z;
 353:Src/pid.c     **** 			tk = -Y;
 354:Src/pid.c     **** 			t0 = REAL_CCR - tk - tk_1;
 355:Src/pid.c     **** 			CCR2 = t0>>1;
 356:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 357:Src/pid.c     **** 			CCR3 = CCR1 + tk;
 358:Src/pid.c     **** 		break;
 359:Src/pid.c     **** 		default:
 360:Src/pid.c     **** 			CCR1 = REAL_CCR >> 1;
 361:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 362:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 363:Src/pid.c     **** 		break;
 364:Src/pid.c     ****   }
 365:Src/pid.c     **** 	CCR1 = CCR1>N97_CCR?N97_CCR:(CCR1<0?0:CCR1);
 366:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 367:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 368:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 369:Src/pid.c     **** 	{
 370:Src/pid.c     **** 			motor_para_identification_count_Tms = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 14


 371:Src/pid.c     **** 			sin_wave_t_us = 0;
 372:Src/pid.c     **** 	}
 373:Src/pid.c     ****    // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Õ¼ï¿½Õ±ï¿½97%
 374:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¶ Step1:ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Step2ï¿½ï¿½ï¿½ï¿½ï¿½Ð²ï¿½ï¿½ï
 375:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4 || g_CmdMap[SYS_MOT_TEST] == 5)
 376:Src/pid.c     **** 	{
 377:Src/pid.c     **** 		sin_wave_t_us = sin_wave_t_us + 4;
 378:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 379:Src/pid.c     **** 		{
 380:Src/pid.c     **** 			sin_wave_t_us = 0;
 381:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 382:Src/pid.c     **** 		}
 383:Src/pid.c     **** 	}
 384:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 4)
 385:Src/pid.c     **** 	{
 386:Src/pid.c     **** 		CCR1 = 1;
 387:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 388:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 389:Src/pid.c     **** 		Para_Identificaion++;
 390:Src/pid.c     **** 		if(Para_Identificaion>=0)
 391:Src/pid.c     **** 		{
 392:Src/pid.c     **** 			Para_Identificaion = 0;
 393:Src/pid.c     **** 			if(index_I_phase<100)
 394:Src/pid.c     **** 			{
 395:Src/pid.c     **** 				I_phase[0][index_I_phase] = -g_IA_Raw;
 396:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
 397:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 398:Src/pid.c     **** 			}
 399:Src/pid.c     **** 			index_I_phase++;
 400:Src/pid.c     **** 		}
 401:Src/pid.c     **** 		if(motor_para_identification_count_Tms > 200)//1sï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 402:Src/pid.c     **** 		{	
 403:Src/pid.c     **** 			T_t = 0.000040/(log(-1.0*(double)I_phase[0][99]/((double)(I_phase[0][2] - I_phase[0][99])))   );
 404:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 405:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 406:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 407:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
 408:Src/pid.c     **** 		}
 409:Src/pid.c     **** 	}	 
 410:Src/pid.c     ****   TIMx->CCR3 = CCR3;
 411:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 412:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 413:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 414:Src/pid.c     **** 	TIMx->CCER = (u16)PWM_OUTPUT_REG;
 415:Src/pid.c     **** }
 416:Src/pid.c     **** 
 417:Src/pid.c     **** extern volatile int g_high_fre_pulse;
 418:Src/pid.c     **** 
 419:Src/pid.c     **** // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½20KHz
 420:Src/pid.c     **** static void CurrentPID(void)
 421:Src/pid.c     **** {            
 422:Src/pid.c     ****   s32 temp32 = 0;       
 423:Src/pid.c     ****   s32 X, Y, Z;
 424:Src/pid.c     **** 	static u16 test = 0;
 425:Src/pid.c     **** 	s32 abs_g_Vq;
 426:Src/pid.c     **** 	s16 set_current = 0;
 427:Src/pid.c     **** 	static int inr_angle =0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 15


 428:Src/pid.c     **** 	
 429:Src/pid.c     **** 	if (g_CmdMap[TAG_WORK_MODE] != MODE_CURRENT)  // ï¿½ï¿½Ç°Ä£Ê½ï¿½ï¿½ï¿½Çµï¿½ï¿½ï¿½ï¿½ï¿½
 430:Src/pid.c     **** 	{
 431:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED || g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
 432:Src/pid.c     **** 		{
 433:Src/pid.c     **** 		//	g_CmdMap[CMD_CUR_FWD_PU] = 1*((s32)g_CmdMap[CMD_ACC_PRE_PU]*5)>>4;
 434:Src/pid.c     **** 			g_CmdMap[CMD_CUR_FWD_PU] = 1*(s32)g_CmdMap[CMD_ACC_PRE_PU];
 435:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 436:Src/pid.c     **** 		}
 437:Src/pid.c     **** 		else if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
 438:Src/pid.c     **** 		{
 439:Src/pid.c     **** //			g_CmdMap[CMD_CUR_SET_PU] = pid_force.out;
 440:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out ;
 441:Src/pid.c     **** 		
 442:Src/pid.c     **** 		}
 443:Src/pid.c     **** 		else
 444:Src/pid.c     **** 		{
 445:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 446:Src/pid.c     **** 		}	
 447:Src/pid.c     **** 	}
 448:Src/pid.c     **** 		//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô£ï¿½ï¿½Ü²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ£ï¿½Ö»ï¿½ï¿½ï¿½ï¿½1msÎªï
 449:Src/pid.c     **** 	if(g_CmdMap[SYS_SELF_TUNING] == 1)//
 450:Src/pid.c     **** 	{
 451:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 452:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 453:Src/pid.c     **** 		if(test++ > (50))
 454:Src/pid.c     **** 		{
 455:Src/pid.c     **** 			test = 0;
 456:Src/pid.c     **** 		}
 457:Src/pid.c     **** 		if(test>(25))
 458:Src/pid.c     **** 		{
 459:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 16*200;
 460:Src/pid.c     **** 		}
 461:Src/pid.c     **** 		else
 462:Src/pid.c     **** 		{
 463:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = -16*200;		
 464:Src/pid.c     **** 		}	
 465:Src/pid.c     **** 	}
 466:Src/pid.c     **** 	else if(g_CmdMap[SYS_SELF_TUNING] == 3)//ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 467:Src/pid.c     **** 	{
 468:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 469:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 470:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 471:Src/pid.c     **** 		{
 472:Src/pid.c     **** 			state_Jtest = 0;
 473:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 474:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 475:Src/pid.c     **** 		}
 476:Src/pid.c     **** 		switch(state_Jtest)
 477:Src/pid.c     **** 		{
 478:Src/pid.c     **** 			case 0:
 479:Src/pid.c     **** 			{	
 480:Src/pid.c     **** 				flag_processing_Jtest = 1;
 481:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
 482:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 483:Src/pid.c     **** 				{
 484:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME1] = g_CmdMap[CMD_JTEST_TIME1] + SVPWM_PERIOD_US;					
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 16


 485:Src/pid.c     **** 				}
 486:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>(8192+819))
 487:Src/pid.c     **** 				{
 488:Src/pid.c     **** 					state_Jtest++;
 489:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 490:Src/pid.c     **** 				}
 491:Src/pid.c     **** 				break;
 492:Src/pid.c     **** 			}
 493:Src/pid.c     **** 			case 1:
 494:Src/pid.c     **** 			{	
 495:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = -8192;
 496:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 497:Src/pid.c     **** 				{
 498:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = g_CmdMap[CMD_JTEST_TIME2] + SVPWM_PERIOD_US;					
 499:Src/pid.c     **** 				}
 500:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 501:Src/pid.c     **** 				{
 502:Src/pid.c     **** 					state_Jtest++;
 503:Src/pid.c     **** 				}
 504:Src/pid.c     **** 				break;
 505:Src/pid.c     **** 			}
 506:Src/pid.c     **** 			case 2:
 507:Src/pid.c     **** 			{	
 508:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<819)
 509:Src/pid.c     **** 				{
 510:Src/pid.c     **** 					state_Jtest++;
 511:Src/pid.c     **** 				}				
 512:Src/pid.c     **** 				break;
 513:Src/pid.c     **** 			}
 514:Src/pid.c     **** 			default:
 515:Src/pid.c     **** 			{	
 516:Src/pid.c     **** 				g_CmdMap[SYS_SELF_TUNING] = 0;
 517:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 518:Src/pid.c     **** 				flag_processing_Jtest = 0;
 519:Src/pid.c     **** 				break;
 520:Src/pid.c     **** 			}
 521:Src/pid.c     **** 		}
 522:Src/pid.c     **** 	}
 523:Src/pid.c     **** 		else if(g_CmdMap[SYS_SELF_TUNING] == 4)//
 524:Src/pid.c     **** 	{
 525:Src/pid.c     **** 		g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 526:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 527:Src/pid.c     **** 
 528:Src/pid.c     **** 		
 529:Src/pid.c     **** 		test++;
 530:Src/pid.c     **** 		if(test < (10*10))
 531:Src/pid.c     **** 		{
 532:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 533:Src/pid.c     **** 		}
 534:Src/pid.c     **** 		else if(test < (10*60))
 535:Src/pid.c     **** 		{
 536:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 4096;
 537:Src/pid.c     **** 		}
 538:Src/pid.c     **** 		else if(test < (10*110))
 539:Src/pid.c     **** 		{
 540:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 541:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 17


 542:Src/pid.c     **** 		else if(test < (10*160))
 543:Src/pid.c     **** 		{
 544:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = -4096;
 545:Src/pid.c     **** 		}
 546:Src/pid.c     **** 		else if(test < (10*170))
 547:Src/pid.c     **** 		{
 548:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 549:Src/pid.c     **** 		}
 550:Src/pid.c     **** 		else
 551:Src/pid.c     **** 		{
 552:Src/pid.c     **** 			test = 0;
 553:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 554:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 555:Src/pid.c     **** 		}
 556:Src/pid.c     **** 	}
 557:Src/pid.c     **** 	else
 558:Src/pid.c     **** 	{
 559:Src/pid.c     **** 
 560:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]> g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 561:Src/pid.c     **** 		{
 562:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 563:Src/pid.c     **** 		}
 564:Src/pid.c     **** 		if(g_CmdMap[CMD_CUR_SET_PU]< g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 565:Src/pid.c     **** 		{
 566:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 567:Src/pid.c     **** 		}
 568:Src/pid.c     **** 	}
 569:Src/pid.c     **** 	
 570:Src/pid.c     **** 	float Ierr_d = 0.f - (float)(g_CmdMap[CMD_CUR_D_ACT_PU]*(*g_pCur_ref_base_mA)/PU_REFERENCE/1000.0f
 571:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 572:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 573:Src/pid.c     ****     float Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_contr
 574:Src/pid.c     **** 
 575:Src/pid.c     ****     float mod_to_V = one_by_sqrt3 * bus_voltage_;
 576:Src/pid.c     ****     float V_to_mod = 1.0f / mod_to_V;
 577:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 578:Src/pid.c     ****     float mod_q = V_to_mod * Vq;
 579:Src/pid.c     **** 
 580:Src/pid.c     **** 	float mod_scalefactor =  0.9f / sqrtf(mod_d * mod_d + mod_q * mod_q);
 581:Src/pid.c     **** 	if(mod_scalefactor < 1.0f)
 582:Src/pid.c     **** 	{
 583:Src/pid.c     ****         mod_d *= mod_scalefactor;
 584:Src/pid.c     ****         mod_q *= mod_scalefactor;
 585:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d *= 0.99f;
 586:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 587:Src/pid.c     **** 	}
 588:Src/pid.c     **** 	else
 589:Src/pid.c     **** 	{
 590:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d += Ierr_d * (motor_.current_control_.i_gain 
 591:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q += Ierr_q * (motor_.current_control_.i
 592:Src/pid.c     **** 	}
 593:Src/pid.c     **** 
 594:Src/pid.c     **** 
 595:Src/pid.c     **** 	
 596:Src/pid.c     **** 	
 597:Src/pid.c     **** 	g_Vq = (s16)(mod_q*(float)REAL_CCR);
 598:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 18


 599:Src/pid.c     **** 	
 600:Src/pid.c     **** //	g_Vq = 100;//g_high_fre_pulse * 500;
 601:Src/pid.c     **** //	g_Vd = g_high_fre_pulse * 1000;
 602:Src/pid.c     **** 	
 603:Src/pid.c     **** 	g_high_fre_pulse = 0 - g_high_fre_pulse;
 604:Src/pid.c     **** 	
 605:Src/pid.c     **** //	inr_angle += 1;
 606:Src/pid.c     **** //	g_ElectricAngle = inr_angle;
 607:Src/pid.c     **** 	
 608:Src/pid.c     ****   // Parkï¿½ï¿½ï¿½ä»»
 609:Src/pid.c     **** //	
 610:Src/pid.c     **** //		g_ElectricAngle_add = (int)pll_estimated_spd /100000;
 611:Src/pid.c     **** //		g_ElectricAngle = g_ElectricAngle + g_ElectricAngle_add;// * 0.000025;
 612:Src/pid.c     **** 	
 613:Src/pid.c     **** 	X = Math_Sin_EN360( g_ElectricAngle  );
 614:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 615:Src/pid.c     **** 	//g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½
 616:Src/pid.c     **** 	//g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 617:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,Y) - Q15_MUL(g_Vq,X);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 618:Src/pid.c     **** 	g_V_Beta = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);
 619:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 620:Src/pid.c     **** 	X = g_V_Beta;
 621:Src/pid.c     **** 	temp32 = Q16_MUL(g_V_Alpha,113512);
 622:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 623:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 624:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
 625:Src/pid.c     ****   temp32 = 0;
 626:Src/pid.c     **** 	/** ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ª**/	
 627:Src/pid.c     **** 	if (X > 0) temp32 = 1;
 628:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 629:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 630:Src/pid.c     **** 	g_Sector = temp32;
 631:Src/pid.c     **** 	g_Sector_test = g_Sector;
 632:Src/pid.c     **** 	g_X = X;
 633:Src/pid.c     **** 	g_Y = Y;
 634:Src/pid.c     **** 	g_Z = Z;
 635:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 636:Src/pid.c     **** 
 637:Src/pid.c     **** }
 638:Src/pid.c     **** static void SpeedPID(void)
 639:Src/pid.c     **** { 
 640:Src/pid.c     **** 	static s32 s_test_speed_t_count = 0;
 641:Src/pid.c     **** 	s16 spd_test = 0;
 642:Src/pid.c     **** 	
 643:Src/pid.c     ****   if (g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT ||g_CmdMap[TAG_WORK_MODE] == MODE_POSITION||g_CmdMap[
 644:Src/pid.c     ****   {
 645:Src/pid.c     **** 			g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_PROFILE_SPD_PU] + g_CmdMap[CMD_SPD_ADD_PU];
 646:Src/pid.c     ****   }
 647:Src/pid.c     **** 	else if( g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 648:Src/pid.c     **** 	{
 649:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_ADD_PU];
 650:Src/pid.c     **** 		
 651:Src/pid.c     **** 		pid_spd.enable =1;
 652:Src/pid.c     **** 	}
 653:Src/pid.c     ****   else if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED)
 654:Src/pid.c     ****   {
 655:Src/pid.c     **** 			if(status_Mode_POSITION_FORCE == 2) //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ÐµÄµï¿½ï¿½ï¿½ï¿½Ù
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 19


 656:Src/pid.c     **** 			{
 657:Src/pid.c     **** 				if(g_CmdMap[CMD_FORCE_DIR] == 0)
 658:Src/pid.c     **** 				{
 659:Src/pid.c     **** 					force_set = g_CmdMap[CMD_FORCE_SET_PU];
 660:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 661:Src/pid.c     **** 				}
 662:Src/pid.c     **** 				else
 663:Src/pid.c     **** 				{
 664:Src/pid.c     **** 					force_set = -1*g_CmdMap[CMD_FORCE_SET_PU];
 665:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 666:Src/pid.c     **** 				}
 667:Src/pid.c     **** 				if(force_set >= 0 )
 668:Src/pid.c     **** 				{
 669:Src/pid.c     **** 					if(force_act>force_set || g_CmdMap[CMD_POS_ACT_PU] > g_CmdMap[SYS_POS_UPPER_LIMIT_PU])
 670:Src/pid.c     **** 					{
 671:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
 672:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;	
 673:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force);
 674:Src/pid.c     **** 					
 675:Src/pid.c     **** 					}
 676:Src/pid.c     **** 					else
 677:Src/pid.c     **** 					{
 678:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SOFT_SET_PU];
 679:Src/pid.c     **** 					}
 680:Src/pid.c     **** 				}
 681:Src/pid.c     **** 				else
 682:Src/pid.c     **** 				{
 683:Src/pid.c     **** 					if(force_act<force_set || g_CmdMap[CMD_POS_ACT_PU] < g_CmdMap[SYS_POS_LOWER_LIMIT_PU])
 684:Src/pid.c     **** 					{
 685:Src/pid.c     **** 						status_Mode_POSITION_FORCE = 3;
 686:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 687:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 688:Src/pid.c     ****  		
 689:Src/pid.c     **** 					}
 690:Src/pid.c     **** 					else
 691:Src/pid.c     **** 					{
 692:Src/pid.c     **** 						g_CmdMap[CMD_SPDREG_REF_PU] = -1*g_CmdMap[CMD_SPD_SOFT_SET_PU];
 693:Src/pid.c     **** 					}
 694:Src/pid.c     **** 				}
 695:Src/pid.c     **** 			}
 696:Src/pid.c     **** 			else
 697:Src/pid.c     **** 			{
 698:Src/pid.c     **** 							if(g_CmdMap[SYS_SPEED_TEST] == 0)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 699:Src/pid.c     **** 							{
 700:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[CMD_SPD_SET_PU];
 701:Src/pid.c     **** 							}
 702:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 1)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½ï
 703:Src/pid.c     **** 							{
 704:Src/pid.c     **** 								
 705:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ACT_PU] < 1638)
 706:Src/pid.c     **** 								{
 707:Src/pid.c     **** 									Test_dirt = 1;					
 708:Src/pid.c     **** 								}
 709:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ACT_PU] > (16384-1638))
 710:Src/pid.c     **** 								{
 711:Src/pid.c     **** 									Test_dirt = -1;					
 712:Src/pid.c     **** 								}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 20


 713:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*g_CmdMap[CMD_SPD_SET_PU];
 714:Src/pid.c     **** 
 715:Src/pid.c     **** 							}	
 716:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 11)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½Ú·ï¿½Î§ï¿½ï¿½ï¿½ï¿½ï¿½
 717:Src/pid.c     **** 							{
 718:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(0)])
 719:Src/pid.c     **** 								{
 720:Src/pid.c     **** 									Test_dirt = 1;
 721:Src/pid.c     **** 								}
 722:Src/pid.c     **** 								else if(g_CmdMap[CMD_POS_ADC_12BIT] > g_CmdMap[POS_LINEARITY_ADC(30)])
 723:Src/pid.c     **** 								{
 724:Src/pid.c     **** 									Test_dirt = -1;
 725:Src/pid.c     **** 								}
 726:Src/pid.c     **** 								spd_test = ABS(g_CmdMap[CMD_SPD_SET_PU]);
 727:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 728:Src/pid.c     **** 								{
 729:Src/pid.c     **** 									s_test_speed_t_count = 0;
 730:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 731:Src/pid.c     **** 									{
 732:Src/pid.c     **** 										Test_perm = 0;   //4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 733:Src/pid.c     **** 									}
 734:Src/pid.c     **** 									else
 735:Src/pid.c     **** 									{
 736:Src/pid.c     **** 										Test_perm = 1;//4000ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½ï¿½Í¨Ñ¶
 737:Src/pid.c     **** 									}
 738:Src/pid.c     **** 									g_flag_monitor_from_host = 0;
 739:Src/pid.c     **** 								}
 740:Src/pid.c     **** 												if(Test_perm == 1)
 741:Src/pid.c     **** 								{
 742:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = Test_dirt*spd_test;
 743:Src/pid.c     **** 								}
 744:Src/pid.c     **** 								else
 745:Src/pid.c     **** 								{
 746:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 747:Src/pid.c     **** 								}				
 748:Src/pid.c     **** 							}				
 749:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 12)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½Ð¡Î»ï
 750:Src/pid.c     **** 							{
 751:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] >g_CmdMap[POS_LINEARITY_ADC(0)])
 752:Src/pid.c     **** 								{
 753:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = -8192;
 754:Src/pid.c     **** 								}
 755:Src/pid.c     **** 								else
 756:Src/pid.c     **** 								{
 757:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 758:Src/pid.c     **** 								}
 759:Src/pid.c     **** 							}
 760:Src/pid.c     **** 							else if(g_CmdMap[SYS_SPEED_TEST] == 13)//ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ù¶ï¿½ï¿½ï¿½ï¿½Ðµï¿½ï¿½ï¿½ï¿½Î»
 761:Src/pid.c     **** 							{
 762:Src/pid.c     **** 								if(g_CmdMap[CMD_POS_ADC_12BIT] < g_CmdMap[POS_LINEARITY_ADC(30)])
 763:Src/pid.c     **** 								{
 764:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 8192;
 765:Src/pid.c     **** 								}
 766:Src/pid.c     **** 								else
 767:Src/pid.c     **** 								{
 768:Src/pid.c     **** 									g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 769:Src/pid.c     **** 								}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 21


 770:Src/pid.c     **** 							}
 771:Src/pid.c     **** 							else
 772:Src/pid.c     **** 							{
 773:Src/pid.c     **** 								g_CmdMap[CMD_SPDREG_REF_PU] = 0;
 774:Src/pid.c     **** 							}				
 775:Src/pid.c     **** 			}
 776:Src/pid.c     **** 	}
 777:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]> g_CmdMap[SYS_SPD_UPPER_LIMIT_PU])
 778:Src/pid.c     **** 	{
 779:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_UPPER_LIMIT_PU];
 780:Src/pid.c     **** 	}
 781:Src/pid.c     **** 	if(g_CmdMap[CMD_SPDREG_REF_PU]< g_CmdMap[SYS_SPD_LOWER_LIMIT_PU])
 782:Src/pid.c     **** 	{
 783:Src/pid.c     **** 		g_CmdMap[CMD_SPDREG_REF_PU] = g_CmdMap[SYS_SPD_LOWER_LIMIT_PU];
 784:Src/pid.c     **** 	}
 785:Src/pid.c     **** 
 786:Src/pid.c     **** 
 787:Src/pid.c     **** 	
 788:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] > g_CmdMap[SYS_CUR_UPPER_LIMIT_PU])
 789:Src/pid.c     **** 	{
 790:Src/pid.c     **** 		g_CmdMap[CMD_CUR_UPPER_LIMIT_PU] = g_CmdMap[SYS_CUR_UPPER_LIMIT_PU];
 791:Src/pid.c     **** 	}
 792:Src/pid.c     **** 	if(g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] < g_CmdMap[SYS_CUR_LOWER_LIMIT_PU])
 793:Src/pid.c     **** 	{
 794:Src/pid.c     **** 		g_CmdMap[CMD_CUR_LOWER_LIMIT_PU] = g_CmdMap[SYS_CUR_LOWER_LIMIT_PU];
 795:Src/pid.c     **** 	}
 796:Src/pid.c     **** 	
 797:Src/pid.c     **** 	pid_spd.Up_limit = g_CmdMap[CMD_CUR_UPPER_LIMIT_PU];
 798:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[CMD_CUR_LOWER_LIMIT_PU];		
 799:Src/pid.c     **** 	
 800:Src/pid.c     **** 	
 801:Src/pid.c     **** 	
 802:Src/pid.c     **** 	
 803:Src/pid.c     **** 	
 804:Src/pid.c     **** //	
 805:Src/pid.c     **** //	pid_spd.Up_limit = 1000;
 806:Src/pid.c     **** //	pid_spd.Low_limit = -1000;		
 807:Src/pid.c     **** //	
 808:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_SPDREG_REF_PU],g_CmdMap[CMD_SPD_ACT_PU],&pid_spd);	
 809:Src/pid.c     **** }
 810:Src/pid.c     **** void PositionPID(void)   //ï¿½Å½ï¿½ï¿½ï¿½ï¿½ï¿½ Î»ï¿½Ãµï¿½ï¿½ï¿½ï¿½ï¿½Ï²ï¿½ï¿½Î·ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿
 811:Src/pid.c     **** {	
 326              		.loc 1 811 0
 327              		.cfi_startproc
 328              		@ args = 0, pretend = 0, frame = 0
 329              		@ frame_needed = 0, uses_anonymous_args = 0
 330 0000 38B5     		push	{r3, r4, r5, lr}
 331              	.LCFI2:
 332              		.cfi_def_cfa_offset 16
 333              		.cfi_offset 3, -16
 334              		.cfi_offset 4, -12
 335              		.cfi_offset 5, -8
 336              		.cfi_offset 14, -4
 812:Src/pid.c     **** 	static s16 delay_cnt = 0;
 813:Src/pid.c     **** 	pos_error_to_target = g_CmdMap[CMD_POS_SET_PU]-g_CmdMap[CMD_POS_ACT_PU];  // Æ«ï¿½ï¿½
 337              		.loc 1 813 0
 338 0002 2C4C     		ldr	r4, .L35
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 22


 814:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 815:Src/pid.c     **** 	if(ABS(pos_error_to_target)<gPos_ds && Profile_moving == 0)
 339              		.loc 1 815 0
 340 0004 2C49     		ldr	r1, .L35+4
 813:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 341              		.loc 1 813 0
 342 0006 B4F84820 		ldrh	r2, [r4, #72]
 343 000a B4F84C30 		ldrh	r3, [r4, #76]
 344              		.loc 1 815 0
 345 000e 0868     		ldr	r0, [r1]
 346 0010 2A49     		ldr	r1, .L35+8
 813:Src/pid.c     **** 	//ï¿½ï¿½ï¿½ï¿½Î»ï¿½ï¿½ï¿½Ð¶ï¿½
 347              		.loc 1 813 0
 348 0012 1BB2     		sxth	r3, r3
 349 0014 12B2     		sxth	r2, r2
 350 0016 D21A     		subs	r2, r2, r3
 351 0018 294B     		ldr	r3, .L35+12
 352 001a 1A60     		str	r2, [r3]
 353              		.loc 1 815 0
 354 001c 1A68     		ldr	r2, [r3]
 355 001e 002A     		cmp	r2, #0
 356 0020 1A68     		ldr	r2, [r3]
 357 0022 B8BF     		it	lt
 358 0024 5242     		rsblt	r2, r2, #0
 359 0026 9042     		cmp	r0, r2
 360 0028 0BDD     		ble	.L26
 361              		.loc 1 815 0 is_stmt 0 discriminator 5
 362 002a 264A     		ldr	r2, .L35+16
 363 002c 1268     		ldr	r2, [r2]
 364 002e 42B9     		cbnz	r2, .L26
 816:Src/pid.c     **** 	{
 817:Src/pid.c     **** 		if(delay_cnt <50)
 365              		.loc 1 817 0 is_stmt 1
 366 0030 254D     		ldr	r5, .L35+20
 367 0032 B5F90020 		ldrsh	r2, [r5]
 368 0036 312A     		cmp	r2, #49
 818:Src/pid.c     **** 		{
 819:Src/pid.c     **** 			delay_cnt++;
 369              		.loc 1 819 0
 370 0038 D5BF     		itete	le
 371 003a 0132     		addle	r2, r2, #1
 820:Src/pid.c     **** 		}
 821:Src/pid.c     **** 		else
 822:Src/pid.c     **** 		{
 823:Src/pid.c     **** 			PosAtDead_Flag = 1;
 372              		.loc 1 823 0
 373 003c 0122     		movgt	r2, #1
 819:Src/pid.c     **** 		}
 374              		.loc 1 819 0
 375 003e 2A80     		strhle	r2, [r5]	@ movhi
 376              		.loc 1 823 0
 377 0040 0A70     		strbgt	r2, [r1]
 378              	.L26:
 824:Src/pid.c     **** 		}
 825:Src/pid.c     **** 	}
 826:Src/pid.c     **** 	if(ABS(pos_error_to_target)>2*gPos_ds || Profile_moving == 1)
 379              		.loc 1 826 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 23


 380 0042 1A68     		ldr	r2, [r3]
 381 0044 1B68     		ldr	r3, [r3]
 382 0046 002A     		cmp	r2, #0
 383 0048 B8BF     		it	lt
 384 004a 5B42     		rsblt	r3, r3, #0
 385 004c B3EB400F 		cmp	r3, r0, lsl #1
 386 0050 03DC     		bgt	.L30
 387              		.loc 1 826 0 is_stmt 0 discriminator 5
 388 0052 1C4B     		ldr	r3, .L35+16
 389 0054 1B68     		ldr	r3, [r3]
 390 0056 012B     		cmp	r3, #1
 391 0058 03D1     		bne	.L31
 392              	.L30:
 827:Src/pid.c     **** 	{
 828:Src/pid.c     **** 		PosAtDead_Flag = 0;
 829:Src/pid.c     **** 		delay_cnt = 0;
 393              		.loc 1 829 0 is_stmt 1
 394 005a 1B4A     		ldr	r2, .L35+20
 828:Src/pid.c     **** 		delay_cnt = 0;
 395              		.loc 1 828 0
 396 005c 0023     		movs	r3, #0
 397 005e 0B70     		strb	r3, [r1]
 398              		.loc 1 829 0
 399 0060 1380     		strh	r3, [r2]	@ movhi
 400              	.L31:
 830:Src/pid.c     **** 	}	
 831:Src/pid.c     **** 	PosAtDead_Flag_Last = PosAtDead_Flag;
 401              		.loc 1 831 0
 402 0062 1A4B     		ldr	r3, .L35+24
 403 0064 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 404 0066 1A70     		strb	r2, [r3]
 832:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 833:Src/pid.c     **** 	// ï¿½ï¿½ï¿½Ö¼ï¿½ï¿½ï¿½	
 834:Src/pid.c     **** 	if(flag_posReg_strengthen == 1)
 405              		.loc 1 834 0
 406 0068 194B     		ldr	r3, .L35+28
 407 006a 1A4D     		ldr	r5, .L35+32
 408 006c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 835:Src/pid.c     **** 	{
 836:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU];
 837:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 838:Src/pid.c     **** 	}
 839:Src/pid.c     **** 	else
 840:Src/pid.c     **** 	{
 841:Src/pid.c     **** 		pid_pos.Up_limit = g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5;
 842:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 843:Src/pid.c     **** 	}		
 844:Src/pid.c     **** 	PID_control(g_CmdMap[CMD_PROFILE_POS_PU],g_CmdMap[CMD_POS_ACT_PU],&pid_pos);
 409              		.loc 1 844 0
 410 006e 194A     		ldr	r2, .L35+32
 834:Src/pid.c     **** 	{
 411              		.loc 1 834 0
 412 0070 012B     		cmp	r3, #1
 836:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 413              		.loc 1 836 0
 414 0072 B4F89232 		ldrh	r3, [r4, #658]
 415 0076 0BBF     		itete	eq
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 24


 416 0078 1BB2     		sxtheq	r3, r3
 841:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 417              		.loc 1 841 0
 418 007a 43F34A13 		sbfxne	r3, r3, #5, #11
 836:Src/pid.c     **** 		pid_pos.Low_limit = -g_CmdMap[SYS_SPD_ADD_LIMIT_PU];	
 419              		.loc 1 836 0
 420 007e EB63     		streq	r3, [r5, #60]
 841:Src/pid.c     **** 		pid_pos.Low_limit = -(g_CmdMap[SYS_SPD_ADD_LIMIT_PU]>>5);	
 421              		.loc 1 841 0
 422 0080 EB63     		strne	r3, [r5, #60]
 837:Src/pid.c     **** 	}
 423              		.loc 1 837 0
 424 0082 0CBF     		ite	eq
 425 0084 B4F89232 		ldrheq	r3, [r4, #658]
 842:Src/pid.c     **** 	}		
 426              		.loc 1 842 0
 427 0088 B4F89232 		ldrhne	r3, [r4, #658]
 428              		.loc 1 844 0
 429 008c B4F86000 		ldrh	r0, [r4, #96]
 430 0090 B4F84C10 		ldrh	r1, [r4, #76]
 837:Src/pid.c     **** 	}
 431              		.loc 1 837 0
 432 0094 0CBF     		ite	eq
 433 0096 1BB2     		sxtheq	r3, r3
 842:Src/pid.c     **** 	}		
 434              		.loc 1 842 0
 435 0098 43F34A13 		sbfxne	r3, r3, #5, #11
 436 009c 5B42     		negs	r3, r3
 437              		.loc 1 844 0
 438 009e 09B2     		sxth	r1, r1
 439 00a0 00B2     		sxth	r0, r0
 842:Src/pid.c     **** 	}		
 440              		.loc 1 842 0
 441 00a2 2B64     		str	r3, [r5, #64]
 442              		.loc 1 844 0
 443 00a4 FFF7FEFF 		bl	PID_control
 444              	.LVL13:
 845:Src/pid.c     **** 	g_CmdMap[CMD_SPD_ADD_PU] = pid_pos.out;
 445              		.loc 1 845 0
 446 00a8 B5F93430 		ldrsh	r3, [r5, #52]
 447 00ac A4F85E30 		strh	r3, [r4, #94]	@ movhi
 846:Src/pid.c     **** }
 448              		.loc 1 846 0
 449 00b0 38BD     		pop	{r3, r4, r5, pc}
 450              	.L36:
 451 00b2 00BF     		.align	2
 452              	.L35:
 453 00b4 00000000 		.word	g_CmdMap
 454 00b8 00000000 		.word	gPos_ds
 455 00bc 00000000 		.word	.LANCHOR2
 456 00c0 00000000 		.word	.LANCHOR0
 457 00c4 00000000 		.word	Profile_moving
 458 00c8 00000000 		.word	.LANCHOR1
 459 00cc 00000000 		.word	.LANCHOR3
 460 00d0 00000000 		.word	flag_posReg_strengthen
 461 00d4 00000000 		.word	pid_pos
 462              		.cfi_endproc
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 25


 463              	.LFE340:
 465              		.section	.text.Gripper_control,"ax",%progbits
 466              		.align	1
 467              		.global	Gripper_control
 468              		.syntax unified
 469              		.thumb
 470              		.thumb_func
 471              		.fpu fpv4-sp-d16
 473              	Gripper_control:
 474              	.LFB341:
 847:Src/pid.c     **** //int16_t Force_set_drop_detection = 0;
 848:Src/pid.c     **** //Î»ï¿½Ã¿ï¿½ï¿½ï¿½
 849:Src/pid.c     **** void Gripper_control(void)
 850:Src/pid.c     **** {
 475              		.loc 1 850 0
 476              		.cfi_startproc
 477              		@ args = 0, pretend = 0, frame = 0
 478              		@ frame_needed = 0, uses_anonymous_args = 0
 479 0000 70B5     		push	{r4, r5, r6, lr}
 480              	.LCFI3:
 481              		.cfi_def_cfa_offset 16
 482              		.cfi_offset 4, -16
 483              		.cfi_offset 5, -12
 484              		.cfi_offset 6, -8
 485              		.cfi_offset 14, -4
 851:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
 486              		.loc 1 851 0
 487 0002 464C     		ldr	r4, .L59
 488 0004 464E     		ldr	r6, .L59+4
 489 0006 B4F84830 		ldrh	r3, [r4, #72]
 490 000a B4F84C00 		ldrh	r0, [r4, #76]
 852:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 491              		.loc 1 852 0
 492 000e B4F80422 		ldrh	r2, [r4, #516]
 493 0012 444D     		ldr	r5, .L59+8
 494 0014 12B2     		sxth	r2, r2
 495 0016 032A     		cmp	r2, #3
 851:Src/pid.c     **** 	s32 error_Pos = g_CmdMap[CMD_POS_SET_PU] - g_CmdMap[CMD_POS_ACT_PU];
 496              		.loc 1 851 0
 497 0018 1BB2     		sxth	r3, r3
 498 001a 00B2     		sxth	r0, r0
 499              	.LVL14:
 500              		.loc 1 852 0
 501 001c 03D1     		bne	.L38
 502              		.loc 1 852 0 is_stmt 0 discriminator 1
 503 001e 424A     		ldr	r2, .L59+12
 504 0020 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 505 0022 012A     		cmp	r2, #1
 506 0024 0BD1     		bne	.L39
 507              	.L38:
 853:Src/pid.c     **** 	{
 854:Src/pid.c     **** 		Gripper_Move = 0x00;
 855:Src/pid.c     **** 		Grriper_Run = 0;
 856:Src/pid.c     **** 		Flag_contact = 0;
 508              		.loc 1 856 0 is_stmt 1
 509 0026 414A     		ldr	r2, .L59+16
 854:Src/pid.c     **** 		Grriper_Run = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 26


 510              		.loc 1 854 0
 511 0028 0023     		movs	r3, #0
 512              	.LVL15:
 513              		.loc 1 856 0
 514 002a 1370     		strb	r3, [r2]
 857:Src/pid.c     **** 		Flag_grip_F_OK = 0;
 515              		.loc 1 857 0
 516 002c 404A     		ldr	r2, .L59+20
 854:Src/pid.c     **** 		Grriper_Run = 0;
 517              		.loc 1 854 0
 518 002e 3380     		strh	r3, [r6]	@ movhi
 519              		.loc 1 857 0
 520 0030 1370     		strb	r3, [r2]
 858:Src/pid.c     **** 		Flag_grip_P_OK = 0;
 521              		.loc 1 858 0
 522 0032 404A     		ldr	r2, .L59+24
 855:Src/pid.c     **** 		Flag_contact = 0;
 523              		.loc 1 855 0
 524 0034 2B70     		strb	r3, [r5]
 525              		.loc 1 858 0
 526 0036 1370     		strb	r3, [r2]
 859:Src/pid.c     **** 		Flag_rellease_P_OK = 0;
 527              		.loc 1 859 0
 528 0038 3F4A     		ldr	r2, .L59+28
 529 003a 1370     		strb	r3, [r2]
 860:Src/pid.c     **** 	}	
 861:Src/pid.c     **** 	else
 862:Src/pid.c     **** 	{
 863:Src/pid.c     **** 		
 864:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]>g_CmdMap[CMD_POS_UPPER_LIMIT_PU])
 865:Src/pid.c     **** //		{
 866:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] =g_CmdMap[CMD_POS_UPPER_LIMIT_PU];		
 867:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] > 16384)
 868:Src/pid.c     **** //			{
 869:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 16384;
 870:Src/pid.c     **** //			}
 871:Src/pid.c     **** //		}
 872:Src/pid.c     **** //		if(g_CmdMap[CMD_POS_SET_PU]<g_CmdMap[CMD_POS_LOWER_LIMIT_PU])
 873:Src/pid.c     **** //		{
 874:Src/pid.c     **** //			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_LOWER_LIMIT_PU];
 875:Src/pid.c     **** //			if(g_CmdMap[CMD_POS_SET_PU] < 0)
 876:Src/pid.c     **** //			{
 877:Src/pid.c     **** //				g_CmdMap[CMD_POS_SET_PU] = 0;
 878:Src/pid.c     **** //			}
 879:Src/pid.c     **** //		}
 880:Src/pid.c     **** 		
 881:Src/pid.c     **** 		
 882:Src/pid.c     **** 		
 883:Src/pid.c     **** 		if(Flag_Set_OpenLen == 1  && (error_Pos>g_CmdMap[SEV_POSITION_DS]||error_Pos<-g_CmdMap[SEV_POSITI
 884:Src/pid.c     **** 		{
 885:Src/pid.c     **** 				Flag_Set_OpenLen = 0;
 886:Src/pid.c     **** 			
 887:Src/pid.c     **** 				if(g_CmdMap[CMD_E_STOP] == 0)
 888:Src/pid.c     **** 				{
 889:Src/pid.c     **** 				
 890:Src/pid.c     **** 				}
 891:Src/pid.c     **** 				
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 27


 892:Src/pid.c     **** 				g_CmdMap[TAG_WORK_MODE] = MODE_POSITION;	
 893:Src/pid.c     **** 				Profile_ParaSet();
 894:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 895:Src/pid.c     **** 				{
 896:Src/pid.c     **** 					tCnt_f = 0.0;
 897:Src/pid.c     **** 				}
 898:Src/pid.c     **** 				
 899:Src/pid.c     **** 				Flag_contact = 0;
 900:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 901:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 902:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 903:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 904:Src/pid.c     **** 				{
 905:Src/pid.c     **** 					Gripper_Move = 0x01;//ï¿½ï¿½È¡
 906:Src/pid.c     **** 					Grriper_Run = 1;
 907:Src/pid.c     **** 					pid_spd.enable = 1;
 908:Src/pid.c     **** 					pid_pos.enable = 1;
 909:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 910:Src/pid.c     **** 					{
 911:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 912:Src/pid.c     **** 					}
 913:Src/pid.c     **** 					//g_Flag_drop_detection = 1;   // 1-ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½ 0-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ø±ï¿½
 914:Src/pid.c     **** 					Grriper_Run_last = 0;
 915:Src/pid.c     **** 				}
 916:Src/pid.c     **** 				else if(g_CmdMap[CMD_POS_SET_PU] > g_CmdMap[CMD_POS_ACT_PU])
 917:Src/pid.c     **** 				{
 918:Src/pid.c     **** 					Gripper_Move = 0x02;//ï¿½É¿ï¿½
 919:Src/pid.c     **** 					Grriper_Run = 1;
 920:Src/pid.c     **** 					pid_spd.enable = 1;
 921:Src/pid.c     **** 					pid_pos.enable = 1;
 922:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 923:Src/pid.c     **** 					{
 924:Src/pid.c     **** 						g_CmdMap[TAG_MOTOR_ENABLE] = 1;
 925:Src/pid.c     **** 					}
 926:Src/pid.c     **** 					Grriper_Run_last = 0;
 927:Src/pid.c     **** 				}
 928:Src/pid.c     **** 				else
 929:Src/pid.c     **** 				{
 930:Src/pid.c     **** 				}
 931:Src/pid.c     **** 		}
 932:Src/pid.c     **** 		g_pos_tag = g_CmdMap[CMD_POS_SET_PU];
 933:Src/pid.c     **** 
 934:Src/pid.c     **** 		if(Gripper_Move == 1)
 935:Src/pid.c     **** 		{
 936:Src/pid.c     **** 			Flag_grip_F_OK = 1;
 937:Src/pid.c     **** 		}
 938:Src/pid.c     **** 		if(Grriper_Run == 1 && g_CmdMap[TAG_MOTOR_ENABLE] == 1)
 939:Src/pid.c     **** 		{		
 940:Src/pid.c     **** 			Flag_Profile_Enable = 1;
 941:Src/pid.c     **** 		}
 942:Src/pid.c     **** 		else
 943:Src/pid.c     **** 		{
 944:Src/pid.c     **** 			Flag_Profile_Enable = 0;
 945:Src/pid.c     **** 		}
 946:Src/pid.c     **** 		//ï¿½ï¿½ï¿½Î·ï¿½ï¿½ï¿½
 947:Src/pid.c     **** 		Profile();
 948:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 28


 949:Src/pid.c     **** 		PositionPID();	
 950:Src/pid.c     **** 	}
 951:Src/pid.c     **** }
 530              		.loc 1 951 0
 531 003c 70BD     		pop	{r4, r5, r6, pc}
 532              	.LVL16:
 533              	.L39:
 883:Src/pid.c     **** 		{
 534              		.loc 1 883 0
 535 003e 3F4A     		ldr	r2, .L59+32
 536 0040 1178     		ldrb	r1, [r2]	@ zero_extendqisi2
 537 0042 0129     		cmp	r1, #1
 538 0044 1146     		mov	r1, r2
 539 0046 40D1     		bne	.L42
 883:Src/pid.c     **** 		{
 540              		.loc 1 883 0 is_stmt 0 discriminator 1
 541 0048 B4F8B622 		ldrh	r2, [r4, #694]
 851:Src/pid.c     **** 	if(	(g_CmdMap[TAG_WORK_MODE] != MODE_POSITION) || Motor_forbidden == 1)
 542              		.loc 1 851 0 is_stmt 1 discriminator 1
 543 004c 1B1A     		subs	r3, r3, r0
 544              	.LVL17:
 883:Src/pid.c     **** 		{
 545              		.loc 1 883 0 discriminator 1
 546 004e 12B2     		sxth	r2, r2
 547 0050 9A42     		cmp	r2, r3
 548 0052 05DB     		blt	.L43
 883:Src/pid.c     **** 		{
 549              		.loc 1 883 0 is_stmt 0 discriminator 2
 550 0054 B4F8B622 		ldrh	r2, [r4, #694]
 551 0058 12B2     		sxth	r2, r2
 552 005a 5242     		negs	r2, r2
 553 005c 9A42     		cmp	r2, r3
 554 005e 34DD     		ble	.L42
 555              	.L43:
 885:Src/pid.c     **** 			
 556              		.loc 1 885 0 is_stmt 1
 557 0060 0023     		movs	r3, #0
 558 0062 0B70     		strb	r3, [r1]
 887:Src/pid.c     **** 				{
 559              		.loc 1 887 0
 560 0064 638A     		ldrh	r3, [r4, #18]
 892:Src/pid.c     **** 				Profile_ParaSet();
 561              		.loc 1 892 0
 562 0066 0323     		movs	r3, #3
 563 0068 A4F80432 		strh	r3, [r4, #516]	@ movhi
 893:Src/pid.c     **** 				if(g_CmdMap[CMD_USEER_MODE] == CMD_USEER_MODE_1_SERVO)
 564              		.loc 1 893 0
 565 006c FFF7FEFF 		bl	Profile_ParaSet
 566              	.LVL18:
 894:Src/pid.c     **** 				{
 567              		.loc 1 894 0
 568 0070 B4F84030 		ldrh	r3, [r4, #64]
 569 0074 1BB2     		sxth	r3, r3
 570 0076 012B     		cmp	r3, #1
 896:Src/pid.c     **** 				}
 571              		.loc 1 896 0
 572 0078 02BF     		ittt	eq
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 29


 573 007a 314B     		ldreq	r3, .L59+36
 574 007c 0022     		moveq	r2, #0
 575 007e 1A60     		streq	r2, [r3]	@ float
 899:Src/pid.c     **** 				Flag_grip_F_OK = 0;
 576              		.loc 1 899 0
 577 0080 2A4A     		ldr	r2, .L59+16
 578 0082 0023     		movs	r3, #0
 579 0084 1370     		strb	r3, [r2]
 900:Src/pid.c     **** 				Flag_grip_P_OK = 0;
 580              		.loc 1 900 0
 581 0086 2A4A     		ldr	r2, .L59+20
 582 0088 1370     		strb	r3, [r2]
 901:Src/pid.c     **** 				Flag_rellease_P_OK = 0;
 583              		.loc 1 901 0
 584 008a 2A4A     		ldr	r2, .L59+24
 585 008c 1370     		strb	r3, [r2]
 902:Src/pid.c     **** 				if(g_CmdMap[CMD_POS_SET_PU] < g_CmdMap[CMD_POS_ACT_PU])
 586              		.loc 1 902 0
 587 008e 2A4A     		ldr	r2, .L59+28
 588 0090 1370     		strb	r3, [r2]
 903:Src/pid.c     **** 				{
 589              		.loc 1 903 0
 590 0092 B4F84820 		ldrh	r2, [r4, #72]
 591 0096 B4F84C30 		ldrh	r3, [r4, #76]
 592 009a 12B2     		sxth	r2, r2
 593 009c 1BB2     		sxth	r3, r3
 594 009e 9A42     		cmp	r2, r3
 595 00a0 2EDA     		bge	.L46
 905:Src/pid.c     **** 					Grriper_Run = 1;
 596              		.loc 1 905 0
 597 00a2 0123     		movs	r3, #1
 598 00a4 3380     		strh	r3, [r6]	@ movhi
 599              	.L58:
 920:Src/pid.c     **** 					pid_pos.enable = 1;
 600              		.loc 1 920 0
 601 00a6 274A     		ldr	r2, .L59+40
 919:Src/pid.c     **** 					pid_spd.enable = 1;
 602              		.loc 1 919 0
 603 00a8 2B70     		strb	r3, [r5]
 920:Src/pid.c     **** 					pid_pos.enable = 1;
 604              		.loc 1 920 0
 605 00aa 1360     		str	r3, [r2]
 921:Src/pid.c     **** 					if(g_CmdMap[CMD_E_STOP] == 0 && (g_CmdMap[CMD_ERROR] & 0x0fff) == 0x0000)
 606              		.loc 1 921 0
 607 00ac 264A     		ldr	r2, .L59+44
 608 00ae 1360     		str	r3, [r2]
 922:Src/pid.c     **** 					{
 609              		.loc 1 922 0
 610 00b0 628A     		ldrh	r2, [r4, #18]
 611 00b2 12B2     		sxth	r2, r2
 612 00b4 32B9     		cbnz	r2, .L48
 922:Src/pid.c     **** 					{
 613              		.loc 1 922 0 is_stmt 0 discriminator 1
 614 00b6 B4F85420 		ldrh	r2, [r4, #84]
 615 00ba C2F30B02 		ubfx	r2, r2, #0, #12
 616 00be 0AB9     		cbnz	r2, .L48
 924:Src/pid.c     **** 					}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 30


 617              		.loc 1 924 0 is_stmt 1
 618 00c0 A4F80232 		strh	r3, [r4, #514]	@ movhi
 619              	.L48:
 926:Src/pid.c     **** 				}
 620              		.loc 1 926 0
 621 00c4 214B     		ldr	r3, .L59+48
 622 00c6 0022     		movs	r2, #0
 623 00c8 1A70     		strb	r2, [r3]
 624              	.L42:
 932:Src/pid.c     **** 
 625              		.loc 1 932 0
 626 00ca B4F84830 		ldrh	r3, [r4, #72]
 627 00ce 204A     		ldr	r2, .L59+52
 628 00d0 1BB2     		sxth	r3, r3
 629 00d2 1360     		str	r3, [r2]
 934:Src/pid.c     **** 		{
 630              		.loc 1 934 0
 631 00d4 B6F90030 		ldrsh	r3, [r6]
 632 00d8 012B     		cmp	r3, #1
 936:Src/pid.c     **** 		}
 633              		.loc 1 936 0
 634 00da 04BF     		itt	eq
 635 00dc 144A     		ldreq	r2, .L59+20
 636 00de 1370     		strbeq	r3, [r2]
 938:Src/pid.c     **** 		{		
 637              		.loc 1 938 0
 638 00e0 2B78     		ldrb	r3, [r5]	@ zero_extendqisi2
 639 00e2 1C4A     		ldr	r2, .L59+56
 640 00e4 012B     		cmp	r3, #1
 641 00e6 17D1     		bne	.L50
 938:Src/pid.c     **** 		{		
 642              		.loc 1 938 0 is_stmt 0 discriminator 1
 643 00e8 B4F80232 		ldrh	r3, [r4, #514]
 644 00ec 1BB2     		sxth	r3, r3
 645 00ee 012B     		cmp	r3, #1
 646 00f0 12D1     		bne	.L50
 647              	.L53:
 944:Src/pid.c     **** 		}
 648              		.loc 1 944 0 is_stmt 1
 649 00f2 1360     		str	r3, [r2]
 947:Src/pid.c     **** 		//Î»ï¿½Ãµï¿½ï¿½ï¿½
 650              		.loc 1 947 0
 651 00f4 FFF7FEFF 		bl	Profile
 652              	.LVL19:
 653              		.loc 1 951 0
 654 00f8 BDE87040 		pop	{r4, r5, r6, lr}
 655              	.LCFI4:
 656              		.cfi_remember_state
 657              		.cfi_restore 14
 658              		.cfi_restore 6
 659              		.cfi_restore 5
 660              		.cfi_restore 4
 661              		.cfi_def_cfa_offset 0
 949:Src/pid.c     **** 	}
 662              		.loc 1 949 0
 663 00fc FFF7FEBF 		b	PositionPID
 664              	.LVL20:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 31


 665              	.L46:
 666              	.LCFI5:
 667              		.cfi_restore_state
 916:Src/pid.c     **** 				{
 668              		.loc 1 916 0
 669 0100 B4F84820 		ldrh	r2, [r4, #72]
 670 0104 B4F84C30 		ldrh	r3, [r4, #76]
 671 0108 12B2     		sxth	r2, r2
 672 010a 1BB2     		sxth	r3, r3
 673 010c 9A42     		cmp	r2, r3
 674 010e DCDD     		ble	.L42
 918:Src/pid.c     **** 					Grriper_Run = 1;
 675              		.loc 1 918 0
 676 0110 0223     		movs	r3, #2
 677 0112 3380     		strh	r3, [r6]	@ movhi
 919:Src/pid.c     **** 					pid_spd.enable = 1;
 678              		.loc 1 919 0
 679 0114 0123     		movs	r3, #1
 680 0116 C6E7     		b	.L58
 681              	.L50:
 944:Src/pid.c     **** 		}
 682              		.loc 1 944 0
 683 0118 0023     		movs	r3, #0
 684 011a EAE7     		b	.L53
 685              	.L60:
 686              		.align	2
 687              	.L59:
 688 011c 00000000 		.word	g_CmdMap
 689 0120 00000000 		.word	Gripper_Move
 690 0124 00000000 		.word	.LANCHOR4
 691 0128 00000000 		.word	Motor_forbidden
 692 012c 00000000 		.word	Flag_contact
 693 0130 00000000 		.word	Flag_grip_F_OK
 694 0134 00000000 		.word	Flag_grip_P_OK
 695 0138 00000000 		.word	Flag_rellease_P_OK
 696 013c 00000000 		.word	.LANCHOR5
 697 0140 00000000 		.word	tCnt_f
 698 0144 00000000 		.word	pid_spd
 699 0148 00000000 		.word	pid_pos
 700 014c 00000000 		.word	.LANCHOR6
 701 0150 00000000 		.word	g_pos_tag
 702 0154 00000000 		.word	Flag_Profile_Enable
 703              		.cfi_endproc
 704              	.LFE341:
 706              		.section	.text.phase_current_from_adcval,"ax",%progbits
 707              		.align	1
 708              		.global	phase_current_from_adcval
 709              		.syntax unified
 710              		.thumb
 711              		.thumb_func
 712              		.fpu fpv4-sp-d16
 714              	phase_current_from_adcval:
 715              	.LFB345:
 952:Src/pid.c     **** 	float v = 11.84;
 953:Src/pid.c     **** 	float L,temp_L;
 954:Src/pid.c     **** 
 955:Src/pid.c     **** extern volatile  int delta_alpha;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 32


 956:Src/pid.c     **** extern volatile  int delata_beta;
 957:Src/pid.c     **** 
 958:Src/pid.c     **** int observer_ElectricAngle;
 959:Src/pid.c     **** int observer_speed;
 960:Src/pid.c     **** int integre_observer_ElectricAngle;
 961:Src/pid.c     **** 
 962:Src/pid.c     **** void hfi_update_angle(void)
 963:Src/pid.c     **** {
 964:Src/pid.c     **** 	int X,Y;
 965:Src/pid.c     **** 	int temp_x;
 966:Src/pid.c     **** 	int temp_y;
 967:Src/pid.c     **** 	int pll_intput;
 968:Src/pid.c     **** 	int temp_q,temp_d;
 969:Src/pid.c     **** 	static float inr_angle = 0;
 970:Src/pid.c     **** 	int  observer_ElectricAngle1;
 971:Src/pid.c     **** 	
 972:Src/pid.c     **** 	pid_pll.dead_zone = 0;
 973:Src/pid.c     **** 	pid_pll.Kp = 1000;
 974:Src/pid.c     **** 	pid_pll.Ki = 10;
 975:Src/pid.c     **** 	pid_pll.Kd = 0;
 976:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 977:Src/pid.c     **** 	pid_pll.enable =1;
 978:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 979:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 980:Src/pid.c     **** 	
 981:Src/pid.c     **** 	
 982:Src/pid.c     **** 	park_transform(delta_alpha, delata_beta, &temp_q, &temp_d,g_ElectricAngle);
 983:Src/pid.c     **** 	
 984:Src/pid.c     **** 	L = v *1.7321*500*1000 /(g_Iq * F_CUR_REGULATOR_HZ/1000 ) /3 /MAX_CCR*0.58*0.7; //0.7 Ïµï¿½ï¿½ï¿½ï
 985:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
 986:Src/pid.c     **** 	
 987:Src/pid.c     **** 	X = Math_Sin_EN360(observer_ElectricAngle);
 988:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 989:Src/pid.c     **** 	
 990:Src/pid.c     **** 	temp_x = Q15_MUL(delta_alpha,X);
 991:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 992:Src/pid.c     **** 	
 993:Src/pid.c     **** 	pll_intput = temp_x - temp_y;  //+ 90ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ x -y ? ,y -x ï¿½ï¿½
 994:Src/pid.c     **** 	
 995:Src/pid.c     **** 	PID_control(0,pll_intput,&pid_pll);
 996:Src/pid.c     **** 	observer_speed = pid_pll.out;
 997:Src/pid.c     **** 	
 998:Src/pid.c     **** 	integre_observer_ElectricAngle +=observer_speed; //update angle
 999:Src/pid.c     **** 	
1000:Src/pid.c     **** 	observer_ElectricAngle = integre_observer_ElectricAngle /100;
1001:Src/pid.c     **** 	
1002:Src/pid.c     **** 	observer_ElectricAngle  &= 0x7fff; 
1003:Src/pid.c     **** 	
1004:Src/pid.c     **** 	observer_ElectricAngle1= observer_ElectricAngle  + EN_90;// EN_90;//EN_90; 
1005:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
1006:Src/pid.c     **** 	
1007:Src/pid.c     **** 	g_ElectricAngle = observer_ElectricAngle1;
1008:Src/pid.c     **** 	
1009:Src/pid.c     **** #if 0 	 //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½Å³ï¿½
1010:Src/pid.c     **** 	inr_angle  += 0.1;
1011:Src/pid.c     **** 	if(inr_angle  > 32768 )
1012:Src/pid.c     **** 		inr_angle = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 33


1013:Src/pid.c     **** 	g_ElectricAngle = 0;
1014:Src/pid.c     **** #endif
1015:Src/pid.c     **** 	
1016:Src/pid.c     **** }
1017:Src/pid.c     **** 
1018:Src/pid.c     **** 
1019:Src/pid.c     **** static void OpenLoop(void)
1020:Src/pid.c     **** {
1021:Src/pid.c     **** 	int X,Y;
1022:Src/pid.c     **** 	int temp_x;
1023:Src/pid.c     **** 	int temp_y;
1024:Src/pid.c     **** 	int pll_intput;
1025:Src/pid.c     **** 	
1026:Src/pid.c     ****   s16 temp32 = g_CmdMap[TAG_OPEN_PWM] * REAL_CCR / 100;  // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½×ªï¿½ï¿½ï¿½ï¿½ï
1027:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
1028:Src/pid.c     **** 	
1029:Src/pid.c     **** 	g_Vq = g_Timer1CCR;  
1030:Src/pid.c     **** 	g_Vd = 0;
1031:Src/pid.c     **** 
1032:Src/pid.c     **** 	X = Math_Sin_EN360( g_ElectricAngle  );
1033:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
1034:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
1035:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
1036:Src/pid.c     **** 
1037:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
1038:Src/pid.c     **** 
1039:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1040:Src/pid.c     **** //	if(observer_speed < 0)
1041:Src/pid.c     **** //	{
1042:Src/pid.c     **** //		g_ElectricAngle = 0 - g_ElectricAngle;
1043:Src/pid.c     **** //	}
1044:Src/pid.c     **** //	g_ElectricAngle += 32768;
1045:Src/pid.c     **** //	g_ElectricAngle &= 0x7fff;
1046:Src/pid.c     **** 	anlge_reg = g_ElectricAngle;//observer_ElectricAngle;
1047:Src/pid.c     **** 	
1048:Src/pid.c     **** 	if(anlge_reg < EN_0)
1049:Src/pid.c     **** 	{
1050:Src/pid.c     **** 		anlge_reg = anlge_reg+EN_360;
1051:Src/pid.c     **** 	}
1052:Src/pid.c     **** 	else if(anlge_reg > EN_360)
1053:Src/pid.c     **** 	{
1054:Src/pid.c     **** 		anlge_reg = anlge_reg-EN_360;
1055:Src/pid.c     **** 	}
1056:Src/pid.c     ****   PWM_OutPut_Open(TIM1, anlge_reg, g_Timer1CCR);
1057:Src/pid.c     **** }
1058:Src/pid.c     **** // ï¿½Õ»ï¿½Ä£Ê½ï¿½ï¿½ï¿½
1059:Src/pid.c     **** //static void CheckModeChange(void)
1060:Src/pid.c     **** //{
1061:Src/pid.c     **** //  static s32 s_OldMode = 0;
1062:Src/pid.c     **** //  if (s_OldMode != g_CmdMap[TAG_WORK_MODE])
1063:Src/pid.c     **** //  {
1064:Src/pid.c     **** //    if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1065:Src/pid.c     **** //		{
1066:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 16384;
1067:Src/pid.c     **** //		}
1068:Src/pid.c     **** //		else
1069:Src/pid.c     **** //		{
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 34


1070:Src/pid.c     **** //			g_CmdMap[CMD_SPD_SET_PU] = 0;
1071:Src/pid.c     **** //		}
1072:Src/pid.c     **** //    g_CmdMap[CMD_CUR_SET_PU] = 0;
1073:Src/pid.c     **** //  }
1074:Src/pid.c     **** //  s_OldMode = g_CmdMap[TAG_WORK_MODE];
1075:Src/pid.c     **** //}
1076:Src/pid.c     **** 
1077:Src/pid.c     ****  volatile s32 s_Disable_Delay = 0;
1078:Src/pid.c     **** 
1079:Src/pid.c     **** static void Pos_Spd_PID(void)
1080:Src/pid.c     **** {
1081:Src/pid.c     **** 	static s32 s_count = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1082:Src/pid.c     ****   static s32 s_Enable_Delay = 0; 	// Ê¹ï¿½ï¿½Hï¿½Åºï¿½ï¿½ï¿½ï¿½Ê±Ê±ï¿½ï¿½
1083:Src/pid.c     ****  GPIOA->BRR  |= (uint32_t)GPIO_PIN_4;
1084:Src/pid.c     **** 	//CheckModeChange();
1085:Src/pid.c     **** 	MTPro();
1086:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
1087:Src/pid.c     **** 	{
1088:Src/pid.c     **** 		g_servo_cmd_period_cnt++; //ï¿½ï¿½ÆµÎ»ï¿½ï¿½ï¿½Å·ï¿½ï¿½Â£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ú¼ï¿½Ê±
1089:Src/pid.c     **** 	}
1090:Src/pid.c     **** 	get_average_force_data();	
1091:Src/pid.c     **** 	
1092:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_FORCE)
1093:Src/pid.c     **** 	{
1094:Src/pid.c     **** 		ForcePID();
1095:Src/pid.c     **** 	}
1096:Src/pid.c     **** 	
1097:Src/pid.c     **** 	
1098:Src/pid.c     **** 	Loop3_EnableManage();
1099:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
1100:Src/pid.c     **** 	{
1101:Src/pid.c     **** 		s_count = 0;
1102:Src/pid.c     **** 		Flag_1ms = 1;
1103:Src/pid.c     **** 		if(++s_count_50ms>50)
1104:Src/pid.c     **** 		{
1105:Src/pid.c     **** 			s_count_50ms = 0;
1106:Src/pid.c     **** 			Flag_50ms = 1;
1107:Src/pid.c     **** 		}
1108:Src/pid.c     **** 		
1109:Src/pid.c     **** 		
1110:Src/pid.c     **** 		
1111:Src/pid.c     **** 		Get_Pos_Rod();
1112:Src/pid.c     **** 		Stroke_protection();
1113:Src/pid.c     **** 		
1114:Src/pid.c     **** //		if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION)
1115:Src/pid.c     **** 		{
1116:Src/pid.c     **** 			Gripper_control();	
1117:Src/pid.c     **** 		}
1118:Src/pid.c     **** 	}
1119:Src/pid.c     **** 	
1120:Src/pid.c     **** 	icmu_sdtransmission_test();
1121:Src/pid.c     **** 	
1122:Src/pid.c     **** 	
1123:Src/pid.c     **** 	if(g_CmdMap[TAG_WORK_MODE] == MODE_POSITION || g_CmdMap[TAG_WORK_MODE] == MODE_SPEED  ||  g_CmdMap
1124:Src/pid.c     **** 	{
1125:Src/pid.c     **** 		SpeedPID();
1126:Src/pid.c     **** 	}	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 35


1127:Src/pid.c     ****   // Hï¿½Å´Ó½ï¿½ï¿½Üµï¿½Ê¹ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½ï¿½È´ï¿½ï¿½Ìµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿
1128:Src/pid.c     ****   if(g_CmdMap[TAG_MOTOR_ENABLE] == 0 || Motor_forbidden == 1 || Motor_emergercy_stop == 1 || Motor_
1129:Src/pid.c     **** 	{
1130:Src/pid.c     **** 		s_Enable_Delay = 0;
1131:Src/pid.c     **** 		Motor_forbidden = 0;
1132:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1133:Src/pid.c     **** 		{
1134:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
1135:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
1136:Src/pid.c     **** 		}
1137:Src/pid.c     **** 		if(g_CmdMap[CMD_ERROR] != 0)
1138:Src/pid.c     **** 		{	
1139:Src/pid.c     **** 			g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
1140:Src/pid.c     **** 		}			
1141:Src/pid.c     **** //		if(s_Disable_Delay <= 1) s_Disable_Delay ++;
1142:Src/pid.c     **** //		if (s_Disable_Delay == 1) // ï¿½ï¿½Ê¹ï¿½Ü±ï¿½Îªï¿½ï¿½ï¿½ï¿½ 50ms
1143:Src/pid.c     **** 		{
1144:Src/pid.c     **** //			s_Disable_Delay = 0;
1145:Src/pid.c     **** 			g_Timer1CCR = 0;
1146:Src/pid.c     ****       Motor_emergercy_stop =0;
1147:Src/pid.c     **** 			Motor_pause_flag = 0;
1148:Src/pid.c     **** 			PWM_Disable();
1149:Src/pid.c     **** 		}
1150:Src/pid.c     **** //		if (s_Disable_Delay > 1)
1151:Src/pid.c     **** //		{
1152:Src/pid.c     **** //			s_Disable_Delay =2;
1153:Src/pid.c     **** //		}
1154:Src/pid.c     **** 		g_Vq = 0;
1155:Src/pid.c     **** 		return;
1156:Src/pid.c     **** 	}
1157:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && Motor_forbidden == 0)
1158:Src/pid.c     **** 	{
1159:Src/pid.c     **** 		if(s_Enable_Delay <= 2) s_Enable_Delay ++;
1160:Src/pid.c     **** 		s_Disable_Delay = 0;
1161:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
1162:Src/pid.c     **** 		{
1163:Src/pid.c     **** 			if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
1164:Src/pid.c     **** 			{
1165:Src/pid.c     **** 				g_CmdMap[CMD_SPD_SET_PU] = 0;
1166:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
1167:Src/pid.c     **** 			}
1168:Src/pid.c     **** 			g_Timer1CCR = 0;		
1169:Src/pid.c     **** 			PWM_Enable();			
1170:Src/pid.c     **** 		}
1171:Src/pid.c     **** 		return;
1172:Src/pid.c     **** 	}  
1173:Src/pid.c     **** }
1174:Src/pid.c     **** s32 I_Alpha, I_Beta; 
1175:Src/pid.c     **** extern 	volatile  int hall_ture_value;
1176:Src/pid.c     **** extern 	volatile  int last_hall_ture_value;
1177:Src/pid.c     **** extern volatile  s32 sample_invered;
1178:Src/pid.c     **** 
1179:Src/pid.c     **** volatile  int delta_alpha;
1180:Src/pid.c     **** volatile  int delata_beta;
1181:Src/pid.c     **** int last_alpha = 0;
1182:Src/pid.c     **** int last_beta = 0;
1183:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 36


1184:Src/pid.c     **** float phase_current_rev_gain_ = 1.0f/16.5f;
1185:Src/pid.c     **** float shunt_conductance1 = 1.0f/(0.011f * 1.1f);
1186:Src/pid.c     **** float shunt_conductance2 = 1.0f/(0.01f*1.1f);
1187:Src/pid.c     **** 
1188:Src/pid.c     **** 
1189:Src/pid.c     **** float phase_current_from_adcval(s32 adcval_bal)
1190:Src/pid.c     **** {
 716              		.loc 1 1190 0
 717              		.cfi_startproc
 718              		@ args = 0, pretend = 0, frame = 0
 719              		@ frame_needed = 0, uses_anonymous_args = 0
 720              		@ link register save eliminated.
 721              	.LVL21:
1191:Src/pid.c     ****   float amp_out_volt = (3300.0f / (float)(1 << 12)) * (float)adcval_bal;
 722              		.loc 1 1191 0
 723 0000 07EE900A 		vmov	s15, r0	@ int
 724 0004 9FED050A 		vldr.32	s0, .L62
1192:Src/pid.c     ****   float shunt_volt = amp_out_volt * phase_current_rev_gain_;
 725              		.loc 1 1192 0
 726 0008 054B     		ldr	r3, .L62+4
1191:Src/pid.c     ****   float amp_out_volt = (3300.0f / (float)(1 << 12)) * (float)adcval_bal;
 727              		.loc 1 1191 0
 728 000a F8EEE77A 		vcvt.f32.s32	s15, s15
 729 000e 67EE807A 		vmul.f32	s15, s15, s0
 730              	.LVL22:
 731              		.loc 1 1192 0
 732 0012 93ED000A 		vldr.32	s0, [r3]
1193:Src/pid.c     ****   return shunt_volt ;
1194:Src/pid.c     **** }
 733              		.loc 1 1194 0
 734 0016 27EE800A 		vmul.f32	s0, s15, s0
 735              	.LVL23:
 736 001a 7047     		bx	lr
 737              	.L63:
 738              		.align	2
 739              	.L62:
 740 001c 00404E3F 		.word	1062092800
 741 0020 00000000 		.word	.LANCHOR7
 742              		.cfi_endproc
 743              	.LFE345:
 745              		.section	.text.GetCurrent,"ax",%progbits
 746              		.align	1
 747              		.global	GetCurrent
 748              		.syntax unified
 749              		.thumb
 750              		.thumb_func
 751              		.fpu fpv4-sp-d16
 753              	GetCurrent:
 754              	.LFB346:
1195:Src/pid.c     **** void GetCurrent(void)
1196:Src/pid.c     **** {
 755              		.loc 1 1196 0
 756              		.cfi_startproc
 757              		@ args = 0, pretend = 0, frame = 0
 758              		@ frame_needed = 0, uses_anonymous_args = 0
 759              	.LVL24:
1197:Src/pid.c     ****   s32 i=0, j=0,I_B1 = 0,I_C1 = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 37


1198:Src/pid.c     **** 
1199:Src/pid.c     **** 	
1200:Src/pid.c     **** 	g_IC_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorC)*1*1000.0f); // mA	
 760              		.loc 1 1200 0
 761 0000 4FF0A041 		mov	r1, #1342177280
 762 0004 624B     		ldr	r3, .L74
 763 0006 D1F88000 		ldr	r0, [r1, #128]
 764 000a 1B68     		ldr	r3, [r3]
1196:Src/pid.c     ****   s32 i=0, j=0,I_B1 = 0,I_C1 = 0;
 765              		.loc 1 1196 0
 766 000c 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 767              	.LCFI6:
 768              		.cfi_def_cfa_offset 24
 769              		.cfi_offset 4, -24
 770              		.cfi_offset 5, -20
 771              		.cfi_offset 6, -16
 772              		.cfi_offset 7, -12
 773              		.cfi_offset 8, -8
 774              		.cfi_offset 14, -4
 775              		.loc 1 1200 0
 776 0010 C01A     		subs	r0, r0, r3
 777 0012 FFF7FEFF 		bl	phase_current_from_adcval
 778              	.LVL25:
 779 0016 9FED5F7A 		vldr.32	s14, .L74+4
 780 001a 5F4B     		ldr	r3, .L74+8
1201:Src/pid.c     **** 	g_IB_Raw = (s16)(-phase_current_from_adcval(ADC2->JDR1-g_ZeroCur_MotorB)*shunt_conductance2); // m
1202:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
1203:Src/pid.c     **** 	
1204:Src/pid.c     **** 	g_IA = g_IA_Raw;
1205:Src/pid.c     **** 	g_IB = g_IB_Raw;
 781              		.loc 1 1205 0
 782 001c 5F4D     		ldr	r5, .L74+12
1206:Src/pid.c     **** 	g_IC = 0 - g_IA_Raw -g_IB_Raw;
 783              		.loc 1 1206 0
 784 001e 604C     		ldr	r4, .L74+16
1207:Src/pid.c     **** 	
1208:Src/pid.c     **** 	update_current_meas(&motor_, g_IA/1000.0f, g_IB/1000.0f, g_IC/1000.0f);
1209:Src/pid.c     **** 
1210:Src/pid.c     **** 	I_Alpha = -(g_IB + g_IC);             // ï¿½È·ï¿½Clark:I_Alpha = (2/3)*(I_a - 0.5*I_b - 0.5*I_c)= 
1211:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 785              		.loc 1 1211 0
 786 0020 604E     		ldr	r6, .L74+20
1200:Src/pid.c     **** 	g_IB_Raw = (s16)(-phase_current_from_adcval(ADC2->JDR1-g_ZeroCur_MotorB)*shunt_conductance2); // m
 787              		.loc 1 1200 0
 788 0022 20EE470A 		vnmul.f32	s0, s0, s14
 789 0026 BDEEC00A 		vcvt.s32.f32	s0, s0
 790 002a 10EE102A 		vmov	r2, s0	@ int
 791 002e 1A80     		strh	r2, [r3]	@ movhi
1201:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
 792              		.loc 1 1201 0
 793 0030 5D4B     		ldr	r3, .L74+24
 794 0032 D3F88000 		ldr	r0, [r3, #128]
 795 0036 5D4B     		ldr	r3, .L74+28
 796 0038 1B68     		ldr	r3, [r3]
 797 003a C01A     		subs	r0, r0, r3
 798 003c FFF7FEFF 		bl	phase_current_from_adcval
 799              	.LVL26:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 38


 800 0040 5B4B     		ldr	r3, .L74+32
1202:Src/pid.c     **** 	
 801              		.loc 1 1202 0
 802 0042 D1F88000 		ldr	r0, [r1, #128]
1201:Src/pid.c     **** 	g_IA_Raw = (s16)(-phase_current_from_adcval(ADC1->JDR1-g_ZeroCur_MotorA)*shunt_conductance1); // m
 803              		.loc 1 1201 0
 804 0046 D3ED007A 		vldr.32	s15, [r3]
 805 004a 20EE670A 		vnmul.f32	s0, s0, s15
 806 004e BDEEC00A 		vcvt.s32.f32	s0, s0
 807 0052 10EE103A 		vmov	r3, s0	@ int
 808 0056 1AB2     		sxth	r2, r3
 809 0058 564B     		ldr	r3, .L74+36
 810 005a 1A80     		strh	r2, [r3]	@ movhi
1202:Src/pid.c     **** 	
 811              		.loc 1 1202 0
 812 005c 564B     		ldr	r3, .L74+40
 813 005e 1B68     		ldr	r3, [r3]
 814 0060 C01A     		subs	r0, r0, r3
 815 0062 FFF7FEFF 		bl	phase_current_from_adcval
 816              	.LVL27:
 817 0066 554B     		ldr	r3, .L74+44
 818 0068 5549     		ldr	r1, .L74+48
 819 006a D3ED007A 		vldr.32	s15, [r3]
1208:Src/pid.c     **** 
 820              		.loc 1 1208 0
 821 006e 5548     		ldr	r0, .L74+52
1205:Src/pid.c     **** 	g_IC = 0 - g_IA_Raw -g_IB_Raw;
 822              		.loc 1 1205 0
 823 0070 2A80     		strh	r2, [r5]	@ movhi
1202:Src/pid.c     **** 	
 824              		.loc 1 1202 0
 825 0072 20EE670A 		vnmul.f32	s0, s0, s15
 826 0076 BDEEC00A 		vcvt.s32.f32	s0, s0
 827 007a 10EE103A 		vmov	r3, s0	@ int
 828 007e 1BB2     		sxth	r3, r3
 829 0080 0B80     		strh	r3, [r1]	@ movhi
1204:Src/pid.c     **** 	g_IB = g_IB_Raw;
 830              		.loc 1 1204 0
 831 0082 5149     		ldr	r1, .L74+56
 832 0084 0B80     		strh	r3, [r1]	@ movhi
1206:Src/pid.c     **** 	
 833              		.loc 1 1206 0
 834 0086 D118     		adds	r1, r2, r3
 835 0088 4942     		negs	r1, r1
 836 008a 09B2     		sxth	r1, r1
1208:Src/pid.c     **** 
 837              		.loc 1 1208 0
 838 008c 07EE901A 		vmov	s15, r1	@ int
 839 0090 B8EEE71A 		vcvt.f32.s32	s2, s15
 840 0094 07EE902A 		vmov	s15, r2	@ int
 841 0098 F8EEE70A 		vcvt.f32.s32	s1, s15
 842 009c 07EE903A 		vmov	s15, r3	@ int
 843 00a0 B8EEE70A 		vcvt.f32.s32	s0, s15
 844 00a4 81EE071A 		vdiv.f32	s2, s2, s14
1206:Src/pid.c     **** 	
 845              		.loc 1 1206 0
 846 00a8 2180     		strh	r1, [r4]	@ movhi
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 39


1208:Src/pid.c     **** 
 847              		.loc 1 1208 0
 848 00aa C0EE870A 		vdiv.f32	s1, s1, s14
 849 00ae 80EE070A 		vdiv.f32	s0, s0, s14
 850 00b2 FFF7FEFF 		bl	update_current_meas
 851              	.LVL28:
1210:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 852              		.loc 1 1210 0
 853 00b6 B4F90020 		ldrsh	r2, [r4]
 854 00ba B5F90000 		ldrsh	r0, [r5]
 855 00be 434C     		ldr	r4, .L74+60
1212:Src/pid.c     **** 	
1213:Src/pid.c     **** 	delta_alpha = I_Alpha - last_alpha;
 856              		.loc 1 1213 0
 857 00c0 434D     		ldr	r5, .L74+64
1210:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 858              		.loc 1 1210 0
 859 00c2 8318     		adds	r3, r0, r2
 860 00c4 5B42     		negs	r3, r3
1211:Src/pid.c     **** 	
 861              		.loc 1 1211 0
 862 00c6 44F6E711 		movw	r1, #18919
 863 00ca 801A     		subs	r0, r0, r2
1210:Src/pid.c     **** 	I_Beta = Q15_MUL(g_IB - g_IC,18919);  // ï¿½È·ï¿½Clark:I_Beta =  (2/3)*(ib-ic)*0.5*squr(3) = (ib-i
 864              		.loc 1 1210 0
 865 00cc 2360     		str	r3, [r4]
1211:Src/pid.c     **** 	
 866              		.loc 1 1211 0
 867 00ce FFF7FEFF 		bl	Q15_MUL
 868              	.LVL29:
 869              		.loc 1 1213 0
 870 00d2 2768     		ldr	r7, [r4]
 871 00d4 2B68     		ldr	r3, [r5]
1214:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 872              		.loc 1 1214 0
 873 00d6 DFF820C1 		ldr	ip, .L74+104
1213:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 874              		.loc 1 1213 0
 875 00da 3E4A     		ldr	r2, .L74+68
1215:Src/pid.c     **** 	
1216:Src/pid.c     **** 	delta_alpha *= g_high_fre_pulse;
 876              		.loc 1 1216 0
 877 00dc DFF81CE1 		ldr	lr, .L74+108
1217:Src/pid.c     **** 	delata_beta *= g_high_fre_pulse;
1218:Src/pid.c     **** 	
1219:Src/pid.c     **** 	last_alpha = I_Alpha;
 878              		.loc 1 1219 0
 879 00e0 2F60     		str	r7, [r5]
1213:Src/pid.c     **** 	delata_beta = I_Beta - last_beta;
 880              		.loc 1 1213 0
 881 00e2 FB1A     		subs	r3, r7, r3
 882 00e4 1360     		str	r3, [r2]
1214:Src/pid.c     **** 	
 883              		.loc 1 1214 0
 884 00e6 DCF80030 		ldr	r3, [ip]
1220:Src/pid.c     **** 	last_beta = I_Beta;
1221:Src/pid.c     **** 	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 40


1222:Src/pid.c     **** 	i = Math_Sin_EN360(g_ElectricAngle );
 885              		.loc 1 1222 0
 886 00ea 3B4D     		ldr	r5, .L74+72
1220:Src/pid.c     **** 	last_beta = I_Beta;
 887              		.loc 1 1220 0
 888 00ec CCF80000 		str	r0, [ip]
1214:Src/pid.c     **** 	
 889              		.loc 1 1214 0
 890 00f0 C11A     		subs	r1, r0, r3
 891 00f2 3A4B     		ldr	r3, .L74+76
1211:Src/pid.c     **** 	
 892              		.loc 1 1211 0
 893 00f4 3060     		str	r0, [r6]
1214:Src/pid.c     **** 	
 894              		.loc 1 1214 0
 895 00f6 1960     		str	r1, [r3]
1216:Src/pid.c     **** 	delata_beta *= g_high_fre_pulse;
 896              		.loc 1 1216 0
 897 00f8 DEF80010 		ldr	r1, [lr]
 898 00fc D2F80080 		ldr	r8, [r2]
 899 0100 01FB08F1 		mul	r1, r1, r8
 900 0104 1160     		str	r1, [r2]
1217:Src/pid.c     **** 	
 901              		.loc 1 1217 0
 902 0106 DEF80020 		ldr	r2, [lr]
 903 010a 1968     		ldr	r1, [r3]
 904 010c 4A43     		muls	r2, r1, r2
 905 010e 1A60     		str	r2, [r3]
 906              		.loc 1 1222 0
 907 0110 2868     		ldr	r0, [r5]
 908 0112 80B2     		uxth	r0, r0
 909 0114 FFF7FEFF 		bl	Math_Sin_EN360
 910              	.LVL30:
 911 0118 0746     		mov	r7, r0
 912              	.LVL31:
1223:Src/pid.c     **** 	j = Math_Cos_EN360(g_ElectricAngle );
 913              		.loc 1 1223 0
 914 011a 2868     		ldr	r0, [r5]
 915              	.LVL32:
 916 011c 80B2     		uxth	r0, r0
 917 011e FFF7FEFF 		bl	Math_Cos_EN360
 918              	.LVL33:
1224:Src/pid.c     **** 	//I_B1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
1225:Src/pid.c     **** 	//I_C1 = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
1226:Src/pid.c     **** 	I_B1 = -Q15_MUL(i, I_Alpha) + Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 919              		.loc 1 1226 0
 920 0122 3168     		ldr	r1, [r6]
1223:Src/pid.c     **** 	j = Math_Cos_EN360(g_ElectricAngle );
 921              		.loc 1 1223 0
 922 0124 8046     		mov	r8, r0
 923              	.LVL34:
 924              		.loc 1 1226 0
 925 0126 FFF7FEFF 		bl	Q15_MUL
 926              	.LVL35:
 927 012a 2168     		ldr	r1, [r4]
 928 012c 0546     		mov	r5, r0
 929 012e 3846     		mov	r0, r7
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 41


 930 0130 FFF7FEFF 		bl	Q15_MUL
 931              	.LVL36:
1227:Src/pid.c     **** 	I_C1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 932              		.loc 1 1227 0
 933 0134 2168     		ldr	r1, [r4]
1226:Src/pid.c     **** 	I_C1 = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 934              		.loc 1 1226 0
 935 0136 2D1A     		subs	r5, r5, r0
 936              	.LVL37:
 937              		.loc 1 1227 0
 938 0138 4046     		mov	r0, r8
 939 013a FFF7FEFF 		bl	Q15_MUL
 940              	.LVL38:
 941 013e 3168     		ldr	r1, [r6]
 942 0140 0446     		mov	r4, r0
 943 0142 3846     		mov	r0, r7
 944 0144 FFF7FEFF 		bl	Q15_MUL
 945              	.LVL39:
1228:Src/pid.c     **** //		I_B1 = (I_B1>>3)<<3;
1229:Src/pid.c     **** //		I_C1 = (I_C1>>3)<<3;
1230:Src/pid.c     **** 
1231:Src/pid.c     ****   if (g_bEnableHB != 0 && (pid_IQ.enable == 1||g_CmdMap[TAG_WORK_MODE] == MODE_OPEN))
 946              		.loc 1 1231 0
 947 0148 254B     		ldr	r3, .L74+80
 948 014a 2649     		ldr	r1, .L74+84
 949 014c 1A88     		ldrh	r2, [r3]
 950 014e 264B     		ldr	r3, .L74+88
 951 0150 12B2     		sxth	r2, r2
1227:Src/pid.c     **** //		I_B1 = (I_B1>>3)<<3;
 952              		.loc 1 1227 0
 953 0152 2044     		add	r0, r0, r4
 954              	.LVL40:
 955 0154 254C     		ldr	r4, .L74+92
 956              		.loc 1 1231 0
 957 0156 2AB1     		cbz	r2, .L65
 958              		.loc 1 1231 0 is_stmt 0 discriminator 1
 959 0158 254A     		ldr	r2, .L74+96
 960 015a 1268     		ldr	r2, [r2]
 961 015c 012A     		cmp	r2, #1
 962 015e 18BF     		it	ne
 963 0160 B1F80422 		ldrhne	r2, [r1, #516]
 964              	.L65:
1232:Src/pid.c     ****   {
1233:Src/pid.c     **** 		g_Iq = I_B1;
1234:Src/pid.c     **** 		g_Id = I_C1;	
1235:Src/pid.c     **** 	}
1236:Src/pid.c     **** 	else
1237:Src/pid.c     **** 	{
1238:Src/pid.c     **** 		g_Iq = I_B1;
 965              		.loc 1 1238 0 is_stmt 1
 966 0164 2560     		str	r5, [r4]
1239:Src/pid.c     **** 		g_Id = I_C1;	
 967              		.loc 1 1239 0
 968 0166 1860     		str	r0, [r3]
1240:Src/pid.c     **** 	}
1241:Src/pid.c     **** 	g_CmdMap[CMD_CUR_D_ACT_PU] = g_Id*PU_REFERENCE/(*g_pCur_ref_base_mA);
 969              		.loc 1 1241 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 42


 970 0168 1A68     		ldr	r2, [r3]
 971 016a 224B     		ldr	r3, .L74+100
 972 016c 1B68     		ldr	r3, [r3]
 973 016e 9203     		lsls	r2, r2, #14
 974 0170 1868     		ldr	r0, [r3]
 975              	.LVL41:
 976 0172 92FBF0F2 		sdiv	r2, r2, r0
 977 0176 12B2     		sxth	r2, r2
 978 0178 A1F89422 		strh	r2, [r1, #660]	@ movhi
 979              	.LVL42:
1242:Src/pid.c     **** 	g_CmdMap[CMD_CUR_ACT_PU] = g_Iq*PU_REFERENCE/(*g_pCur_ref_base_mA);
 980              		.loc 1 1242 0
 981 017c 2368     		ldr	r3, [r4]
 982 017e 9B03     		lsls	r3, r3, #14
 983 0180 93FBF0F3 		sdiv	r3, r3, r0
 984 0184 1BB2     		sxth	r3, r3
 985 0186 A1F84E30 		strh	r3, [r1, #78]	@ movhi
1243:Src/pid.c     **** 	
1244:Src/pid.c     **** 	
1245:Src/pid.c     **** }
 986              		.loc 1 1245 0
 987 018a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 988              	.LVL43:
 989              	.L75:
 990 018e 00BF     		.align	2
 991              	.L74:
 992 0190 00000000 		.word	g_ZeroCur_MotorC
 993 0194 00007A44 		.word	1148846080
 994 0198 00000000 		.word	.LANCHOR8
 995 019c 00000000 		.word	.LANCHOR14
 996 01a0 00000000 		.word	.LANCHOR15
 997 01a4 00000000 		.word	I_Beta
 998 01a8 00010050 		.word	1342177536
 999 01ac 00000000 		.word	g_ZeroCur_MotorB
 1000 01b0 00000000 		.word	.LANCHOR9
 1001 01b4 00000000 		.word	.LANCHOR10
 1002 01b8 00000000 		.word	g_ZeroCur_MotorA
 1003 01bc 00000000 		.word	.LANCHOR11
 1004 01c0 00000000 		.word	.LANCHOR12
 1005 01c4 00000000 		.word	motor_
 1006 01c8 00000000 		.word	.LANCHOR13
 1007 01cc 00000000 		.word	I_Alpha
 1008 01d0 00000000 		.word	.LANCHOR16
 1009 01d4 00000000 		.word	delta_alpha
 1010 01d8 00000000 		.word	g_ElectricAngle
 1011 01dc 00000000 		.word	delata_beta
 1012 01e0 00000000 		.word	g_bEnableHB
 1013 01e4 00000000 		.word	g_CmdMap
 1014 01e8 00000000 		.word	.LANCHOR19
 1015 01ec 00000000 		.word	.LANCHOR18
 1016 01f0 00000000 		.word	pid_IQ
 1017 01f4 00000000 		.word	g_pCur_ref_base_mA
 1018 01f8 00000000 		.word	.LANCHOR17
 1019 01fc 00000000 		.word	g_high_fre_pulse
 1020              		.cfi_endproc
 1021              	.LFE346:
 1023              		.section	.text.park_transform,"ax",%progbits
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 43


 1024              		.align	1
 1025              		.global	park_transform
 1026              		.syntax unified
 1027              		.thumb
 1028              		.thumb_func
 1029              		.fpu fpv4-sp-d16
 1031              	park_transform:
 1032              	.LFB347:
1246:Src/pid.c     **** 
1247:Src/pid.c     **** 
1248:Src/pid.c     **** void park_transform(int alpha, int beta, int*q, int*d,int ElectricAngle )
1249:Src/pid.c     **** {
 1033              		.loc 1 1249 0
 1034              		.cfi_startproc
 1035              		@ args = 4, pretend = 0, frame = 0
 1036              		@ frame_needed = 0, uses_anonymous_args = 0
 1037              	.LVL44:
 1038 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1039              	.LCFI7:
 1040              		.cfi_def_cfa_offset 32
 1041              		.cfi_offset 4, -32
 1042              		.cfi_offset 5, -28
 1043              		.cfi_offset 6, -24
 1044              		.cfi_offset 7, -20
 1045              		.cfi_offset 8, -16
 1046              		.cfi_offset 9, -12
 1047              		.cfi_offset 10, -8
 1048              		.cfi_offset 14, -4
1250:Src/pid.c     **** 	int i,j;
1251:Src/pid.c     **** 	
1252:Src/pid.c     **** 	i = Math_Sin_EN360(ElectricAngle);
 1049              		.loc 1 1252 0
 1050 0004 BDF82040 		ldrh	r4, [sp, #32]
1253:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
1254:Src/pid.c     **** 	*q = Q15_MUL(j, I_Alpha) + Q15_MUL(i, I_Beta);//Parkï¿½ä»»:Iq = i_Alpha*cos - i_Beta*sin
 1051              		.loc 1 1254 0
 1052 0008 124F     		ldr	r7, .L77
 1053 000a 134D     		ldr	r5, .L77+4
1252:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1054              		.loc 1 1252 0
 1055 000c 2046     		mov	r0, r4
 1056              	.LVL45:
1249:Src/pid.c     **** 	int i,j;
 1057              		.loc 1 1249 0
 1058 000e 9246     		mov	r10, r2
 1059 0010 9846     		mov	r8, r3
1252:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1060              		.loc 1 1252 0
 1061 0012 FFF7FEFF 		bl	Math_Sin_EN360
 1062              	.LVL46:
 1063 0016 0646     		mov	r6, r0
 1064              	.LVL47:
1253:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1065              		.loc 1 1253 0
 1066 0018 2046     		mov	r0, r4
 1067              	.LVL48:
 1068 001a FFF7FEFF 		bl	Math_Cos_EN360
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 44


 1069              	.LVL49:
 1070              		.loc 1 1254 0
 1071 001e 3968     		ldr	r1, [r7]
1253:Src/pid.c     **** 	j = Math_Cos_EN360(ElectricAngle);
 1072              		.loc 1 1253 0
 1073 0020 8146     		mov	r9, r0
 1074              	.LVL50:
 1075              		.loc 1 1254 0
 1076 0022 FFF7FEFF 		bl	Q15_MUL
 1077              	.LVL51:
 1078 0026 2968     		ldr	r1, [r5]
 1079 0028 0446     		mov	r4, r0
 1080 002a 3046     		mov	r0, r6
 1081 002c FFF7FEFF 		bl	Q15_MUL
 1082              	.LVL52:
 1083 0030 2044     		add	r0, r0, r4
 1084 0032 CAF80000 		str	r0, [r10]
1255:Src/pid.c     **** 	*d = Q15_MUL(i, I_Alpha) - Q15_MUL(j, I_Beta);//Parkï¿½ä»»:Id = i_Alpha*sin + i_Beta*cos
 1085              		.loc 1 1255 0
 1086 0036 3968     		ldr	r1, [r7]
 1087 0038 3046     		mov	r0, r6
 1088 003a FFF7FEFF 		bl	Q15_MUL
 1089              	.LVL53:
 1090 003e 2968     		ldr	r1, [r5]
 1091 0040 0446     		mov	r4, r0
 1092 0042 4846     		mov	r0, r9
 1093 0044 FFF7FEFF 		bl	Q15_MUL
 1094              	.LVL54:
 1095 0048 201A     		subs	r0, r4, r0
 1096 004a C8F80000 		str	r0, [r8]
1256:Src/pid.c     **** }
 1097              		.loc 1 1256 0
 1098 004e BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1099              	.LVL55:
 1100              	.L78:
 1101 0052 00BF     		.align	2
 1102              	.L77:
 1103 0054 00000000 		.word	I_Alpha
 1104 0058 00000000 		.word	I_Beta
 1105              		.cfi_endproc
 1106              	.LFE347:
 1108              		.global	__aeabi_f2d
 1109              		.global	__aeabi_dmul
 1110              		.global	__aeabi_i2d
 1111              		.global	__aeabi_ddiv
 1112              		.global	__aeabi_d2f
 1113              		.section	.text.hfi_update_angle,"ax",%progbits
 1114              		.align	1
 1115              		.global	hfi_update_angle
 1116              		.syntax unified
 1117              		.thumb
 1118              		.thumb_func
 1119              		.fpu fpv4-sp-d16
 1121              	hfi_update_angle:
 1122              	.LFB342:
 963:Src/pid.c     **** 	int X,Y;
 1123              		.loc 1 963 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 45


 1124              		.cfi_startproc
 1125              		@ args = 0, pretend = 0, frame = 8
 1126              		@ frame_needed = 0, uses_anonymous_args = 0
 1127 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1128              	.LCFI8:
 1129              		.cfi_def_cfa_offset 36
 1130              		.cfi_offset 4, -36
 1131              		.cfi_offset 5, -32
 1132              		.cfi_offset 6, -28
 1133              		.cfi_offset 7, -24
 1134              		.cfi_offset 8, -20
 1135              		.cfi_offset 9, -16
 1136              		.cfi_offset 10, -12
 1137              		.cfi_offset 11, -8
 1138              		.cfi_offset 14, -4
 972:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1139              		.loc 1 972 0
 1140 0004 5E4C     		ldr	r4, .L80+32
 982:Src/pid.c     **** 	
 1141              		.loc 1 982 0
 1142 0006 DFF8ACB1 		ldr	fp, .L80+84
 1143 000a DFF8ACA1 		ldr	r10, .L80+88
 1144 000e 5D4D     		ldr	r5, .L80+36
 1145 0010 DBF80000 		ldr	r0, [fp]
 1146 0014 DAF80010 		ldr	r1, [r10]
 974:Src/pid.c     **** 	pid_pll.Kd = 0;
 1147              		.loc 1 974 0
 1148 0018 4FF47A72 		mov	r2, #1000
 1149 001c 0A23     		movs	r3, #10
 1150 001e C4E90223 		strd	r2, r3, [r4, #8]
 976:Src/pid.c     **** 	pid_pll.enable =1;
 1151              		.loc 1 976 0
 1152 0022 46F2A813 		movw	r3, #25000
 1153 0026 A363     		str	r3, [r4, #56]
 977:Src/pid.c     **** 	pid_pll.Up_limit = 0x7FFFFFFF;
 1154              		.loc 1 977 0
 1155 0028 0123     		movs	r3, #1
 1156 002a 2360     		str	r3, [r4]
 978:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 1157              		.loc 1 978 0
 1158 002c 6FF00043 		mvn	r3, #-2147483648
 963:Src/pid.c     **** 	int X,Y;
 1159              		.loc 1 963 0
 1160 0030 85B0     		sub	sp, sp, #20
 1161              	.LCFI9:
 1162              		.cfi_def_cfa_offset 56
 978:Src/pid.c     **** 	pid_pll.Low_limit = -0x7FFFFFFF;
 1163              		.loc 1 978 0
 1164 0032 E363     		str	r3, [r4, #60]
 979:Src/pid.c     **** 	
 1165              		.loc 1 979 0
 1166 0034 0233     		adds	r3, r3, #2
 1167 0036 2364     		str	r3, [r4, #64]
 982:Src/pid.c     **** 	
 1168              		.loc 1 982 0
 1169 0038 2B68     		ldr	r3, [r5]
 1170 003a 0093     		str	r3, [sp]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 46


 972:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1171              		.loc 1 972 0
 1172 003c 0027     		movs	r7, #0
 982:Src/pid.c     **** 	
 1173              		.loc 1 982 0
 1174 003e 02AA     		add	r2, sp, #8
 1175 0040 03AB     		add	r3, sp, #12
 972:Src/pid.c     **** 	pid_pll.Kp = 1000;
 1176              		.loc 1 972 0
 1177 0042 6761     		str	r7, [r4, #20]
 975:Src/pid.c     **** 	pid_pll.frequency = F_CUR_REGULATOR_HZ;
 1178              		.loc 1 975 0
 1179 0044 2761     		str	r7, [r4, #16]
 982:Src/pid.c     **** 	
 1180              		.loc 1 982 0
 1181 0046 FFF7FEFF 		bl	park_transform
 1182              	.LVL56:
 984:Src/pid.c     **** 	temp_L = v *1.7321*500*1000 /(temp_d * F_CUR_REGULATOR_HZ/1000 ) /3/MAX_CCR*0.58*0.7;
 1183              		.loc 1 984 0
 1184 004a 4F4B     		ldr	r3, .L80+40
 1185 004c 1868     		ldr	r0, [r3]	@ float
 1186 004e FFF7FEFF 		bl	__aeabi_f2d
 1187              	.LVL57:
 1188 0052 43A3     		adr	r3, .L80
 1189 0054 D3E90023 		ldrd	r2, [r3]
 1190 0058 FFF7FEFF 		bl	__aeabi_dmul
 1191              	.LVL58:
 1192 005c 0022     		movs	r2, #0
 1193 005e 4B4B     		ldr	r3, .L80+44
 1194 0060 FFF7FEFF 		bl	__aeabi_dmul
 1195              	.LVL59:
 1196 0064 0022     		movs	r2, #0
 1197 0066 4A4B     		ldr	r3, .L80+48
 1198 0068 FFF7FEFF 		bl	__aeabi_dmul
 1199              	.LVL60:
 1200 006c 494B     		ldr	r3, .L80+52
 1201 006e 8046     		mov	r8, r0
 1202 0070 1868     		ldr	r0, [r3]
 1203 0072 1926     		movs	r6, #25
 1204 0074 7043     		muls	r0, r6, r0
 1205 0076 8946     		mov	r9, r1
 1206 0078 FFF7FEFF 		bl	__aeabi_i2d
 1207              	.LVL61:
 1208 007c 0246     		mov	r2, r0
 1209 007e 0B46     		mov	r3, r1
 1210 0080 4046     		mov	r0, r8
 1211 0082 4946     		mov	r1, r9
 1212 0084 FFF7FEFF 		bl	__aeabi_ddiv
 1213              	.LVL62:
 1214 0088 0022     		movs	r2, #0
 1215 008a 434B     		ldr	r3, .L80+56
 1216 008c FFF7FEFF 		bl	__aeabi_ddiv
 1217              	.LVL63:
 1218 0090 35A3     		adr	r3, .L80+8
 1219 0092 D3E90023 		ldrd	r2, [r3]
 1220 0096 FFF7FEFF 		bl	__aeabi_ddiv
 1221              	.LVL64:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 47


 1222 009a 35A3     		adr	r3, .L80+16
 1223 009c D3E90023 		ldrd	r2, [r3]
 1224 00a0 FFF7FEFF 		bl	__aeabi_dmul
 1225              	.LVL65:
 1226 00a4 34A3     		adr	r3, .L80+24
 1227 00a6 D3E90023 		ldrd	r2, [r3]
 1228 00aa FFF7FEFF 		bl	__aeabi_dmul
 1229              	.LVL66:
 1230 00ae FFF7FEFF 		bl	__aeabi_d2f
 1231              	.LVL67:
 1232 00b2 3A4B     		ldr	r3, .L80+60
 1233 00b4 1860     		str	r0, [r3]	@ float
 985:Src/pid.c     **** 	
 1234              		.loc 1 985 0
 1235 00b6 0398     		ldr	r0, [sp, #12]
 1236 00b8 7043     		muls	r0, r6, r0
 1237 00ba FFF7FEFF 		bl	__aeabi_i2d
 1238              	.LVL68:
 1239 00be 0246     		mov	r2, r0
 1240 00c0 0B46     		mov	r3, r1
 1241 00c2 4046     		mov	r0, r8
 1242 00c4 4946     		mov	r1, r9
 1243 00c6 FFF7FEFF 		bl	__aeabi_ddiv
 1244              	.LVL69:
 1245 00ca 0022     		movs	r2, #0
 1246 00cc 324B     		ldr	r3, .L80+56
 987:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 1247              		.loc 1 987 0
 1248 00ce 344E     		ldr	r6, .L80+64
 985:Src/pid.c     **** 	
 1249              		.loc 1 985 0
 1250 00d0 FFF7FEFF 		bl	__aeabi_ddiv
 1251              	.LVL70:
 1252 00d4 24A3     		adr	r3, .L80+8
 1253 00d6 D3E90023 		ldrd	r2, [r3]
 1254 00da FFF7FEFF 		bl	__aeabi_ddiv
 1255              	.LVL71:
 1256 00de 24A3     		adr	r3, .L80+16
 1257 00e0 D3E90023 		ldrd	r2, [r3]
 1258 00e4 FFF7FEFF 		bl	__aeabi_dmul
 1259              	.LVL72:
 1260 00e8 23A3     		adr	r3, .L80+24
 1261 00ea D3E90023 		ldrd	r2, [r3]
 1262 00ee FFF7FEFF 		bl	__aeabi_dmul
 1263              	.LVL73:
 1264 00f2 FFF7FEFF 		bl	__aeabi_d2f
 1265              	.LVL74:
 1266 00f6 2B4B     		ldr	r3, .L80+68
 1267 00f8 1860     		str	r0, [r3]	@ float
 987:Src/pid.c     ****   Y = Math_Cos_EN360(observer_ElectricAngle);
 1268              		.loc 1 987 0
 1269 00fa 3088     		ldrh	r0, [r6]
 1270 00fc FFF7FEFF 		bl	Math_Sin_EN360
 1271              	.LVL75:
 1272 0100 8046     		mov	r8, r0
 1273              	.LVL76:
 988:Src/pid.c     **** 	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 48


 1274              		.loc 1 988 0
 1275 0102 3088     		ldrh	r0, [r6]
 1276              	.LVL77:
 1277 0104 FFF7FEFF 		bl	Math_Cos_EN360
 1278              	.LVL78:
 990:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1279              		.loc 1 990 0
 1280 0108 4146     		mov	r1, r8
 988:Src/pid.c     **** 	
 1281              		.loc 1 988 0
 1282 010a 8146     		mov	r9, r0
 1283              	.LVL79:
 990:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1284              		.loc 1 990 0
 1285 010c DBF80000 		ldr	r0, [fp]
 1286              	.LVL80:
 1287 0110 FFF7FEFF 		bl	Q15_MUL
 1288              	.LVL81:
 991:Src/pid.c     **** 	
 1289              		.loc 1 991 0
 1290 0114 4946     		mov	r1, r9
 990:Src/pid.c     **** 	temp_y = Q15_MUL(delata_beta,Y);
 1291              		.loc 1 990 0
 1292 0116 8046     		mov	r8, r0
 1293              	.LVL82:
 991:Src/pid.c     **** 	
 1294              		.loc 1 991 0
 1295 0118 DAF80000 		ldr	r0, [r10]
 1296              	.LVL83:
 1297 011c FFF7FEFF 		bl	Q15_MUL
 1298              	.LVL84:
 995:Src/pid.c     **** 	observer_speed = pid_pll.out;
 1299              		.loc 1 995 0
 1300 0120 2246     		mov	r2, r4
 1301 0122 A8EB0001 		sub	r1, r8, r0
 1302              	.LVL85:
 1303 0126 3846     		mov	r0, r7
 1304              	.LVL86:
 1305 0128 FFF7FEFF 		bl	PID_control
 1306              	.LVL87:
 996:Src/pid.c     **** 	
 1307              		.loc 1 996 0
 1308 012c 1E4A     		ldr	r2, .L80+72
 1309 012e 636B     		ldr	r3, [r4, #52]
 1310 0130 1360     		str	r3, [r2]
 998:Src/pid.c     **** 	
 1311              		.loc 1 998 0
 1312 0132 1E4A     		ldr	r2, .L80+76
 1313 0134 1168     		ldr	r1, [r2]
 1314 0136 0B44     		add	r3, r3, r1
 1315 0138 1360     		str	r3, [r2]
1000:Src/pid.c     **** 	
 1316              		.loc 1 1000 0
 1317 013a 6422     		movs	r2, #100
 1318 013c 93FBF2F3 		sdiv	r3, r3, r2
1004:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 1319              		.loc 1 1004 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 49


 1320 0140 1B4A     		ldr	r2, .L80+80
 1321 0142 B2F90020 		ldrsh	r2, [r2]
1002:Src/pid.c     **** 	
 1322              		.loc 1 1002 0
 1323 0146 C3F30E03 		ubfx	r3, r3, #0, #15
 1324 014a 3360     		str	r3, [r6]
1004:Src/pid.c     **** 	observer_ElectricAngle1  &= 0x7fff; 
 1325              		.loc 1 1004 0
 1326 014c 1344     		add	r3, r3, r2
 1327              	.LVL88:
1005:Src/pid.c     **** 	
 1328              		.loc 1 1005 0
 1329 014e C3F30E03 		ubfx	r3, r3, #0, #15
 1330              	.LVL89:
1007:Src/pid.c     **** 	
 1331              		.loc 1 1007 0
 1332 0152 2B60     		str	r3, [r5]
1016:Src/pid.c     **** 
 1333              		.loc 1 1016 0
 1334 0154 05B0     		add	sp, sp, #20
 1335              	.LCFI10:
 1336              		.cfi_def_cfa_offset 36
 1337              		@ sp needed
 1338 0156 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1339              	.LVL90:
 1340              	.L81:
 1341 015a 00BFAFF3 		.align	3
 1341      0080
 1342              	.L80:
 1343 0160 F46C567D 		.word	2102815988
 1344 0164 AEB6FB3F 		.word	1073460910
 1345 0168 00000000 		.word	0
 1346 016c 00A0A740 		.word	1084727296
 1347 0170 8FC2F528 		.word	687194767
 1348 0174 5C8FE23F 		.word	1071812444
 1349 0178 66666666 		.word	1717986918
 1350 017c 6666E63F 		.word	1072064102
 1351 0180 00000000 		.word	pid_pll
 1352 0184 00000000 		.word	g_ElectricAngle
 1353 0188 00000000 		.word	.LANCHOR20
 1354 018c 00407F40 		.word	1082081280
 1355 0190 00408F40 		.word	1083129856
 1356 0194 00000000 		.word	.LANCHOR18
 1357 0198 00000840 		.word	1074266112
 1358 019c 00000000 		.word	L
 1359 01a0 00000000 		.word	observer_ElectricAngle
 1360 01a4 00000000 		.word	temp_L
 1361 01a8 00000000 		.word	observer_speed
 1362 01ac 00000000 		.word	integre_observer_ElectricAngle
 1363 01b0 00000000 		.word	EN_90
 1364 01b4 00000000 		.word	delta_alpha
 1365 01b8 00000000 		.word	delata_beta
 1366              		.cfi_endproc
 1367              	.LFE342:
 1369              		.global	__aeabi_d2uiz
 1370              		.section	.text.ServoPro_Fast,"ax",%progbits
 1371              		.align	1
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 50


 1372              		.global	ServoPro_Fast
 1373              		.syntax unified
 1374              		.thumb
 1375              		.thumb_func
 1376              		.fpu fpv4-sp-d16
 1378              	ServoPro_Fast:
 1379              	.LFB348:
1257:Src/pid.c     **** 
1258:Src/pid.c     **** s32 ServoPro_En_count = 0;
1259:Src/pid.c     **** extern volatile s32 Encoder_Inc;   							// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1260:Src/pid.c     **** extern volatile s32 s_SpeedTimeAdd1;   					// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Öµï¿½ä»¯ï¿½ï¿½
1261:Src/pid.c     **** extern volatile s32 start_speed_sample;
1262:Src/pid.c     ****  volatile  int pid_hall_ture_value1;
1263:Src/pid.c     ****   volatile  int pid_last_hall_ture_value1;
1264:Src/pid.c     ****  volatile int last_hall_sample_time = 0;
1265:Src/pid.c     ****  volatile int speed1,speed2,speed3;
1266:Src/pid.c     **** 
1267:Src/pid.c     **** extern volatile int time4_capture_ch1;
1268:Src/pid.c     **** 
1269:Src/pid.c     **** int pid_hall_sample_time_point[10];
1270:Src/pid.c     **** int pid_hall_sample_time_index = 0;
1271:Src/pid.c     **** volatile int last_time4_capture_ch1 = 0;
1272:Src/pid.c     **** 
1273:Src/pid.c     **** volatile int hall_speed_sample_timeout_cnt=0; //ï¿½ï¿½ï¿½ãµ½30ms
1274:Src/pid.c     **** volatile int  hall_speed_sample_cnt = 0;
1275:Src/pid.c     **** volatile int hall_speed_sample_timeout =0;
1276:Src/pid.c     **** volatile int hall_cnt = 0;
1277:Src/pid.c     **** 
1278:Src/pid.c     **** volatile int hall_now_time = 0;
1279:Src/pid.c     **** volatile int hall_previous_1_time = 0;
1280:Src/pid.c     **** volatile int hall_previous_2_time = 0;
1281:Src/pid.c     **** volatile int hall_previous_3_time = 0;
1282:Src/pid.c     **** int64_t hall_total_time;
1283:Src/pid.c     **** 
1284:Src/pid.c     **** volatile int64_t Vel_PPS_raw1 =0;
1285:Src/pid.c     **** 
1286:Src/pid.c     **** void ServoPro_Fast(void)
1287:Src/pid.c     **** {
 1380              		.loc 1 1287 0
 1381              		.cfi_startproc
 1382              		@ args = 0, pretend = 0, frame = 16
 1383              		@ frame_needed = 0, uses_anonymous_args = 0
 1384              	.LVL91:
 1385 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 1386              	.LCFI11:
 1387              		.cfi_def_cfa_offset 36
 1388              		.cfi_offset 4, -36
 1389              		.cfi_offset 5, -32
 1390              		.cfi_offset 6, -28
 1391              		.cfi_offset 7, -24
 1392              		.cfi_offset 8, -20
 1393              		.cfi_offset 9, -16
 1394              		.cfi_offset 10, -12
 1395              		.cfi_offset 11, -8
 1396              		.cfi_offset 14, -4
1288:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
1289:Src/pid.c     **** 
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 51


1290:Src/pid.c     **** 	
1291:Src/pid.c     **** 	int64_t speed;
1292:Src/pid.c     **** 
1293:Src/pid.c     **** 	
1294:Src/pid.c     **** 	static u8 PlusPosition_flag = 0;
1295:Src/pid.c     ****   static s32 s_count = 0;
1296:Src/pid.c     ****   static int s_hal_cnt=0;
1297:Src/pid.c     **** 	EXTI_HandleTypeDef EXTI_Handle;
1298:Src/pid.c     **** 	
1299:Src/pid.c     **** GPIOA->BSRR  |= (uint32_t)GPIO_PIN_15;
 1397              		.loc 1 1299 0
 1398 0004 4FF09042 		mov	r2, #1207959552
1287:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
 1399              		.loc 1 1287 0
 1400 0008 2DED088B 		vpush.64	{d8, d9, d10, d11}
 1401              	.LCFI12:
 1402              		.cfi_def_cfa_offset 68
 1403              		.cfi_offset 80, -68
 1404              		.cfi_offset 81, -64
 1405              		.cfi_offset 82, -60
 1406              		.cfi_offset 83, -56
 1407              		.cfi_offset 84, -52
 1408              		.cfi_offset 85, -48
 1409              		.cfi_offset 86, -44
 1410              		.cfi_offset 87, -40
 1411              		.loc 1 1299 0
 1412 000c 9369     		ldr	r3, [r2, #24]
 1413 000e 43F40043 		orr	r3, r3, #32768
 1414 0012 9361     		str	r3, [r2, #24]
1287:Src/pid.c     **** 	int64_t s_SpeedTimeAdd11=0;
 1415              		.loc 1 1287 0
 1416 0014 85B0     		sub	sp, sp, #20
 1417              	.LCFI13:
 1418              		.cfi_def_cfa_offset 88
1300:Src/pid.c     **** 	
1301:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X01);
1302:Src/pid.c     **** 	//---------------------------------ï¿½ï¿½ï¿½Â´ï¿½ï¿½ï¿½20KHz(50us)Ö´ï¿½ï¿½-----------------
1303:Src/pid.c     **** //	if(g_BeginPIDFlag == 1)
1304:Src/pid.c     **** 	{
1305:Src/pid.c     **** 		GetElectricAngle();//ï¿½ï¿½È¡ï¿½ï¿½Ç¶ï¿½
 1419              		.loc 1 1305 0
 1420 0016 FFF7FEFF 		bl	GetElectricAngle
 1421              	.LVL92:
1306:Src/pid.c     **** 		GetCurrent();   // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 	
 1422              		.loc 1 1306 0
 1423 001a FFF7FEFF 		bl	GetCurrent
 1424              	.LVL93:
1307:Src/pid.c     **** 		
1308:Src/pid.c     **** //		hfi_update_angle();
1309:Src/pid.c     **** 		
1310:Src/pid.c     **** 	}
1311:Src/pid.c     **** 	
1312:Src/pid.c     **** 
1313:Src/pid.c     **** 	measure_R();
 1425              		.loc 1 1313 0
 1426 001e FFF7FEFF 		bl	measure_R
 1427              	.LVL94:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 52


1314:Src/pid.c     **** 	if(g_bEnableHB) 																											// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ or ï¿½ï¿½ï¿½ï¿½
 1428              		.loc 1 1314 0
 1429 0022 724B     		ldr	r3, .L168
 1430 0024 1B88     		ldrh	r3, [r3]
 1431 0026 1BB2     		sxth	r3, r3
 1432 0028 002B     		cmp	r3, #0
 1433 002a 7FD0     		beq	.L83
 1434              	.LBB13:
1315:Src/pid.c     **** 	{
1316:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_OPEN)
 1435              		.loc 1 1316 0
 1436 002c 704B     		ldr	r3, .L168+4
 1437 002e 714D     		ldr	r5, .L168+8
 1438 0030 B3F80412 		ldrh	r1, [r3, #516]
 1439 0034 704E     		ldr	r6, .L168+12
 1440 0036 DFF8FC81 		ldr	r8, .L168+72
 1441 003a 704F     		ldr	r7, .L168+16
 1442 003c DFF8F891 		ldr	r9, .L168+76
 1443 0040 DFF8F8A1 		ldr	r10, .L168+80
 1444 0044 9FED6E9A 		vldr.32	s18, .L168+20
 1445 0048 DFED6E9A 		vldr.32	s19, .L168+24
 1446 004c 09B2     		sxth	r1, r1
 1447 004e 1C46     		mov	r4, r3
 1448 0050 0029     		cmp	r1, #0
 1449 0052 40F08B80 		bne	.L84
 1450              	.LBB14:
 1451              	.LBB15:
1026:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
 1452              		.loc 1 1026 0
 1453 0056 B3F86032 		ldrh	r3, [r3, #608]
1030:Src/pid.c     **** 
 1454              		.loc 1 1030 0
 1455 005a 3160     		str	r1, [r6]
1026:Src/pid.c     ****   g_Timer1CCR = (ABS(temp32) <= REAL_CCR) ? temp32 : MAX_CCR;  // ï¿½ï¿½Ê±ï¿½ï¿½ï¿½ï¿½ï¿½Õµï¿½ï¿½ï¿
 1456              		.loc 1 1026 0
 1457 005c 4FF45262 		mov	r2, #3360
 1458 0060 13FB02F3 		smulbb	r3, r3, r2
 1459 0064 6422     		movs	r2, #100
 1460 0066 93FBF2F3 		sdiv	r3, r3, r2
 1461              	.LVL95:
1027:Src/pid.c     **** 	
 1462              		.loc 1 1027 0
 1463 006a 03F55262 		add	r2, r3, #3360
 1464 006e 92B2     		uxth	r2, r2
 1465 0070 B2F5D25F 		cmp	r2, #6720
 1466 0074 88BF     		it	hi
 1467 0076 4FF43D63 		movhi	r3, #3024
 1468              	.LVL96:
 1469 007a 634A     		ldr	r2, .L168+28
1029:Src/pid.c     **** 	g_Vd = 0;
 1470              		.loc 1 1029 0
 1471 007c 0192     		str	r2, [sp, #4]
 1472 007e 1BB2     		sxth	r3, r3
1027:Src/pid.c     **** 	
 1473              		.loc 1 1027 0
 1474 0080 1360     		str	r3, [r2]
1029:Src/pid.c     **** 	g_Vd = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 53


 1475              		.loc 1 1029 0
 1476 0082 1368     		ldr	r3, [r2]
1032:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 1477              		.loc 1 1032 0
 1478 0084 D8F80000 		ldr	r0, [r8]
1029:Src/pid.c     **** 	g_Vd = 0;
 1479              		.loc 1 1029 0
 1480 0088 2B60     		str	r3, [r5]
1032:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 1481              		.loc 1 1032 0
 1482 008a 80B2     		uxth	r0, r0
 1483 008c FFF7FEFF 		bl	Math_Sin_EN360
 1484              	.LVL97:
 1485 0090 0446     		mov	r4, r0
 1486              	.LVL98:
1033:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 1487              		.loc 1 1033 0
 1488 0092 D8F80000 		ldr	r0, [r8]
 1489              	.LVL99:
 1490 0096 80B2     		uxth	r0, r0
 1491 0098 FFF7FEFF 		bl	Math_Cos_EN360
 1492              	.LVL100:
1034:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 1493              		.loc 1 1034 0
 1494 009c 2146     		mov	r1, r4
1033:Src/pid.c     **** 	g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½Ä¼
 1495              		.loc 1 1033 0
 1496 009e 8346     		mov	fp, r0
 1497              	.LVL101:
1034:Src/pid.c     **** 	g_V_Beta = Q15_MUL(-g_Vd,Y) + Q15_MUL(g_Vq,X);
 1498              		.loc 1 1034 0
 1499 00a0 3068     		ldr	r0, [r6]
 1500              	.LVL102:
 1501 00a2 FFF7FEFF 		bl	Q15_MUL
 1502              	.LVL103:
 1503 00a6 5946     		mov	r1, fp
 1504 00a8 0090     		str	r0, [sp]
 1505 00aa 2868     		ldr	r0, [r5]
 1506 00ac FFF7FEFF 		bl	Q15_MUL
 1507              	.LVL104:
 1508 00b0 009B     		ldr	r3, [sp]
 1509 00b2 1844     		add	r0, r0, r3
 1510 00b4 3860     		str	r0, [r7]
1035:Src/pid.c     **** 
 1511              		.loc 1 1035 0
 1512 00b6 3068     		ldr	r0, [r6]
 1513 00b8 5946     		mov	r1, fp
 1514 00ba 4042     		negs	r0, r0
 1515 00bc FFF7FEFF 		bl	Q15_MUL
 1516              	.LVL105:
 1517 00c0 2146     		mov	r1, r4
 1518 00c2 0646     		mov	r6, r0
 1519 00c4 2868     		ldr	r0, [r5]
1048:Src/pid.c     **** 	{
 1520              		.loc 1 1048 0
 1521 00c6 514C     		ldr	r4, .L168+32
 1522              	.LVL106:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 54


1035:Src/pid.c     **** 
 1523              		.loc 1 1035 0
 1524 00c8 FFF7FEFF 		bl	Q15_MUL
 1525              	.LVL107:
1037:Src/pid.c     **** 
 1526              		.loc 1 1037 0
 1527 00cc 9AED000A 		vldr.32	s0, [r10]
1035:Src/pid.c     **** 
 1528              		.loc 1 1035 0
 1529 00d0 3044     		add	r0, r0, r6
1037:Src/pid.c     **** 
 1530              		.loc 1 1037 0
 1531 00d2 20EE099A 		vmul.f32	s18, s0, s18
 1532 00d6 07EE900A 		vmov	s15, r0	@ int
 1533 00da 97ED000A 		vldr.32	s0, [r7]	@ int
1035:Src/pid.c     **** 
 1534              		.loc 1 1035 0
 1535 00de C9F80000 		str	r0, [r9]
1037:Src/pid.c     **** 
 1536              		.loc 1 1037 0
 1537 00e2 F8EEE70A 		vcvt.f32.s32	s1, s15
 1538 00e6 B8EEC00A 		vcvt.f32.s32	s0, s0
 1539 00ea 60EE890A 		vmul.f32	s1, s1, s18
 1540 00ee 20EE090A 		vmul.f32	s0, s0, s18
 1541 00f2 4748     		ldr	r0, .L168+36
 1542 00f4 C0EEA90A 		vdiv.f32	s1, s1, s19
 1543 00f8 80EE290A 		vdiv.f32	s0, s0, s19
 1544 00fc FFF7FEFF 		bl	update_current_control
 1545              	.LVL108:
1046:Src/pid.c     **** 	
 1546              		.loc 1 1046 0
 1547 0100 D8F80030 		ldr	r3, [r8]
1048:Src/pid.c     **** 	{
 1548              		.loc 1 1048 0
 1549 0104 B4F90040 		ldrsh	r4, [r4]
1046:Src/pid.c     **** 	
 1550              		.loc 1 1046 0
 1551 0108 4249     		ldr	r1, .L168+40
 1552 010a 019A     		ldr	r2, [sp, #4]
 1553 010c 18B2     		sxth	r0, r3
1048:Src/pid.c     **** 	{
 1554              		.loc 1 1048 0
 1555 010e 8442     		cmp	r4, r0
1046:Src/pid.c     **** 	
 1556              		.loc 1 1046 0
 1557 0110 0880     		strh	r0, [r1]	@ movhi
 1558 0112 414C     		ldr	r4, .L168+44
1048:Src/pid.c     **** 	{
 1559              		.loc 1 1048 0
 1560 0114 24DD     		ble	.L86
1050:Src/pid.c     **** 	}
 1561              		.loc 1 1050 0
 1562 0116 2088     		ldrh	r0, [r4]
 1563 0118 0344     		add	r3, r3, r0
 1564              	.L159:
1054:Src/pid.c     **** 	}
 1565              		.loc 1 1054 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 55


 1566 011a 0B80     		strh	r3, [r1]	@ movhi
 1567              	.L87:
1056:Src/pid.c     **** }
 1568              		.loc 1 1056 0
 1569 011c 1268     		ldr	r2, [r2]
 1570 011e B1F90010 		ldrsh	r1, [r1]
 1571 0122 3E48     		ldr	r0, .L168+48
 1572 0124 FFF7FEFF 		bl	PWM_OutPut_Open
 1573              	.LVL109:
 1574              	.L88:
 1575              	.LBE15:
 1576              	.LBE14:
1317:Src/pid.c     **** 		{
1318:Src/pid.c     **** 			OpenLoop();
1319:Src/pid.c     **** 		}
1320:Src/pid.c     **** 		else
1321:Src/pid.c     **** 		{
1322:Src/pid.c     **** 			CurrentPID();
1323:Src/pid.c     **** 		}
1324:Src/pid.c     **** 		motor_fault_check(); //Â¼Ã¬Â²Ã©ÂµÃ§Â»ÃºÃÃÂ·Ã±ÃÃÃÃ½Â³Â£Â¹Â¤ÃÃ·
 1577              		.loc 1 1324 0
 1578 0128 FFF7FEFF 		bl	motor_fault_check
 1579              	.LVL110:
 1580              	.L83:
 1581              	.LBE13:
1325:Src/pid.c     **** 	}
1326:Src/pid.c     **** 	
1327:Src/pid.c     **** 
1328:Src/pid.c     **** 	PlusPosition_flag ^= 0x1;
 1582              		.loc 1 1328 0
 1583 012c 3C4A     		ldr	r2, .L168+52
 1584 012e 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 1585 0130 83F00103 		eor	r3, r3, #1
 1586 0134 1370     		strb	r3, [r2]
1329:Src/pid.c     **** 
1330:Src/pid.c     **** 	non_linear_flux_observer();
 1587              		.loc 1 1330 0
 1588 0136 FFF7FEFF 		bl	non_linear_flux_observer
 1589              	.LVL111:
1331:Src/pid.c     **** 	encode_sample();
 1590              		.loc 1 1331 0
 1591 013a FFF7FEFF 		bl	encode_sample
 1592              	.LVL112:
1332:Src/pid.c     ****     sensorless_sensor_phase_switch();
 1593              		.loc 1 1332 0
 1594 013e FFF7FEFF 		bl	sensorless_sensor_phase_switch
 1595              	.LVL113:
1333:Src/pid.c     **** 
1334:Src/pid.c     **** 	s_count ++;
 1596              		.loc 1 1334 0
 1597 0142 384A     		ldr	r2, .L168+56
 1598 0144 1368     		ldr	r3, [r2]
 1599 0146 0133     		adds	r3, r3, #1
1335:Src/pid.c     **** 	if(s_count >= (F_CUR_REGULATOR_HZ/F_SPD_REGULATOR_HZ))
 1600              		.loc 1 1335 0
 1601 0148 052B     		cmp	r3, #5
 1602 014a 00F32C83 		bgt	.L136
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 56


1334:Src/pid.c     **** 	if(s_count >= (F_CUR_REGULATOR_HZ/F_SPD_REGULATOR_HZ))
 1603              		.loc 1 1334 0
 1604 014e 1360     		str	r3, [r2]
 1605              	.L137:
1336:Src/pid.c     **** 	{	
1337:Src/pid.c     **** 		s_count = 0;    		
1338:Src/pid.c     **** 		EXTI->SWIER1 |= 0x08;
1339:Src/pid.c     **** 		EXTI_Handle.Line = 3;
1340:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
1341:Src/pid.c     **** 	} 
1342:Src/pid.c     **** 
1343:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1344:Src/pid.c     **** //	GPIO_WriteBit(GPIOA,GPIO_Pin_15,0X00);
1345:Src/pid.c     **** 	
1346:Src/pid.c     **** 	SPI3->DR =0X0000;
 1606              		.loc 1 1346 0
 1607 0150 354B     		ldr	r3, .L168+60
 1608 0152 0022     		movs	r2, #0
 1609 0154 DA60     		str	r2, [r3, #12]
1347:Src/pid.c     **** 	
1348:Src/pid.c     **** }
 1610              		.loc 1 1348 0
 1611 0156 05B0     		add	sp, sp, #20
 1612              	.LCFI14:
 1613              		.cfi_remember_state
 1614              		.cfi_def_cfa_offset 68
 1615              		@ sp needed
 1616 0158 BDEC088B 		vldm	sp!, {d8-d11}
 1617              	.LCFI15:
 1618              		.cfi_restore 86
 1619              		.cfi_restore 87
 1620              		.cfi_restore 84
 1621              		.cfi_restore 85
 1622              		.cfi_restore 82
 1623              		.cfi_restore 83
 1624              		.cfi_restore 80
 1625              		.cfi_restore 81
 1626              		.cfi_def_cfa_offset 36
 1627 015c BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 1628              	.LVL114:
 1629              	.L86:
 1630              	.LCFI16:
 1631              		.cfi_restore_state
 1632              	.LBB26:
 1633              	.LBB17:
 1634              	.LBB16:
1052:Src/pid.c     **** 	{
 1635              		.loc 1 1052 0
 1636 0160 B4F90040 		ldrsh	r4, [r4]
 1637 0164 A042     		cmp	r0, r4
 1638 0166 D9DD     		ble	.L87
1054:Src/pid.c     **** 	}
 1639              		.loc 1 1054 0
 1640 0168 1B1B     		subs	r3, r3, r4
 1641 016a D6E7     		b	.L159
 1642              	.LVL115:
 1643              	.L84:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 57


 1644              	.LBE16:
 1645              	.LBE17:
 1646              	.LBB18:
 1647              	.LBB19:
 429:Src/pid.c     **** 	{
 1648              		.loc 1 429 0
 1649 016c B3F80432 		ldrh	r3, [r3, #516]
 1650 0170 1BB2     		sxth	r3, r3
 1651 0172 012B     		cmp	r3, #1
 1652 0174 15D0     		beq	.L89
 431:Src/pid.c     **** 		{
 1653              		.loc 1 431 0
 1654 0176 B4F80432 		ldrh	r3, [r4, #516]
 1655 017a 1BB2     		sxth	r3, r3
 1656 017c 022B     		cmp	r3, #2
 1657 017e 04D0     		beq	.L90
 1658 0180 B4F80432 		ldrh	r3, [r4, #516]
 1659 0184 1BB2     		sxth	r3, r3
 1660 0186 032B     		cmp	r3, #3
 1661 0188 25D1     		bne	.L91
 1662              	.L90:
 434:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = (s32)pid_spd.out + (s32)g_CmdMap[CMD_CUR_FWD_PU];//Ç°ï¿½ï¿½ï¿½ï¿½ï¿½ï
 1663              		.loc 1 434 0
 1664 018a B4F87032 		ldrh	r3, [r4, #624]
 1665 018e A4F86E32 		strh	r3, [r4, #622]	@ movhi
 435:Src/pid.c     **** 		}
 1666              		.loc 1 435 0
 1667 0192 264B     		ldr	r3, .L168+64
 1668 0194 B4F86E22 		ldrh	r2, [r4, #622]
 1669 0198 5B6B     		ldr	r3, [r3, #52]
 1670 019a 1344     		add	r3, r3, r2
 1671 019c 1BB2     		sxth	r3, r3
 1672              	.L160:
 445:Src/pid.c     **** 		}	
 1673              		.loc 1 445 0
 1674 019e A4F84230 		strh	r3, [r4, #66]	@ movhi
 1675              	.L89:
 449:Src/pid.c     **** 	{
 1676              		.loc 1 449 0
 1677 01a2 B4F85432 		ldrh	r3, [r4, #596]
 1678 01a6 1AB2     		sxth	r2, r3
 1679 01a8 012A     		cmp	r2, #1
 1680 01aa 49D1     		bne	.L93
 451:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1681              		.loc 1 451 0
 1682 01ac A4F80232 		strh	r3, [r4, #514]	@ movhi
 452:Src/pid.c     **** 		if(test++ > (50))
 1683              		.loc 1 452 0
 1684 01b0 A4F80432 		strh	r3, [r4, #516]	@ movhi
 453:Src/pid.c     **** 		{
 1685              		.loc 1 453 0
 1686 01b4 1E4B     		ldr	r3, .L168+68
 1687 01b6 1A88     		ldrh	r2, [r3]
 1688 01b8 322A     		cmp	r2, #50
 1689 01ba 94BF     		ite	ls
 1690 01bc 0132     		addls	r2, r2, #1
 455:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 58


 1691              		.loc 1 455 0
 1692 01be 0022     		movhi	r2, #0
 1693 01c0 1A80     		strh	r2, [r3]	@ movhi
 457:Src/pid.c     **** 		{
 1694              		.loc 1 457 0
 1695 01c2 1B88     		ldrh	r3, [r3]
 1696 01c4 192B     		cmp	r3, #25
 459:Src/pid.c     **** 		}
 1697              		.loc 1 459 0
 1698 01c6 8CBF     		ite	hi
 1699 01c8 4FF44863 		movhi	r3, #3200
 463:Src/pid.c     **** 		}	
 1700              		.loc 1 463 0
 1701 01cc 4FF28033 		movwls	r3, #62336
 1702              	.L162:
 566:Src/pid.c     **** 		}
 1703              		.loc 1 566 0
 1704 01d0 A4F84230 		strh	r3, [r4, #66]	@ movhi
 1705 01d4 75E0     		b	.L97
 1706              	.L91:
 437:Src/pid.c     **** 		{
 1707              		.loc 1 437 0
 1708 01d6 B4F80432 		ldrh	r3, [r4, #516]
 1709 01da 1BB2     		sxth	r3, r3
 1710 01dc 042B     		cmp	r3, #4
 440:Src/pid.c     **** 		
 1711              		.loc 1 440 0
 1712 01de 0ABF     		itet	eq
 1713 01e0 124B     		ldreq	r3, .L168+64
 445:Src/pid.c     **** 		}	
 1714              		.loc 1 445 0
 1715 01e2 0023     		movne	r3, #0
 440:Src/pid.c     **** 		
 1716              		.loc 1 440 0
 1717 01e4 B3F93430 		ldrsheq	r3, [r3, #52]
 1718 01e8 D9E7     		b	.L160
 1719              	.L169:
 1720 01ea 00BF     		.align	2
 1721              	.L168:
 1722 01ec 00000000 		.word	g_bEnableHB
 1723 01f0 00000000 		.word	g_CmdMap
 1724 01f4 00000000 		.word	.LANCHOR21
 1725 01f8 00000000 		.word	.LANCHOR22
 1726 01fc 00000000 		.word	.LANCHOR23
 1727 0200 3ACD133F 		.word	1058262330
 1728 0204 00005245 		.word	1163001856
 1729 0208 00000000 		.word	g_Timer1CCR
 1730 020c 00000000 		.word	EN_0
 1731 0210 00000000 		.word	motor_
 1732 0214 00000000 		.word	anlge_reg
 1733 0218 00000000 		.word	EN_360
 1734 021c 002C0140 		.word	1073818624
 1735 0220 00000000 		.word	.LANCHOR34
 1736 0224 00000000 		.word	.LANCHOR35
 1737 0228 003C0040 		.word	1073757184
 1738 022c 00000000 		.word	pid_spd
 1739 0230 00000000 		.word	.LANCHOR25
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 59


 1740 0234 00000000 		.word	g_ElectricAngle
 1741 0238 00000000 		.word	.LANCHOR24
 1742 023c 00000000 		.word	bus_voltage_
 1743              	.L93:
 466:Src/pid.c     **** 	{
 1744              		.loc 1 466 0
 1745 0240 B4F85432 		ldrh	r3, [r4, #596]
 1746 0244 1BB2     		sxth	r3, r3
 1747 0246 032B     		cmp	r3, #3
 1748 0248 40F03E81 		bne	.L98
 468:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1749              		.loc 1 468 0
 1750 024c 0123     		movs	r3, #1
 470:Src/pid.c     **** 		{
 1751              		.loc 1 470 0
 1752 024e C24A     		ldr	r2, .L170
 468:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_CURRENT;
 1753              		.loc 1 468 0
 1754 0250 A4F80232 		strh	r3, [r4, #514]	@ movhi
 469:Src/pid.c     **** 		if(flag_processing_Jtest == 0)
 1755              		.loc 1 469 0
 1756 0254 A4F80432 		strh	r3, [r4, #516]	@ movhi
 470:Src/pid.c     **** 		{
 1757              		.loc 1 470 0
 1758 0258 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 1759 025a C04B     		ldr	r3, .L170+4
 1760 025c 00F0FF01 		and	r1, r0, #255
 1761 0260 20B9     		cbnz	r0, .L99
 472:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME1] = 0;
 1762              		.loc 1 472 0
 1763 0262 1980     		strh	r1, [r3]	@ movhi
 473:Src/pid.c     **** 			g_CmdMap[CMD_JTEST_TIME2] = 0;
 1764              		.loc 1 473 0
 1765 0264 A4F8C010 		strh	r1, [r4, #192]	@ movhi
 474:Src/pid.c     **** 		}
 1766              		.loc 1 474 0
 1767 0268 A4F8C210 		strh	r1, [r4, #194]	@ movhi
 1768              	.L99:
 476:Src/pid.c     **** 		{
 1769              		.loc 1 476 0
 1770 026c 1988     		ldrh	r1, [r3]
 1771 026e 09B2     		sxth	r1, r1
 1772 0270 0129     		cmp	r1, #1
 1773 0272 00F00481 		beq	.L101
 1774 0276 0229     		cmp	r1, #2
 1775 0278 00F01281 		beq	.L102
 1776 027c 0029     		cmp	r1, #0
 1777 027e 40F01C81 		bne	.L157
 480:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 8192;
 1778              		.loc 1 480 0
 1779 0282 0121     		movs	r1, #1
 1780 0284 1170     		strb	r1, [r2]
 481:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]>819)
 1781              		.loc 1 481 0
 1782 0286 4FF40052 		mov	r2, #8192
 1783 028a A4F84220 		strh	r2, [r4, #66]	@ movhi
 482:Src/pid.c     **** 				{
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 60


 1784              		.loc 1 482 0
 1785 028e B4F85020 		ldrh	r2, [r4, #80]
 1786 0292 12B2     		sxth	r2, r2
 1787 0294 B2F54D7F 		cmp	r2, #820
 484:Src/pid.c     **** 				}
 1788              		.loc 1 484 0
 1789 0298 A1BF     		itttt	ge
 1790 029a B4F8C020 		ldrhge	r2, [r4, #192]
 1791 029e 2832     		addge	r2, r2, #40
 1792 02a0 12B2     		sxthge	r2, r2
 1793 02a2 A4F8C020 		strhge	r2, [r4, #192]	@ movhi
 486:Src/pid.c     **** 				{
 1794              		.loc 1 486 0
 1795 02a6 B4F85020 		ldrh	r2, [r4, #80]
 1796 02aa 42F23331 		movw	r1, #9011
 1797 02ae 12B2     		sxth	r2, r2
 1798 02b0 8A42     		cmp	r2, r1
 1799 02b2 06DD     		ble	.L97
 488:Src/pid.c     **** 					g_CmdMap[CMD_JTEST_TIME2] = 0;
 1800              		.loc 1 488 0
 1801 02b4 1A88     		ldrh	r2, [r3]
 1802 02b6 0132     		adds	r2, r2, #1
 1803 02b8 12B2     		sxth	r2, r2
 1804 02ba 1A80     		strh	r2, [r3]	@ movhi
 489:Src/pid.c     **** 				}
 1805              		.loc 1 489 0
 1806 02bc 0023     		movs	r3, #0
 1807 02be A4F8C230 		strh	r3, [r4, #194]	@ movhi
 1808              	.L97:
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1809              		.loc 1 570 0
 1810 02c2 A74A     		ldr	r2, .L170+8
 1811 02c4 B4F89432 		ldrh	r3, [r4, #660]
 1812 02c8 1268     		ldr	r2, [r2]
 1813 02ca 9FEDA67A 		vldr.32	s14, .L170+12
 1814 02ce 1268     		ldr	r2, [r2]
 572:Src/pid.c     ****     float Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_contr
 1815              		.loc 1 572 0
 1816 02d0 DFF8A4B2 		ldr	fp, .L170+32
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1817              		.loc 1 570 0
 1818 02d4 9FEDA4AA 		vldr.32	s20, .L170+16
 573:Src/pid.c     **** 
 1819              		.loc 1 573 0
 1820 02d8 DBED0D8A 		vldr.32	s17, [fp, #52]
 572:Src/pid.c     ****     float Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_contr
 1821              		.loc 1 572 0
 1822 02dc 9BED0C8A 		vldr.32	s16, [fp, #48]
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1823              		.loc 1 570 0
 1824 02e0 1BB2     		sxth	r3, r3
 1825 02e2 4FF48041 		mov	r1, #16384
 1826 02e6 5343     		muls	r3, r2, r3
 1827 02e8 93FBF1F3 		sdiv	r3, r3, r1
 1828 02ec 07EE903A 		vmov	s15, r3	@ int
 571:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1829              		.loc 1 571 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 61


 1830 02f0 B4F84230 		ldrh	r3, [r4, #66]
 1831 02f4 B4F84E00 		ldrh	r0, [r4, #78]
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1832              		.loc 1 570 0
 1833 02f8 F8EEE77A 		vcvt.f32.s32	s15, s15
 571:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1834              		.loc 1 571 0
 1835 02fc 00B2     		sxth	r0, r0
 1836 02fe 1BB2     		sxth	r3, r3
 1837 0300 1B1A     		subs	r3, r3, r0
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1838              		.loc 1 570 0
 1839 0302 C7EE876A 		vdiv.f32	s13, s15, s14
 571:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1840              		.loc 1 571 0
 1841 0306 5343     		muls	r3, r2, r3
 1842 0308 93FBF1F3 		sdiv	r3, r3, r1
 1843 030c 07EE903A 		vmov	s15, r3	@ int
 1844 0310 F8EEE77A 		vcvt.f32.s32	s15, s15
 576:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 1845              		.loc 1 576 0
 1846 0314 B7EE00BA 		vmov.f32	s22, #1.0e+0
 571:Src/pid.c     **** 	float Vd = motor_.current_control_.v_current_control_integral_d + Ierr_d * motor_.current_control_
 1847              		.loc 1 571 0
 1848 0318 C7EE87AA 		vdiv.f32	s21, s15, s14
 575:Src/pid.c     ****     float V_to_mod = 1.0f / mod_to_V;
 1849              		.loc 1 575 0
 1850 031c DAED007A 		vldr.32	s15, [r10]
 1851 0320 67EE897A 		vmul.f32	s15, s15, s18
 570:Src/pid.c     ****     float Ierr_q = (float)((g_CmdMap[CMD_CUR_SET_PU] - g_CmdMap[CMD_CUR_ACT_PU])*(*g_pCur_ref_base_
 1852              		.loc 1 570 0
 1853 0324 3AEE66AA 		vsub.f32	s20, s20, s13
 1854              	.LVL116:
 576:Src/pid.c     ****     float mod_d = V_to_mod * Vd;
 1855              		.loc 1 576 0
 1856 0328 8BEE277A 		vdiv.f32	s14, s22, s15
 572:Src/pid.c     ****     float Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_contr
 1857              		.loc 1 572 0
 1858 032c DBED0A6A 		vldr.32	s13, [fp, #40]
 1859              	.LVL117:
 573:Src/pid.c     **** 
 1860              		.loc 1 573 0
 1861 0330 EAEEA68A 		vfma.f32	s17, s21, s13
 572:Src/pid.c     ****     float Vq = motor_.current_control_.v_current_control_integral_q + Ierr_q * motor_.current_contr
 1862              		.loc 1 572 0
 1863 0334 AAEE268A 		vfma.f32	s16, s20, s13
 578:Src/pid.c     **** 
 1864              		.loc 1 578 0
 1865 0338 68EE878A 		vmul.f32	s17, s17, s14
 577:Src/pid.c     ****     float mod_q = V_to_mod * Vq;
 1866              		.loc 1 577 0
 1867 033c 28EE078A 		vmul.f32	s16, s16, s14
 1868              	.LVL118:
 580:Src/pid.c     **** 	if(mod_scalefactor < 1.0f)
 1869              		.loc 1 580 0
 1870 0340 28EEA80A 		vmul.f32	s0, s17, s17
 1871 0344 A8EE080A 		vfma.f32	s0, s16, s16
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 62


 1872 0348 FFF7FEFF 		bl	sqrtf
 1873              	.LVL119:
 1874 034c DFED877A 		vldr.32	s15, .L170+20
 1875 0350 87EE800A 		vdiv.f32	s0, s15, s0
 1876              	.LVL120:
 581:Src/pid.c     **** 	{
 1877              		.loc 1 581 0
 1878 0354 B4EECB0A 		vcmpe.f32	s0, s22
 1879 0358 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1880 035c 40F11E81 		bpl	.L158
 585:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1881              		.loc 1 585 0
 1882 0360 9BED0C7A 		vldr.32	s14, [fp, #48]
 1883 0364 DFED826A 		vldr.32	s13, .L170+24
 586:Src/pid.c     **** 	}
 1884              		.loc 1 586 0
 1885 0368 DBED0D7A 		vldr.32	s15, [fp, #52]
 585:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1886              		.loc 1 585 0
 1887 036c 27EE267A 		vmul.f32	s14, s14, s13
 583:Src/pid.c     ****         mod_q *= mod_scalefactor;
 1888              		.loc 1 583 0
 1889 0370 28EE008A 		vmul.f32	s16, s16, s0
 1890              	.LVL121:
 584:Src/pid.c     **** 		motor_.current_control_.v_current_control_integral_d *= 0.99f;
 1891              		.loc 1 584 0
 1892 0374 68EE808A 		vmul.f32	s17, s17, s0
 1893              	.LVL122:
 586:Src/pid.c     **** 	}
 1894              		.loc 1 586 0
 1895 0378 67EEA67A 		vmul.f32	s15, s15, s13
 585:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q *= 0.99f;
 1896              		.loc 1 585 0
 1897 037c 8BED0C7A 		vstr.32	s14, [fp, #48]
 1898              	.L165:
 597:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1899              		.loc 1 597 0
 1900 0380 68EEA98A 		vmul.f32	s17, s17, s19
 1901              	.LVL123:
 598:Src/pid.c     **** 	
 1902              		.loc 1 598 0
 1903 0384 28EE298A 		vmul.f32	s16, s16, s19
 1904              	.LVL124:
 597:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1905              		.loc 1 597 0
 1906 0388 FDEEE88A 		vcvt.s32.f32	s17, s17
 598:Src/pid.c     **** 	
 1907              		.loc 1 598 0
 1908 038c BDEEC88A 		vcvt.s32.f32	s16, s16
 597:Src/pid.c     **** 	g_Vd = (s16)(mod_d*(float)REAL_CCR);	
 1909              		.loc 1 597 0
 1910 0390 18EE903A 		vmov	r3, s17	@ int
 1911 0394 1BB2     		sxth	r3, r3
 1912 0396 2B60     		str	r3, [r5]
 598:Src/pid.c     **** 	
 1913              		.loc 1 598 0
 1914 0398 18EE103A 		vmov	r3, s16	@ int
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 63


 603:Src/pid.c     **** 	
 1915              		.loc 1 603 0
 1916 039c 754A     		ldr	r2, .L170+28
 591:Src/pid.c     **** 	}
 1917              		.loc 1 591 0
 1918 039e CBED0D7A 		vstr.32	s15, [fp, #52]
 598:Src/pid.c     **** 	
 1919              		.loc 1 598 0
 1920 03a2 1BB2     		sxth	r3, r3
 1921 03a4 3360     		str	r3, [r6]
 603:Src/pid.c     **** 	
 1922              		.loc 1 603 0
 1923 03a6 1368     		ldr	r3, [r2]
 1924 03a8 5B42     		negs	r3, r3
 1925 03aa 1360     		str	r3, [r2]
 613:Src/pid.c     **** 	Y = Math_Cos_EN360( g_ElectricAngle );
 1926              		.loc 1 613 0
 1927 03ac D8F80000 		ldr	r0, [r8]
 1928 03b0 80B2     		uxth	r0, r0
 1929 03b2 FFF7FEFF 		bl	Math_Sin_EN360
 1930              	.LVL125:
 1931 03b6 8346     		mov	fp, r0
 1932              	.LVL126:
 614:Src/pid.c     **** 	//g_V_Alpha = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);  // ï¿½ï¿½Ç¶È¶ï¿½ï¿½ï¿½ÎªQï¿½ï¿½ï¿½ï¿½Alphaï¿½ï¿½
 1933              		.loc 1 614 0
 1934 03b8 D8F80000 		ldr	r0, [r8]
 1935              	.LVL127:
 1936 03bc 80B2     		uxth	r0, r0
 1937 03be FFF7FEFF 		bl	Math_Cos_EN360
 1938              	.LVL128:
 617:Src/pid.c     **** 	g_V_Beta = Q15_MUL(g_Vd,X) + Q15_MUL(g_Vq,Y);
 1939              		.loc 1 617 0
 1940 03c2 0146     		mov	r1, r0
 1941 03c4 0090     		str	r0, [sp]
 1942 03c6 3068     		ldr	r0, [r6]
 1943              	.LVL129:
 1944 03c8 FFF7FEFF 		bl	Q15_MUL
 1945              	.LVL130:
 1946 03cc 5946     		mov	r1, fp
 1947 03ce 8046     		mov	r8, r0
 1948 03d0 2868     		ldr	r0, [r5]
 1949 03d2 FFF7FEFF 		bl	Q15_MUL
 1950              	.LVL131:
 1951 03d6 A8EB0000 		sub	r0, r8, r0
 1952 03da 3860     		str	r0, [r7]
 618:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 1953              		.loc 1 618 0
 1954 03dc 5946     		mov	r1, fp
 1955 03de 3068     		ldr	r0, [r6]
 1956 03e0 FFF7FEFF 		bl	Q15_MUL
 1957              	.LVL132:
 1958 03e4 009B     		ldr	r3, [sp]
 1959 03e6 0646     		mov	r6, r0
 1960 03e8 1946     		mov	r1, r3
 1961 03ea 2868     		ldr	r0, [r5]
 1962 03ec FFF7FEFF 		bl	Q15_MUL
 1963              	.LVL133:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 64


 1964 03f0 3044     		add	r0, r0, r6
 619:Src/pid.c     **** 	X = g_V_Beta;
 1965              		.loc 1 619 0
 1966 03f2 07EE900A 		vmov	s15, r0	@ int
 1967 03f6 9AED000A 		vldr.32	s0, [r10]
 618:Src/pid.c     **** 	update_current_control(&motor_, (float)bus_voltage_*one_by_sqrt3*g_V_Alpha/REAL_CCR, (float)bus_vo
 1968              		.loc 1 618 0
 1969 03fa C9F80000 		str	r0, [r9]
 619:Src/pid.c     **** 	X = g_V_Beta;
 1970              		.loc 1 619 0
 1971 03fe F8EEE70A 		vcvt.f32.s32	s1, s15
 1972 0402 D7ED007A 		vldr.32	s15, [r7]	@ int
 1973 0406 5C48     		ldr	r0, .L170+32
 1974 0408 20EE099A 		vmul.f32	s18, s0, s18
 1975 040c B8EEE70A 		vcvt.f32.s32	s0, s15
 1976 0410 60EE890A 		vmul.f32	s1, s1, s18
 1977 0414 20EE090A 		vmul.f32	s0, s0, s18
 1978 0418 C0EEA90A 		vdiv.f32	s1, s1, s19
 1979 041c 80EE290A 		vdiv.f32	s0, s0, s19
 1980 0420 FFF7FEFF 		bl	update_current_control
 1981              	.LVL134:
 621:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 1982              		.loc 1 621 0
 1983 0424 5549     		ldr	r1, .L170+36
 1984 0426 3868     		ldr	r0, [r7]
 620:Src/pid.c     **** 	temp32 = Q16_MUL(g_V_Alpha,113512);
 1985              		.loc 1 620 0
 1986 0428 D9F80050 		ldr	r5, [r9]
 1987              	.LVL135:
 621:Src/pid.c     **** 	Y = (g_V_Beta + temp32) >> 1;
 1988              		.loc 1 621 0
 1989 042c FFF7FEFF 		bl	Q16_MUL
 1990              	.LVL136:
 622:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 1991              		.loc 1 622 0
 1992 0430 D9F80030 		ldr	r3, [r9]
 630:Src/pid.c     **** 	g_Sector_test = g_Sector;
 1993              		.loc 1 630 0
 1994 0434 524A     		ldr	r2, .L170+40
 622:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 1995              		.loc 1 622 0
 1996 0436 C618     		adds	r6, r0, r3
 627:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 1997              		.loc 1 627 0
 1998 0438 002D     		cmp	r5, #0
 623:Src/pid.c     ****   // ï¿½ï¿½ï¿½ï¿½ï¿½Ñ¹Ê¸ï¿½ï¿½ï¿½ï¿½ï¿½Úµï¿½ï¿½ï¿½ï¿½ï¿½
 1999              		.loc 1 623 0
 2000 043a A3EB0000 		sub	r0, r3, r0
 2001              	.LVL137:
 622:Src/pid.c     **** 	Z = (g_V_Beta - temp32) >> 1;  
 2002              		.loc 1 622 0
 2003 043e 4FEA6606 		asr	r6, r6, #1
 2004              	.LVL138:
 627:Src/pid.c     **** 	if (Z < 0) temp32 += 2;
 2005              		.loc 1 627 0
 2006 0442 D4BF     		ite	le
 2007 0444 0023     		movle	r3, #0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 65


 2008 0446 0123     		movgt	r3, #1
 2009              	.LVL139:
 628:Src/pid.c     **** 	if (Y < 0) temp32 += 4;	
 2010              		.loc 1 628 0
 2011 0448 4010     		asrs	r0, r0, #1
 2012              	.LVL140:
 2013 044a 48BF     		it	mi
 2014 044c 0233     		addmi	r3, r3, #2
 2015              	.LVL141:
 629:Src/pid.c     **** 	g_Sector = temp32;
 2016              		.loc 1 629 0
 2017 044e 002E     		cmp	r6, #0
 2018 0450 B8BF     		it	lt
 2019 0452 0433     		addlt	r3, r3, #4
 2020              	.LVL142:
 630:Src/pid.c     **** 	g_Sector_test = g_Sector;
 2021              		.loc 1 630 0
 2022 0454 1360     		str	r3, [r2]
 631:Src/pid.c     **** 	g_X = X;
 2023              		.loc 1 631 0
 2024 0456 4B4A     		ldr	r2, .L170+44
 2025 0458 1380     		strh	r3, [r2]	@ movhi
 632:Src/pid.c     **** 	g_Y = Y;
 2026              		.loc 1 632 0
 2027 045a 4B4A     		ldr	r2, .L170+48
 2028 045c 1560     		str	r5, [r2]
 633:Src/pid.c     **** 	g_Z = Z;
 2029              		.loc 1 633 0
 2030 045e 4B4A     		ldr	r2, .L170+52
 2031 0460 1660     		str	r6, [r2]
 634:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 2032              		.loc 1 634 0
 2033 0462 4B4A     		ldr	r2, .L170+56
 2034              	.LBB20:
 2035              	.LBB21:
 309:Src/pid.c     ****   {
 2036              		.loc 1 309 0
 2037 0464 013B     		subs	r3, r3, #1
 2038              	.LVL143:
 2039              	.LBE21:
 2040              	.LBE20:
 634:Src/pid.c     ****   Calculate_CCR_SVP(TIM1, g_Sector, g_X, g_Y, g_Z);
 2041              		.loc 1 634 0
 2042 0466 1060     		str	r0, [r2]
 2043              	.LVL144:
 2044              	.LBB24:
 2045              	.LBB22:
 309:Src/pid.c     ****   {
 2046              		.loc 1 309 0
 2047 0468 052B     		cmp	r3, #5
 2048 046a 00F21181 		bhi	.L139
 2049 046e DFE813F0 		tbh	[pc, r3, lsl #1]
 2050              	.L122:
 2051 0472 A800     		.2byte	(.L121-.L122)/2
 2052 0474 EC00     		.2byte	(.L123-.L122)/2
 2053 0476 F300     		.2byte	(.L124-.L122)/2
 2054 0478 FA00     		.2byte	(.L125-.L122)/2
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 66


 2055 047a 0101     		.2byte	(.L126-.L122)/2
 2056 047c 0801     		.2byte	(.L127-.L122)/2
 2057              	.LVL145:
 2058              		.p2align 1
 2059              	.L101:
 2060              	.LBE22:
 2061              	.LBE24:
 495:Src/pid.c     **** 				if(g_CmdMap[CMD_SPD_ACT_PU]<8192+819)
 2062              		.loc 1 495 0
 2063 047e 4FF46042 		mov	r2, #57344
 2064 0482 A4F84220 		strh	r2, [r4, #66]	@ movhi
 496:Src/pid.c     **** 				{
 2065              		.loc 1 496 0
 2066 0486 B4F85020 		ldrh	r2, [r4, #80]
 2067 048a 42F23231 		movw	r1, #9010
 2068 048e 12B2     		sxth	r2, r2
 2069 0490 8A42     		cmp	r2, r1
 498:Src/pid.c     **** 				}
 2070              		.loc 1 498 0
 2071 0492 DFBF     		itttt	le
 2072 0494 B4F8C220 		ldrhle	r2, [r4, #194]
 2073 0498 2832     		addle	r2, r2, #40
 2074 049a 12B2     		sxthle	r2, r2
 2075 049c A4F8C220 		strhle	r2, [r4, #194]	@ movhi
 2076              	.L102:
 508:Src/pid.c     **** 				{
 2077              		.loc 1 508 0
 2078 04a0 B4F85020 		ldrh	r2, [r4, #80]
 2079 04a4 40F23231 		movw	r1, #818
 2080 04a8 12B2     		sxth	r2, r2
 2081 04aa 8A42     		cmp	r2, r1
 2082 04ac 3FF709AF 		bgt	.L97
 510:Src/pid.c     **** 				}				
 2083              		.loc 1 510 0
 2084 04b0 1A88     		ldrh	r2, [r3]
 2085 04b2 0132     		adds	r2, r2, #1
 2086 04b4 12B2     		sxth	r2, r2
 2087 04b6 1A80     		strh	r2, [r3]	@ movhi
 2088 04b8 03E7     		b	.L97
 2089              	.L157:
 516:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 2090              		.loc 1 516 0
 2091 04ba 0023     		movs	r3, #0
 2092 04bc A4F85432 		strh	r3, [r4, #596]	@ movhi
 517:Src/pid.c     **** 				flag_processing_Jtest = 0;
 2093              		.loc 1 517 0
 2094 04c0 A4F84230 		strh	r3, [r4, #66]	@ movhi
 518:Src/pid.c     **** 				break;
 2095              		.loc 1 518 0
 2096 04c4 1370     		strb	r3, [r2]
 2097 04c6 FCE6     		b	.L97
 2098              	.L98:
 523:Src/pid.c     **** 	{
 2099              		.loc 1 523 0
 2100 04c8 B4F85432 		ldrh	r3, [r4, #596]
 2101 04cc 1BB2     		sxth	r3, r3
 2102 04ce 042B     		cmp	r3, #4
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 67


 2103 04d0 2AD1     		bne	.L108
 525:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 2104              		.loc 1 525 0
 2105 04d2 0123     		movs	r3, #1
 529:Src/pid.c     **** 		if(test < (10*10))
 2106              		.loc 1 529 0
 2107 04d4 2F4A     		ldr	r2, .L170+60
 525:Src/pid.c     **** 		g_CmdMap[TAG_WORK_MODE] = MODE_SPEED;
 2108              		.loc 1 525 0
 2109 04d6 A4F80232 		strh	r3, [r4, #514]	@ movhi
 526:Src/pid.c     **** 
 2110              		.loc 1 526 0
 2111 04da 0223     		movs	r3, #2
 2112 04dc A4F80432 		strh	r3, [r4, #516]	@ movhi
 529:Src/pid.c     **** 		if(test < (10*10))
 2113              		.loc 1 529 0
 2114 04e0 1388     		ldrh	r3, [r2]
 2115 04e2 0133     		adds	r3, r3, #1
 2116 04e4 9BB2     		uxth	r3, r3
 530:Src/pid.c     **** 		{
 2117              		.loc 1 530 0
 2118 04e6 632B     		cmp	r3, #99
 529:Src/pid.c     **** 		if(test < (10*10))
 2119              		.loc 1 529 0
 2120 04e8 1380     		strh	r3, [r2]	@ movhi
 530:Src/pid.c     **** 		{
 2121              		.loc 1 530 0
 2122 04ea 01D8     		bhi	.L109
 2123              	.L167:
 540:Src/pid.c     **** 		}
 2124              		.loc 1 540 0
 2125 04ec 0023     		movs	r3, #0
 2126 04ee 04E0     		b	.L163
 2127              	.L109:
 534:Src/pid.c     **** 		{
 2128              		.loc 1 534 0
 2129 04f0 B3F5167F 		cmp	r3, #600
 2130 04f4 04D2     		bcs	.L110
 536:Src/pid.c     **** 		}
 2131              		.loc 1 536 0
 2132 04f6 4FF48053 		mov	r3, #4096
 2133              	.L163:
 554:Src/pid.c     **** 		}
 2134              		.loc 1 554 0
 2135 04fa A4F84630 		strh	r3, [r4, #70]	@ movhi
 2136 04fe E0E6     		b	.L97
 2137              	.L110:
 538:Src/pid.c     **** 		{
 2138              		.loc 1 538 0
 2139 0500 40F24B41 		movw	r1, #1099
 2140 0504 8B42     		cmp	r3, r1
 2141 0506 F1D9     		bls	.L167
 542:Src/pid.c     **** 		{
 2142              		.loc 1 542 0
 2143 0508 B3F5C86F 		cmp	r3, #1600
 2144 050c 02D2     		bcs	.L112
 544:Src/pid.c     **** 		}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 68


 2145              		.loc 1 544 0
 2146 050e 4FF47043 		mov	r3, #61440
 2147 0512 F2E7     		b	.L163
 2148              	.L112:
 546:Src/pid.c     **** 		{
 2149              		.loc 1 546 0
 2150 0514 40F2A361 		movw	r1, #1699
 2151 0518 8B42     		cmp	r3, r1
 2152 051a 4FF00003 		mov	r3, #0
 552:Src/pid.c     **** 			g_CmdMap[SYS_SELF_TUNING] = 0;
 2153              		.loc 1 552 0
 2154 051e 84BF     		itt	hi
 2155 0520 1380     		strhhi	r3, [r2]	@ movhi
 553:Src/pid.c     **** 			g_CmdMap[CMD_SPD_SET_PU] = 0;
 2156              		.loc 1 553 0
 2157 0522 A4F85432 		strhhi	r3, [r4, #596]	@ movhi
 2158 0526 E8E7     		b	.L163
 2159              	.L108:
 560:Src/pid.c     **** 		{
 2160              		.loc 1 560 0
 2161 0528 B4F84220 		ldrh	r2, [r4, #66]
 2162 052c B4F88032 		ldrh	r3, [r4, #640]
 2163 0530 12B2     		sxth	r2, r2
 2164 0532 1BB2     		sxth	r3, r3
 2165 0534 9A42     		cmp	r2, r3
 562:Src/pid.c     **** 		}
 2166              		.loc 1 562 0
 2167 0536 C4BF     		itt	gt
 2168 0538 B4F88032 		ldrhgt	r3, [r4, #640]
 2169 053c A4F84230 		strhgt	r3, [r4, #66]	@ movhi
 564:Src/pid.c     **** 		{
 2170              		.loc 1 564 0
 2171 0540 B4F84220 		ldrh	r2, [r4, #66]
 2172 0544 B4F88232 		ldrh	r3, [r4, #642]
 2173 0548 12B2     		sxth	r2, r2
 2174 054a 1BB2     		sxth	r3, r3
 2175 054c 9A42     		cmp	r2, r3
 2176 054e BFF6B8AE 		bge	.L97
 566:Src/pid.c     **** 		}
 2177              		.loc 1 566 0
 2178 0552 B4F88232 		ldrh	r3, [r4, #642]
 2179 0556 3BE6     		b	.L162
 2180              	.L171:
 2181              		.align	2
 2182              	.L170:
 2183 0558 00000000 		.word	flag_processing_Jtest
 2184 055c 00000000 		.word	state_Jtest
 2185 0560 00000000 		.word	g_pCur_ref_base_mA
 2186 0564 00007A44 		.word	1148846080
 2187 0568 00000000 		.word	0
 2188 056c 6666663F 		.word	1063675494
 2189 0570 A4707D3F 		.word	1065185444
 2190 0574 00000000 		.word	g_high_fre_pulse
 2191 0578 00000000 		.word	motor_
 2192 057c 68BB0100 		.word	113512
 2193 0580 00000000 		.word	.LANCHOR26
 2194 0584 00000000 		.word	g_Sector_test
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 69


 2195 0588 00000000 		.word	g_X
 2196 058c 00000000 		.word	g_Y
 2197 0590 00000000 		.word	g_Z
 2198 0594 00000000 		.word	.LANCHOR25
 2199 0598 ACC52738 		.word	942130604
 2200              	.LVL146:
 2201              	.L158:
 590:Src/pid.c     ****         motor_.current_control_.v_current_control_integral_q += Ierr_q * (motor_.current_control_.i
 2202              		.loc 1 590 0
 2203 059c 1FED027A 		vldr.32	s14, .L170+64
 2204 05a0 DBED0B7A 		vldr.32	s15, [fp, #44]
 2205 05a4 67EE877A 		vmul.f32	s15, s15, s14
 2206 05a8 9BED0C7A 		vldr.32	s14, [fp, #48]
 2207 05ac AAEE277A 		vfma.f32	s14, s20, s15
 2208 05b0 8BED0C7A 		vstr.32	s14, [fp, #48]
 591:Src/pid.c     **** 	}
 2209              		.loc 1 591 0
 2210 05b4 9BED0D7A 		vldr.32	s14, [fp, #52]
 2211 05b8 AAEEA77A 		vfma.f32	s14, s21, s15
 2212 05bc F0EE477A 		vmov.f32	s15, s14
 2213 05c0 DEE6     		b	.L165
 2214              	.LVL147:
 2215              	.L121:
 2216              	.LBB25:
 2217              	.LBB23:
 314:Src/pid.c     **** 			CCR3 = t0>>1;
 2218              		.loc 1 314 0
 2219 05c2 C6F55263 		rsb	r3, r6, #3360
 2220 05c6 1B1A     		subs	r3, r3, r0
 315:Src/pid.c     **** 			CCR1 = CCR3 + tk;
 2221              		.loc 1 315 0
 2222 05c8 5B10     		asrs	r3, r3, #1
 2223              	.LVL148:
 316:Src/pid.c     **** 			CCR2 = CCR1 + tk_1;
 2224              		.loc 1 316 0
 2225 05ca F218     		adds	r2, r6, r3
 2226              	.LVL149:
 317:Src/pid.c     **** 		break;		
 2227              		.loc 1 317 0
 2228 05cc 8118     		adds	r1, r0, r2
 2229              	.LVL150:
 2230              	.L120:
 368:Src/pid.c     **** 	{
 2231              		.loc 1 368 0
 2232 05ce B4F81A02 		ldrh	r0, [r4, #538]
 2233              	.LVL151:
 2234 05d2 00B2     		sxth	r0, r0
 2235 05d4 18B9     		cbnz	r0, .L128
 370:Src/pid.c     **** 			sin_wave_t_us = 0;
 2236              		.loc 1 370 0
 2237 05d6 7E4D     		ldr	r5, .L172+8
 2238              	.LVL152:
 2239 05d8 2860     		str	r0, [r5]
 371:Src/pid.c     **** 	}
 2240              		.loc 1 371 0
 2241 05da 7E4D     		ldr	r5, .L172+12
 2242 05dc 2860     		str	r0, [r5]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 70


 2243              	.L128:
 375:Src/pid.c     **** 	{
 2244              		.loc 1 375 0
 2245 05de B4F81A02 		ldrh	r0, [r4, #538]
 2246 05e2 00B2     		sxth	r0, r0
 2247 05e4 0428     		cmp	r0, #4
 2248 05e6 04D0     		beq	.L129
 2249 05e8 B4F81A02 		ldrh	r0, [r4, #538]
 2250 05ec 00B2     		sxth	r0, r0
 2251 05ee 0528     		cmp	r0, #5
 2252 05f0 0DD1     		bne	.L130
 2253              	.L129:
 377:Src/pid.c     **** 		if(sin_wave_t_us > 1000)
 2254              		.loc 1 377 0
 2255 05f2 7848     		ldr	r0, .L172+12
 2256 05f4 0568     		ldr	r5, [r0]
 2257 05f6 0435     		adds	r5, r5, #4
 2258 05f8 0560     		str	r5, [r0]
 378:Src/pid.c     **** 		{
 2259              		.loc 1 378 0
 2260 05fa 0568     		ldr	r5, [r0]
 2261 05fc B5F57A7F 		cmp	r5, #1000
 2262 0600 05DD     		ble	.L130
 380:Src/pid.c     **** 			motor_para_identification_count_Tms++;
 2263              		.loc 1 380 0
 2264 0602 0025     		movs	r5, #0
 2265 0604 0560     		str	r5, [r0]
 381:Src/pid.c     **** 		}
 2266              		.loc 1 381 0
 2267 0606 724D     		ldr	r5, .L172+8
 2268 0608 2868     		ldr	r0, [r5]
 2269 060a 0130     		adds	r0, r0, #1
 2270 060c 2860     		str	r0, [r5]
 2271              	.L130:
 384:Src/pid.c     **** 	{
 2272              		.loc 1 384 0
 2273 060e B4F81A02 		ldrh	r0, [r4, #538]
 2274 0612 00B2     		sxth	r0, r0
 2275 0614 0428     		cmp	r0, #4
 2276 0616 40D0     		beq	.L132
 2277 0618 40F67530 		movw	r0, #2933
 365:Src/pid.c     ****   CCR2 = CCR2>N97_CCR?N97_CCR:(CCR2<0?0:CCR2);
 2278              		.loc 1 365 0
 2279 061c 22EAE272 		bic	r2, r2, r2, asr #31
 2280              	.LVL153:
 2281 0620 8242     		cmp	r2, r0
 366:Src/pid.c     ****   CCR3 = CCR3>N97_CCR?N97_CCR:(CCR3<0?0:CCR3);
 2282              		.loc 1 366 0
 2283 0622 21EAE171 		bic	r1, r1, r1, asr #31
 2284              	.LVL154:
 367:Src/pid.c     **** 	if(g_CmdMap[SYS_MOT_TEST] == 0)
 2285              		.loc 1 367 0
 2286 0626 23EAE373 		bic	r3, r3, r3, asr #31
 2287              	.LVL155:
 2288 062a A8BF     		it	ge
 2289 062c 0246     		movge	r2, r0
 2290 062e 8142     		cmp	r1, r0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 71


 2291 0630 A8BF     		it	ge
 2292 0632 0146     		movge	r1, r0
 2293 0634 8342     		cmp	r3, r0
 2294 0636 A8BF     		it	ge
 2295 0638 0346     		movge	r3, r0
 2296              	.LVL156:
 2297              	.L133:
 410:Src/pid.c     ****   TIMx->CCR2 = CCR2;
 2298              		.loc 1 410 0
 2299 063a 6748     		ldr	r0, .L172+16
 2300 063c C363     		str	r3, [r0, #60]
 414:Src/pid.c     **** }
 2301              		.loc 1 414 0
 2302 063e 45F25553 		movw	r3, #21845
 2303              	.LVL157:
 411:Src/pid.c     ****   TIMx->CCR1 = CCR1;
 2304              		.loc 1 411 0
 2305 0642 8163     		str	r1, [r0, #56]
 2306              	.LVL158:
 412:Src/pid.c     **** 	//TIMx->CCER = (u16)0x5FFF;
 2307              		.loc 1 412 0
 2308 0644 4263     		str	r2, [r0, #52]
 414:Src/pid.c     **** }
 2309              		.loc 1 414 0
 2310 0646 0362     		str	r3, [r0, #32]
 2311 0648 6EE5     		b	.L88
 2312              	.LVL159:
 2313              	.L123:
 322:Src/pid.c     **** 			CCR2 = t0>>1;
 2314              		.loc 1 322 0
 2315 064a 05F55261 		add	r1, r5, #3360
 2316 064e 891B     		subs	r1, r1, r6
 323:Src/pid.c     **** 			CCR3 = CCR2 + tk;
 2317              		.loc 1 323 0
 2318 0650 4910     		asrs	r1, r1, #1
 2319              	.LVL160:
 2320 0652 4B1B     		subs	r3, r1, r5
 2321              	.LVL161:
 325:Src/pid.c     **** 		break;		
 2322              		.loc 1 325 0
 2323 0654 F218     		adds	r2, r6, r3
 2324              	.LVL162:
 2325 0656 BAE7     		b	.L120
 2326              	.LVL163:
 2327              	.L124:
 330:Src/pid.c     **** 			CCR3 = t0>>1;
 2328              		.loc 1 330 0
 2329 0658 00F55263 		add	r3, r0, #3360
 2330 065c 5B1B     		subs	r3, r3, r5
 331:Src/pid.c     **** 			CCR2 = CCR3 + tk_1;
 2331              		.loc 1 331 0
 2332 065e 5B10     		asrs	r3, r3, #1
 2333              	.LVL164:
 332:Src/pid.c     **** 			CCR1 = CCR2 + tk;
 2334              		.loc 1 332 0
 2335 0660 E918     		adds	r1, r5, r3
 2336              	.LVL165:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 72


 2337 0662 0A1A     		subs	r2, r1, r0
 2338              	.LVL166:
 2339 0664 B3E7     		b	.L120
 2340              	.LVL167:
 2341              	.L125:
 338:Src/pid.c     **** 			CCR1 = t0>>1;
 2342              		.loc 1 338 0
 2343 0666 C0F55262 		rsb	r2, r0, #3360
 2344 066a 2A44     		add	r2, r2, r5
 339:Src/pid.c     **** 			CCR2 = CCR1 + tk;
 2345              		.loc 1 339 0
 2346 066c 5210     		asrs	r2, r2, #1
 2347              	.LVL168:
 340:Src/pid.c     **** 			CCR3 = CCR2 + tk_1;
 2348              		.loc 1 340 0
 2349 066e 8118     		adds	r1, r0, r2
 2350              	.LVL169:
 2351 0670 4B1B     		subs	r3, r1, r5
 2352              	.LVL170:
 2353 0672 ACE7     		b	.L120
 2354              	.LVL171:
 2355              	.L126:
 346:Src/pid.c     **** 			CCR1 = t0>>1;
 2356              		.loc 1 346 0
 2357 0674 C5F55262 		rsb	r2, r5, #3360
 2358 0678 3244     		add	r2, r2, r6
 347:Src/pid.c     **** 			CCR3 = CCR1 + tk_1;
 2359              		.loc 1 347 0
 2360 067a 5210     		asrs	r2, r2, #1
 2361              	.LVL172:
 2362 067c 931B     		subs	r3, r2, r6
 2363              	.LVL173:
 349:Src/pid.c     **** 		break;
 2364              		.loc 1 349 0
 2365 067e E918     		adds	r1, r5, r3
 2366              	.LVL174:
 2367 0680 A5E7     		b	.L120
 2368              	.LVL175:
 2369              	.L127:
 354:Src/pid.c     **** 			CCR2 = t0>>1;
 2370              		.loc 1 354 0
 2371 0682 06F55261 		add	r1, r6, #3360
 2372 0686 0144     		add	r1, r1, r0
 355:Src/pid.c     **** 			CCR1 = CCR2 + tk_1;
 2373              		.loc 1 355 0
 2374 0688 4910     		asrs	r1, r1, #1
 2375              	.LVL176:
 2376 068a 0A1A     		subs	r2, r1, r0
 2377              	.LVL177:
 2378 068c 931B     		subs	r3, r2, r6
 2379              	.LVL178:
 2380 068e 9EE7     		b	.L120
 2381              	.LVL179:
 2382              	.L139:
 362:Src/pid.c     **** 		break;
 2383              		.loc 1 362 0
 2384 0690 4FF4D263 		mov	r3, #1680
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 73


 361:Src/pid.c     **** 			CCR3 = REAL_CCR >> 1;
 2385              		.loc 1 361 0
 2386 0694 1946     		mov	r1, r3
 360:Src/pid.c     **** 			CCR2 = REAL_CCR >> 1;
 2387              		.loc 1 360 0
 2388 0696 1A46     		mov	r2, r3
 2389 0698 99E7     		b	.L120
 2390              	.LVL180:
 2391              	.L132:
 389:Src/pid.c     **** 		if(Para_Identificaion>=0)
 2392              		.loc 1 389 0
 2393 069a 504B     		ldr	r3, .L172+20
 2394 069c 1A68     		ldr	r2, [r3]
 2395 069e 0132     		adds	r2, r2, #1
 2396 06a0 1A60     		str	r2, [r3]
 390:Src/pid.c     **** 		{
 2397              		.loc 1 390 0
 2398 06a2 1A68     		ldr	r2, [r3]
 2399 06a4 002A     		cmp	r2, #0
 2400 06a6 20DB     		blt	.L134
 392:Src/pid.c     **** 			if(index_I_phase<100)
 2401              		.loc 1 392 0
 2402 06a8 0022     		movs	r2, #0
 2403 06aa 1A60     		str	r2, [r3]
 393:Src/pid.c     **** 			{
 2404              		.loc 1 393 0
 2405 06ac 4C4B     		ldr	r3, .L172+24
 2406 06ae 1A68     		ldr	r2, [r3]
 2407 06b0 632A     		cmp	r2, #99
 2408 06b2 17DC     		bgt	.L135
 395:Src/pid.c     **** 				I_phase[1][index_I_phase] = -g_IB_Raw;
 2409              		.loc 1 395 0
 2410 06b4 4B4A     		ldr	r2, .L172+28
 2411 06b6 1968     		ldr	r1, [r3]
 2412 06b8 B2F90020 		ldrsh	r2, [r2]
 2413 06bc 4A48     		ldr	r0, .L172+32
 2414 06be 5242     		negs	r2, r2
 2415 06c0 40F82120 		str	r2, [r0, r1, lsl #2]
 396:Src/pid.c     **** 				I_phase[2][index_I_phase] = -g_IC_Raw;		
 2416              		.loc 1 396 0
 2417 06c4 4949     		ldr	r1, .L172+36
 2418 06c6 1A68     		ldr	r2, [r3]
 2419 06c8 B1F90010 		ldrsh	r1, [r1]
 2420 06cc 6432     		adds	r2, r2, #100
 2421 06ce 4942     		negs	r1, r1
 2422 06d0 40F82210 		str	r1, [r0, r2, lsl #2]
 397:Src/pid.c     **** 			}
 2423              		.loc 1 397 0
 2424 06d4 4649     		ldr	r1, .L172+40
 2425 06d6 1A68     		ldr	r2, [r3]
 2426 06d8 B1F90010 		ldrsh	r1, [r1]
 2427 06dc C832     		adds	r2, r2, #200
 2428 06de 4942     		negs	r1, r1
 2429 06e0 40F82210 		str	r1, [r0, r2, lsl #2]
 2430              	.L135:
 399:Src/pid.c     **** 		}
 2431              		.loc 1 399 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 74


 2432 06e4 1A68     		ldr	r2, [r3]
 2433 06e6 0132     		adds	r2, r2, #1
 2434 06e8 1A60     		str	r2, [r3]
 2435              	.L134:
 401:Src/pid.c     **** 		{	
 2436              		.loc 1 401 0
 2437 06ea 394B     		ldr	r3, .L172+8
 2438 06ec 1B68     		ldr	r3, [r3]
 2439 06ee C82B     		cmp	r3, #200
 2440 06f0 54DD     		ble	.L140
 403:Src/pid.c     **** 			T_t_1 = -1.0/T_t;	
 2441              		.loc 1 403 0
 2442 06f2 3D4D     		ldr	r5, .L172+32
 2443 06f4 D5F88C01 		ldr	r0, [r5, #396]
 2444 06f8 D5F80890 		ldr	r9, [r5, #8]
 2445 06fc D5F88C81 		ldr	r8, [r5, #396]
 2446 0700 FFF7FEFF 		bl	__aeabi_i2d
 2447              	.LVL181:
 2448 0704 0646     		mov	r6, r0
 2449              	.LVL182:
 2450 0706 A9EB0800 		sub	r0, r9, r8
 2451 070a 01F10047 		add	r7, r1, #-2147483648
 2452 070e FFF7FEFF 		bl	__aeabi_i2d
 2453              	.LVL183:
 2454 0712 0246     		mov	r2, r0
 2455 0714 0B46     		mov	r3, r1
 2456 0716 3046     		mov	r0, r6
 2457 0718 3946     		mov	r1, r7
 2458 071a FFF7FEFF 		bl	__aeabi_ddiv
 2459              	.LVL184:
 2460 071e 41EC100B 		vmov	d0, r0, r1
 2461 0722 FFF7FEFF 		bl	log
 2462              	.LVL185:
 2463 0726 28A1     		adr	r1, .L172
 2464 0728 D1E90001 		ldrd	r0, [r1]
 2465 072c 53EC102B 		vmov	r2, r3, d0
 2466 0730 FFF7FEFF 		bl	__aeabi_ddiv
 2467              	.LVL186:
 2468 0734 2F4B     		ldr	r3, .L172+44
 2469 0736 0646     		mov	r6, r0
 2470 0738 0F46     		mov	r7, r1
 2471 073a C3E90067 		strd	r6, [r3]
 404:Src/pid.c     **** 			g_CmdMap[SYS_MOT_TEST] = 0;
 2472              		.loc 1 404 0
 2473 073e 0246     		mov	r2, r0
 2474 0740 0B46     		mov	r3, r1
 2475 0742 0020     		movs	r0, #0
 2476 0744 2C49     		ldr	r1, .L172+48
 2477 0746 FFF7FEFF 		bl	__aeabi_ddiv
 2478              	.LVL187:
 2479 074a 2C4B     		ldr	r3, .L172+52
 2480 074c C3E90001 		strd	r0, [r3]
 405:Src/pid.c     **** 			g_CmdMap[MOT_RES] = 2*(12000*1000)/(3*I_phase[0][99]);// ï¿½ï¿½ï¿½ï¿½è£º0.5*(U_Dc*0.866*Duty/g_I
 2481              		.loc 1 405 0
 2482 0750 0023     		movs	r3, #0
 2483 0752 A4F81A32 		strh	r3, [r4, #538]	@ movhi
 406:Src/pid.c     **** 			g_CmdMap[MOT_INDUC] = (u16)(1000.0*T_t*(double)g_CmdMap[MOT_RES]);
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 75


 2484              		.loc 1 406 0
 2485 0756 D5F88C21 		ldr	r2, [r5, #396]
 2486 075a 294B     		ldr	r3, .L172+56
 2487 075c 02EB4202 		add	r2, r2, r2, lsl #1
 2488 0760 93FBF2F3 		sdiv	r3, r3, r2
 2489 0764 1BB2     		sxth	r3, r3
 2490 0766 A4F84032 		strh	r3, [r4, #576]	@ movhi
 407:Src/pid.c     **** 		}
 2491              		.loc 1 407 0
 2492 076a 0022     		movs	r2, #0
 2493 076c 254B     		ldr	r3, .L172+60
 2494 076e B4F84052 		ldrh	r5, [r4, #576]
 2495 0772 3046     		mov	r0, r6
 2496 0774 3946     		mov	r1, r7
 2497 0776 FFF7FEFF 		bl	__aeabi_dmul
 2498              	.LVL188:
 2499 077a 2DB2     		sxth	r5, r5
 2500 077c 0646     		mov	r6, r0
 2501 077e 2846     		mov	r0, r5
 2502 0780 0F46     		mov	r7, r1
 2503 0782 FFF7FEFF 		bl	__aeabi_i2d
 2504              	.LVL189:
 2505 0786 0246     		mov	r2, r0
 2506 0788 0B46     		mov	r3, r1
 2507 078a 3046     		mov	r0, r6
 2508 078c 3946     		mov	r1, r7
 2509 078e FFF7FEFF 		bl	__aeabi_dmul
 2510              	.LVL190:
 2511 0792 FFF7FEFF 		bl	__aeabi_d2uiz
 2512              	.LVL191:
 2513 0796 00B2     		sxth	r0, r0
 2514 0798 A4F84202 		strh	r0, [r4, #578]	@ movhi
 2515              	.L140:
 388:Src/pid.c     **** 		Para_Identificaion++;
 2516              		.loc 1 388 0
 2517 079c 40F61F53 		movw	r3, #3359
 387:Src/pid.c     **** 		CCR3 = REAL_CCR-1;
 2518              		.loc 1 387 0
 2519 07a0 1946     		mov	r1, r3
 386:Src/pid.c     **** 		CCR2 = REAL_CCR-1;
 2520              		.loc 1 386 0
 2521 07a2 0122     		movs	r2, #1
 2522 07a4 49E7     		b	.L133
 2523              	.LVL192:
 2524              	.L136:
 2525              	.LBE23:
 2526              	.LBE25:
 2527              	.LBE19:
 2528              	.LBE18:
 2529              	.LBE26:
1337:Src/pid.c     **** 		EXTI->SWIER1 |= 0x08;
 2530              		.loc 1 1337 0
 2531 07a6 0023     		movs	r3, #0
 2532 07a8 1360     		str	r3, [r2]
1338:Src/pid.c     **** 		EXTI_Handle.Line = 3;
 2533              		.loc 1 1338 0
 2534 07aa 174A     		ldr	r2, .L172+64
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 76


 2535 07ac 1369     		ldr	r3, [r2, #16]
1339:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
 2536              		.loc 1 1339 0
 2537 07ae 04A8     		add	r0, sp, #16
1338:Src/pid.c     **** 		EXTI_Handle.Line = 3;
 2538              		.loc 1 1338 0
 2539 07b0 43F00803 		orr	r3, r3, #8
 2540 07b4 1361     		str	r3, [r2, #16]
1339:Src/pid.c     **** 		HAL_EXTI_GenerateSWI(&EXTI_Handle);
 2541              		.loc 1 1339 0
 2542 07b6 0323     		movs	r3, #3
 2543 07b8 40F8083D 		str	r3, [r0, #-8]!
1340:Src/pid.c     **** 	} 
 2544              		.loc 1 1340 0
 2545 07bc FFF7FEFF 		bl	HAL_EXTI_GenerateSWI
 2546              	.LVL193:
 2547 07c0 C6E4     		b	.L137
 2548              	.L173:
 2549 07c2 00BFAFF3 		.align	3
 2549      0080
 2550              	.L172:
 2551 07c8 F168E388 		.word	-1998362383
 2552 07cc B5F8043F 		.word	1057290421
 2553 07d0 00000000 		.word	.LANCHOR27
 2554 07d4 00000000 		.word	.LANCHOR28
 2555 07d8 002C0140 		.word	1073818624
 2556 07dc 00000000 		.word	.LANCHOR29
 2557 07e0 00000000 		.word	.LANCHOR30
 2558 07e4 00000000 		.word	.LANCHOR12
 2559 07e8 00000000 		.word	.LANCHOR31
 2560 07ec 00000000 		.word	.LANCHOR10
 2561 07f0 00000000 		.word	.LANCHOR8
 2562 07f4 00000000 		.word	.LANCHOR32
 2563 07f8 0000F0BF 		.word	-1074790400
 2564 07fc 00000000 		.word	.LANCHOR33
 2565 0800 00366E01 		.word	24000000
 2566 0804 00408F40 		.word	1083129856
 2567 0808 00040140 		.word	1073808384
 2568              		.cfi_endproc
 2569              	.LFE348:
 2571              		.section	.text.Loop3_EnableManage,"ax",%progbits
 2572              		.align	1
 2573              		.global	Loop3_EnableManage
 2574              		.syntax unified
 2575              		.thumb
 2576              		.thumb_func
 2577              		.fpu fpv4-sp-d16
 2579              	Loop3_EnableManage:
 2580              	.LFB349:
1349:Src/pid.c     **** void Loop3_EnableManage(void)   //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æµï¿½Ê¹ï¿½Ü¹ï¿½ï¿½ï¿½
1350:Src/pid.c     **** {
 2581              		.loc 1 1350 0
 2582              		.cfi_startproc
 2583              		@ args = 0, pretend = 0, frame = 0
 2584              		@ frame_needed = 0, uses_anonymous_args = 0
 2585              		@ link register save eliminated.
1351:Src/pid.c     **** 	//Ç¿ï¿½Ã¹Ø±ï¿½ï¿½Ù¶ï¿½
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 77


1352:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2586              		.loc 1 1352 0
 2587 0000 2E4B     		ldr	r3, .L200
 2588 0002 2F48     		ldr	r0, .L200+4
 2589 0004 B3F80222 		ldrh	r2, [r3, #514]
 2590 0008 2E49     		ldr	r1, .L200+8
 2591 000a 12B2     		sxth	r2, r2
 2592 000c 012A     		cmp	r2, #1
 2593 000e 4BD1     		bne	.L175
1353:Src/pid.c     **** 			&& 	(	g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT	  //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 2594              		.loc 1 1353 0
 2595 0010 B3F80422 		ldrh	r2, [r3, #516]
 2596 0014 12B2     		sxth	r2, r2
 2597 0016 012A     		cmp	r2, #1
 2598 0018 12D0     		beq	.L176
1354:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_FORCE 	//ï¿½ï¿½ï¿½Ø»ï¿½				
 2599              		.loc 1 1354 0
 2600 001a B3F80422 		ldrh	r2, [r3, #516]
 2601 001e 12B2     		sxth	r2, r2
 2602 0020 042A     		cmp	r2, #4
 2603 0022 0DD0     		beq	.L176
1355:Src/pid.c     **** 						|| g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
 2604              		.loc 1 1355 0
 2605 0024 B3F80422 		ldrh	r2, [r3, #516]
 2606 0028 12B2     		sxth	r2, r2
 2607 002a 022A     		cmp	r2, #2
 2608 002c 08D0     		beq	.L176
1356:Src/pid.c     **** 						|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿
 2609              		.loc 1 1356 0
 2610 002e B3F80422 		ldrh	r2, [r3, #516]
 2611 0032 12B2     		sxth	r2, r2
 2612 0034 032A     		cmp	r2, #3
 2613 0036 37D1     		bne	.L175
 2614              		.loc 1 1356 0 is_stmt 0 discriminator 1
 2615 0038 234A     		ldr	r2, .L200+12
 2616 003a 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 2617 003c 002A     		cmp	r2, #0
 2618 003e 33D1     		bne	.L175
 2619              	.L176:
1357:Src/pid.c     **** 					)
1358:Src/pid.c     **** 		)
1359:Src/pid.c     **** 	{	
1360:Src/pid.c     **** 		pid_IQ.enable = 1;
 2620              		.loc 1 1360 0 is_stmt 1
 2621 0040 0122     		movs	r2, #1
 2622              	.L197:
1361:Src/pid.c     **** 		pid_ID.enable = 1;
1362:Src/pid.c     **** 	}
1363:Src/pid.c     **** 	else
1364:Src/pid.c     **** 	{
1365:Src/pid.c     **** 		pid_IQ.enable = 0;
 2623              		.loc 1 1365 0
 2624 0042 0260     		str	r2, [r0]
1366:Src/pid.c     **** 		pid_ID.enable = 0;
 2625              		.loc 1 1366 0
 2626 0044 0A60     		str	r2, [r1]
1367:Src/pid.c     **** 	}
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 78


1368:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 && g_CmdMap[TAG_WORK_MODE] == MODE_FORCE )
 2627              		.loc 1 1368 0
 2628 0046 B3F80222 		ldrh	r2, [r3, #514]
 2629 004a 2048     		ldr	r0, .L200+16
 2630 004c 12B2     		sxth	r2, r2
 2631 004e 012A     		cmp	r2, #1
 2632 0050 2CD1     		bne	.L178
 2633              		.loc 1 1368 0 is_stmt 0 discriminator 1
 2634 0052 B3F80412 		ldrh	r1, [r3, #516]
 2635 0056 09B2     		sxth	r1, r1
 2636 0058 0429     		cmp	r1, #4
 2637 005a 27D1     		bne	.L178
 2638              	.L198:
1369:Src/pid.c     **** 	{	
1370:Src/pid.c     **** 		pid_force.enable = 1;
1371:Src/pid.c     **** 	}
1372:Src/pid.c     **** 	else
1373:Src/pid.c     **** 	{
1374:Src/pid.c     **** 		pid_force.enable = 0;
 2639              		.loc 1 1374 0 is_stmt 1
 2640 005c 0260     		str	r2, [r0]
1375:Src/pid.c     **** 	}	
1376:Src/pid.c     **** 	if(g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2641              		.loc 1 1376 0
 2642 005e B3F80222 		ldrh	r2, [r3, #514]
 2643 0062 1B49     		ldr	r1, .L200+20
 2644 0064 12B2     		sxth	r2, r2
 2645 0066 012A     		cmp	r2, #1
 2646 0068 22D1     		bne	.L180
1377:Src/pid.c     **** 			&& ( g_CmdMap[TAG_WORK_MODE] == MODE_SPEED	//ï¿½Ù¶È»ï¿½
 2647              		.loc 1 1377 0
 2648 006a B3F80422 		ldrh	r2, [r3, #516]
 2649 006e 12B2     		sxth	r2, r2
 2650 0070 022A     		cmp	r2, #2
 2651 0072 07D0     		beq	.L181
1378:Src/pid.c     **** 					|| (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0)  //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½
 2652              		.loc 1 1378 0
 2653 0074 B3F80422 		ldrh	r2, [r3, #516]
 2654 0078 12B2     		sxth	r2, r2
 2655 007a 032A     		cmp	r2, #3
 2656 007c 18D1     		bne	.L180
 2657              		.loc 1 1378 0 is_stmt 0 discriminator 1
 2658 007e 124A     		ldr	r2, .L200+12
 2659 0080 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 2660 0082 AAB9     		cbnz	r2, .L180
 2661              	.L181:
1379:Src/pid.c     **** 					)
1380:Src/pid.c     **** 		)
1381:Src/pid.c     **** 	{	
1382:Src/pid.c     **** 		pid_spd.enable = 1;
 2662              		.loc 1 1382 0 is_stmt 1
 2663 0084 0122     		movs	r2, #1
 2664              	.L199:
1383:Src/pid.c     **** 	}
1384:Src/pid.c     **** 	else
1385:Src/pid.c     **** 	{
1386:Src/pid.c     **** 		pid_spd.enable = 0;
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 79


 2665              		.loc 1 1386 0
 2666 0086 0A60     		str	r2, [r1]
1387:Src/pid.c     **** 	}
1388:Src/pid.c     **** 	if(	g_CmdMap[TAG_MOTOR_ENABLE] == 1 
 2667              		.loc 1 1388 0
 2668 0088 B3F80222 		ldrh	r2, [r3, #514]
 2669 008c 1149     		ldr	r1, .L200+24
 2670 008e 12B2     		sxth	r2, r2
 2671 0090 012A     		cmp	r2, #1
 2672 0092 0FD1     		bne	.L183
1389:Src/pid.c     **** 			&& (g_CmdMap[TAG_WORK_MODE] == MODE_POSITION && PosAtDead_Flag == 0) //Î»ï¿½ï¿½ï¿½Ò²ï¿½ï¿½ï¿½ï¿½
 2673              		.loc 1 1389 0
 2674 0094 B3F80432 		ldrh	r3, [r3, #516]
 2675 0098 1BB2     		sxth	r3, r3
 2676 009a 032B     		cmp	r3, #3
 2677 009c 0AD1     		bne	.L183
 2678              		.loc 1 1389 0 is_stmt 0 discriminator 1
 2679 009e 0A4B     		ldr	r3, .L200+12
 2680 00a0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2681 00a2 3BB9     		cbnz	r3, .L183
1390:Src/pid.c     **** 		)
1391:Src/pid.c     **** 	{	
1392:Src/pid.c     **** 		pid_pos.enable = 1;
 2682              		.loc 1 1392 0 is_stmt 1
 2683 00a4 0A60     		str	r2, [r1]
 2684 00a6 7047     		bx	lr
 2685              	.L175:
1365:Src/pid.c     **** 		pid_ID.enable = 0;
 2686              		.loc 1 1365 0
 2687 00a8 0022     		movs	r2, #0
 2688 00aa CAE7     		b	.L197
 2689              	.L178:
1374:Src/pid.c     **** 	}	
 2690              		.loc 1 1374 0
 2691 00ac 0022     		movs	r2, #0
 2692 00ae D5E7     		b	.L198
 2693              	.L180:
1386:Src/pid.c     **** 	}
 2694              		.loc 1 1386 0
 2695 00b0 0022     		movs	r2, #0
 2696 00b2 E8E7     		b	.L199
 2697              	.L183:
1393:Src/pid.c     **** 	}
1394:Src/pid.c     **** 	else
1395:Src/pid.c     **** 	{
1396:Src/pid.c     **** 		pid_pos.enable = 0;
 2698              		.loc 1 1396 0
 2699 00b4 0023     		movs	r3, #0
 2700 00b6 0B60     		str	r3, [r1]
1397:Src/pid.c     **** 	}
1398:Src/pid.c     **** }
 2701              		.loc 1 1398 0
 2702 00b8 7047     		bx	lr
 2703              	.L201:
 2704 00ba 00BF     		.align	2
 2705              	.L200:
 2706 00bc 00000000 		.word	g_CmdMap
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 80


 2707 00c0 00000000 		.word	pid_IQ
 2708 00c4 00000000 		.word	pid_ID
 2709 00c8 00000000 		.word	.LANCHOR2
 2710 00cc 00000000 		.word	pid_force
 2711 00d0 00000000 		.word	pid_spd
 2712 00d4 00000000 		.word	pid_pos
 2713              		.cfi_endproc
 2714              	.LFE349:
 2716              		.section	.text.work_var_updata,"ax",%progbits
 2717              		.align	1
 2718              		.global	work_var_updata
 2719              		.syntax unified
 2720              		.thumb
 2721              		.thumb_func
 2722              		.fpu fpv4-sp-d16
 2724              	work_var_updata:
 2725              	.LFB350:
1399:Src/pid.c     **** // ï¿½ï¿½ï¿½Â¿ï¿½ï¿½Æ²ï¿½ï¿½ï¿½
1400:Src/pid.c     **** void work_var_updata(void)
1401:Src/pid.c     **** {
 2726              		.loc 1 1401 0
 2727              		.cfi_startproc
 2728              		@ args = 0, pretend = 0, frame = 0
 2729              		@ frame_needed = 0, uses_anonymous_args = 0
1402:Src/pid.c     ****   /************************************************************************************************
1403:Src/pid.c     **** 	g_Encode_offset = (int)g_CmdMap[MOT_EANGLE_OFFSET];
 2730              		.loc 1 1403 0
 2731 0000 464B     		ldr	r3, .L205
 2732 0002 4749     		ldr	r1, .L205+4
 2733 0004 B3F84C22 		ldrh	r2, [r3, #588]
 2734 0008 4648     		ldr	r0, .L205+8
 2735 000a 12B2     		sxth	r2, r2
1401:Src/pid.c     ****   /************************************************************************************************
 2736              		.loc 1 1401 0
 2737 000c F0B5     		push	{r4, r5, r6, r7, lr}
 2738              	.LCFI17:
 2739              		.cfi_def_cfa_offset 20
 2740              		.cfi_offset 4, -20
 2741              		.cfi_offset 5, -16
 2742              		.cfi_offset 6, -12
 2743              		.cfi_offset 7, -8
 2744              		.cfi_offset 14, -4
 2745              		.loc 1 1403 0
 2746 000e 0A60     		str	r2, [r1]
1404:Src/pid.c     **** 	if (g_CmdMap[SEV_PARAME_LOCKED] != 0)	 	// ï¿½Ç·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
 2747              		.loc 1 1404 0
 2748 0010 B3F8A062 		ldrh	r6, [r3, #672]
 2749 0014 444D     		ldr	r5, .L205+12
 2750 0016 454C     		ldr	r4, .L205+16
 2751 0018 4549     		ldr	r1, .L205+20
 2752 001a 464A     		ldr	r2, .L205+24
 2753 001c 464F     		ldr	r7, .L205+28
 2754 001e 36B2     		sxth	r6, r6
 2755 0020 9EB3     		cbz	r6, .L203
1405:Src/pid.c     **** 	{
1406:Src/pid.c     **** 		pid_pos.Kp = g_ThreeLoopParaBefLock[(SEV_POSITION_P)&0x0F];
 2756              		.loc 1 1406 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 81


 2757 0022 464B     		ldr	r3, .L205+32
 2758 0024 B3F91060 		ldrsh	r6, [r3, #16]
 2759 0028 AE60     		str	r6, [r5, #8]
1407:Src/pid.c     **** 		pid_pos.Ki = g_ThreeLoopParaBefLock[(SEV_POSITION_I)&0x0F];
 2760              		.loc 1 1407 0
 2761 002a B3F91260 		ldrsh	r6, [r3, #18]
 2762 002e EE60     		str	r6, [r5, #12]
1408:Src/pid.c     **** 		pid_pos.Kd = 0;
1409:Src/pid.c     **** 		pid_pos.dead_zone = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 2763              		.loc 1 1409 0
 2764 0030 B3F916C0 		ldrsh	ip, [r3, #22]
 2765 0034 C5F814C0 		str	ip, [r5, #20]
1408:Src/pid.c     **** 		pid_pos.Kd = 0;
 2766              		.loc 1 1408 0
 2767 0038 0026     		movs	r6, #0
 2768 003a 2E61     		str	r6, [r5, #16]
1410:Src/pid.c     **** 		
1411:Src/pid.c     **** 		pid_spd.Kp = g_ThreeLoopParaBefLock[(SEV_SPEED_P)&0x0F];
 2769              		.loc 1 1411 0
 2770 003c B3F90850 		ldrsh	r5, [r3, #8]
 2771 0040 A560     		str	r5, [r4, #8]
1412:Src/pid.c     **** 		pid_spd.Ki = g_ThreeLoopParaBefLock[(SEV_SPEED_I)&0x0F];
 2772              		.loc 1 1412 0
 2773 0042 B3F90A50 		ldrsh	r5, [r3, #10]
1413:Src/pid.c     **** 		pid_spd.Kd = 0;
1414:Src/pid.c     **** 		pid_spd.dead_zone = g_ThreeLoopParaBefLock[(SEV_SPEED_DS)&0x0F];
1415:Src/pid.c     **** 
1416:Src/pid.c     **** 		pid_IQ.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
 2774              		.loc 1 1416 0
 2775 0046 B3F902E0 		ldrsh	lr, [r3, #2]
 2776 004a C0F808E0 		str	lr, [r0, #8]
1413:Src/pid.c     **** 		pid_spd.Kd = 0;
 2777              		.loc 1 1413 0
 2778 004e C4E90356 		strd	r5, r6, [r4, #12]
1414:Src/pid.c     **** 
 2779              		.loc 1 1414 0
 2780 0052 B3F90E50 		ldrsh	r5, [r3, #14]
 2781 0056 6561     		str	r5, [r4, #20]
1417:Src/pid.c     **** 		pid_IQ.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 2782              		.loc 1 1417 0
 2783 0058 B3F90450 		ldrsh	r5, [r3, #4]
1418:Src/pid.c     **** 		pid_IQ.Kd = 0;
1419:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2784              		.loc 1 1419 0
 2785 005c 0424     		movs	r4, #4
1420:Src/pid.c     **** 
1421:Src/pid.c     **** 		pid_ID.Kp = g_ThreeLoopParaBefLock[(SEV_CURRENT_P)&0x0F];
1422:Src/pid.c     **** 		pid_ID.Ki = g_ThreeLoopParaBefLock[(SEV_CURRENT_I)&0x0F];
 2786              		.loc 1 1422 0
 2787 005e C1E902E5 		strd	lr, r5, [r1, #8]
1423:Src/pid.c     **** 		pid_ID.Kd = 0;
1424:Src/pid.c     **** 		pid_ID.dead_zone = 4;	
 2788              		.loc 1 1424 0
 2789 0062 C1E90464 		strd	r6, r4, [r1, #16]
1425:Src/pid.c     **** 
1426:Src/pid.c     **** 		pid_force.Kp = g_ThreeLoopParaBefLock[(SEV_FORCE_P)&0x0F];
 2790              		.loc 1 1426 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 82


 2791 0066 B3F91810 		ldrsh	r1, [r3, #24]
 2792 006a 9160     		str	r1, [r2, #8]
1427:Src/pid.c     **** 		pid_force.Ki = g_ThreeLoopParaBefLock[(SEV_FORCE_I)&0x0F];
 2793              		.loc 1 1427 0
 2794 006c B3F91A10 		ldrsh	r1, [r3, #26]
 2795 0070 D160     		str	r1, [r2, #12]
1428:Src/pid.c     **** 		pid_force.Kd = g_ThreeLoopParaBefLock[(SEV_FORCE_D)&0x0F];
 2796              		.loc 1 1428 0
 2797 0072 B3F91C10 		ldrsh	r1, [r3, #28]
1429:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
 2798              		.loc 1 1429 0
 2799 0076 B3F91E30 		ldrsh	r3, [r3, #30]
1419:Src/pid.c     **** 
 2800              		.loc 1 1419 0
 2801 007a 4461     		str	r4, [r0, #20]
1418:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2802              		.loc 1 1418 0
 2803 007c C0E90356 		strd	r5, r6, [r0, #12]
1428:Src/pid.c     **** 		pid_force.dead_zone = g_ThreeLoopParaBefLock[(SEV_FORCE_DS)&0x0F];
 2804              		.loc 1 1428 0
 2805 0080 1161     		str	r1, [r2, #16]
 2806              		.loc 1 1429 0
 2807 0082 5361     		str	r3, [r2, #20]
1430:Src/pid.c     **** 		gPos_ds = g_ThreeLoopParaBefLock[(SEV_POSITION_DS)&0x0F];
 2808              		.loc 1 1430 0
 2809 0084 C7F800C0 		str	ip, [r7]
 2810              	.L202:
1431:Src/pid.c     **** 	}
1432:Src/pid.c     **** 	else
1433:Src/pid.c     **** 	{
1434:Src/pid.c     **** 		pid_pos.Kp = g_CmdMap[SEV_POSITION_P];
1435:Src/pid.c     **** 		pid_pos.Ki = g_CmdMap[SEV_POSITION_I];
1436:Src/pid.c     **** 		pid_pos.Kd = 0;
1437:Src/pid.c     **** 		pid_pos.dead_zone = g_CmdMap[SEV_POSITION_DS];
1438:Src/pid.c     **** 		
1439:Src/pid.c     **** 		pid_spd.Kp = g_CmdMap[SEV_SPEED_P];
1440:Src/pid.c     **** 		pid_spd.Ki = g_CmdMap[SEV_SPEED_I];
1441:Src/pid.c     **** 		pid_spd.Kd = 0;
1442:Src/pid.c     **** 		pid_spd.dead_zone = g_CmdMap[SEV_SPEED_DS];
1443:Src/pid.c     **** 
1444:Src/pid.c     **** 		pid_IQ.Kp = g_CmdMap[SEV_CURRENT_P];
1445:Src/pid.c     **** 		pid_IQ.Ki = g_CmdMap[SEV_CURRENT_I];
1446:Src/pid.c     **** 		pid_IQ.Kd = 0;
1447:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
1448:Src/pid.c     **** 
1449:Src/pid.c     **** 		pid_ID.Kp = g_CmdMap[SEV_CURRENT_P];
1450:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
1451:Src/pid.c     **** 		pid_ID.Kd = 0;
1452:Src/pid.c     **** 		pid_ID.dead_zone = 4;
1453:Src/pid.c     **** 		
1454:Src/pid.c     **** 		pid_force.Kp = g_CmdMap[SEV_FORCE_P];
1455:Src/pid.c     **** 		pid_force.Ki = g_CmdMap[SEV_FORCE_I];
1456:Src/pid.c     **** 		pid_force.Kd = g_CmdMap[SEV_FORCE_D];
1457:Src/pid.c     **** 		pid_force.dead_zone = g_CmdMap[SEV_FORCE_DS];
1458:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
1459:Src/pid.c     **** 	}
1460:Src/pid.c     ****   /**************************************************************************/	
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 83


1461:Src/pid.c     **** }
 2811              		.loc 1 1461 0
 2812 0088 F0BD     		pop	{r4, r5, r6, r7, pc}
 2813              	.L203:
1434:Src/pid.c     **** 		pid_pos.Ki = g_CmdMap[SEV_POSITION_I];
 2814              		.loc 1 1434 0
 2815 008a B3F8B0C2 		ldrh	ip, [r3, #688]
 2816 008e 0FFA8CFC 		sxth	ip, ip
 2817 0092 C5F808C0 		str	ip, [r5, #8]
1435:Src/pid.c     **** 		pid_pos.Kd = 0;
 2818              		.loc 1 1435 0
 2819 0096 B3F8B2C2 		ldrh	ip, [r3, #690]
 2820 009a 0FFA8CFC 		sxth	ip, ip
1436:Src/pid.c     **** 		pid_pos.dead_zone = g_CmdMap[SEV_POSITION_DS];
 2821              		.loc 1 1436 0
 2822 009e C5E903C6 		strd	ip, r6, [r5, #12]
1437:Src/pid.c     **** 		
 2823              		.loc 1 1437 0
 2824 00a2 B3F8B6C2 		ldrh	ip, [r3, #694]
 2825 00a6 0FFA8CFC 		sxth	ip, ip
 2826 00aa C5F814C0 		str	ip, [r5, #20]
1439:Src/pid.c     **** 		pid_spd.Ki = g_CmdMap[SEV_SPEED_I];
 2827              		.loc 1 1439 0
 2828 00ae B3F8A852 		ldrh	r5, [r3, #680]
 2829 00b2 2DB2     		sxth	r5, r5
 2830 00b4 A560     		str	r5, [r4, #8]
1440:Src/pid.c     **** 		pid_spd.Kd = 0;
 2831              		.loc 1 1440 0
 2832 00b6 B3F8AA52 		ldrh	r5, [r3, #682]
 2833 00ba 2DB2     		sxth	r5, r5
1441:Src/pid.c     **** 		pid_spd.dead_zone = g_CmdMap[SEV_SPEED_DS];
 2834              		.loc 1 1441 0
 2835 00bc C4E90356 		strd	r5, r6, [r4, #12]
1442:Src/pid.c     **** 
 2836              		.loc 1 1442 0
 2837 00c0 B3F8AE52 		ldrh	r5, [r3, #686]
 2838 00c4 2DB2     		sxth	r5, r5
 2839 00c6 6561     		str	r5, [r4, #20]
1444:Src/pid.c     **** 		pid_IQ.Ki = g_CmdMap[SEV_CURRENT_I];
 2840              		.loc 1 1444 0
 2841 00c8 B3F8A242 		ldrh	r4, [r3, #674]
 2842 00cc 24B2     		sxth	r4, r4
 2843 00ce 8460     		str	r4, [r0, #8]
1445:Src/pid.c     **** 		pid_IQ.Kd = 0;
 2844              		.loc 1 1445 0
 2845 00d0 B3F8A442 		ldrh	r4, [r3, #676]
 2846 00d4 24B2     		sxth	r4, r4
1446:Src/pid.c     **** 		pid_IQ.dead_zone = 4;	
 2847              		.loc 1 1446 0
 2848 00d6 C0E90346 		strd	r4, r6, [r0, #12]
1447:Src/pid.c     **** 
 2849              		.loc 1 1447 0
 2850 00da 0424     		movs	r4, #4
 2851 00dc 4461     		str	r4, [r0, #20]
1449:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
 2852              		.loc 1 1449 0
 2853 00de B3F8A202 		ldrh	r0, [r3, #674]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 84


1452:Src/pid.c     **** 		
 2854              		.loc 1 1452 0
 2855 00e2 4C61     		str	r4, [r1, #20]
1449:Src/pid.c     **** 		pid_ID.Ki = g_CmdMap[SEV_CURRENT_I];
 2856              		.loc 1 1449 0
 2857 00e4 00B2     		sxth	r0, r0
 2858 00e6 8860     		str	r0, [r1, #8]
1450:Src/pid.c     **** 		pid_ID.Kd = 0;
 2859              		.loc 1 1450 0
 2860 00e8 B3F8A402 		ldrh	r0, [r3, #676]
 2861 00ec 00B2     		sxth	r0, r0
1451:Src/pid.c     **** 		pid_ID.dead_zone = 4;
 2862              		.loc 1 1451 0
 2863 00ee C1E90306 		strd	r0, r6, [r1, #12]
1454:Src/pid.c     **** 		pid_force.Ki = g_CmdMap[SEV_FORCE_I];
 2864              		.loc 1 1454 0
 2865 00f2 B3F8B812 		ldrh	r1, [r3, #696]
 2866 00f6 09B2     		sxth	r1, r1
 2867 00f8 9160     		str	r1, [r2, #8]
1455:Src/pid.c     **** 		pid_force.Kd = g_CmdMap[SEV_FORCE_D];
 2868              		.loc 1 1455 0
 2869 00fa B3F8BA12 		ldrh	r1, [r3, #698]
 2870 00fe 09B2     		sxth	r1, r1
 2871 0100 D160     		str	r1, [r2, #12]
1456:Src/pid.c     **** 		pid_force.dead_zone = g_CmdMap[SEV_FORCE_DS];
 2872              		.loc 1 1456 0
 2873 0102 B3F8BC12 		ldrh	r1, [r3, #700]
 2874 0106 09B2     		sxth	r1, r1
 2875 0108 1161     		str	r1, [r2, #16]
1457:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2876              		.loc 1 1457 0
 2877 010a B3F8BE12 		ldrh	r1, [r3, #702]
1458:Src/pid.c     **** 	}
 2878              		.loc 1 1458 0
 2879 010e B3F8B632 		ldrh	r3, [r3, #694]
1457:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2880              		.loc 1 1457 0
 2881 0112 09B2     		sxth	r1, r1
1458:Src/pid.c     **** 	}
 2882              		.loc 1 1458 0
 2883 0114 1BB2     		sxth	r3, r3
1457:Src/pid.c     **** 		gPos_ds = g_CmdMap[SEV_POSITION_DS];
 2884              		.loc 1 1457 0
 2885 0116 5161     		str	r1, [r2, #20]
1458:Src/pid.c     **** 	}
 2886              		.loc 1 1458 0
 2887 0118 3B60     		str	r3, [r7]
 2888              		.loc 1 1461 0
 2889 011a B5E7     		b	.L202
 2890              	.L206:
 2891              		.align	2
 2892              	.L205:
 2893 011c 00000000 		.word	g_CmdMap
 2894 0120 00000000 		.word	g_Encode_offset
 2895 0124 00000000 		.word	pid_IQ
 2896 0128 00000000 		.word	pid_pos
 2897 012c 00000000 		.word	pid_spd
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 85


 2898 0130 00000000 		.word	pid_ID
 2899 0134 00000000 		.word	pid_force
 2900 0138 00000000 		.word	gPos_ds
 2901 013c 00000000 		.word	g_ThreeLoopParaBefLock
 2902              		.cfi_endproc
 2903              	.LFE350:
 2905              		.section	.text.EXTI3_IRQHandler,"ax",%progbits
 2906              		.align	1
 2907              		.global	EXTI3_IRQHandler
 2908              		.syntax unified
 2909              		.thumb
 2910              		.thumb_func
 2911              		.fpu fpv4-sp-d16
 2913              	EXTI3_IRQHandler:
 2914              	.LFB351:
1462:Src/pid.c     **** 
1463:Src/pid.c     **** 
1464:Src/pid.c     **** // Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½ï¿½ï¿½ï¿½Ð¶ï¿½ 2KHz
1465:Src/pid.c     **** void EXTI3_IRQHandler(void)
1466:Src/pid.c     **** {
 2915              		.loc 1 1466 0
 2916              		.cfi_startproc
 2917              		@ args = 0, pretend = 0, frame = 0
 2918              		@ frame_needed = 0, uses_anonymous_args = 0
1467:Src/pid.c     ****  // if(EXTI_GetITStatus(EXTI_Line3) != RESET)
1468:Src/pid.c     ****   {
1469:Src/pid.c     **** 		//LED2_TOOGLE(); fortest
1470:Src/pid.c     **** 		EXTI->PR1 |= 0x0008;		// ï¿½ï¿½ï¿½ï¿½ï¿½Ö¾
 2919              		.loc 1 1470 0
 2920 0000 AB4A     		ldr	r2, .L312
 2921 0002 5369     		ldr	r3, [r2, #20]
 2922 0004 43F00803 		orr	r3, r3, #8
1466:Src/pid.c     ****  // if(EXTI_GetITStatus(EXTI_Line3) != RESET)
 2923              		.loc 1 1466 0
 2924 0008 70B5     		push	{r4, r5, r6, lr}
 2925              	.LCFI18:
 2926              		.cfi_def_cfa_offset 16
 2927              		.cfi_offset 4, -16
 2928              		.cfi_offset 5, -12
 2929              		.cfi_offset 6, -8
 2930              		.cfi_offset 14, -4
 2931              		.loc 1 1470 0
 2932 000a 5361     		str	r3, [r2, #20]
 2933              	.LBB33:
 2934              	.LBB34:
1083:Src/pid.c     **** 	//CheckModeChange();
 2935              		.loc 1 1083 0
 2936 000c 4FF09042 		mov	r2, #1207959552
1092:Src/pid.c     **** 	{
 2937              		.loc 1 1092 0
 2938 0010 A84C     		ldr	r4, .L312+4
1083:Src/pid.c     **** 	//CheckModeChange();
 2939              		.loc 1 1083 0
 2940 0012 936A     		ldr	r3, [r2, #40]
 2941 0014 43F01003 		orr	r3, r3, #16
 2942 0018 9362     		str	r3, [r2, #40]
1085:Src/pid.c     **** 	if(g_servo_cmd_period_cnt<2000)
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 86


 2943              		.loc 1 1085 0
 2944 001a FFF7FEFF 		bl	MTPro
 2945              	.LVL194:
1086:Src/pid.c     **** 	{
 2946              		.loc 1 1086 0
 2947 001e A64A     		ldr	r2, .L312+8
 2948 0020 1368     		ldr	r3, [r2]
 2949 0022 B3F5FA6F 		cmp	r3, #2000
1088:Src/pid.c     **** 	}
 2950              		.loc 1 1088 0
 2951 0026 BCBF     		itt	lt
 2952 0028 0133     		addlt	r3, r3, #1
 2953 002a 1360     		strlt	r3, [r2]
1090:Src/pid.c     **** 	
 2954              		.loc 1 1090 0
 2955 002c FFF7FEFF 		bl	get_average_force_data
 2956              	.LVL195:
1092:Src/pid.c     **** 	{
 2957              		.loc 1 1092 0
 2958 0030 B4F80432 		ldrh	r3, [r4, #516]
 2959 0034 1BB2     		sxth	r3, r3
 2960 0036 042B     		cmp	r3, #4
 2961 0038 4CD1     		bne	.L210
 2962              	.LVL196:
 2963              	.LBB35:
 2964              	.LBB36:
 203:Src/pid.c     **** 	{
 2965              		.loc 1 203 0
 2966 003a 638D     		ldrh	r3, [r4, #42]
 2967 003c 9F49     		ldr	r1, .L312+12
 2968 003e A04A     		ldr	r2, .L312+16
 2969 0040 1BB2     		sxth	r3, r3
 2970 0042 002B     		cmp	r3, #0
 2971 0044 77D1     		bne	.L211
 205:Src/pid.c     **** 		force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 2972              		.loc 1 205 0
 2973 0046 B4F84430 		ldrh	r3, [r4, #68]
 2974 004a 0B80     		strh	r3, [r1]	@ movhi
 206:Src/pid.c     **** 	}
 2975              		.loc 1 206 0
 2976 004c B4F85A30 		ldrh	r3, [r4, #90]
 2977              	.L305:
 211:Src/pid.c     **** 	}
 2978              		.loc 1 211 0
 2979 0050 1380     		strh	r3, [r2]	@ movhi
 239:Src/pid.c     **** 	pid_force.Low_limit = ((g_CmdMap[SYS_SPD_LOWER_LIMIT_PU]>>0));
 2980              		.loc 1 239 0
 2981 0052 B4F88432 		ldrh	r3, [r4, #644]
 2982 0056 9B4D     		ldr	r5, .L312+20
 2983 0058 1BB2     		sxth	r3, r3
 2984 005a EB63     		str	r3, [r5, #60]
 240:Src/pid.c     **** 	
 2985              		.loc 1 240 0
 2986 005c B4F88632 		ldrh	r3, [r4, #646]
 242:Src/pid.c     **** 	{
 2987              		.loc 1 242 0
 2988 0060 B4F84C00 		ldrh	r0, [r4, #76]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 87


 240:Src/pid.c     **** 	
 2989              		.loc 1 240 0
 2990 0064 1BB2     		sxth	r3, r3
 2991 0066 2B64     		str	r3, [r5, #64]
 242:Src/pid.c     **** 	{
 2992              		.loc 1 242 0
 2993 0068 B4F88C32 		ldrh	r3, [r4, #652]
 2994 006c 00B2     		sxth	r0, r0
 2995 006e 1BB2     		sxth	r3, r3
 2996 0070 9842     		cmp	r0, r3
 2997 0072 6ADD     		ble	.L213
 2998              	.L215:
 244:Src/pid.c     **** 		
 2999              		.loc 1 244 0
 3000 0074 0023     		movs	r3, #0
 3001 0076 EB63     		str	r3, [r5, #60]
 3002              	.L214:
 252:Src/pid.c     **** 	{
 3003              		.loc 1 252 0
 3004 0078 B4F84C00 		ldrh	r0, [r4, #76]
 3005 007c B4F88E32 		ldrh	r3, [r4, #654]
 3006 0080 00B2     		sxth	r0, r0
 3007 0082 1BB2     		sxth	r3, r3
 3008 0084 9842     		cmp	r0, r3
 3009 0086 70DA     		bge	.L216
 3010              	.L218:
 254:Src/pid.c     **** 		
 3011              		.loc 1 254 0
 3012 0088 0023     		movs	r3, #0
 3013 008a 2B64     		str	r3, [r5, #64]
 3014              	.L217:
 289:Src/pid.c     **** //	}
 3015              		.loc 1 289 0
 3016 008c 0888     		ldrh	r0, [r1]
 3017 008e 1188     		ldrh	r1, [r2]
 3018 0090 8C4A     		ldr	r2, .L312+20
 3019 0092 09B2     		sxth	r1, r1
 3020 0094 00B2     		sxth	r0, r0
 3021 0096 FFF7FEFF 		bl	PID_control
 3022              	.LVL197:
 292:Src/pid.c     **** 	
 3023              		.loc 1 292 0
 3024 009a B5F93430 		ldrsh	r3, [r5, #52]
 3025 009e A4F85E30 		strh	r3, [r4, #94]	@ movhi
 294:Src/pid.c     **** 	{
 3026              		.loc 1 294 0
 3027 00a2 B4F84030 		ldrh	r3, [r4, #64]
 3028 00a6 1BB2     		sxth	r3, r3
 3029 00a8 042B     		cmp	r3, #4
 3030 00aa 08D0     		beq	.L219
 3031 00ac B4F84030 		ldrh	r3, [r4, #64]
 3032 00b0 1BB2     		sxth	r3, r3
 3033 00b2 052B     		cmp	r3, #5
 3034 00b4 0ED1     		bne	.L210
 3035 00b6 844B     		ldr	r3, .L312+24
 3036 00b8 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3037 00ba 032B     		cmp	r3, #3
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 88


 3038 00bc 0AD1     		bne	.L210
 3039              	.L219:
 296:Src/pid.c     **** 		g_CmdMap[CMD_PROFILE_POS_PU] = g_CmdMap[CMD_POS_ACT_PU];
 3040              		.loc 1 296 0
 3041 00be 834B     		ldr	r3, .L312+28
 3042 00c0 0022     		movs	r2, #0
 3043 00c2 1A60     		str	r2, [r3]
 297:Src/pid.c     **** 		g_CmdMap[CMD_POS_SET_PU] = g_CmdMap[CMD_POS_ACT_PU];
 3044              		.loc 1 297 0
 3045 00c4 B4F84C30 		ldrh	r3, [r4, #76]
 3046 00c8 A4F86030 		strh	r3, [r4, #96]	@ movhi
 298:Src/pid.c     **** 	}
 3047              		.loc 1 298 0
 3048 00cc B4F84C30 		ldrh	r3, [r4, #76]
 3049 00d0 A4F84830 		strh	r3, [r4, #72]	@ movhi
 3050              	.LVL198:
 3051              	.L210:
 3052              	.LBE36:
 3053              	.LBE35:
1098:Src/pid.c     **** 	if(++s_count>=(F_SPD_REGULATOR_HZ/F_POS_REGULATOR_HZ))
 3054              		.loc 1 1098 0
 3055 00d4 FFF7FEFF 		bl	Loop3_EnableManage
 3056              	.LVL199:
1099:Src/pid.c     **** 	{
 3057              		.loc 1 1099 0
 3058 00d8 7D4A     		ldr	r2, .L312+32
 3059 00da 1368     		ldr	r3, [r2]
 3060 00dc 0133     		adds	r3, r3, #1
 3061 00de 002B     		cmp	r3, #0
 3062 00e0 52DC     		bgt	.L221
 3063 00e2 1360     		str	r3, [r2]
 3064              	.L222:
1120:Src/pid.c     **** 	
 3065              		.loc 1 1120 0
 3066 00e4 FFF7FEFF 		bl	icmu_sdtransmission_test
 3067              	.LVL200:
1123:Src/pid.c     **** 	{
 3068              		.loc 1 1123 0
 3069 00e8 B4F80432 		ldrh	r3, [r4, #516]
 3070 00ec 1BB2     		sxth	r3, r3
 3071 00ee 032B     		cmp	r3, #3
 3072 00f0 0AD0     		beq	.L225
 3073 00f2 B4F80432 		ldrh	r3, [r4, #516]
 3074 00f6 1BB2     		sxth	r3, r3
 3075 00f8 022B     		cmp	r3, #2
 3076 00fa 05D0     		beq	.L225
 3077 00fc B4F80432 		ldrh	r3, [r4, #516]
 3078 0100 1BB2     		sxth	r3, r3
 3079 0102 042B     		cmp	r3, #4
 3080 0104 40F09D80 		bne	.L226
 3081              	.L225:
 3082              	.LVL201:
 3083              	.LBB38:
 3084              	.LBB39:
 643:Src/pid.c     ****   {
 3085              		.loc 1 643 0
 3086 0108 B4F80432 		ldrh	r3, [r4, #516]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 89


 3087 010c 714D     		ldr	r5, .L312+36
 3088 010e 1BB2     		sxth	r3, r3
 3089 0110 012B     		cmp	r3, #1
 3090 0112 09D0     		beq	.L227
 3091 0114 B4F80432 		ldrh	r3, [r4, #516]
 3092 0118 1BB2     		sxth	r3, r3
 3093 011a 032B     		cmp	r3, #3
 3094 011c 04D0     		beq	.L227
 3095 011e B4F80432 		ldrh	r3, [r4, #516]
 3096 0122 1BB2     		sxth	r3, r3
 3097 0124 062B     		cmp	r3, #6
 3098 0126 45D1     		bne	.L228
 3099              	.L227:
 645:Src/pid.c     ****   }
 3100              		.loc 1 645 0
 3101 0128 B4F86230 		ldrh	r3, [r4, #98]
 3102 012c B4F85E20 		ldrh	r2, [r4, #94]
 3103 0130 1344     		add	r3, r3, r2
 3104              	.LVL202:
 3105              	.L310:
 742:Src/pid.c     **** 								}
 3106              		.loc 1 742 0
 3107 0132 1BB2     		sxth	r3, r3
 3108 0134 21E1     		b	.L309
 3109              	.LVL203:
 3110              	.L211:
 3111              	.LBE39:
 3112              	.LBE38:
 3113              	.LBB42:
 3114              	.LBB37:
 210:Src/pid.c     **** 		force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3115              		.loc 1 210 0
 3116 0136 B4F84430 		ldrh	r3, [r4, #68]
 3117 013a 5B42     		negs	r3, r3
 3118 013c 1BB2     		sxth	r3, r3
 3119 013e 0B80     		strh	r3, [r1]	@ movhi
 211:Src/pid.c     **** 	}
 3120              		.loc 1 211 0
 3121 0140 B4F85A30 		ldrh	r3, [r4, #90]
 3122 0144 5B42     		negs	r3, r3
 3123 0146 1BB2     		sxth	r3, r3
 3124 0148 82E7     		b	.L305
 3125              	.L213:
 247:Src/pid.c     **** 	{
 3126              		.loc 1 247 0
 3127 014a B4F88C32 		ldrh	r3, [r4, #652]
 3128 014e B4F84C00 		ldrh	r0, [r4, #76]
 3129 0152 1BB2     		sxth	r3, r3
 3130 0154 00B2     		sxth	r0, r0
 3131 0156 A3F5CC73 		sub	r3, r3, #408
 3132 015a 8342     		cmp	r3, r0
 3133 015c 8CDC     		bgt	.L214
 3134 015e B4F84230 		ldrh	r3, [r4, #66]
 3135 0162 1BB2     		sxth	r3, r3
 3136 0164 002B     		cmp	r3, #0
 3137 0166 85DC     		bgt	.L215
 3138 0168 86E7     		b	.L214
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 90


 3139              	.L216:
 257:Src/pid.c     **** 	{
 3140              		.loc 1 257 0
 3141 016a B4F88E32 		ldrh	r3, [r4, #654]
 3142 016e B4F84C00 		ldrh	r0, [r4, #76]
 3143 0172 1BB2     		sxth	r3, r3
 3144 0174 00B2     		sxth	r0, r0
 3145 0176 03F5CC73 		add	r3, r3, #408
 3146 017a 8342     		cmp	r3, r0
 3147 017c 86DB     		blt	.L217
 3148 017e B4F84230 		ldrh	r3, [r4, #66]
 3149 0182 1B04     		lsls	r3, r3, #16
 3150 0184 80D4     		bmi	.L218
 3151 0186 81E7     		b	.L217
 3152              	.LVL204:
 3153              	.L221:
 3154              	.LBE37:
 3155              	.LBE42:
1101:Src/pid.c     **** 		Flag_1ms = 1;
 3156              		.loc 1 1101 0
 3157 0188 0020     		movs	r0, #0
 3158 018a 1060     		str	r0, [r2]
1102:Src/pid.c     **** 		if(++s_count_50ms>50)
 3159              		.loc 1 1102 0
 3160 018c 524B     		ldr	r3, .L312+40
1103:Src/pid.c     **** 		{
 3161              		.loc 1 1103 0
 3162 018e 534A     		ldr	r2, .L312+44
1102:Src/pid.c     **** 		if(++s_count_50ms>50)
 3163              		.loc 1 1102 0
 3164 0190 0121     		movs	r1, #1
 3165 0192 1970     		strb	r1, [r3]
1103:Src/pid.c     **** 		{
 3166              		.loc 1 1103 0
 3167 0194 1388     		ldrh	r3, [r2]
 3168 0196 0B44     		add	r3, r3, r1
 3169 0198 1BB2     		sxth	r3, r3
 3170 019a 322B     		cmp	r3, #50
1106:Src/pid.c     **** 		}
 3171              		.loc 1 1106 0
 3172 019c C9BF     		itett	gt
 3173 019e 504B     		ldrgt	r3, .L312+48
1103:Src/pid.c     **** 		{
 3174              		.loc 1 1103 0
 3175 01a0 1380     		strhle	r3, [r2]	@ movhi
1105:Src/pid.c     **** 			Flag_50ms = 1;
 3176              		.loc 1 1105 0
 3177 01a2 1080     		strhgt	r0, [r2]	@ movhi
1106:Src/pid.c     **** 		}
 3178              		.loc 1 1106 0
 3179 01a4 1980     		strhgt	r1, [r3]	@ movhi
1111:Src/pid.c     **** 		Stroke_protection();
 3180              		.loc 1 1111 0
 3181 01a6 FFF7FEFF 		bl	Get_Pos_Rod
 3182              	.LVL205:
1112:Src/pid.c     **** 		
 3183              		.loc 1 1112 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 91


 3184 01aa FFF7FEFF 		bl	Stroke_protection
 3185              	.LVL206:
1116:Src/pid.c     **** 		}
 3186              		.loc 1 1116 0
 3187 01ae FFF7FEFF 		bl	Gripper_control
 3188              	.LVL207:
 3189 01b2 97E7     		b	.L222
 3190              	.LVL208:
 3191              	.L228:
 3192              	.LBB43:
 3193              	.LBB40:
 647:Src/pid.c     **** 	{
 3194              		.loc 1 647 0
 3195 01b4 B4F80432 		ldrh	r3, [r4, #516]
 3196 01b8 1BB2     		sxth	r3, r3
 3197 01ba 042B     		cmp	r3, #4
 3198 01bc 40F09E80 		bne	.L230
 649:Src/pid.c     **** 		
 3199              		.loc 1 649 0
 3200 01c0 B4F85E30 		ldrh	r3, [r4, #94]
 3201 01c4 A4F85C30 		strh	r3, [r4, #92]	@ movhi
 651:Src/pid.c     **** 	}
 3202              		.loc 1 651 0
 3203 01c8 0123     		movs	r3, #1
 3204 01ca 2B60     		str	r3, [r5]
 3205              	.LVL209:
 3206              	.L229:
 777:Src/pid.c     **** 	{
 3207              		.loc 1 777 0
 3208 01cc B4F85C20 		ldrh	r2, [r4, #92]
 3209 01d0 B4F88432 		ldrh	r3, [r4, #644]
 3210 01d4 12B2     		sxth	r2, r2
 3211 01d6 1BB2     		sxth	r3, r3
 3212 01d8 9A42     		cmp	r2, r3
 779:Src/pid.c     **** 	}
 3213              		.loc 1 779 0
 3214 01da C4BF     		itt	gt
 3215 01dc B4F88432 		ldrhgt	r3, [r4, #644]
 3216 01e0 A4F85C30 		strhgt	r3, [r4, #92]	@ movhi
 781:Src/pid.c     **** 	{
 3217              		.loc 1 781 0
 3218 01e4 B4F85C20 		ldrh	r2, [r4, #92]
 3219 01e8 B4F88632 		ldrh	r3, [r4, #646]
 3220 01ec 12B2     		sxth	r2, r2
 3221 01ee 1BB2     		sxth	r3, r3
 3222 01f0 9A42     		cmp	r2, r3
 783:Src/pid.c     **** 	}
 3223              		.loc 1 783 0
 3224 01f2 BCBF     		itt	lt
 3225 01f4 B4F88632 		ldrhlt	r3, [r4, #646]
 3226 01f8 A4F85C30 		strhlt	r3, [r4, #92]	@ movhi
 788:Src/pid.c     **** 	{
 3227              		.loc 1 788 0
 3228 01fc 628C     		ldrh	r2, [r4, #34]
 3229 01fe B4F88032 		ldrh	r3, [r4, #640]
 3230 0202 12B2     		sxth	r2, r2
 3231 0204 1BB2     		sxth	r3, r3
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 92


 3232 0206 9A42     		cmp	r2, r3
 790:Src/pid.c     **** 	}
 3233              		.loc 1 790 0
 3234 0208 C4BF     		itt	gt
 3235 020a B4F88032 		ldrhgt	r3, [r4, #640]
 3236 020e 6384     		strhgt	r3, [r4, #34]	@ movhi
 792:Src/pid.c     **** 	{
 3237              		.loc 1 792 0
 3238 0210 A28C     		ldrh	r2, [r4, #36]
 3239 0212 B4F88232 		ldrh	r3, [r4, #642]
 3240 0216 12B2     		sxth	r2, r2
 3241 0218 1BB2     		sxth	r3, r3
 3242 021a 9A42     		cmp	r2, r3
 794:Src/pid.c     **** 	}
 3243              		.loc 1 794 0
 3244 021c BCBF     		itt	lt
 3245 021e B4F88232 		ldrhlt	r3, [r4, #642]
 3246 0222 A384     		strhlt	r3, [r4, #36]	@ movhi
 797:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[CMD_CUR_LOWER_LIMIT_PU];		
 3247              		.loc 1 797 0
 3248 0224 638C     		ldrh	r3, [r4, #34]
 808:Src/pid.c     **** }
 3249              		.loc 1 808 0
 3250 0226 2B4A     		ldr	r2, .L312+36
 797:Src/pid.c     **** 	pid_spd.Low_limit = g_CmdMap[CMD_CUR_LOWER_LIMIT_PU];		
 3251              		.loc 1 797 0
 3252 0228 1BB2     		sxth	r3, r3
 3253 022a EB63     		str	r3, [r5, #60]
 798:Src/pid.c     **** 	
 3254              		.loc 1 798 0
 3255 022c A38C     		ldrh	r3, [r4, #36]
 808:Src/pid.c     **** }
 3256              		.loc 1 808 0
 3257 022e B4F85C00 		ldrh	r0, [r4, #92]
 3258 0232 B4F85010 		ldrh	r1, [r4, #80]
 798:Src/pid.c     **** 	
 3259              		.loc 1 798 0
 3260 0236 1BB2     		sxth	r3, r3
 808:Src/pid.c     **** }
 3261              		.loc 1 808 0
 3262 0238 09B2     		sxth	r1, r1
 3263 023a 00B2     		sxth	r0, r0
 798:Src/pid.c     **** 	
 3264              		.loc 1 798 0
 3265 023c 2B64     		str	r3, [r5, #64]
 808:Src/pid.c     **** }
 3266              		.loc 1 808 0
 3267 023e FFF7FEFF 		bl	PID_control
 3268              	.LVL210:
 3269              	.L226:
 3270              	.LBE40:
 3271              	.LBE43:
1128:Src/pid.c     **** 	{
 3272              		.loc 1 1128 0
 3273 0242 B4F80222 		ldrh	r2, [r4, #514]
 3274 0246 274B     		ldr	r3, .L312+52
 3275 0248 2748     		ldr	r0, .L312+56
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 93


 3276 024a 2849     		ldr	r1, .L312+60
 3277 024c 12B2     		sxth	r2, r2
 3278 024e 4AB1     		cbz	r2, .L261
 3279 0250 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 3280 0252 012A     		cmp	r2, #1
 3281 0254 06D0     		beq	.L261
 3282 0256 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
 3283 0258 012A     		cmp	r2, #1
 3284 025a 03D0     		beq	.L261
 3285 025c 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 3286 025e 012A     		cmp	r2, #1
 3287 0260 40F02381 		bne	.L262
 3288              	.L261:
1130:Src/pid.c     **** 		Motor_forbidden = 0;
 3289              		.loc 1 1130 0
 3290 0264 0022     		movs	r2, #0
1131:Src/pid.c     **** 		if(g_CmdMap[TAG_WORK_MODE] == MODE_SPEED ||g_CmdMap[TAG_WORK_MODE] == MODE_CURRENT )
 3291              		.loc 1 1131 0
 3292 0266 1A70     		strb	r2, [r3]
1132:Src/pid.c     **** 		{
 3293              		.loc 1 1132 0
 3294 0268 B4F80432 		ldrh	r3, [r4, #516]
1130:Src/pid.c     **** 		Motor_forbidden = 0;
 3295              		.loc 1 1130 0
 3296 026c 204D     		ldr	r5, .L312+64
1132:Src/pid.c     **** 		{
 3297              		.loc 1 1132 0
 3298 026e 1BB2     		sxth	r3, r3
 3299 0270 022B     		cmp	r3, #2
1130:Src/pid.c     **** 		Motor_forbidden = 0;
 3300              		.loc 1 1130 0
 3301 0272 2A60     		str	r2, [r5]
1132:Src/pid.c     **** 		{
 3302              		.loc 1 1132 0
 3303 0274 04D0     		beq	.L263
 3304 0276 B4F80432 		ldrh	r3, [r4, #516]
 3305 027a 1BB2     		sxth	r3, r3
 3306 027c 012B     		cmp	r3, #1
 3307 027e 04D1     		bne	.L264
 3308              	.L263:
1134:Src/pid.c     **** 			g_CmdMap[CMD_CUR_SET_PU] = 0;
 3309              		.loc 1 1134 0
 3310 0280 0023     		movs	r3, #0
 3311 0282 A4F84630 		strh	r3, [r4, #70]	@ movhi
1135:Src/pid.c     **** 		}
 3312              		.loc 1 1135 0
 3313 0286 A4F84230 		strh	r3, [r4, #66]	@ movhi
 3314              	.L264:
1137:Src/pid.c     **** 		{	
 3315              		.loc 1 1137 0
 3316 028a B4F85430 		ldrh	r3, [r4, #84]
 3317 028e 1BB2     		sxth	r3, r3
 3318 0290 1BB1     		cbz	r3, .L265
1139:Src/pid.c     **** 		}			
 3319              		.loc 1 1139 0
 3320 0292 B4F84C30 		ldrh	r3, [r4, #76]
 3321 0296 A4F84830 		strh	r3, [r4, #72]	@ movhi
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 94


 3322              	.L265:
1145:Src/pid.c     ****       Motor_emergercy_stop =0;
 3323              		.loc 1 1145 0
 3324 029a 164B     		ldr	r3, .L312+68
 3325 029c 0024     		movs	r4, #0
 3326 029e 1C60     		str	r4, [r3]
1146:Src/pid.c     **** 			Motor_pause_flag = 0;
 3327              		.loc 1 1146 0
 3328 02a0 0470     		strb	r4, [r0]
1147:Src/pid.c     **** 			PWM_Disable();
 3329              		.loc 1 1147 0
 3330 02a2 0C70     		strb	r4, [r1]
1148:Src/pid.c     **** 		}
 3331              		.loc 1 1148 0
 3332 02a4 FFF7FEFF 		bl	PWM_Disable
 3333              	.LVL211:
1154:Src/pid.c     **** 		return;
 3334              		.loc 1 1154 0
 3335 02a8 134B     		ldr	r3, .L312+72
 3336 02aa 1C60     		str	r4, [r3]
 3337              	.L207:
 3338              	.LBE34:
 3339              	.LBE33:
1471:Src/pid.c     ****     Pos_Spd_PID();  // ï¿½ï¿½ï¿½ï¿½Î»ï¿½Ã»ï¿½ï¿½ï¿½ï¿½Ù¶È»ï¿½				
1472:Src/pid.c     **** 		//UpdateErrorStateLED(); 		
1473:Src/pid.c     ****   }
1474:Src/pid.c     **** }
 3340              		.loc 1 1474 0
 3341 02ac 70BD     		pop	{r4, r5, r6, pc}
 3342              	.L313:
 3343 02ae 00BF     		.align	2
 3344              	.L312:
 3345 02b0 00040140 		.word	1073808384
 3346 02b4 00000000 		.word	g_CmdMap
 3347 02b8 00000000 		.word	g_servo_cmd_period_cnt
 3348 02bc 00000000 		.word	force_set
 3349 02c0 00000000 		.word	force_act
 3350 02c4 00000000 		.word	pid_force
 3351 02c8 00000000 		.word	status_Mode_POSITION_FORCE
 3352 02cc 00000000 		.word	Flag_Profile_Enable
 3353 02d0 00000000 		.word	.LANCHOR36
 3354 02d4 00000000 		.word	pid_spd
 3355 02d8 00000000 		.word	Flag_1ms
 3356 02dc 00000000 		.word	s_count_50ms
 3357 02e0 00000000 		.word	Flag_50ms
 3358 02e4 00000000 		.word	Motor_forbidden
 3359 02e8 00000000 		.word	Motor_emergercy_stop
 3360 02ec 00000000 		.word	Motor_pause_flag
 3361 02f0 00000000 		.word	.LANCHOR40
 3362 02f4 00000000 		.word	g_Timer1CCR
 3363 02f8 00000000 		.word	.LANCHOR21
 3364              	.LVL212:
 3365              	.L230:
 3366              	.LBB47:
 3367              	.LBB45:
 3368              	.LBB44:
 3369              	.LBB41:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 95


 653:Src/pid.c     ****   {
 3370              		.loc 1 653 0
 3371 02fc B4F80432 		ldrh	r3, [r4, #516]
 3372 0300 1BB2     		sxth	r3, r3
 3373 0302 022B     		cmp	r3, #2
 3374 0304 7FF462AF 		bne	.L229
 655:Src/pid.c     **** 			{
 3375              		.loc 1 655 0
 3376 0308 7E49     		ldr	r1, .L314
 3377 030a 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 3378 030c 022B     		cmp	r3, #2
 3379 030e 45D1     		bne	.L231
 657:Src/pid.c     **** 				{
 3380              		.loc 1 657 0
 3381 0310 638D     		ldrh	r3, [r4, #42]
 3382 0312 7D48     		ldr	r0, .L314+4
 3383 0314 7D4A     		ldr	r2, .L314+8
 3384 0316 1BB2     		sxth	r3, r3
 3385 0318 1BBB     		cbnz	r3, .L232
 659:Src/pid.c     **** 					force_act = g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3386              		.loc 1 659 0
 3387 031a B4F84430 		ldrh	r3, [r4, #68]
 3388 031e 0380     		strh	r3, [r0]	@ movhi
 660:Src/pid.c     **** 				}
 3389              		.loc 1 660 0
 3390 0320 B4F85A30 		ldrh	r3, [r4, #90]
 3391              	.L306:
 665:Src/pid.c     **** 				}
 3392              		.loc 1 665 0
 3393 0324 1380     		strh	r3, [r2]	@ movhi
 667:Src/pid.c     **** 				{
 3394              		.loc 1 667 0
 3395 0326 0388     		ldrh	r3, [r0]
 669:Src/pid.c     **** 					{
 3396              		.loc 1 669 0
 3397 0328 1288     		ldrh	r2, [r2]
 667:Src/pid.c     **** 				{
 3398              		.loc 1 667 0
 3399 032a 13F4004F 		tst	r3, #32768
 669:Src/pid.c     **** 					{
 3400              		.loc 1 669 0
 3401 032e 0388     		ldrh	r3, [r0]
 3402 0330 12B2     		sxth	r2, r2
 3403 0332 1BB2     		sxth	r3, r3
 667:Src/pid.c     **** 				{
 3404              		.loc 1 667 0
 3405 0334 24D1     		bne	.L234
 669:Src/pid.c     **** 					{
 3406              		.loc 1 669 0
 3407 0336 9A42     		cmp	r2, r3
 3408 0338 07DC     		bgt	.L237
 3409 033a B4F84C20 		ldrh	r2, [r4, #76]
 3410 033e B4F88C32 		ldrh	r3, [r4, #652]
 3411 0342 12B2     		sxth	r2, r2
 3412 0344 1BB2     		sxth	r3, r3
 3413 0346 9A42     		cmp	r2, r3
 3414 0348 15DD     		ble	.L236
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 96


 3415              	.L237:
 685:Src/pid.c     **** 						g_CmdMap[TAG_WORK_MODE] = MODE_FORCE;
 3416              		.loc 1 685 0
 3417 034a 0323     		movs	r3, #3
 3418 034c 0B70     		strb	r3, [r1]
 686:Src/pid.c     **** 						force_PID_out(g_CmdMap[CMD_CUR_SET_PU],&pid_force); 
 3419              		.loc 1 686 0
 3420 034e 0423     		movs	r3, #4
 3421 0350 A4F80432 		strh	r3, [r4, #516]	@ movhi
 687:Src/pid.c     ****  		
 3422              		.loc 1 687 0
 3423 0354 B4F84200 		ldrh	r0, [r4, #66]
 3424 0358 6D49     		ldr	r1, .L314+12
 3425 035a 00B2     		sxth	r0, r0
 3426 035c FFF7FEFF 		bl	force_PID_out
 3427              	.LVL213:
 3428 0360 34E7     		b	.L229
 3429              	.L232:
 664:Src/pid.c     **** 					force_act = -1*g_CmdMap[CMD_FORCE_ACT_RAW_PU];
 3430              		.loc 1 664 0
 3431 0362 B4F84430 		ldrh	r3, [r4, #68]
 3432 0366 5B42     		negs	r3, r3
 3433 0368 1BB2     		sxth	r3, r3
 3434 036a 0380     		strh	r3, [r0]	@ movhi
 665:Src/pid.c     **** 				}
 3435              		.loc 1 665 0
 3436 036c B4F85A30 		ldrh	r3, [r4, #90]
 3437 0370 5B42     		negs	r3, r3
 3438 0372 1BB2     		sxth	r3, r3
 3439 0374 D6E7     		b	.L306
 3440              	.L236:
 678:Src/pid.c     **** 					}
 3441              		.loc 1 678 0
 3442 0376 B4F84A30 		ldrh	r3, [r4, #74]
 3443              	.LVL214:
 3444              	.L309:
 773:Src/pid.c     **** 							}				
 3445              		.loc 1 773 0
 3446 037a A4F85C30 		strh	r3, [r4, #92]	@ movhi
 3447 037e 25E7     		b	.L229
 3448              	.LVL215:
 3449              	.L234:
 683:Src/pid.c     **** 					{
 3450              		.loc 1 683 0
 3451 0380 9A42     		cmp	r2, r3
 3452 0382 E2DB     		blt	.L237
 3453 0384 B4F84C20 		ldrh	r2, [r4, #76]
 3454 0388 B4F88E32 		ldrh	r3, [r4, #654]
 3455 038c 12B2     		sxth	r2, r2
 3456 038e 1BB2     		sxth	r3, r3
 3457 0390 9A42     		cmp	r2, r3
 3458 0392 DADB     		blt	.L237
 692:Src/pid.c     **** 					}
 3459              		.loc 1 692 0
 3460 0394 B4F84A30 		ldrh	r3, [r4, #74]
 3461 0398 5B42     		negs	r3, r3
 3462 039a CAE6     		b	.L310
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 97


 3463              	.L231:
 698:Src/pid.c     **** 							{
 3464              		.loc 1 698 0
 3465 039c B4F81C32 		ldrh	r3, [r4, #540]
 3466 03a0 1BB2     		sxth	r3, r3
 3467 03a2 13B9     		cbnz	r3, .L239
 700:Src/pid.c     **** 							}
 3468              		.loc 1 700 0
 3469 03a4 B4F84630 		ldrh	r3, [r4, #70]
 3470 03a8 E7E7     		b	.L309
 3471              	.L239:
 702:Src/pid.c     **** 							{
 3472              		.loc 1 702 0
 3473 03aa B4F81C32 		ldrh	r3, [r4, #540]
 3474 03ae 1BB2     		sxth	r3, r3
 3475 03b0 012B     		cmp	r3, #1
 3476 03b2 18D1     		bne	.L240
 705:Src/pid.c     **** 								{
 3477              		.loc 1 705 0
 3478 03b4 B4F84C20 		ldrh	r2, [r4, #76]
 3479 03b8 40F26561 		movw	r1, #1637
 3480 03bc 12B2     		sxth	r2, r2
 3481 03be 8A42     		cmp	r2, r1
 3482 03c0 544A     		ldr	r2, .L314+16
 3483 03c2 06DC     		bgt	.L241
 3484              	.L307:
 711:Src/pid.c     **** 								}
 3485              		.loc 1 711 0
 3486 03c4 1360     		str	r3, [r2]
 3487              	.L242:
 713:Src/pid.c     **** 
 3488              		.loc 1 713 0
 3489 03c6 B4F84630 		ldrh	r3, [r4, #70]
 3490              	.LVL216:
 3491              	.L311:
 742:Src/pid.c     **** 								}
 3492              		.loc 1 742 0
 3493 03ca 1268     		ldr	r2, [r2]
 3494 03cc 12FB03F3 		smulbb	r3, r2, r3
 3495 03d0 AFE6     		b	.L310
 3496              	.LVL217:
 3497              	.L241:
 709:Src/pid.c     **** 								{
 3498              		.loc 1 709 0
 3499 03d2 B4F84C30 		ldrh	r3, [r4, #76]
 3500 03d6 43F69A11 		movw	r1, #14746
 3501 03da 1BB2     		sxth	r3, r3
 3502 03dc 8B42     		cmp	r3, r1
 3503 03de F2DD     		ble	.L242
 711:Src/pid.c     **** 								}
 3504              		.loc 1 711 0
 3505 03e0 4FF0FF33 		mov	r3, #-1
 3506 03e4 EEE7     		b	.L307
 3507              	.L240:
 716:Src/pid.c     **** 							{
 3508              		.loc 1 716 0
 3509 03e6 B4F81C32 		ldrh	r3, [r4, #540]
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 98


 3510 03ea 1BB2     		sxth	r3, r3
 3511 03ec 0B2B     		cmp	r3, #11
 3512 03ee 3AD1     		bne	.L243
 718:Src/pid.c     **** 								{
 3513              		.loc 1 718 0
 3514 03f0 B4F86420 		ldrh	r2, [r4, #100]
 3515 03f4 B4F8E032 		ldrh	r3, [r4, #736]
 3516 03f8 12B2     		sxth	r2, r2
 3517 03fa 1BB2     		sxth	r3, r3
 3518 03fc 9A42     		cmp	r2, r3
 3519 03fe 18DA     		bge	.L244
 720:Src/pid.c     **** 								}
 3520              		.loc 1 720 0
 3521 0400 444B     		ldr	r3, .L314+16
 3522 0402 0122     		movs	r2, #1
 3523              	.L308:
 724:Src/pid.c     **** 								}
 3524              		.loc 1 724 0
 3525 0404 1A60     		str	r2, [r3]
 3526              	.L245:
 726:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3527              		.loc 1 726 0
 3528 0406 B4F84630 		ldrh	r3, [r4, #70]
 727:Src/pid.c     **** 								{
 3529              		.loc 1 727 0
 3530 040a 4348     		ldr	r0, .L314+20
 3531 040c 4349     		ldr	r1, .L314+24
 3532 040e 0268     		ldr	r2, [r0]
 726:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3533              		.loc 1 726 0
 3534 0410 13F4004F 		tst	r3, #32768
 3535 0414 B4F84630 		ldrh	r3, [r4, #70]
 3536 0418 18BF     		it	ne
 3537 041a 5B42     		rsbne	r3, r3, #0
 727:Src/pid.c     **** 								{
 3538              		.loc 1 727 0
 3539 041c B2F57A6F 		cmp	r2, #4000
 726:Src/pid.c     **** 								if(s_test_speed_t_count++>4000)
 3540              		.loc 1 726 0
 3541 0420 1BB2     		sxth	r3, r3
 3542              	.LVL218:
 727:Src/pid.c     **** 								{
 3543              		.loc 1 727 0
 3544 0422 12DC     		bgt	.L248
 3545 0424 0132     		adds	r2, r2, #1
 3546 0426 0260     		str	r2, [r0]
 3547              	.L249:
 740:Src/pid.c     **** 								{
 3548              		.loc 1 740 0
 3549 0428 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 3550 042a 012A     		cmp	r2, #1
 3551 042c 3BD1     		bne	.L255
 742:Src/pid.c     **** 								}
 3552              		.loc 1 742 0
 3553 042e 394A     		ldr	r2, .L314+16
 3554 0430 CBE7     		b	.L311
 3555              	.LVL219:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 99


 3556              	.L244:
 722:Src/pid.c     **** 								{
 3557              		.loc 1 722 0
 3558 0432 B4F86420 		ldrh	r2, [r4, #100]
 3559 0436 B4F85833 		ldrh	r3, [r4, #856]
 3560 043a 12B2     		sxth	r2, r2
 3561 043c 1BB2     		sxth	r3, r3
 3562 043e 9A42     		cmp	r2, r3
 3563 0440 E1DD     		ble	.L245
 724:Src/pid.c     **** 								}
 3564              		.loc 1 724 0
 3565 0442 344B     		ldr	r3, .L314+16
 3566 0444 4FF0FF32 		mov	r2, #-1
 3567 0448 DCE7     		b	.L308
 3568              	.LVL220:
 3569              	.L248:
 729:Src/pid.c     **** 									if(g_flag_monitor_from_host == 0)
 3570              		.loc 1 729 0
 3571 044a 0022     		movs	r2, #0
 3572 044c 0260     		str	r2, [r0]
 730:Src/pid.c     **** 									{
 3573              		.loc 1 730 0
 3574 044e 344A     		ldr	r2, .L314+28
 3575 0450 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 3576 0452 00F0FF06 		and	r6, r0, #255
 3577 0456 18B9     		cbnz	r0, .L250
 732:Src/pid.c     **** 									}
 3578              		.loc 1 732 0
 3579 0458 0E70     		strb	r6, [r1]
 3580              	.L251:
 738:Src/pid.c     **** 								}
 3581              		.loc 1 738 0
 3582 045a 0020     		movs	r0, #0
 3583 045c 1070     		strb	r0, [r2]
 3584 045e E3E7     		b	.L249
 3585              	.L250:
 736:Src/pid.c     **** 									}
 3586              		.loc 1 736 0
 3587 0460 0120     		movs	r0, #1
 3588 0462 0870     		strb	r0, [r1]
 3589 0464 F9E7     		b	.L251
 3590              	.LVL221:
 3591              	.L243:
 749:Src/pid.c     **** 							{
 3592              		.loc 1 749 0
 3593 0466 B4F81C32 		ldrh	r3, [r4, #540]
 3594 046a 1BB2     		sxth	r3, r3
 3595 046c 0C2B     		cmp	r3, #12
 3596 046e 0AD1     		bne	.L253
 751:Src/pid.c     **** 								{
 3597              		.loc 1 751 0
 3598 0470 B4F86420 		ldrh	r2, [r4, #100]
 3599 0474 B4F8E032 		ldrh	r3, [r4, #736]
 3600 0478 12B2     		sxth	r2, r2
 3601 047a 1BB2     		sxth	r3, r3
 3602 047c 9A42     		cmp	r2, r3
 3603 047e 12DD     		ble	.L255
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 100


 753:Src/pid.c     **** 								}
 3604              		.loc 1 753 0
 3605 0480 4FF46043 		mov	r3, #57344
 3606 0484 79E7     		b	.L309
 3607              	.L253:
 760:Src/pid.c     **** 							{
 3608              		.loc 1 760 0
 3609 0486 B4F81C32 		ldrh	r3, [r4, #540]
 3610 048a 1BB2     		sxth	r3, r3
 3611 048c 0D2B     		cmp	r3, #13
 3612 048e 0AD1     		bne	.L255
 762:Src/pid.c     **** 								{
 3613              		.loc 1 762 0
 3614 0490 B4F86420 		ldrh	r2, [r4, #100]
 3615 0494 B4F85833 		ldrh	r3, [r4, #856]
 3616 0498 12B2     		sxth	r2, r2
 3617 049a 1BB2     		sxth	r3, r3
 3618 049c 9A42     		cmp	r2, r3
 3619 049e 02DA     		bge	.L255
 764:Src/pid.c     **** 								}
 3620              		.loc 1 764 0
 3621 04a0 4FF40053 		mov	r3, #8192
 3622 04a4 69E7     		b	.L309
 3623              	.LVL222:
 3624              	.L255:
 773:Src/pid.c     **** 							}				
 3625              		.loc 1 773 0
 3626 04a6 0023     		movs	r3, #0
 3627 04a8 67E7     		b	.L309
 3628              	.L262:
 3629              	.LBE41:
 3630              	.LBE44:
1157:Src/pid.c     **** 	{
 3631              		.loc 1 1157 0
 3632 04aa B4F80222 		ldrh	r2, [r4, #514]
 3633 04ae 12B2     		sxth	r2, r2
 3634 04b0 012A     		cmp	r2, #1
 3635 04b2 7FF4FBAE 		bne	.L207
 3636 04b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3637 04b8 002B     		cmp	r3, #0
 3638 04ba 7FF4F7AE 		bne	.L207
1159:Src/pid.c     **** 		s_Disable_Delay = 0;
 3639              		.loc 1 1159 0
 3640 04be 194B     		ldr	r3, .L314+32
 3641 04c0 1A68     		ldr	r2, [r3]
 3642 04c2 022A     		cmp	r2, #2
 3643 04c4 DCBF     		itt	le
 3644 04c6 0132     		addle	r2, r2, #1
 3645 04c8 1A60     		strle	r2, [r3]
1161:Src/pid.c     **** 		{
 3646              		.loc 1 1161 0
 3647 04ca 1B68     		ldr	r3, [r3]
1160:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
 3648              		.loc 1 1160 0
 3649 04cc 164A     		ldr	r2, .L314+36
 3650 04ce 0021     		movs	r1, #0
1161:Src/pid.c     **** 		{
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 101


 3651              		.loc 1 1161 0
 3652 04d0 012B     		cmp	r3, #1
1160:Src/pid.c     **** 		if (s_Enable_Delay == 1)  // ï¿½Ó½ï¿½ï¿½Ü±ï¿½ÎªÊ¹ï¿½ï¿½ 50ms
 3653              		.loc 1 1160 0
 3654 04d2 1160     		str	r1, [r2]
1161:Src/pid.c     **** 		{
 3655              		.loc 1 1161 0
 3656 04d4 7FF4EAAE 		bne	.L207
1163:Src/pid.c     **** 			{
 3657              		.loc 1 1163 0
 3658 04d8 B4F80432 		ldrh	r3, [r4, #516]
 3659 04dc 1BB2     		sxth	r3, r3
 3660 04de 022B     		cmp	r3, #2
 3661 04e0 04D0     		beq	.L270
 3662 04e2 B4F80432 		ldrh	r3, [r4, #516]
 3663 04e6 1BB2     		sxth	r3, r3
 3664 04e8 012B     		cmp	r3, #1
 3665 04ea 04D1     		bne	.L271
 3666              	.L270:
1165:Src/pid.c     **** 				g_CmdMap[CMD_CUR_SET_PU] = 0;
 3667              		.loc 1 1165 0
 3668 04ec 0023     		movs	r3, #0
 3669 04ee A4F84630 		strh	r3, [r4, #70]	@ movhi
1166:Src/pid.c     **** 			}
 3670              		.loc 1 1166 0
 3671 04f2 A4F84230 		strh	r3, [r4, #66]	@ movhi
 3672              	.L271:
1168:Src/pid.c     **** 			PWM_Enable();			
 3673              		.loc 1 1168 0
 3674 04f6 0D4B     		ldr	r3, .L314+40
 3675 04f8 0022     		movs	r2, #0
 3676              	.LBE45:
 3677              	.LBE47:
 3678              		.loc 1 1474 0
 3679 04fa BDE87040 		pop	{r4, r5, r6, lr}
 3680              	.LCFI19:
 3681              		.cfi_restore 14
 3682              		.cfi_restore 6
 3683              		.cfi_restore 5
 3684              		.cfi_restore 4
 3685              		.cfi_def_cfa_offset 0
 3686              	.LBB48:
 3687              	.LBB46:
1168:Src/pid.c     **** 			PWM_Enable();			
 3688              		.loc 1 1168 0
 3689 04fe 1A60     		str	r2, [r3]
1169:Src/pid.c     **** 		}
 3690              		.loc 1 1169 0
 3691 0500 FFF7FEBF 		b	PWM_Enable
 3692              	.LVL223:
 3693              	.L315:
 3694              		.align	2
 3695              	.L314:
 3696 0504 00000000 		.word	status_Mode_POSITION_FORCE
 3697 0508 00000000 		.word	force_set
 3698 050c 00000000 		.word	force_act
 3699 0510 00000000 		.word	pid_force
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 102


 3700 0514 00000000 		.word	.LANCHOR37
 3701 0518 00000000 		.word	.LANCHOR38
 3702 051c 00000000 		.word	.LANCHOR39
 3703 0520 00000000 		.word	g_flag_monitor_from_host
 3704 0524 00000000 		.word	.LANCHOR40
 3705 0528 00000000 		.word	.LANCHOR41
 3706 052c 00000000 		.word	g_Timer1CCR
 3707              	.LBE46:
 3708              	.LBE48:
 3709              		.cfi_endproc
 3710              	.LFE351:
 3712              		.global	Vel_PPS_raw1
 3713              		.comm	hall_total_time,8,8
 3714              		.global	hall_previous_3_time
 3715              		.global	hall_previous_2_time
 3716              		.global	hall_previous_1_time
 3717              		.global	hall_now_time
 3718              		.global	hall_cnt
 3719              		.global	hall_speed_sample_timeout
 3720              		.global	hall_speed_sample_cnt
 3721              		.global	hall_speed_sample_timeout_cnt
 3722              		.global	last_time4_capture_ch1
 3723              		.global	pid_hall_sample_time_index
 3724              		.comm	pid_hall_sample_time_point,40,4
 3725              		.comm	speed3,4,4
 3726              		.comm	speed2,4,4
 3727              		.comm	speed1,4,4
 3728              		.global	last_hall_sample_time
 3729              		.comm	pid_last_hall_ture_value1,4,4
 3730              		.comm	pid_hall_ture_value1,4,4
 3731              		.global	ServoPro_En_count
 3732              		.global	shunt_conductance2
 3733              		.global	shunt_conductance1
 3734              		.global	phase_current_rev_gain_
 3735              		.global	last_beta
 3736              		.global	last_alpha
 3737              		.comm	delata_beta,4,4
 3738              		.comm	delta_alpha,4,4
 3739              		.comm	I_Beta,4,4
 3740              		.comm	I_Alpha,4,4
 3741              		.global	s_Disable_Delay
 3742              		.comm	integre_observer_ElectricAngle,4,4
 3743              		.comm	observer_speed,4,4
 3744              		.comm	observer_ElectricAngle,4,4
 3745              		.comm	temp_L,4,4
 3746              		.comm	L,4,4
 3747              		.global	v
 3748              		.comm	pid_pll,72,8
 3749              		.comm	pid_pos,72,8
 3750              		.comm	pid_spd,72,8
 3751              		.comm	pid_force,72,8
 3752              		.comm	pid_ID,72,8
 3753              		.comm	pid_IQ,72,8
 3754              		.global	pos_error_to_target
 3755              		.global	T_t_1
 3756              		.global	T_t
 3757              		.global	Para_Identificaion
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 103


 3758              		.global	index_I_phase
 3759              		.global	I_phase
 3760              		.global	motor_para_identification_count_Tms
 3761              		.global	sin_wave_t_us
 3762              		.global	Test_dirt_last
 3763              		.global	Test_dirt
 3764              		.global	Test_perm
 3765              		.global	Flag_Set_OpenLen
 3766              		.global	Brake_rellease_delay_cnt
 3767              		.global	Brake_rellease_delay
 3768              		.global	Grriper_Run_off_delay_cnt
 3769              		.global	Grriper_Run_on_delay_cnt
 3770              		.global	Grriper_Run_last
 3771              		.global	Grriper_Run
 3772              		.global	Grriper_Ready
 3773              		.global	Spd_RPM_CatchLimit
 3774              		.comm	g_Z,4,4
 3775              		.comm	g_Y,4,4
 3776              		.comm	g_X,4,4
 3777              		.global	g_decLen
 3778              		.comm	anlge_reg,2,2
 3779              		.global	g_spd_error
 3780              		.comm	time4_capture_ch1,4,4
 3781              		.global	PosAtDead_Flag_Last
 3782              		.global	PosAtDead_Flag
 3783              		.global	g_posPID_e
 3784              		.global	g_testAngle
 3785              		.global	V_SetTotal
 3786              		.global	V_AddReg
 3787              		.global	g_Pos_Spd
 3788              		.global	g_Pos_PID_16BIT
 3789              		.global	Speed_I_out
 3790              		.global	Speed_P_out
 3791              		.global	g_Pos_Icnt
 3792              		.global	g_Spd_Icnt
 3793              		.global	g_Sector
 3794              		.global	g_V_Beta
 3795              		.global	g_V_Alpha
 3796              		.global	g_Vd_Pu
 3797              		.global	g_Vq_Pu
 3798              		.global	g_Vd
 3799              		.global	g_Vq
 3800              		.global	g_Id_sum
 3801              		.global	g_Iq_sum
 3802              		.global	g_I_Array_Index_Invalid
 3803              		.global	g_I_Array_Index
 3804              		.global	g_Id_Array
 3805              		.global	g_Iq_Array
 3806              		.comm	g_Id_filter,4,4
 3807              		.comm	g_Iq_filter,4,4
 3808              		.global	g_Id
 3809              		.global	g_Iq
 3810              		.global	g_Sum_ABC
 3811              		.global	g_IC_Raw
 3812              		.global	g_IC
 3813              		.global	g_IB_Raw
 3814              		.global	g_IB
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 104


 3815              		.global	g_IA_Raw
 3816              		.global	g_IA
 3817              		.section	.bss.Brake_rellease_delay,"aw",%nobits
 3820              	Brake_rellease_delay:
 3821 0000 00       		.space	1
 3822              		.section	.bss.Brake_rellease_delay_cnt,"aw",%nobits
 3823              		.align	2
 3826              	Brake_rellease_delay_cnt:
 3827 0000 00000000 		.space	4
 3828              		.section	.bss.Flag_Set_OpenLen,"aw",%nobits
 3829              		.set	.LANCHOR5,. + 0
 3832              	Flag_Set_OpenLen:
 3833 0000 00       		.space	1
 3834              		.section	.bss.Grriper_Ready,"aw",%nobits
 3837              	Grriper_Ready:
 3838 0000 00       		.space	1
 3839              		.section	.bss.Grriper_Run,"aw",%nobits
 3840              		.set	.LANCHOR4,. + 0
 3843              	Grriper_Run:
 3844 0000 00       		.space	1
 3845              		.section	.bss.Grriper_Run_last,"aw",%nobits
 3846              		.set	.LANCHOR6,. + 0
 3849              	Grriper_Run_last:
 3850 0000 00       		.space	1
 3851              		.section	.bss.Grriper_Run_off_delay_cnt,"aw",%nobits
 3852              		.align	2
 3855              	Grriper_Run_off_delay_cnt:
 3856 0000 00000000 		.space	4
 3857              		.section	.bss.Grriper_Run_on_delay_cnt,"aw",%nobits
 3858              		.align	2
 3861              	Grriper_Run_on_delay_cnt:
 3862 0000 00000000 		.space	4
 3863              		.section	.bss.I_phase,"aw",%nobits
 3864              		.align	2
 3865              		.set	.LANCHOR31,. + 0
 3868              	I_phase:
 3869 0000 00000000 		.space	1200
 3869      00000000 
 3869      00000000 
 3869      00000000 
 3869      00000000 
 3870              		.section	.bss.Para_Identificaion,"aw",%nobits
 3871              		.align	2
 3872              		.set	.LANCHOR29,. + 0
 3875              	Para_Identificaion:
 3876 0000 00000000 		.space	4
 3877              		.section	.bss.PlusPosition_flag.12156,"aw",%nobits
 3878              		.set	.LANCHOR34,. + 0
 3881              	PlusPosition_flag.12156:
 3882 0000 00       		.space	1
 3883              		.section	.bss.PosAtDead_Flag,"aw",%nobits
 3884              		.set	.LANCHOR2,. + 0
 3887              	PosAtDead_Flag:
 3888 0000 00       		.space	1
 3889              		.section	.bss.PosAtDead_Flag_Last,"aw",%nobits
 3890              		.set	.LANCHOR3,. + 0
 3893              	PosAtDead_Flag_Last:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 105


 3894 0000 00       		.space	1
 3895              		.section	.bss.ServoPro_En_count,"aw",%nobits
 3896              		.align	2
 3899              	ServoPro_En_count:
 3900 0000 00000000 		.space	4
 3901              		.section	.bss.Spd_RPM_CatchLimit,"aw",%nobits
 3902              		.align	1
 3905              	Spd_RPM_CatchLimit:
 3906 0000 0000     		.space	2
 3907              		.section	.bss.Speed_I_out,"aw",%nobits
 3908              		.align	2
 3911              	Speed_I_out:
 3912 0000 00000000 		.space	4
 3913              		.section	.bss.Speed_P_out,"aw",%nobits
 3914              		.align	2
 3917              	Speed_P_out:
 3918 0000 00000000 		.space	4
 3919              		.section	.bss.T_t,"aw",%nobits
 3920              		.align	3
 3921              		.set	.LANCHOR32,. + 0
 3924              	T_t:
 3925 0000 00000000 		.space	8
 3925      00000000 
 3926              		.section	.bss.T_t_1,"aw",%nobits
 3927              		.align	3
 3928              		.set	.LANCHOR33,. + 0
 3931              	T_t_1:
 3932 0000 00000000 		.space	8
 3932      00000000 
 3933              		.section	.bss.Test_perm,"aw",%nobits
 3934              		.set	.LANCHOR39,. + 0
 3937              	Test_perm:
 3938 0000 00       		.space	1
 3939              		.section	.bss.V_AddReg,"aw",%nobits
 3940              		.align	2
 3943              	V_AddReg:
 3944 0000 00000000 		.space	4
 3945              		.section	.bss.V_SetTotal,"aw",%nobits
 3946              		.align	2
 3949              	V_SetTotal:
 3950 0000 00000000 		.space	4
 3951              		.section	.bss.Vel_PPS_raw1,"aw",%nobits
 3952              		.align	3
 3955              	Vel_PPS_raw1:
 3956 0000 00000000 		.space	8
 3956      00000000 
 3957              		.section	.bss.delay_cnt.12054,"aw",%nobits
 3958              		.align	1
 3959              		.set	.LANCHOR1,. + 0
 3962              	delay_cnt.12054:
 3963 0000 0000     		.space	2
 3964              		.section	.bss.g_IA,"aw",%nobits
 3965              		.align	1
 3966              		.set	.LANCHOR13,. + 0
 3969              	g_IA:
 3970 0000 0000     		.space	2
 3971              		.section	.bss.g_IA_Raw,"aw",%nobits
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 106


 3972              		.align	1
 3973              		.set	.LANCHOR12,. + 0
 3976              	g_IA_Raw:
 3977 0000 0000     		.space	2
 3978              		.section	.bss.g_IB,"aw",%nobits
 3979              		.align	1
 3980              		.set	.LANCHOR14,. + 0
 3983              	g_IB:
 3984 0000 0000     		.space	2
 3985              		.section	.bss.g_IB_Raw,"aw",%nobits
 3986              		.align	1
 3987              		.set	.LANCHOR10,. + 0
 3990              	g_IB_Raw:
 3991 0000 0000     		.space	2
 3992              		.section	.bss.g_IC,"aw",%nobits
 3993              		.align	1
 3994              		.set	.LANCHOR15,. + 0
 3997              	g_IC:
 3998 0000 0000     		.space	2
 3999              		.section	.bss.g_IC_Raw,"aw",%nobits
 4000              		.align	1
 4001              		.set	.LANCHOR8,. + 0
 4004              	g_IC_Raw:
 4005 0000 0000     		.space	2
 4006              		.section	.bss.g_I_Array_Index,"aw",%nobits
 4007              		.align	2
 4010              	g_I_Array_Index:
 4011 0000 00000000 		.space	4
 4012              		.section	.bss.g_I_Array_Index_Invalid,"aw",%nobits
 4013              		.align	2
 4016              	g_I_Array_Index_Invalid:
 4017 0000 00000000 		.space	4
 4018              		.section	.bss.g_Id,"aw",%nobits
 4019              		.align	2
 4020              		.set	.LANCHOR19,. + 0
 4023              	g_Id:
 4024 0000 00000000 		.space	4
 4025              		.section	.bss.g_Id_Array,"aw",%nobits
 4026              		.align	2
 4029              	g_Id_Array:
 4030 0000 00000000 		.space	2048
 4030      00000000 
 4030      00000000 
 4030      00000000 
 4030      00000000 
 4031              		.section	.bss.g_Id_sum,"aw",%nobits
 4032              		.align	2
 4035              	g_Id_sum:
 4036 0000 00000000 		.space	4
 4037              		.section	.bss.g_Iq,"aw",%nobits
 4038              		.align	2
 4039              		.set	.LANCHOR18,. + 0
 4042              	g_Iq:
 4043 0000 00000000 		.space	4
 4044              		.section	.bss.g_Iq_Array,"aw",%nobits
 4045              		.align	2
 4048              	g_Iq_Array:
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 107


 4049 0000 00000000 		.space	2048
 4049      00000000 
 4049      00000000 
 4049      00000000 
 4049      00000000 
 4050              		.section	.bss.g_Iq_sum,"aw",%nobits
 4051              		.align	2
 4054              	g_Iq_sum:
 4055 0000 00000000 		.space	4
 4056              		.section	.bss.g_Pos_Icnt,"aw",%nobits
 4057              		.align	3
 4060              	g_Pos_Icnt:
 4061 0000 00000000 		.space	8
 4061      00000000 
 4062              		.section	.bss.g_Pos_PID_16BIT,"aw",%nobits
 4063              		.align	2
 4066              	g_Pos_PID_16BIT:
 4067 0000 00000000 		.space	4
 4068              		.section	.bss.g_Pos_Spd,"aw",%nobits
 4069              		.align	2
 4072              	g_Pos_Spd:
 4073 0000 00000000 		.space	4
 4074              		.section	.bss.g_Sector,"aw",%nobits
 4075              		.align	2
 4076              		.set	.LANCHOR26,. + 0
 4079              	g_Sector:
 4080 0000 00000000 		.space	4
 4081              		.section	.bss.g_Spd_Icnt,"aw",%nobits
 4082              		.align	2
 4085              	g_Spd_Icnt:
 4086 0000 00000000 		.space	4
 4087              		.section	.bss.g_Sum_ABC,"aw",%nobits
 4088              		.align	1
 4091              	g_Sum_ABC:
 4092 0000 0000     		.space	2
 4093              		.section	.bss.g_V_Alpha,"aw",%nobits
 4094              		.align	2
 4095              		.set	.LANCHOR23,. + 0
 4098              	g_V_Alpha:
 4099 0000 00000000 		.space	4
 4100              		.section	.bss.g_V_Beta,"aw",%nobits
 4101              		.align	2
 4102              		.set	.LANCHOR24,. + 0
 4105              	g_V_Beta:
 4106 0000 00000000 		.space	4
 4107              		.section	.bss.g_Vd,"aw",%nobits
 4108              		.align	2
 4109              		.set	.LANCHOR22,. + 0
 4112              	g_Vd:
 4113 0000 00000000 		.space	4
 4114              		.section	.bss.g_Vd_Pu,"aw",%nobits
 4115              		.align	2
 4118              	g_Vd_Pu:
 4119 0000 00000000 		.space	4
 4120              		.section	.bss.g_Vq,"aw",%nobits
 4121              		.align	2
 4122              		.set	.LANCHOR21,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 108


 4125              	g_Vq:
 4126 0000 00000000 		.space	4
 4127              		.section	.bss.g_Vq_Pu,"aw",%nobits
 4128              		.align	2
 4131              	g_Vq_Pu:
 4132 0000 00000000 		.space	4
 4133              		.section	.bss.g_decLen,"aw",%nobits
 4134              		.align	2
 4137              	g_decLen:
 4138 0000 00000000 		.space	4
 4139              		.section	.bss.g_posPID_e,"aw",%nobits
 4140              		.align	2
 4143              	g_posPID_e:
 4144 0000 00000000 		.space	4
 4145              		.section	.bss.g_spd_error,"aw",%nobits
 4146              		.align	2
 4149              	g_spd_error:
 4150 0000 00000000 		.space	4
 4151              		.section	.bss.g_testAngle,"aw",%nobits
 4152              		.align	1
 4155              	g_testAngle:
 4156 0000 0000     		.space	2
 4157              		.section	.bss.hall_cnt,"aw",%nobits
 4158              		.align	2
 4161              	hall_cnt:
 4162 0000 00000000 		.space	4
 4163              		.section	.bss.hall_now_time,"aw",%nobits
 4164              		.align	2
 4167              	hall_now_time:
 4168 0000 00000000 		.space	4
 4169              		.section	.bss.hall_previous_1_time,"aw",%nobits
 4170              		.align	2
 4173              	hall_previous_1_time:
 4174 0000 00000000 		.space	4
 4175              		.section	.bss.hall_previous_2_time,"aw",%nobits
 4176              		.align	2
 4179              	hall_previous_2_time:
 4180 0000 00000000 		.space	4
 4181              		.section	.bss.hall_previous_3_time,"aw",%nobits
 4182              		.align	2
 4185              	hall_previous_3_time:
 4186 0000 00000000 		.space	4
 4187              		.section	.bss.hall_speed_sample_cnt,"aw",%nobits
 4188              		.align	2
 4191              	hall_speed_sample_cnt:
 4192 0000 00000000 		.space	4
 4193              		.section	.bss.hall_speed_sample_timeout,"aw",%nobits
 4194              		.align	2
 4197              	hall_speed_sample_timeout:
 4198 0000 00000000 		.space	4
 4199              		.section	.bss.hall_speed_sample_timeout_cnt,"aw",%nobits
 4200              		.align	2
 4203              	hall_speed_sample_timeout_cnt:
 4204 0000 00000000 		.space	4
 4205              		.section	.bss.index_I_phase,"aw",%nobits
 4206              		.align	2
 4207              		.set	.LANCHOR30,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 109


 4210              	index_I_phase:
 4211 0000 00000000 		.space	4
 4212              		.section	.bss.last_alpha,"aw",%nobits
 4213              		.align	2
 4214              		.set	.LANCHOR16,. + 0
 4217              	last_alpha:
 4218 0000 00000000 		.space	4
 4219              		.section	.bss.last_beta,"aw",%nobits
 4220              		.align	2
 4221              		.set	.LANCHOR17,. + 0
 4224              	last_beta:
 4225 0000 00000000 		.space	4
 4226              		.section	.bss.last_hall_sample_time,"aw",%nobits
 4227              		.align	2
 4230              	last_hall_sample_time:
 4231 0000 00000000 		.space	4
 4232              		.section	.bss.last_time4_capture_ch1,"aw",%nobits
 4233              		.align	2
 4236              	last_time4_capture_ch1:
 4237 0000 00000000 		.space	4
 4238              		.section	.bss.motor_para_identification_count_Tms,"aw",%nobits
 4239              		.align	2
 4240              		.set	.LANCHOR27,. + 0
 4243              	motor_para_identification_count_Tms:
 4244 0000 00000000 		.space	4
 4245              		.section	.bss.pid_hall_sample_time_index,"aw",%nobits
 4246              		.align	2
 4249              	pid_hall_sample_time_index:
 4250 0000 00000000 		.space	4
 4251              		.section	.bss.pos_error_to_target,"aw",%nobits
 4252              		.align	2
 4253              		.set	.LANCHOR0,. + 0
 4256              	pos_error_to_target:
 4257 0000 00000000 		.space	4
 4258              		.section	.bss.s_Disable_Delay,"aw",%nobits
 4259              		.align	2
 4260              		.set	.LANCHOR41,. + 0
 4263              	s_Disable_Delay:
 4264 0000 00000000 		.space	4
 4265              		.section	.bss.s_Enable_Delay.12093,"aw",%nobits
 4266              		.align	2
 4267              		.set	.LANCHOR40,. + 0
 4270              	s_Enable_Delay.12093:
 4271 0000 00000000 		.space	4
 4272              		.section	.bss.s_count.12092,"aw",%nobits
 4273              		.align	2
 4274              		.set	.LANCHOR36,. + 0
 4277              	s_count.12092:
 4278 0000 00000000 		.space	4
 4279              		.section	.bss.s_count.12157,"aw",%nobits
 4280              		.align	2
 4281              		.set	.LANCHOR35,. + 0
 4284              	s_count.12157:
 4285 0000 00000000 		.space	4
 4286              		.section	.bss.s_test_speed_t_count.12049,"aw",%nobits
 4287              		.align	2
 4288              		.set	.LANCHOR38,. + 0
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 110


 4291              	s_test_speed_t_count.12049:
 4292 0000 00000000 		.space	4
 4293              		.section	.bss.sin_wave_t_us,"aw",%nobits
 4294              		.align	2
 4295              		.set	.LANCHOR28,. + 0
 4298              	sin_wave_t_us:
 4299 0000 00000000 		.space	4
 4300              		.section	.bss.test.12028,"aw",%nobits
 4301              		.align	1
 4302              		.set	.LANCHOR25,. + 0
 4305              	test.12028:
 4306 0000 0000     		.space	2
 4307              		.section	.data.Test_dirt,"aw",%progbits
 4308              		.align	2
 4309              		.set	.LANCHOR37,. + 0
 4312              	Test_dirt:
 4313 0000 01000000 		.word	1
 4314              		.section	.data.Test_dirt_last,"aw",%progbits
 4315              		.align	2
 4318              	Test_dirt_last:
 4319 0000 01000000 		.word	1
 4320              		.section	.data.phase_current_rev_gain_,"aw",%progbits
 4321              		.align	2
 4322              		.set	.LANCHOR7,. + 0
 4325              	phase_current_rev_gain_:
 4326 0000 103E783D 		.word	1031290384
 4327              		.section	.data.shunt_conductance1,"aw",%progbits
 4328              		.align	2
 4329              		.set	.LANCHOR11,. + 0
 4332              	shunt_conductance1:
 4333 0000 0D4AA542 		.word	1118128653
 4334              		.section	.data.shunt_conductance2,"aw",%progbits
 4335              		.align	2
 4336              		.set	.LANCHOR9,. + 0
 4339              	shunt_conductance2:
 4340 0000 74D1B542 		.word	1119211892
 4341              		.section	.data.v,"aw",%progbits
 4342              		.align	2
 4343              		.set	.LANCHOR20,. + 0
 4346              	v:
 4347 0000 A4703D41 		.word	1094545572
 4348              		.text
 4349              	.Letext0:
 4350              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4351              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\include
 4352              		.file 4 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 4353              		.file 5 "Drivers/CMSIS/Include/core_cm4.h"
 4354              		.file 6 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/system_stm32g4xx.h"
 4355              		.file 7 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g431xx.h"
 4356              		.file 8 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g4xx.h"
 4357              		.file 9 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 4358              		.file 10 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 4359              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_adc.h"
 4360              		.file 12 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_exti.h"
 4361              		.file 13 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_flash.h"
 4362              		.file 14 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_spi.h"
 4363              		.file 15 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_tim.h"
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 111


 4364              		.file 16 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_uart.h"
 4365              		.file 17 "Inc/pid.h"
 4366              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4367              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4368              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\lib\\gcc\\arm-none-ea
 4369              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4370              		.file 22 "c:\\program files (x86)\\gnu tools arm embedded\\7 2018-q2-update\\arm-none-eabi\\includ
 4371              		.file 23 "Inc/uart.h"
 4372              		.file 24 "Inc/pwm.h"
 4373              		.file 25 "Inc/spi_MEncoder.h"
 4374              		.file 26 "Inc/adc.h"
 4375              		.file 27 "Inc/stm32_math_sin.h"
 4376              		.file 28 "Inc/profile_joint.h"
 4377              		.file 29 "Inc/icmu.h"
 4378              		.file 30 "Inc/performance_test.h"
 4379              		.file 31 "Inc/global.h"
 4380              		.file 32 "Inc/sensorless.h"
 4381              		.file 33 "Inc/security.h"
 4382              		.file 34 "Inc/stm32_math.h"
 4383              		.file 35 "Inc/parameter_identification.h"
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 112


DEFINED SYMBOLS
                            *ABS*:00000000 pid.c
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:18     .text.PID_ini:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:25     .text.PID_ini:00000000 PID_ini
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:47     .text.PID_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:54     .text.PID_control:00000000 PID_control
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:245    .text.PID_control:00000104 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:252    .text.force_PID_out:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:259    .text.force_PID_out:00000000 force_PID_out
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:317    .text.PositionPID:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:324    .text.PositionPID:00000000 PositionPID
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:453    .text.PositionPID:000000b4 $d
                            *COM*:00000048 pid_pos
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:466    .text.Gripper_control:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:473    .text.Gripper_control:00000000 Gripper_control
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:688    .text.Gripper_control:0000011c $d
                            *COM*:00000048 pid_spd
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:707    .text.phase_current_from_adcval:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:714    .text.phase_current_from_adcval:00000000 phase_current_from_adcval
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:740    .text.phase_current_from_adcval:0000001c $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:746    .text.GetCurrent:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:753    .text.GetCurrent:00000000 GetCurrent
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:992    .text.GetCurrent:00000190 $d
                            *COM*:00000004 I_Beta
                            *COM*:00000004 I_Alpha
                            *COM*:00000004 delta_alpha
                            *COM*:00000004 delata_beta
                            *COM*:00000048 pid_IQ
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1024   .text.park_transform:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1031   .text.park_transform:00000000 park_transform
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1103   .text.park_transform:00000054 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1114   .text.hfi_update_angle:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1121   .text.hfi_update_angle:00000000 hfi_update_angle
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1343   .text.hfi_update_angle:00000160 $d
                            *COM*:00000048 pid_pll
                            *COM*:00000004 L
                            *COM*:00000004 observer_ElectricAngle
                            *COM*:00000004 temp_L
                            *COM*:00000004 observer_speed
                            *COM*:00000004 integre_observer_ElectricAngle
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1371   .text.ServoPro_Fast:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1378   .text.ServoPro_Fast:00000000 ServoPro_Fast
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1722   .text.ServoPro_Fast:000001ec $d
                            *COM*:00000002 anlge_reg
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:1745   .text.ServoPro_Fast:00000240 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2051   .text.ServoPro_Fast:00000472 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2058   .text.ServoPro_Fast:0000047e $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2183   .text.ServoPro_Fast:00000558 $d
                            *COM*:00000004 g_X
                            *COM*:00000004 g_Y
                            *COM*:00000004 g_Z
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2203   .text.ServoPro_Fast:0000059c $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2551   .text.ServoPro_Fast:000007c8 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2572   .text.Loop3_EnableManage:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2579   .text.Loop3_EnableManage:00000000 Loop3_EnableManage
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2706   .text.Loop3_EnableManage:000000bc $d
                            *COM*:00000048 pid_ID
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 113


                            *COM*:00000048 pid_force
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2717   .text.work_var_updata:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2724   .text.work_var_updata:00000000 work_var_updata
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2893   .text.work_var_updata:0000011c $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2906   .text.EXTI3_IRQHandler:00000000 $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:2913   .text.EXTI3_IRQHandler:00000000 EXTI3_IRQHandler
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3345   .text.EXTI3_IRQHandler:000002b0 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3371   .text.EXTI3_IRQHandler:000002fc $t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3696   .text.EXTI3_IRQHandler:00000504 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3955   .bss.Vel_PPS_raw1:00000000 Vel_PPS_raw1
                            *COM*:00000008 hall_total_time
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4185   .bss.hall_previous_3_time:00000000 hall_previous_3_time
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4179   .bss.hall_previous_2_time:00000000 hall_previous_2_time
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4173   .bss.hall_previous_1_time:00000000 hall_previous_1_time
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4167   .bss.hall_now_time:00000000 hall_now_time
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4161   .bss.hall_cnt:00000000 hall_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4197   .bss.hall_speed_sample_timeout:00000000 hall_speed_sample_timeout
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4191   .bss.hall_speed_sample_cnt:00000000 hall_speed_sample_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4203   .bss.hall_speed_sample_timeout_cnt:00000000 hall_speed_sample_timeout_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4236   .bss.last_time4_capture_ch1:00000000 last_time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4249   .bss.pid_hall_sample_time_index:00000000 pid_hall_sample_time_index
                            *COM*:00000028 pid_hall_sample_time_point
                            *COM*:00000004 speed3
                            *COM*:00000004 speed2
                            *COM*:00000004 speed1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4230   .bss.last_hall_sample_time:00000000 last_hall_sample_time
                            *COM*:00000004 pid_last_hall_ture_value1
                            *COM*:00000004 pid_hall_ture_value1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3899   .bss.ServoPro_En_count:00000000 ServoPro_En_count
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4339   .data.shunt_conductance2:00000000 shunt_conductance2
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4332   .data.shunt_conductance1:00000000 shunt_conductance1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4325   .data.phase_current_rev_gain_:00000000 phase_current_rev_gain_
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4224   .bss.last_beta:00000000 last_beta
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4217   .bss.last_alpha:00000000 last_alpha
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4263   .bss.s_Disable_Delay:00000000 s_Disable_Delay
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4346   .data.v:00000000 v
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4256   .bss.pos_error_to_target:00000000 pos_error_to_target
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3931   .bss.T_t_1:00000000 T_t_1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3924   .bss.T_t:00000000 T_t
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3875   .bss.Para_Identificaion:00000000 Para_Identificaion
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4210   .bss.index_I_phase:00000000 index_I_phase
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3868   .bss.I_phase:00000000 I_phase
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4243   .bss.motor_para_identification_count_Tms:00000000 motor_para_identification_count_Tms
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4298   .bss.sin_wave_t_us:00000000 sin_wave_t_us
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4318   .data.Test_dirt_last:00000000 Test_dirt_last
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4312   .data.Test_dirt:00000000 Test_dirt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3937   .bss.Test_perm:00000000 Test_perm
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3832   .bss.Flag_Set_OpenLen:00000000 Flag_Set_OpenLen
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3826   .bss.Brake_rellease_delay_cnt:00000000 Brake_rellease_delay_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3820   .bss.Brake_rellease_delay:00000000 Brake_rellease_delay
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3855   .bss.Grriper_Run_off_delay_cnt:00000000 Grriper_Run_off_delay_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3861   .bss.Grriper_Run_on_delay_cnt:00000000 Grriper_Run_on_delay_cnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3849   .bss.Grriper_Run_last:00000000 Grriper_Run_last
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3843   .bss.Grriper_Run:00000000 Grriper_Run
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3837   .bss.Grriper_Ready:00000000 Grriper_Ready
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3905   .bss.Spd_RPM_CatchLimit:00000000 Spd_RPM_CatchLimit
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4137   .bss.g_decLen:00000000 g_decLen
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 114


C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4149   .bss.g_spd_error:00000000 g_spd_error
                            *COM*:00000004 time4_capture_ch1
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3893   .bss.PosAtDead_Flag_Last:00000000 PosAtDead_Flag_Last
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3887   .bss.PosAtDead_Flag:00000000 PosAtDead_Flag
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4143   .bss.g_posPID_e:00000000 g_posPID_e
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4155   .bss.g_testAngle:00000000 g_testAngle
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3949   .bss.V_SetTotal:00000000 V_SetTotal
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3943   .bss.V_AddReg:00000000 V_AddReg
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4072   .bss.g_Pos_Spd:00000000 g_Pos_Spd
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4066   .bss.g_Pos_PID_16BIT:00000000 g_Pos_PID_16BIT
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3911   .bss.Speed_I_out:00000000 Speed_I_out
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3917   .bss.Speed_P_out:00000000 Speed_P_out
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4060   .bss.g_Pos_Icnt:00000000 g_Pos_Icnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4085   .bss.g_Spd_Icnt:00000000 g_Spd_Icnt
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4079   .bss.g_Sector:00000000 g_Sector
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4105   .bss.g_V_Beta:00000000 g_V_Beta
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4098   .bss.g_V_Alpha:00000000 g_V_Alpha
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4118   .bss.g_Vd_Pu:00000000 g_Vd_Pu
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4131   .bss.g_Vq_Pu:00000000 g_Vq_Pu
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4112   .bss.g_Vd:00000000 g_Vd
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4125   .bss.g_Vq:00000000 g_Vq
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4035   .bss.g_Id_sum:00000000 g_Id_sum
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4054   .bss.g_Iq_sum:00000000 g_Iq_sum
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4016   .bss.g_I_Array_Index_Invalid:00000000 g_I_Array_Index_Invalid
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4010   .bss.g_I_Array_Index:00000000 g_I_Array_Index
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4029   .bss.g_Id_Array:00000000 g_Id_Array
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4048   .bss.g_Iq_Array:00000000 g_Iq_Array
                            *COM*:00000004 g_Id_filter
                            *COM*:00000004 g_Iq_filter
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4023   .bss.g_Id:00000000 g_Id
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4042   .bss.g_Iq:00000000 g_Iq
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4091   .bss.g_Sum_ABC:00000000 g_Sum_ABC
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4004   .bss.g_IC_Raw:00000000 g_IC_Raw
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3997   .bss.g_IC:00000000 g_IC
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3990   .bss.g_IB_Raw:00000000 g_IB_Raw
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3983   .bss.g_IB:00000000 g_IB
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3976   .bss.g_IA_Raw:00000000 g_IA_Raw
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3969   .bss.g_IA:00000000 g_IA
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3821   .bss.Brake_rellease_delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3823   .bss.Brake_rellease_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3833   .bss.Flag_Set_OpenLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3838   .bss.Grriper_Ready:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3844   .bss.Grriper_Run:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3850   .bss.Grriper_Run_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3852   .bss.Grriper_Run_off_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3858   .bss.Grriper_Run_on_delay_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3864   .bss.I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3871   .bss.Para_Identificaion:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3881   .bss.PlusPosition_flag.12156:00000000 PlusPosition_flag.12156
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3882   .bss.PlusPosition_flag.12156:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3888   .bss.PosAtDead_Flag:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3894   .bss.PosAtDead_Flag_Last:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3896   .bss.ServoPro_En_count:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3902   .bss.Spd_RPM_CatchLimit:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3908   .bss.Speed_I_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3914   .bss.Speed_P_out:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3920   .bss.T_t:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 115


C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3927   .bss.T_t_1:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3938   .bss.Test_perm:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3940   .bss.V_AddReg:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3946   .bss.V_SetTotal:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3952   .bss.Vel_PPS_raw1:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3958   .bss.delay_cnt.12054:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3962   .bss.delay_cnt.12054:00000000 delay_cnt.12054
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3965   .bss.g_IA:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3972   .bss.g_IA_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3979   .bss.g_IB:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3986   .bss.g_IB_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:3993   .bss.g_IC:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4000   .bss.g_IC_Raw:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4007   .bss.g_I_Array_Index:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4013   .bss.g_I_Array_Index_Invalid:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4019   .bss.g_Id:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4026   .bss.g_Id_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4032   .bss.g_Id_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4038   .bss.g_Iq:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4045   .bss.g_Iq_Array:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4051   .bss.g_Iq_sum:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4057   .bss.g_Pos_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4063   .bss.g_Pos_PID_16BIT:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4069   .bss.g_Pos_Spd:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4075   .bss.g_Sector:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4082   .bss.g_Spd_Icnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4088   .bss.g_Sum_ABC:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4094   .bss.g_V_Alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4101   .bss.g_V_Beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4108   .bss.g_Vd:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4115   .bss.g_Vd_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4121   .bss.g_Vq:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4128   .bss.g_Vq_Pu:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4134   .bss.g_decLen:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4140   .bss.g_posPID_e:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4146   .bss.g_spd_error:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4152   .bss.g_testAngle:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4158   .bss.hall_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4164   .bss.hall_now_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4170   .bss.hall_previous_1_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4176   .bss.hall_previous_2_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4182   .bss.hall_previous_3_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4188   .bss.hall_speed_sample_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4194   .bss.hall_speed_sample_timeout:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4200   .bss.hall_speed_sample_timeout_cnt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4206   .bss.index_I_phase:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4213   .bss.last_alpha:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4220   .bss.last_beta:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4227   .bss.last_hall_sample_time:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4233   .bss.last_time4_capture_ch1:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4239   .bss.motor_para_identification_count_Tms:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4246   .bss.pid_hall_sample_time_index:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4252   .bss.pos_error_to_target:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4259   .bss.s_Disable_Delay:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4266   .bss.s_Enable_Delay.12093:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4270   .bss.s_Enable_Delay.12093:00000000 s_Enable_Delay.12093
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4273   .bss.s_count.12092:00000000 $d
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 116


C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4277   .bss.s_count.12092:00000000 s_count.12092
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4280   .bss.s_count.12157:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4284   .bss.s_count.12157:00000000 s_count.12157
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4287   .bss.s_test_speed_t_count.12049:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4291   .bss.s_test_speed_t_count.12049:00000000 s_test_speed_t_count.12049
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4294   .bss.sin_wave_t_us:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4301   .bss.test.12028:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4305   .bss.test.12028:00000000 test.12028
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4308   .data.Test_dirt:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4315   .data.Test_dirt_last:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4321   .data.phase_current_rev_gain_:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4328   .data.shunt_conductance1:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4335   .data.shunt_conductance2:00000000 $d
C:\Users\82057\AppData\Local\Temp\cc8NJIya.s:4342   .data.v:00000000 $d

UNDEFINED SYMBOLS
g_CmdMap
gPos_ds
Profile_moving
flag_posReg_strengthen
Profile_ParaSet
Profile
Gripper_Move
Motor_forbidden
Flag_contact
Flag_grip_F_OK
Flag_grip_P_OK
Flag_rellease_P_OK
tCnt_f
g_pos_tag
Flag_Profile_Enable
update_current_meas
Q15_MUL
Math_Sin_EN360
Math_Cos_EN360
g_ZeroCur_MotorC
g_ZeroCur_MotorB
g_ZeroCur_MotorA
motor_
g_ElectricAngle
g_bEnableHB
g_pCur_ref_base_mA
g_high_fre_pulse
__aeabi_f2d
__aeabi_dmul
__aeabi_i2d
__aeabi_ddiv
__aeabi_d2f
EN_90
__aeabi_d2uiz
GetElectricAngle
measure_R
update_current_control
PWM_OutPut_Open
motor_fault_check
non_linear_flux_observer
encode_sample
ARM GAS  C:\Users\82057\AppData\Local\Temp\cc8NJIya.s 			page 117


sensorless_sensor_phase_switch
g_Timer1CCR
EN_0
EN_360
bus_voltage_
sqrtf
Q16_MUL
flag_processing_Jtest
state_Jtest
g_Sector_test
log
HAL_EXTI_GenerateSWI
g_Encode_offset
g_ThreeLoopParaBefLock
MTPro
get_average_force_data
icmu_sdtransmission_test
Get_Pos_Rod
Stroke_protection
PWM_Disable
g_servo_cmd_period_cnt
force_set
force_act
status_Mode_POSITION_FORCE
Flag_1ms
s_count_50ms
Flag_50ms
Motor_emergercy_stop
Motor_pause_flag
PWM_Enable
g_flag_monitor_from_host
